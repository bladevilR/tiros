(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58d495c5"],{"3c2d":function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{width:"100%","overflow-x":"hidden"}},[e("a-button",{attrs:{"na-btn-type":"print",type:"primary"},on:{click:t.exportPrint}},[t._v("导出打印")]),e("div",{staticStyle:{margin:"0px",padding:"0px",width:"100%",height:"calc(100vh - 85px)"},attrs:{id:"luckysheet"}}),t.showLoading?e("div",{staticStyle:{width:"100%","text-align":"center",position:"absolute",top:"0px",height:"100%","font-size":"16px","z-index":"1000000000",background:"#fff"}},[t._m(0)]):t._e()],1)},n=[function(){var t=this,e=t._self._c;return e("div",{staticStyle:{position:"relative",top:"45%",width:"100%"}},[e("div",{staticClass:"luckysheetLoaderGif"}),e("span",[t._v("加载中...")])])}],a=o("8fad"),i=o("2410"),l=o.n(i),c=o("e24e"),s={name:"view",props:["customId","formName"],data:function(){return{showLoading:!1,defaultOptions:{container:"luckysheet",title:"sheet",column:26,row:50,lang:"zh",allowEdit:!0,showinfobar:!1,sheetFormulaBar:!1,showsheetbar:!1,showstatisticBar:!0,enableAddRow:!1,enableAddCol:!1,showtoolbar:!1}}},beforeDestroy:function(){luckysheet.destroy()},mounted:function(){var t=this,e=l()(this.defaultOptions);e.data=[{name:"Sheet1",color:"",status:"1",order:"0",index:0,ch_width:2044,rh_height:1080}],this.customId?Object(a["Db"])(this.customId).then((function(t){if(t.success){var o=JSON.parse(t.result);o.scrollLeft=0,o.scrollTop=0,e.showtoolbarConfig={},o.config.authority={sheet:1,hintText:"禁止编辑",allowRangeList:[]},e.data=[o],luckysheet.destroy(),luckysheet.create(e)}})).catch((function(o){t.$message.error("加载表单内容异常"),luckysheet.destroy(),luckysheet.create(e)})):(luckysheet.destroy(),luckysheet.create(e))},methods:{exportPrint:function(){try{var t=this.formName;t||(t="export"),Object(c["a"])(luckysheet.getAllSheets(),t)}catch(e){}}}},d=s,h=o("2877"),u=Object(h["a"])(d,r,n,!1,null,"22edf2fe",null);e["default"]=u.exports},e24e:function(t,e,o){"use strict";o.d(e,"a",(function(){return c}));var r=o("e8ae"),n=o.n(r),a=o("21a6"),i=o.n(a),l=(o("7268"),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"),c=function(t,e){var o=new n.a.Workbook;"[object Object]"===Object.prototype.toString.call(t)&&(t=[t]),t.forEach((function(t){if(0===t.data.length)return!0;var e=o.addWorksheet(t.name),r=t.config&&t.config.merge||{},n=t.config&&t.config.borderInfo||{},a=t.config&&t.config.columnlen||{},i=t.images||{};return h(i,o,e),d(a,e),s(t.config,e),g(t.data,e),u(r,e),f(n,e),!0}));var r=o.xlsx.writeBuffer().then((function(t){var o=new Blob([t],{type:l});i.a.saveAs(o,"".concat(e,".xlsx"))}));return r},s=function(t,e){if(t&&t.rowlen)for(var o in t.rowlen){var r=parseInt(o),n=parseInt(t.rowlen[o]),a=e.getRow(r+1);a.height=n}},d=function(t,e){for(var o in t){var r=parseInt(o),n=parseInt(t[o]);e.getColumn(r+1).width=parseInt(n/7)}},h=function(t,e,o){for(var r in t){var n=t[r],a=n.src.split(";base64,"),i=a[0].replaceAll("data:image/",""),l=e.addImage({base64:n.src,extension:i}),c=luckysheet.location(n.default.left,n.default.top);o.addImage(l,{tl:{col:c.col,row:c.row},ext:{width:n.default.width,height:n.default.height}})}},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,o=Object.values(t);o.forEach((function(t){e.mergeCells(t.r+1,t.c+1,t.r+t.rs,t.c+t.cs)}))},f=function(t,e){Array.isArray(t)&&t.forEach((function(t){if("range"===t.rangeType)for(var o=b(t.borderType,t.style,t.color),r=t.range[0],n=r.row,a=r.column,i=n[0]+1;i<n[1]+2;i++)for(var l=a[0]+1;l<a[1]+2;l++)e.getCell(i,l).border=o;if("cell"===t.rangeType){var c=t.value,s=c.col_index,d=c.row_index,h=Object.assign({},t.value);delete h.col_index,delete h.row_index;var u=y(h,d,s);e.getCell(d+1,s+1).border=u}}))},g=function(t,e){Array.isArray(t)&&t.forEach((function(t,o){t.every((function(t,r){if(!t)return!0;var n=v(t.bg),a=p(t.ff,t.fc,t.bl,t.it,t.fs,t.cl,t.ul),i=m(t.vt,t.ht,t.tb,t.tr),l="";t.f?l={formula:t.f,result:t.v}:!t.v&&t.ct&&t.ct.s?t.ct.s.forEach((function(t){l+=t.v})):l=t.v;var c=w(r),s=e.getCell(c+(o+1));for(var d in n){s.fill=n;break}return s.font=a,s.alignment=i,s.value=l,!0}))}))},v=function(t){if(!t)return{};var e={type:"pattern",pattern:"solid",fgColor:{argb:t.replace("#","")}};return e},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000000",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l={0:"微软雅黑",1:"宋体（Song）",2:"黑体（ST Heiti）",3:"楷体（ST Kaiti）",4:"仿宋（ST FangSong）",5:"新宋体（ST Song）",6:"华文新魏",7:"华文行楷",8:"华文隶书",9:"Arial",10:"Times New Roman ",11:"Tahoma ",12:"Verdana",num2bl:function(t){return 0!==t}},c={name:"number"===typeof t?l[t]:t,family:1,size:n,color:{argb:e.replace("#","")},bold:l.num2bl(o),italic:l.num2bl(r),underline:l.num2bl(i),strike:l.num2bl(a)};return c},m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"default",n={vertical:{0:"middle",1:"top",2:"bottom",default:"top"},horizontal:{0:"center",1:"left",2:"right",default:"left"},wrapText:{0:!1,1:!1,2:!0,default:!1},textRotation:{0:0,1:45,2:-45,3:"vertical",4:90,5:-90,default:0}},a={vertical:n.vertical[t],horizontal:n.horizontal[e],wrapText:n.wrapText[o],textRotation:n.textRotation[r]};return a},b=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000";if(!t)return{};var r={type:{"border-all":"all","border-top":"top","border-right":"right","border-bottom":"bottom","border-left":"left"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}},n={style:r.style[e],color:{argb:o.replace("#","")}},a={};return"all"===r.type[t]?(a["top"]=n,a["right"]=n,a["bottom"]=n,a["left"]=n):a[r.type[t]]=n,a};function y(t,e,o){var r={},n={type:{l:"left",r:"right",b:"bottom",t:"top"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}};for(var a in t)-1===t[a].color.indexOf("rgb")?r[n.type[a]]={style:n.style[t[a].style],color:{argb:t[a].color.replace("#","")}}:r[n.type[a]]={style:n.style[t[a].style],color:{argb:t[a].color}};return r}function w(t){var e="A".charCodeAt(0),o="Z".charCodeAt(0),r=o-e+1,n="";while(t>=0)n=String.fromCharCode(t%r+e)+n,t=Math.floor(t/r)-1;return n}}}]);