(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0151438a","chunk-2d0be16a"],{"2f88":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"导入EXCEL",width:600,visible:e.visible,confirmLoading:e.uploading},on:{cancel:e.handleClose}},[t("a-form-model",{attrs:{form:e.form}},[t("a-row",[t("a-col",[t("a-form-model-item",{attrs:{prop:"fileList",labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"请选择文件"}},[t("a-upload",{attrs:{name:"file",multiple:!1,accept:".xls,.xlsx",fileList:e.form.fileList,remove:e.handleRemove,beforeUpload:e.beforeUpload}},[t("a-button",{attrs:{disabled:e.form.fileList.length>=e.sum}},[t("a-icon",{attrs:{type:"upload"}}),e._v(" 选择导入文件 ")],1)],1)],1)],1),t("a-col",[t("a-form-model-item",{attrs:{prop:"",labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"清除已有数据"}},[t("a-switch",{model:{value:e.form.clear,callback:function(t){e.$set(e.form,"clear",t)},expression:"form.clear"}})],1)],1)],1)],1),t("template",{slot:"footer"},[t("a-button",{on:{click:e.handleClose}},[e._v("关闭")]),t("a-button",{attrs:{type:"primary",disabled:0===e.form.fileList.length,loading:e.uploading},on:{click:e.handleImport}},[e._v(" "+e._s(e.uploading?"导入中...":"开始导入")+" ")])],1)],2)},i=[],l=a("0fea");function o(e){return c(e)||u(e)||s(e)||n()}function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){if(e){if("string"==typeof e)return d(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?d(e,t):void 0}}function u(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function c(e){if(Array.isArray(e))return d(e)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=Array(t);a<t;a++)r[a]=e[a];return r}var m={name:"GroupStockImport",props:{url:{type:String,default:"",required:!1},biz:{type:String,default:"",required:!1},sum:{type:Number,default:1}},data:function(){return{visible:!1,uploading:!1,form:{fileList:[],clear:!0},uploadAction:"",foreignKeys:"",labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}}},watch:{url:function(e){e&&(this.uploadAction=e)}},created:function(){this.uploadAction=this.url},mounted:function(){},methods:{handleClose:function(){this.visible=!1},show:function(e){Object.assign(this.form,this.$options.data().form),this.uploading=!1,this.visible=!0,this.foreignKeys=e},handleRemove:function(e){var t=this.form.fileList.indexOf(e),a=this.form.fileList;a.splice(t,1),this.fileList=JSON.parse(JSON.stringify(a))},beforeUpload:function(e){return this.form.fileList=[].concat(o(this.form.fileList),[e]),!1},handleImport:function(){var e=this,t=this.form.fileList,a=new FormData;this.biz&&a.append("isSingleTableImport",this.biz),this.foreignKeys&&this.foreignKeys.length>0&&a.append("foreignKeys",this.foreignKeys),t.forEach((function(e){a.append("file",e)})),a.append("cleanup",this.form.clear),this.uploading=!0,Object(l["j"])(this.uploadAction,a).then((function(t){e.uploading=!1,t.success?(e.$message.success(t.message),e.visible=!1,e.$emit("ok"),Object.assign(e.form,e.$options.data().form)):e.$message.warning(t.message)}))}}},h=m,p=a("2877"),f=Object(p["a"])(h,r,i,!1,null,"0e723c8c",null);t["default"]=f.exports},"5f50":function(e,t,a){},6651:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bodyWrapper"},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"物资"}},[t("a-input",{attrs:{placeholder:"物资编号或名称",disabled:e.searchTextDis,allowClear:""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"物资类别"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_material_type"},model:{value:e.queryParam.materialType,callback:function(t){e.$set(e.queryParam,"materialType",t)},expression:"queryParam.materialType"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"车辆"}},[t("j-dict-select-seach-tag",{attrs:{placeholder:"请选择",dictCode:"bu_train_info,train_no,train_no"},model:{value:e.queryParam.trainNo,callback:function(t){e.$set(e.queryParam,"trainNo",t)},expression:"queryParam.trainNo"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"班组"}},[t("j-dict-select-tag",{ref:"groupSelect",attrs:{disabled:e.disGroup,placeholder:"请选择班组",dictCode:"bu_mtr_workshop_group,group_name,id"},on:{loaderData:e.dictLoaderData},model:{value:e.queryParam.groupId,callback:function(t){e.$set(e.queryParam,"groupId",t)},expression:"queryParam.groupId"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:4,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")]),e.isComponent?e._e():t("a-button",{on:{click:e.setMaterialAttribute}},[e._v("物资属性设置")]),e.isComponent?e._e():t("a-button",{on:{click:e.recoverMaterialAttribute}},[e._v("恢复车间属性")]),e.isComponent?e._e():t("a-button",{on:{click:e.transToTurnover}},[e._v("转入周转件")]),e.isComponent?e._e():t("a-button",{directives:[{name:"has",rawName:"v-has",value:"group:stock:import",expression:"'group:stock:import'"}],on:{click:function(t){return e.$refs.importModal.show()}}},[e._v("导入")]),e.isComponent?e._e():t("a-button",{on:{click:e.exportGroupStock}},[e._v("导出")])],1)],1)])],1)],1)],1),t("div",{style:e.tableHeight.top},[t("vxe-table",{ref:"listTable",attrs:{border:"",align:e.allAlign,data:e.tableData,height:"auto","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"manual",mode:"row"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"materialTypeCode",title:"物资编码",width:"140","header-align":"center",align:"center"}}),t("vxe-table-column",{attrs:{field:"materialTypeName",title:"物资名称",width:"150","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"spec","min-width":"180","header-align":"center",align:"left",title:"物资描述"}}),t("vxe-table-column",{attrs:{field:"trainNo",title:"车号",width:"80"}}),t("vxe-table-column",{attrs:{field:"groupName",title:"所属班组",width:"100"}}),t("vxe-table-column",{attrs:{field:"tradeNo","header-align":"center",align:"left",width:"160",title:"所属批次"}}),t("vxe-table-column",{attrs:{field:"amount",title:"库存数量",width:"100"}}),t("vxe-table-column",{attrs:{field:"usableAmount",title:"当前可用量",width:"100"}}),t("vxe-table-column",{attrs:{field:"usedDetailInfo",title:"占用详情",width:"180","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"useCategory_dictText",title:"类别",width:"80"}}),t("vxe-table-column",{attrs:{field:"materialAttr_dictText",title:"属性",width:"80"}}),t("vxe-table-column",{attrs:{field:"price",title:"价格",width:"80","header-align":"center",align:"right"}}),t("vxe-table-column",{attrs:{field:"systemName",title:"所属系统",width:"160"}}),t("vxe-table-column",{attrs:{field:"workstationName",title:"所属工位",width:"160"}})],1)],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}}),t("group-stock-import",{ref:"importModal",attrs:{url:"/import/groupStock"},on:{ok:function(t){return e.findList()}}}),t("material-attr-modal",{ref:"materialAttr",attrs:{ids:e.ids},on:{ok:function(t){return e.findList()}}}),t("TransTurnoverModal",{ref:"transTurnoverModal",attrs:{"group-stock-id":e.ids},on:{ok:function(t){return e.findList()}}})],1)},i=[],l=a("c54ca"),o=a("2f88"),n=a("1468"),s=a("839a"),u={name:"List",props:{isComponent:{type:Boolean,default:!1},multiple:{type:Boolean,default:!0},groupId:{type:String,default:""},materialTypeCode:{type:String,default:""}},components:{GroupStockImport:o["default"],MaterialAttrModal:n["default"],TransTurnoverModal:s["default"]},data:function(){return{searchTextDis:!1,disGroup:!1,queryParam:{searchText:"",materialType:void 0,groupId:this.$store.getters.userInfo.departId,trainNo:null,pageNo:1,pageSize:10},totalResult:0,allAlign:"center",tableData:[],tableHeight:{top:this.isComponent?"height: calc(80vh - 183px)":"height: calc(100vh - 225px)",bottom:this.isComponent?"height: calc(80vh - 183px)":"height: calc(100vh - 225px)",size:"100%"},ids:""}},mounted:function(){},methods:{dictLoaderData:function(){if(this.$store.getters.userInfo.departId){var e=this.$refs.groupSelect.getSelectItem(this.$store.getters.userInfo.departId);e?(this.queryParam.groupId=this.$store.getters.userInfo.departId,this.disGroup=!0):(this.queryParam.groupId=null,this.disGroup=!1),this.groupId&&(this.queryParam.groupId=this.groupId,this.disGroup=!0),this.materialTypeCode&&(this.queryParam.searchText=this.materialTypeCode,this.searchTextDis=!0)}this.findList()},getCheckboxRecords:function(){var e=this.multiple?this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord();return e},findList:function(){var e=this;Object(l["eb"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},exportGroupStock:function(){Object(l["Jb"])("班组库存导出.xls",{searchText:this.queryParam.searchText,materialType:this.queryParam.materialType,groupId:this.queryParam.groupId})},setMaterialAttribute:function(){var e=this.getCheckboxRecords();e.length>0?(this.ids=e.map((function(e){return e.id})).join(","),this.$refs.materialAttr.show()):this.$message.error("尚未选中任何数据!")},recoverMaterialAttribute:function(){var e=this,t=this.getCheckboxRecords();if(t.length>0){var a=t.map((function(e){return e.id})).join(","),r=t.map((function(e){return e.groupId})).join(",");Object(l["Yb"])("ids="+a+"&groupIds="+r).then((function(t){t.success?(e.$message.success(t.message),e.findList()):e.$message.error(t.message)}))}else this.$message.error("尚未选中任何数据!")},transToTurnover:function(){var e=this.getCheckboxRecords();e.length>0?e.length>1?this.$message.warning("只能选中一条数据!"):(this.ids=e.map((function(e){return e.id})).join(","),this.$refs.transTurnoverModal.show()):this.$message.error("尚未选中任何数据!")}}},c=u,d=a("2877"),m=Object(d["a"])(c,r,i,!1,null,null,null);t["default"]=m.exports},7164:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"97%",title:"物料选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",centered:"",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-tabs",{attrs:{"default-active-key":e.tabIndex},on:{change:e.setTabIndex}},[e.mode.indexOf(3)>-1?t("a-tab-pane",{key:"3",attrs:{tab:"班组物料"}},[t("GroupStock",{key:e.tabIndex,ref:"groupStock",attrs:{multiple:e.multiple,materialTypeCode:e.materialTypeCode,groupId:e.willChangeQueryParam.groupId,isComponent:!0}})],1):e._e(),e.mode.indexOf(2)>-1?t("a-tab-pane",{key:"2",attrs:{tab:"必换件清单"}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:4,sm:12}},[t("a-form-item",{attrs:{label:"物资"}},[t("a-input",{attrs:{allowClear:"",placeholder:"物资编码或者名称"},model:{value:e.willChangeQueryParam.searchText,callback:function(t){e.$set(e.willChangeQueryParam,"searchText",t)},expression:"willChangeQueryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:3,sm:24}},[t("a-form-item",{attrs:{label:"所属线路"}},[t("line-select-list",{model:{value:e.willChangeQueryParam.lineId,callback:function(t){e.$set(e.willChangeQueryParam,"lineId",t)},expression:"willChangeQueryParam.lineId"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"所属修程"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_repair_program,name,id"},model:{value:e.willChangeQueryParam.repairProgramId,callback:function(t){e.$set(e.willChangeQueryParam,"repairProgramId",t)},expression:"willChangeQueryParam.repairProgramId"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"所属系统"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_train_asset_type,name,id,struct_type=1 and parent_id is null"},model:{value:e.willChangeQueryParam.sysId,callback:function(t){e.$set(e.willChangeQueryParam,"sysId",t)},expression:"willChangeQueryParam.sysId"}})],1)],1),t("a-col",{attrs:{md:3,sm:24}},[t("a-form-item",{attrs:{label:"班组"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择班组",dictCode:e.dictGroupStr},model:{value:e.willChangeQueryParam.groupId,callback:function(t){e.$set(e.willChangeQueryParam,"groupId",t)},expression:"willChangeQueryParam.groupId"}})],1)],1),t("a-col",{attrs:{md:3,sm:24}},[t("a-form-item",{attrs:{label:"工位"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:e.dictCodeStrWork},model:{value:e.willChangeQueryParam.workstationId,callback:function(t){e.$set(e.willChangeQueryParam,"workstationId",t)},expression:"willChangeQueryParam.workstationId"}})],1)],1),t("a-col",{attrs:{md:2,sm:8}},[t("a-form-item",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 186px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 186px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData2,"highlight-current-row":"","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"click",mode:"cell",showIcon:"true"}},on:{"cell-click":e.onCellClick}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"code",title:"物料编码",width:"150"}}),t("vxe-table-column",{attrs:{field:"name",title:"物料名称",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"amount",title:"当前库存",align:"right","header-align":"center",width:"80"}}),1===e.tabIndex?[t("vxe-table-column",{attrs:{field:"category1_dictText",title:"类别",width:"120"}}),t("vxe-table-column",{attrs:{field:"category2_dictText",title:"属性",width:"120"}}),t("vxe-table-column",{attrs:{field:"unit",title:"单位",width:"150"}})]:e._e(),2===e.tabIndex?[t("vxe-table-column",{attrs:{field:"spec",title:"物资描述",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"groupName",title:"所属班组",align:"left","header-align":"center",width:"150"}}),t("vxe-table-column",{attrs:{field:"workstationName",title:"所属工位",align:"left","header-align":"center",width:"150"}}),t("vxe-table-column",{attrs:{field:"lineName",title:"线路",width:"100"}}),t("vxe-table-column",{attrs:{field:"repairProgramName",title:"修程",width:"120"}})]:e._e(),t("vxe-table-column",{attrs:{field:"num",title:"所需数量",width:"80","edit-render":{name:"$input",immediate:!0,props:{type:"number",Min:0}}}})],2)],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.willChangeQueryParam.pageNo,"page-size":e.willChangeQueryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.willChangeQueryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.willChangeQueryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.willChangeQueryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.willChangeQueryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1):e._e(),e.mode.indexOf(1)>-1?t("a-tab-pane",{key:"1",attrs:{tab:"其他物资"}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"物料名称"}},[t("a-input",{attrs:{allowClear:"",placeholder:"物料名称或编码"},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"物料分类"}},[t("j-dict-select-tag",{attrs:{"hidden-array":e.hiddenType,dictCode:"bu_material_type"},model:{value:e.queryParam.category1,callback:function(t){e.$set(e.queryParam,"category1",t)},expression:"queryParam.category1"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"物料属性"}},[t("j-dict-select-tag",{attrs:{dictCode:"bu_material_attr"},model:{value:e.queryParam.attr,callback:function(t){e.$set(e.queryParam,"attr",t)},expression:"queryParam.attr"}})],1)],1),t("a-col",{attrs:{md:3,sm:8}},[t("a-form-item",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 186px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 186px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"highlight-current-row":"","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"click",mode:"cell",showIcon:"true"}},on:{"cell-click":e.onCellClick}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"code",title:"物料编码",width:"150"}}),t("vxe-table-column",{attrs:{field:"name",title:"物料名称",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"category1_dictText",title:"类别",width:"120"}}),t("vxe-table-column",{attrs:{field:"category2_dictText",title:"属性",width:"120"}}),t("vxe-table-column",{attrs:{field:"unit",title:"单位",width:"80"}}),t("vxe-table-column",{attrs:{field:"amount",title:"当前库存",align:"right","header-align":"center",width:"80"}}),t("vxe-table-column",{attrs:{field:"spec",title:"物资描述",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"num",title:"所需数量",width:"100","edit-render":{name:"$input",immediate:!0,props:{type:"number",Min:0}}}})],1)],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult2,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1):e._e()],1)],1)},i=[],l=a("c54ca"),o=a("b098"),n=a("5633"),s=a("6651"),u={name:"MaterialList",components:{JTreeSelect:o["default"],LineSelectList:n["default"],GroupStock:s["default"]},props:{multiple:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1,required:!1},materialTypeCode:{type:String,default:""},defaultCheckedKeys:{type:String,default:""},mode:{type:Array,default:function(){return[1,2]}},showTypeCode:{type:Boolean,default:!1},typeCodeList:{type:Array,default:function(){return[]}},groupId:{type:String,default:null},lineId:{type:[Number,String],default:null},repairProgramId:{type:[Number,String],default:null}},watch:{defaultCheckedKeys:{immediate:!0,handler:function(e){this.queryParam.warehouseId=e}},lineId:{immediate:!0,handler:function(e){this.mode.indexOf(2)>-1&&e&&(this.willChangeQueryParam.lineId=e)}},repairProgramId:{immediate:!0,handler:function(e){this.mode.indexOf(2)>-1&&e&&(this.willChangeQueryParam.repairProgramId=e)}},"willChangeQueryParam.groupId":{handler:function(e,t){this.dictCodeStrWork=e?"bu_mtr_workstation,name,id,id in (select workstation_id from bu_group_workstation where group_id='".concat(e,"')"):"bu_mtr_workstation,name,id"},immediate:!0,deep:!0}},data:function(){return{planIdCopy:"",hiddenType:[],dictGroupStr:"bu_mtr_workshop_group,group_name,id,workshop_id='"+this.$store.getters.userInfo.workshopId+"'|workshop_id",dictCodeStrWork:"bu_mtr_workstation,name,id",queryParam:{type:"1",category1:"",searchText:"",attr:null,warehouseId:"",materialTypeCodeList:[],pageNo:1,pageSize:10},willChangeQueryParam:{searchText:"",lineId:"",repairProgramId:"",sysId:"",groupId:this.groupId||"",workstationId:"",materialTypeCodeList:[],pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],totalResult2:0,tableData2:[],visible:!1,confirmLoading:!1,formItemLayout:{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},tabIndex:this.mode[0]+""}},created:function(){},methods:{setTabIndex:function(e){this.tabIndex=e,this.findList()},showModal:function(){this.visible=!0,this.groupId&&(this.willChangeQueryParam.groupId=this.groupId),this.typeCodeList.length>1&&(this.hiddenType=[1]),this.mode&&1===this.mode.length&&(this.tabIndex=(this.mode[0]+"").trim()),this.findList()},findList:function(){var e=this,t="";switch(this.tabIndex){case"1":var a=Object.assign({},this.queryParam);!a.category1&&this.typeCodeList&&this.typeCodeList.length&&(a.category1=this.typeCodeList.length?this.typeCodeList.join(","):""),t=Object(l["hb"])(a);break;default:t=Object(l["Hb"])(this.willChangeQueryParam);break}t.then((function(t){"1"===e.tabIndex?(e.totalResult2=t.result.total,e.tableData=t.result.records,e.tableData.forEach((function(t){e.$set(t,"num",1)}))):(e.totalResult=t.result.total,e.tableData2=t.result.records,e.tableData2.forEach((function(t){e.$set(t,"num",1),"2"===e.tabIndex&&e.$set(t,"num",t.needAmount)})))}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;switch(this.tabIndex){case"1":this.queryParam.pageNo=t,this.queryParam.pageSize=a;break;default:this.willChangeQueryParam.pageNo=t,this.willChangeQueryParam.pageSize=a;break}this.findList()},handleOk:function(){var e=this,t=[];if(this.multiple?t="3"===this.tabIndex?this.$refs.groupStock.getCheckboxRecords():this.$refs.listTable.getCheckboxRecords():(this.$refs.listTable||this.$refs.groupStock)&&t.push("3"===this.tabIndex?this.$refs.groupStock.getCheckboxRecords():this.$refs.listTable.getRadioRecord()),"2"===this.tabIndex||"3"===this.tabIndex){var a=[];t.forEach((function(t){var r=Object.assign({},t);"3"===e.tabIndex&&(r.groupStockId=t.id,r.usableAmount=t.usableAmount),r.id=t.materialTypeId,"3"===e.tabIndex?(r.num=1,r.category1=-1,r.category1_dictText="其他",r.name=t.materialTypeName,r.code=t.materialTypeCode):(r.category1=1,r.category1_dictText="必换件"),a.push(r)})),t=a}Array.from(t,(function(e,t){e.useCategory=e.category1,e.useCategory_dictText=e.category1_dictText})),this.$emit("ok",t),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,this.tabIndex="1"},onCellClick:function(e){var t=e.row,a=e.column;"num"===a.property&&this.$refs.listTable.setCheckboxRow([t],!0)}}},c=u,d=(a("dd2ec"),a("2877")),m=Object(d["a"])(c,r,i,!1,null,"5ac45bb0",null);t["default"]=m.exports},"839a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"转入周转件",visible:e.visible,confirmLoading:e.confirmLoading,destroyOnClose:!0,cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"转入数量"}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["transAmount",e.validatorRules.transAmount],expression:"['transAmount', validatorRules.transAmount]",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{min:0,step:.1,max:99999999,placeholder:"请输入转入数量"}})],1)],1)],1)],1)],1)},i=[],l=a("c54ca"),o={name:"TransTurnoverModal",components:{},props:["groupStockId"],data:function(){return{visible:!1,confirmLoading:!1,form:this.$form.createForm(this),model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}},validatorRules:{transAmount:{rules:[{required:!0,message:"请输入转入数量!"}]}},transAmount:0}},methods:{show:function(){this.visible=!0,this.form.resetFields(),this.model=Object.assign({},{})},handleOk:function(){var e=this;e.form.validateFields((function(t,a){if(!t){var r=Object.assign(e.model,a);e.confirmLoading=!0,Object(l["pc"])("groupStockId="+e.groupStockId+"&transAmount="+r.transAmount).then((function(t){t.success?(e.$message.success(t.result),e.$emit("ok"),e.close()):e.$message.error(t.message)})).finally((function(){e.confirmLoading=!1}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},n=o,s=a("2877"),u=Object(s["a"])(n,r,i,!1,null,"7146cee2",null);t["default"]=u.exports},b098:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-tree-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",labelInValue:"",getPopupContainer:function(e){return e.parentNode},disabled:e.disabled,dropdownStyle:{maxHeight:"400px",overflow:"auto"},placeholder:e.placeholder,loadData:e.asyncLoadTreeData,value:e.treeValue,treeData:e.treeData,multiple:e.multiple},on:{change:e.onChange,search:e.onSearch}})},i=[],l=a("0fea");function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function n(e){return c(e)||u(e)||m(e)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function c(e){if(Array.isArray(e))return h(e)}function d(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=m(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,n=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){n=!0,l=e},f:function(){try{o||null==a.return||a.return()}finally{if(n)throw l}}}}function m(e,t){if(e){if("string"==typeof e)return h(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=Array(t);a<t;a++)r[a]=e[a];return r}var p={name:"JTreeSelect",props:{value:{type:String,required:!1},placeholder:{type:String,default:"请选择",required:!1},dict:{type:String,default:"",required:!1},pidField:{type:String,default:"pid",required:!1},pidValue:{type:String,default:"",required:!1},disabled:{type:Boolean,default:!1,required:!1},hasChildField:{type:String,default:"",required:!1},condition:{type:String,default:"",required:!1},multiple:{type:Boolean,default:!1},loadTriggleChange:{type:Boolean,default:!1,required:!1}},data:function(){return{treeValue:null,treeData:[],url:"/sys/dict/loadTreeData",view:"/sys/dict/loadDictItem/",tableName:"",text:"",code:""}},watch:{value:function(){this.loadItemByCode()},dict:function(){this.initDictInfo(),this.loadRoot()}},created:function(){var e=this;this.validateProp().then((function(){e.initDictInfo(),e.loadRoot(),e.loadItemByCode()}))},methods:{loadItemByCode:function(){var e=this;this.value&&"0"!=this.value?Object(l["d"])("".concat(this.view).concat(this.dict),{key:this.value}).then((function(t){if(t.success){var a=e.value.split(",");e.treeValue=t.result.map((function(e,t){return{key:a[t],value:a[t],label:e}})),e.onLoadTriggleChange(t.result[0])}})):this.treeValue=null},onLoadTriggleChange:function(e){!this.multiple&&this.loadTriggleChange&&this.$emit("change",this.value,e)},initDictInfo:function(){var e=this.dict.split(",");this.tableName=e[0],this.text=e[1],this.code=e[2]},asyncLoadTreeData:function(e){var t=this;return new Promise((function(a){if(e.$vnode.children)a();else{var r=e.$vnode.key,i={pid:r,tableName:t.tableName,text:t.text,code:t.code,pidField:t.pidField,hasChildField:t.hasChildField,condition:t.condition};Object(l["d"])(t.url,i).then((function(e){if(e.success){var i,l=d(e.result);try{for(l.s();!(i=l.n()).done;){var o=i.value;o.value=o.key,0==o.leaf?o.isLeaf=!1:1==o.leaf&&(o.isLeaf=!0)}}catch(s){l.e(s)}finally{l.f()}t.addChildren(r,e.result,t.treeData),t.treeData=n(t.treeData)}a()}))}}))},addChildren:function(e,t,a){if(a&&a.length>0){var r,i=d(a);try{for(i.s();!(r=i.n()).done;){var l=r.value;if(l.key==e){t&&0!=t.length?l.children=t:l.isLeaf=!0;break}this.addChildren(e,t,l.children)}}catch(o){i.e(o)}finally{i.f()}}},loadRoot:function(){var e=this,t={pid:this.pidValue,tableName:this.tableName,text:this.text,code:this.code,pidField:this.pidField,hasChildField:this.hasChildField,condition:this.condition};Object(l["d"])(this.url,t).then((function(t){if(t.success&&t.result){var a,r=d(t.result);try{for(r.s();!(a=r.n()).done;){var i=a.value;i.value=i.key,0==i.leaf?i.isLeaf=!1:1==i.leaf&&(i.isLeaf=!0)}}catch(l){r.e(l)}finally{r.f()}e.treeData=n(t.result)}}))},onChange:function(e){e?e instanceof Array?(this.$emit("change",e.map((function(e){return e.value})).join(",")),this.treeValue=e):(this.$emit("change",e.value,e.label),this.treeValue=e):(this.$emit("change",""),this.treeValue=null)},onSearch:function(e){},getCurrTreeData:function(){return this.treeData},validateProp:function(){var e=this,t=this.condition;return new Promise((function(a,r){if(t)try{var i=JSON.parse(t);"object"==o(i)&&i?a():(e.$message.error("组件JTreeSelect-condition传值有误，需要一个json字符串!"),r())}catch(l){e.$message.error("组件JTreeSelect-condition传值有误，需要一个json字符串!"),r()}else a()}))}},model:{prop:"value",event:"change"}},f=p,g=a("2877"),b=Object(g["a"])(f,r,i,!1,null,null,null);t["default"]=b.exports},dd2ec:function(e,t,a){"use strict";a("5f50")}}]);