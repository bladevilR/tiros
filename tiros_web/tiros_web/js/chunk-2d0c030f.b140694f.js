(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c030f"],{4173:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{height:"calc(100% - 0px)"}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:6,sm:8}},[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[e("a-space",[e("a-button",{attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("新增")]),e("a-button",{on:{click:t.deleteRecord}},[t._v("删除")])],1)],1)])],1)],1),e("div",{staticStyle:{height:"calc(100vh - 185px)"}},[e("vxe-table",{ref:"listTable",staticStyle:{height:"calc(100vh - 235px)"},attrs:{border:"","max-height":"100%",align:t.allAlign,data:t.certList,"show-overflow":"tooltip","keep-source":!0,"checkbox-config":{trigger:"row",highlight:!0},"edit-config":{key:"id",trigger:"manual",mode:"row",autoClear:!1,showStatus:!0}},on:{"update:data":function(e){t.certList=e}}},[e("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),e("vxe-table-column",{attrs:{field:"certNo",title:"证件编号","min-width":"80","edit-render":{name:"input"}}}),e("vxe-table-column",{attrs:{field:"certName",title:"证件名称","min-width":"100",align:"left","header-align":"center","edit-render":{name:"input"}}}),e("vxe-table-column",{attrs:{field:"certCategory_dictText",title:"证件类型",width:"140","edit-render":{name:"input"}},scopedSlots:t._u([{key:"edit",fn:function(r){var a=r.row;return[e("j-dict-select-tag",{staticStyle:{width:"100%"},attrs:{triggerChange:!0,dictCode:"bu_user_cert_category"},on:{change:t.onCategoryChange},model:{value:a.certCategory,callback:function(e){t.$set(a,"certCategory",e)},expression:"row.certCategory"}})]}}])}),e("vxe-table-column",{attrs:{field:"validDate",title:"证件有效期","min-width":"100","edit-render":{name:"input"}},scopedSlots:t._u([{key:"edit",fn:function(r){var a=r.row;return[e("a-date-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择有效期",format:"YYYY-MM-DD"},model:{value:a.validDate,callback:function(e){t.$set(a,"validDate",e)},expression:"row.validDate"}})]}}])}),e("vxe-table-column",{attrs:{field:"scanFile",title:"扫描件","min-width":"120"}}),e("vxe-table-column",{attrs:{field:"remark",title:"备注",align:"left","header-align":"center","edit-render":{name:"input"}}}),e("vxe-table-column",{attrs:{title:"操作",width:"120",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(r){var a=r.row;return[t.$refs.listTable.isActiveByRow(a)?[e("a-space",[e("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(e){return e.stopPropagation(),t.saveRowEvent(a)}}},[t._v("保存")]),e("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(e){return e.stopPropagation(),t.cancelRowEvent(a)}}},[t._v("取消")])],1)]:[e("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(e){return e.stopPropagation(),t.editRowEvent(a)}}},[t._v("编辑")])]]}}])})],1),e("vxe-pager",{attrs:{perfect:"","current-page":t.queryParam.currentPage,"page-size":t.queryParam.pageSize,total:t.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(e){return t.$set(t.queryParam,"currentPage",e)},"update:current-page":function(e){return t.$set(t.queryParam,"currentPage",e)},"update:pageSize":function(e){return t.$set(t.queryParam,"pageSize",e)},"update:page-size":function(e){return t.$set(t.queryParam,"pageSize",e)}}})],1)])},i=[],n=r("8fad"),c=r("c1df"),s=r.n(c),l=r("4ec3"),o=r("ca00"),u={props:{certList:{type:Array,default:function(){return[]}},userId:{type:String,default:""}},mounted:function(){var t=this;this.totalResult=this.certList.length,Object(n["tc"])({id:this.userId}).then((function(e){e.success&&t.$emit("update:certList",e.result.certList)}))},data:function(){return{curEditMode:0,curRow:null,queryParam:{title:"",trainTime:"",userId:"",pageNo:1,pageSize:10},totalResult:0,allAlign:"center",validRules:{code:[{required:!0,message:"请选择工器具"}],amount:[{required:!0,message:"数量必须填写"}]}}},methods:{handleAdd:function(){var t=this;if(!this.$refs.listTable.getActiveRecord()){this.curEditMode=1;var e={id:Object(o["p"])()};this.$refs.listTable.insertAt(e,-1).then((function(e){var r=e.row;t.$refs.listTable.setActiveCell(r,"certNo")}))}},editRowEvent:function(t){this.curEditMode=2,this.$refs.listTable.setActiveRow(t)},delRowEvent:function(t){var e=this;this.certList.map((function(r,a){t.id===r.id&&(e.certList.splice(a,1),e.$emit("update:certList",e.certList))}))},saveRowEvent:function(t){var e=this;this.$refs.listTable.validate(t,(function(r){if(r)for(var a in r){var i=r[a];i.forEach((function(t){t.rule&&e.$message.error(t.rule.message)}))}else 1===e.curEditMode&&(t["validDate"]=s()(t.validDate).format("YYYY-MM-DD"),Object(l["f"])("bu_user_cert_category").then((function(r){r.success&&(r.result.map((function(e){e.value===t.trainType&&(t["certCategory_dictText"]=e.title)})),e.certList.push(t),e.$emit("update:certList",e.certList))}))),e.$refs.listTable.clearActived(),e.curEditMode=0}))},cancelRowEvent:function(t){this.$refs.listTable.clearActived(),1===this.curEditMode?this.$refs.listTable.remove(t):2===this.curEditMode&&this.$refs.listTable.revertData(t),this.curEditMode=0},selectAllEvent:function(t){t.checked,t.records},selectChangeEvent:function(t){t.checked,t.records},deleteRecord:function(){var t=this,e=this.$refs.listTable.getCheckboxRecords();e.length>0?this.$confirm({content:"是否删除选中".concat(e.length,"数据？"),onOk:function(){t.certList.map((function(r,a){e.find((function(t){return r.id==t.id}))&&t.certList.splice(a,1)})),t.$emit("update:certList",t.certList)}}):this.$message.error("尚未选中任何数据!")},onCategoryChange:function(t,e){var r=this.$refs.listTable.getActiveRecord(),a=r.row;a.certCategory_dictText=e.title}}},d=u,f=r("2877"),h=Object(f["a"])(d,a,i,!1,null,null,null);e["default"]=h.exports}}]);