(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e9361084"],{"01a1":function(t,n,c){"use strict";c("3e8b")},"3e8b":function(t,n,c){},ae1c:function(t,n,c){"use strict";c.r(n);var e=function(){var t=this,n=t._self._c;return n("a-modal",{attrs:{title:"编辑作业指导书正文",width:"96%",maskClosable:!1,footer:null,bodyStyle:t.modalBodyStyle,dialogStyle:{top:"10px"},wrapClassName:"jgb-editor-modal"},model:{value:t.visible,callback:function(n){t.visible=n},expression:"visible"}},[n("div",{staticClass:"editor-toolbar"},[n("a-space",[n("a-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.handleSave}},[t._v("保存")]),n("a-dropdown",[n("a-button",[t._v("插入模板")]),n("a-menu",{attrs:{slot:"overlay"},on:{click:t.handleInsertTemplate},slot:"overlay"},[n("a-menu-item",{key:"cover"},[t._v("封面")]),n("a-menu-item",{key:"changeRecord"},[t._v("文件变更记录卡")]),n("a-menu-item",{key:"processFlow"},[t._v("工艺流程图")]),n("a-menu-item",{key:"consumables"},[t._v("消耗料")]),n("a-menu-item",{key:"materialDetail"},[t._v("物料明细")]),n("a-menu-item",{key:"preWork"},[t._v("作业前准备")]),n("a-menu-item",{key:"processStep"},[t._v("工序工步")]),n("a-menu-item",{key:"tools"},[t._v("工具工装")]),n("a-menu-item",{key:"torqueList"},[t._v("扭力值清单")]),n("a-menu-item",{key:"appendix"},[t._v("附录")])],1)],1),n("a-button",{on:{click:t.handleExport}},[t._v("导出DOCX")]),n("a-button",{on:{click:t.handleClose}},[t._v("关闭")])],1),n("div",{staticClass:"tips"},[t._v(" 当前："+t._s(t.record.fileName||"-")+"（版本："+t._s(t.record.fileVer||"-")+"） ")])],1),n("div",{staticClass:"editor-body"},[n("j-editor",{ref:"jeditor",attrs:{height:t.editorHeight},model:{value:t.contentHtml,callback:function(n){t.contentHtml=n},expression:"contentHtml"}})],1)])},d=[],o=c("a061"),a=c("8fad"),l="width:100%;border-collapse:collapse;",s="border:1px solid #333;padding:6px 8px;",r={FILE_NO:"fileNo",FILE_NAME:"fileName",FILE_VER:"fileVer",PROJECT:"project",CREATOR_NAME:"creatorName",EXE_TIME:"exeTime",REVIEWER_NAME:"reviewerName",APPROVER_NAME:"approverName"};function i(t){return null===t||void 0===t?"":String(t)}function y(t){var n=t||{},c={};return Object.keys(r).forEach((function(t){var e=r[t];c[t]=i(n[e])})),c}function h(t){return'<span data-jgb-token="'.concat(t,'">').concat("{{"+t+"}}","</span>")}function u(){return'\n<div style="page-break-after:always;text-align:center;padding-top:120px;">\n  <h1 style="font-size:28px;">'.concat(h("FILE_NAME"),'</h1>\n  <table border="1" cellspacing="0" cellpadding="6" style="').concat(l,'margin-top:60px;">\n    <tr>\n      <td style="').concat(s,'width:25%;">文件编号</td>\n      <td style="').concat(s,'width:25%;">').concat(h("FILE_NO"),'</td>\n      <td style="').concat(s,'width:25%;">版本号</td>\n      <td style="').concat(s,'width:25%;">').concat(h("FILE_VER"),'</td>\n    </tr>\n    <tr>\n      <td style="').concat(s,'">编制人</td>\n      <td style="').concat(s,'">').concat(h("CREATOR_NAME"),'</td>\n      <td style="').concat(s,'">编制日期</td>\n      <td style="').concat(s,'">').concat(h("EXE_TIME"),'</td>\n    </tr>\n    <tr>\n      <td style="').concat(s,'">审核人</td>\n      <td style="').concat(s,'">').concat(h("REVIEWER_NAME"),'</td>\n      <td style="').concat(s,'">审批人</td>\n      <td style="').concat(s,'">').concat(h("APPROVER_NAME"),'</td>\n    </tr>\n    <tr>\n      <td style="').concat(s,'">项目号</td>\n      <td style="').concat(s,'" colspan="3">').concat(h("PROJECT"),"</td>\n    </tr>\n  </table>\n</div>\n")}function p(){return'\n<h2>文件变更记录卡</h2>\n<table border="1" cellspacing="0" cellpadding="6" style="'.concat(l,'">\n  <tr style="background:#f0f0f0;">\n    <th style="').concat(s,'width:8%;">序号</th>\n    <th style="').concat(s,'width:15%;">变更日期</th>\n    <th style="').concat(s,'width:37%;">变更内容</th>\n    <th style="').concat(s,'width:15%;">变更人</th>\n    <th style="').concat(s,'width:15%;">审批人</th>\n    <th style="').concat(s,'width:10%;">版本</th>\n  </tr>\n  <tr><td style="').concat(s,'">1</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">2</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">3</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n</table>\n')}function m(){return'\n<h2>工艺流程图</h2>\n<div style="border:1px dashed #999;min-height:300px;padding:20px;text-align:center;color:#999;">\n  <p>（请在此处插入工艺流程图图片）</p>\n</div>\n'}function w(){return'\n<h2>消耗料清单</h2>\n<table border="1" cellspacing="0" cellpadding="6" style="'.concat(l,'">\n  <tr style="background:#f0f0f0;">\n    <th style="').concat(s,'width:8%;">序号</th>\n    <th style="').concat(s,'width:18%;">物料编码</th>\n    <th style="').concat(s,'width:22%;">物料名称</th>\n    <th style="').concat(s,'width:18%;">规格型号</th>\n    <th style="').concat(s,'width:10%;">单位</th>\n    <th style="').concat(s,'width:10%;">数量</th>\n    <th style="').concat(s,'width:14%;">备注</th>\n  </tr>\n  <tr><td style="').concat(s,'">1</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">2</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">3</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n</table>\n')}function f(){return'\n<h2>物料明细</h2>\n<table border="1" cellspacing="0" cellpadding="6" style="'.concat(l,'">\n  <tr style="background:#f0f0f0;">\n    <th style="').concat(s,'width:8%;">序号</th>\n    <th style="').concat(s,'width:15%;">物料编码</th>\n    <th style="').concat(s,'width:20%;">物料名称</th>\n    <th style="').concat(s,'width:15%;">规格型号</th>\n    <th style="').concat(s,'width:8%;">单位</th>\n    <th style="').concat(s,'width:8%;">数量</th>\n    <th style="').concat(s,'width:12%;">单价</th>\n    <th style="').concat(s,'width:14%;">备注</th>\n  </tr>\n  <tr><td style="').concat(s,'">1</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">2</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">3</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n</table>\n')}function b(){return'\n<h2>作业前准备</h2>\n<table border="1" cellspacing="0" cellpadding="6" style="'.concat(l,'">\n  <tr style="background:#f0f0f0;">\n    <th style="').concat(s,'width:8%;">序号</th>\n    <th style="').concat(s,'width:52%;">检查项目</th>\n    <th style="').concat(s,'width:20%;">标准/要求</th>\n    <th style="').concat(s,'width:20%;">确认结果</th>\n  </tr>\n  <tr><td style="').concat(s,'">1</td><td style="').concat(s,'">人员资质确认</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">2</td><td style="').concat(s,'">工具工装检查</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">3</td><td style="').concat(s,'">物料准备确认</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">4</td><td style="').concat(s,'">安全防护确认</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n</table>\n')}function g(){return'\n<h2>工序工步</h2>\n<table border="1" cellspacing="0" cellpadding="6" style="'.concat(l,'">\n  <tr style="background:#f0f0f0;">\n    <th style="').concat(s,'width:8%;">工序号</th>\n    <th style="').concat(s,'width:8%;">工步号</th>\n    <th style="').concat(s,'width:34%;">作业内容</th>\n    <th style="').concat(s,'width:20%;">技术要求</th>\n    <th style="').concat(s,'width:15%;">工具/工装</th>\n    <th style="').concat(s,'width:15%;">备注</th>\n  </tr>\n  <tr><td style="').concat(s,'">1</td><td style="').concat(s,'">1</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'"></td><td style="').concat(s,'">2</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">2</td><td style="').concat(s,'">1</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n</table>\n')}function v(){return'\n<h2>工具工装清单</h2>\n<table border="1" cellspacing="0" cellpadding="6" style="'.concat(l,'">\n  <tr style="background:#f0f0f0;">\n    <th style="').concat(s,'width:8%;">序号</th>\n    <th style="').concat(s,'width:18%;">工具编码</th>\n    <th style="').concat(s,'width:24%;">工具名称</th>\n    <th style="').concat(s,'width:20%;">规格型号</th>\n    <th style="').concat(s,'width:10%;">数量</th>\n    <th style="').concat(s,'width:20%;">备注</th>\n  </tr>\n  <tr><td style="').concat(s,'">1</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">2</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">3</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n</table>\n')}function E(){return'\n<h2>扭力值清单</h2>\n<table border="1" cellspacing="0" cellpadding="6" style="'.concat(l,'">\n  <tr style="background:#f0f0f0;">\n    <th style="').concat(s,'width:8%;">序号</th>\n    <th style="').concat(s,'width:22%;">安装部位</th>\n    <th style="').concat(s,'width:20%;">螺栓规格</th>\n    <th style="').concat(s,'width:15%;">扭力值(N·m)</th>\n    <th style="').concat(s,'width:15%;">工具</th>\n    <th style="').concat(s,'width:20%;">备注</th>\n  </tr>\n  <tr><td style="').concat(s,'">1</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">2</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n  <tr><td style="').concat(s,'">3</td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td><td style="').concat(s,'"></td></tr>\n</table>\n')}function k(){return'\n<h2>附录</h2>\n<div style="border:1px dashed #999;min-height:200px;padding:20px;color:#999;">\n  <p>（请在此处填写附录内容，可插入图片、表格等）</p>\n</div>\n'}function _(t,n){var c=t||"",e=y(n);return Object.keys(e).forEach((function(t){var n=e[t],d=new RegExp("\\{\\{".concat(t,"\\}\\}"),"g");c=c.replace(d,n)})),c}var x={name:"JobGuideBookEditorModal",components:{JEditor:o["default"]},data:function(){return{visible:!1,record:{},contentHtml:"",loading:!1,editorHeight:520}},computed:{modalBodyStyle:function(){return{height:"calc(100vh - 120px)",overflow:"hidden"}}},methods:{open:function(t){this.record=t||{},this.contentHtml=_(t&&t.contentHtml||"",this.record),this.visible=!0,this.setEditorHeight(),window.addEventListener("resize",this.setEditorHeight)},handleInsertTemplate:function(t){var n=t.key,c={cover:u,changeRecord:p,processFlow:m,consumables:w,materialDetail:f,preWork:b,processStep:g,tools:v,torqueList:E,appendix:k},e=c[n];if(e){var d=_(e(this.record),this.record);this.contentHtml=(this.contentHtml||"")+d}},handleSave:function(){var t=this;if(this.record.id){var n=2===this.record.status||0===this.record.status&&2!==this.record.reviewStatus;n?(this.loading=!0,Object(a["md"])(this.record.id,this.contentHtml).then((function(n){n.success?(t.$message.success("正文已保存"),t.$emit("saved"),t.handleClose()):t.$message.error(n.message||"保存失败")})).finally((function(){t.loading=!1}))):this.$message.warning("仅草稿、审核中、审批中状态可编辑保存")}else this.$message.warning("未选择作业指导书")},handleExport:function(){var t='<html><head><meta charset="utf-8"></head><body>'.concat(this.contentHtml||"<p>暂无正文</p>","</body></html>"),n=new Blob(["\ufeff",t],{type:"application/msword"}),c=window.URL.createObjectURL(n),e=document.createElement("a");e.href=c,e.download="".concat(this.record.fileName||"作业指导书",".docx"),document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(c)},handleClose:function(){this.visible=!1,this.record={},this.contentHtml="",this.loading=!1,window.removeEventListener("resize",this.setEditorHeight)},setEditorHeight:function(){var t=window.innerHeight||900;this.editorHeight=Math.max(420,t-220)}}},R=x,H=(c("01a1"),c("2877")),N=Object(H["a"])(R,e,d,!1,null,"7454b49a",null);n["default"]=N.exports}}]);