(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36a4e4be","chunk-ad0db6b8","chunk-acc24a18","chunk-0f12fa96","chunk-2093b0ec","chunk-5730732a","chunk-535429be","chunk-cfac6c42"],{"009c":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:"90%",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0,centered:"",bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"表单:"}},[t("a-input",{attrs:{placeholder:"表单名称或编码",allowClear:""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"表单类型:"}},[t("a-select",{attrs:{allowClear:""},model:{value:e.queryParam.formTypeList,callback:function(t){e.$set(e.queryParam,"formTypeList",t)},expression:"queryParam.formTypeList"}},[t("a-select-option",{attrs:{value:3}},[e._v(" 作业记录表")]),t("a-select-option",{attrs:{value:1}},[e._v(" 数据记录表")]),t("a-select-option",{attrs:{value:4}},[e._v(" 检查记录表")])],1)],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"选择工位"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",placeholder:"请选择工位",open:!1},on:{dropdownVisibleChange:function(t){return e.openStationSelectModal()},change:e.onStationChange},model:{value:e.stationName,callback:function(t){e.stationName=t},expression:"stationName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1),t("a-col",{attrs:{md:9,sm:8}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")]),t("a-button",{on:{click:e.openFormModal}},[e._v("从模板添加")]),t("a-button",{attrs:{disabled:!e.btnStatus.edit},on:{click:function(t){return e.openFormEditModal(e.btnStatus.editRow)}}},[e._v("修改")]),t("a-button",{attrs:{loading:e.deleteLoading,disabled:e.records.length<=0},on:{click:e.deleteForm}},[e._v("删除")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 90px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 90px)"},attrs:{border:"","max-height":"100%",align:"center",data:e.tableData,"radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"show-overflow":"tooltip"},on:{"checkbox-change":e.rowSelectChange,"checkbox-all":e.rowSelectChange}},[t("vxe-table-column",{attrs:{type:"seq",fixed:"left",width:"60"}}),e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"planName",title:"列计划",align:"left","header-align":"center",width:"180"}}),t("vxe-table-column",{attrs:{field:"title",title:"表单名称","min-width":"220",align:"left","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[1!==e.operator?t("span",[e._v(e._s(a.title))]):t("a",{on:{click:function(t){return t.stopPropagation(),e.jumpInfo(a)}}},[e._v(e._s(a.title))])]}}])}),t("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"code",title:"表单编码",width:"120"}}),t("vxe-table-column",{attrs:{field:"formType_dictText",title:"表单类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(3!==r.formType?r.formType_dictText:1===r.workRecordType?"作业记录表(老)":"作业记录表(新)")+" ")]}}])}),t("vxe-table-column",{attrs:{field:"reguName",title:"所属规程",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(r.reguName)+" ")]}},{key:"edit",fn:function(r){var a=r.row;return[t("a-input",{attrs:{placeholder:"请选择表单",disabled:""},model:{value:a.reguName,callback:function(t){e.$set(a,"reguName",t)},expression:"row.reguName"}})]}}])}),t("vxe-table-column",{attrs:{field:"reguVersion",title:"规程版本",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(r.reguVersion)+" ")]}},{key:"edit",fn:function(r){var a=r.row;return[t("a-input",{attrs:{placeholder:"请选择表单",disabled:""},model:{value:a.reguVersion,callback:function(t){e.$set(a,"reguVersion",t)},expression:"row.reguVersion"}})]}}])}),t("vxe-table-column",{attrs:{field:"trainStructName",title:"关联设备","min-width":"150",align:"left","header-align":"center"}})],1)],1),t("JobCheckTableView",{ref:"jobCheckTableView"}),t("RecordTableView",{ref:"recordTableView"}),t("FormViewModal",{ref:"formViewModal"}),t("ViewWorkForm",{ref:"viewWorkForm",attrs:{operator:e.operator}}),t("TaskFormModel",{ref:"taskFormModel",attrs:{repairId:e.repairId,operator:e.operator,checkList:e.tableData,trainNo:e.trainNo,"plan-id":e.planId,"line-id":e.lineId},on:{ok:e.onAddForm}}),t("work-station-list",{ref:"stationSelectModal",on:{ok:e.onSelectStation}}),t("task-form-edit-model",{ref:"taskFormEditModel",attrs:{"line-id":e.lineId,"train-no":e.trainNo},on:{ok:e.findList}})],1)},n=[],o=r("37582"),i=r("e42a"),l=r("8fad"),s=r("3dbe"),c=r("aaa8"),u=r("7e9e"),d=r("88da"),f=r("60c8"),h=r("1158"),m=r("54f6"),p=r("0c04");function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return(t=k(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e){var t=w(e,"string");return"symbol"==g(t)?t:t+""}function w(e,t){if("object"!=g(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=g(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var x={name:"TaskFormSelectModel",components:{FormsList:o["default"],CarDeviceSelect:i["default"],TaskFormModel:f["default"],WorkStationList:h["default"],TaskFormEditModel:p["default"],ViewWorkForm:d["default"],JobCheckTableView:c["default"],RecordTableView:u["default"],FormViewModal:s["default"]},props:{trainNo:{type:String,default:""},lineId:{type:String,default:""},workOrderTaskId:{type:String,default:""},workOrderId:{type:String,default:""},repairId:{type:[Number,String],default:null},operator:{type:[String,Number],default:""},checkList:{type:Array,default:function(){return[]}},multiple:{type:Boolean,default:!0}},data:function(){return{records:[],deleteLoading:!1,title:"列计划已有表单实例",confirmLoading:!1,visible:!1,tableData:[],stationName:"",queryParam:{formTypeList:"",planId:"",searchText:"",workstationId:null},totalResult:0,planId:"",btnStatus:new m["a"](this,"listTable")}},methods:{jumpInfo:function(e){var t=y(y({},e),{},{planFormId:e.planFormId,instType:e.formType,formObjId:e.formObjId,formInstId:e.id,workRecordType:e.workRecordType,formName:e.title,workOrderId:this.workOrderId,workOrderTaskId:this.workOrderTaskId});delete t.id,this.$refs.viewWorkForm.showModal(t,this.trainNo)},deleteForm:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords(),r=t.map((function(e){return{formType:e.formType,formInstId:e.id,planId:e.planId}}));this.deleteLoading=!0,Object(l["R"])(r).then((function(t){t.success?(e.$message.success("删除成功"),e.findList()):e.$message.warning(t.message),e.deleteLoading=!1})).catch((function(t){e.deleteLoading=!1}))},rowSelectChange:function(e){var t=e.records;this.records=t,this.btnStatus.update()},findList:function(){var e=this;Object(l["vb"])(this.queryParam).then((function(t){t.success?(e.tableData=t.result||[],e.records=[]):e.$message.warn(t.message)}))},showModal:function(e){this.queryParam.planId=e,this.tableData=[],this.findList(),this.visible=!0},openFormEditModal:function(e){this.$refs.taskFormEditModel.edit(e)},handleOk:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();if(t.length){var r=t.filter((function(t){var r=e.checkList.find((function(e){return e.formInstId===t.id}));return r&&e.$message.warn("".concat(t.title,"已经添加了")),r}));if(r.length>0)return;t.length>0&&(this.$emit("ok",t),this.visible=!1)}else this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},openFormModal:function(){this.$refs.taskFormModel.showModal(this.queryParam.planId)},onAddForm:function(e){this.findList()},openStationSelectModal:function(){this.$refs.stationSelectModal.showModal()},onSelectStation:function(e){e.length&&(this.queryParam.workstationId=e[0].id,this.stationName=e[0].name)},onStationChange:function(e){e||(this.queryParam.workstationId=null)}}},S=x,T=(r("8cf3"),r("2877")),I=Object(T["a"])(S,a,n,!1,null,"787457a7",null);t["default"]=I.exports},"0c04":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0,centered:""},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"标题"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["title",e.validatorRules.title],expression:"[ 'title', validatorRules.title]",modifiers:{trim:!0}}]})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"车辆设备"}},[t("div",{on:{click:e.openAssetSelectModal}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["trainStructName",e.validatorRules.trainStructName],expression:"['trainStructName', validatorRules.trainStructName]",modifiers:{trim:!0}}],ref:"trainAssetSelect",staticStyle:{width:"100%"},attrs:{placeholder:"请选择作业目标设备",open:!1}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)])],1)],1)],1),t("CarDeviceSelectNew",{ref:"trainAssetSelectModal",attrs:{trainNo:e.trainNo,lineId:e.lineId,multiple:!1,canSelectType:[2,3,4]},on:{ok:e.onTrainAssetSelect,cancel:e.onCancelTrainAssetSelect}})],1)],1)},n=[],o=r("310d"),i=r("b47d"),l={name:"TaskFormEditModel",components:{CarDeviceSelectNew:o["default"]},props:["lineId","trainNo"],data:function(){return{title:"编辑",visible:!1,trainStructId:"",model:{},confirmLoading:!1,form:this.$form.createForm(this),labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}},validatorRules:{title:{rules:[{required:!0,message:"请输入标题!"},{max:64,message:"输入长度不能超过64字符!"}]},trainStructName:{rules:[{required:!0,message:"请选择车辆设备!"}]}}}},methods:{edit:function(e){var t=this;this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue({title:t.model.title,trainStructName:t.model.structDetailName}),t.trainStructId=t.model.trainStructId}))},handleOk:function(){var e=this;e.form.validateFields((function(t,r){if(!t){e.confirmLoading=!0;var a=Object.assign(e.model,r,{trainStructId:e.trainStructId,formType:e.model.formType});Object(i["Qb"])(a).then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok"),e.close()):e.$message.warning(t.message)})).finally((function(){e.confirmLoading=!1}))}}))},openAssetSelectModal:function(){this.$refs.trainAssetSelectModal.showModal()},onTrainAssetSelect:function(e){var t=this;if(e.length){var r=e[0];this.trainStructId=r.id,this.$nextTick((function(){t.form.setFieldsValue({trainStructName:r.assetName})}))}},onCancelTrainAssetSelect:function(){},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},s=l,c=r("2877"),u=Object(c["a"])(s,a,n,!1,null,"5f227585",null);t["default"]=u.exports},"10f9":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("TablePrint",{ref:"tablePrint"}),t("LuckySheetPrint",{ref:"luckySheetPrint",attrs:{luckySheetId:e.luckySheetId},on:{sheetPrintOk:function(t){return e.$emit("sheetPrintOk")}}}),t("JobCheckTableExport",{ref:"jobCheckPrint"})],1)},n=[],o=r("90f1"),i=r("e89a"),l=r("3cf2"),s=r("b7b4"),c=r("b9c3"),u=r("8fad"),d={name:"WorkRecordPrint",components:{TablePrint:o["default"],JobCheckTableExport:l["default"],LuckySheetPrint:i["default"]},props:{luckySheetId:{type:String,default:"lsPrint"}},data:function(){return{}},created:function(){},methods:{print:function(e){switch(e.instType){case 1:this.loadOnlineFormDetail(e.id,e.formInstId);break;case 3:1===e.workRecordType?this.loadRecordTableDetail(e.id,e.formInstId):2===e.workRecordType&&this.loadWorkRecordForm(e,!0);break;case 4:this.loadWorkFormDetail(e.task2InstId,e.formInstId)}},loadWorkRecordForm:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(u["ub"])(e.formObjId).then((function(a){if(a.success){var n=JSON.parse(a.result);if(!r)return void t.$refs.luckySheetPrint.printBySheet(n);Object(c["U"])(e.formInstId).then((function(e){if(e.success&&e.result){var r=JSON.parse(e.result);n.data=[],n.celldata=luckysheet.transToCellData(r)}t.$refs.luckySheetPrint.printBySheet(n)}))}else t.$message.error("获取作业记录表模板数据失败")}))},loadRecordTableDetail:function(e,t){var r=this;Object(c["R"])({task2InstId:e,formInstId:t,needChecks:!0,needCategory:!0,allItems:!0}).then((function(e){e.success&&e.result?(r.$nextTick((function(){e.result.categoryList&&e.result.categoryList.sort((function(e,t){return e.recIndex-t.recIndex})),r.$refs.tablePrint.printByData(e.result)})),r.visible=!0):r.$message.error("加载记录数据异常")}))},loadWorkFormDetail:function(e,t){var r=this;Object(s["x"])({task2InstId:e,formInstId:t}).then((function(e){e.success&&e.result?r.$refs.jobCheckPrint.printByRow(e.result):r.$message.error("加载记录数据异常")}))},loadOnlineFormDetail:function(e,t){var r=this;Object(c["Q"])({task2InstId:e,formInstId:t,needValues:!1}).then((function(e){try{if(e.success&&e.result){var t=e.result,a=JSON.parse(t.result);r.$nextTick((function(){Object(u["ub"])(t.formObjId).then((function(e){if(e.success){var t=JSON.parse(e.result);a&&(t.celldata=luckysheet.transToCellData(a)),r.$refs.luckySheetPrint.printBySheet(t)}}))}))}else r.$message.error("加载记录数据异常")}catch(n){r.$message.error("加载记录数据异常")}}))},printNoData:function(e){try{switch(e.instType){case 1:this.loadOnlineDetailNoData(e.formInstId);break;case 3:1===e.workRecordType?this.loadRecordDetailNoData(e.formInstId):2===e.workRecordType&&this.loadWorkRecordForm(e,!1);break;case 4:this.loadCheckDetailNoData(e.formInstId)}}catch(t){}},loadRecordDetailNoData:function(e){var t=this;Object(u["Ab"])({id:e}).then((function(e){e.success&&e.result?(t.$nextTick((function(){e.result.categoryList&&e.result.categoryList.sort((function(e,t){return e.recIndex-t.recIndex})),t.$refs.tablePrint.printByData(e.result)})),t.visible=!0):t.$message.error("加载记录数据异常")}))},loadCheckDetailNoData:function(e){var t=this;Object(s["y"])({id:e}).then((function(e){try{e.success&&e.result?(t.$refs.jobCheckPrint.printByRow(e.result),t.visible=!0):t.$message.error("加载记录数据异常")}catch(r){t.$message.error("加载记录数据异常")}}))},loadOnlineDetailNoData:function(e){var t=this;this.visible=!0,Object(u["ub"])(e).then((function(e){if(e.success){var r=JSON.parse(e.result);t.$refs.luckySheetPrint.printBySheet(r)}}))}}},f=d,h=r("2877"),m=Object(h["a"])(f,a,n,!1,null,null,null);t["default"]=m.exports},1158:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:"工位选择",centered:"",bodyStyle:{height:"80vh"},visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{staticStyle:{"border-right":"1px dotted #D3E1F1",height:"calc(80vh - 20px)","margin-right":"8px",padding:"0px"},attrs:{md:4,sm:24}},[e.treeData.length?t("a-tree",{attrs:{defaultExpandAll:"","tree-data":e.treeData,"default-selected-keys":e.defaultKey,dropdownStyle:{maxHeight:"200px",overflow:"auto"},replaceFields:{title:"name",key:"id"}},on:{select:e.onSelect}}):e._e()],1),t("a-col",{attrs:{md:19,sm:24}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getWorkStation.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"工位"}},[t("a-input",{attrs:{placeholder:"请输入工位名称","allow-clear":""},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"班组"}},[t("j-dict-select-tag",{attrs:{dictCode:"sys_depart,depart_name,id,org_category=4",placeholder:"请选择"},model:{value:e.queryParam.groupId,callback:function(t){e.$set(e.queryParam,"groupId",t)},expression:"queryParam.groupId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-space",[t("a-button",{on:{click:e.getWorkStation}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticClass:"limitHeight"},[t("vxe-table",{ref:"listTable",staticStyle:{height:"100%"},attrs:{border:"","row-id":"id",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"},"radio-config":{trigger:"row"},"checkbox-config":{trigger:"row",highlight:!0,range:!0,checkStrictly:!0},"max-height":"100%"}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"stationNo",title:"工位号",width:"100"}}),t("vxe-table-column",{attrs:{field:"name",title:"工位名称",width:"20%",align:"left"}}),t("vxe-table-column",{attrs:{field:"groupName",title:"所属班组",width:"20%",align:"left"}}),t("vxe-table-column",{attrs:{field:"location",title:"位置",width:"100",align:"left"}}),t("vxe-table-column",{attrs:{field:"content",title:"作业内容",width:"25%",align:"left"}}),t("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"10%",align:"left"}})],1)],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.page.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)],1)],1)},n=[],o=r("8fad"),i={name:"WorkStationList",props:{multiple:{type:Boolean,default:!1},groupId:{type:String,default:null}},data:function(){return{visible:!1,confirmLoading:!1,treeData:[],tableData:[],allAlign:"center",defaultKey:[],queryParam:{id:"",name:"",groupId:"",pageNo:1,pageSize:10},page:{currentPage:1,pageSize:10,totalResult:3}}},mounted:function(){this.groupId&&(this.queryParam.groupId=this.groupId)},methods:{showModal:function(){this.visible=!0,this.getTreeList()},getTreeList:function(){var e=this;Object(o["Ub"])().then((function(t){t.success&&(e.treeData=t.result,e.defaultKey[0]=t.result[0].id,e.queryParam.id=t.result[0].id,e.getWorkStation())}))},getWorkStation:function(){var e=this;Object(o["Tb"])(this.queryParam).then((function(t){e.page.totalResult=t.result.total,e.tableData=t.result.records}))},onSelect:function(e,t){var r=t.node.dataRef;e.length>0&&(this.queryParam.id=r.id,this.queryParam.pageNo=1,this.getWorkStation())},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.getTreeList()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},l=i,s=(r("7483"),r("2877")),c=Object(s["a"])(l,a,n,!1,null,"ea42f1f8",null);t["default"]=c.exports},"14d0":function(e,t,r){"use strict";r("de37")},"25e0":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,centered:"",width:500,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查日期"}},[t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["checkDate",e.validatorRules.checkDate],expression:"['checkDate', validatorRules.checkDate]"}],staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD",placeholder:"选择检查日期"},on:{change:e.changeCheckDate}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查结果"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["checkResult",e.validatorRules.checkResult],expression:"['checkResult', validatorRules.checkResult]"}],attrs:{triggerChange:!0,placeholder:"请选择检查结果",dictCode:"bu_work_order_record_result"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"质量负责人"}},[t("a-input",{ref:"userSelect",staticStyle:{width:"100%"},attrs:{placeholder:"请选择质量负责人",open:!1},on:{click:function(t){return e.openSelectUser()}},model:{value:e.checkUserName,callback:function(t){e.checkUserName=t},expression:"checkUserName"}},[t("a-icon",{attrs:{slot:"suffix",type:"ellipsis"},slot:"suffix"})],1)],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"备注"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["remark"],expression:"['remark']",modifiers:{trim:!0}}],attrs:{placeholder:"请输入备注"}})],1)],1)],1),t("user-list",{ref:"userSelectModal",attrs:{multiple:!1},on:{ok:e.onSelectUser}})],1)},n=[],o=r("b245"),i=r("b7b4"),l=r("c1df"),s=r.n(l),c={name:"ConfirmForm",components:{UserList:o["default"]},data:function(){return{title:"检查确认",visible:!1,recordId:"",checkUserName:"",checkUserId:"",model:{},confirmLoading:!1,labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},form:this.$form.createForm(this),validatorRules:{checkDate:{rules:[{required:!0,message:"请选择检查日期!"}]},checkResult:{rules:[{required:!0,message:"请选择检查结果!"}]}}}},mounted:function(){},methods:{confirm:function(e){var t=this;this.form.resetFields(),this.visible=!0,this.confirmLoading=!1,this.recordId=e,this.model=Object.assign({},{checkDate:s()(new Date).format("YYYY-MM-DD")}),this.$nextTick((function(){t.form.setFieldsValue({checkDate:t.model.checkDate})})),this.checkUserName=this.$store.getters.userInfo.realname,this.checkUserId=this.$store.getters.userInfo.id},changeCheckDate:function(e){e&&(this.model.checkDate=e)},handleOk:function(){var e=this;e.form.validateFields((function(t,r){if(!t){e.confirmLoading=!0;var a=Object.assign(e.model,r,{checkDate:s()(e.model.checkDate).format("YYYY-MM-DD"),id:e.recordId,checkUserName:e.checkUserName,checkUserId:e.checkUserId});Object(i["f"])(a).then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok",a),e.close()):e.$message.warning(t.message)})).finally((function(){e.confirmLoading=!1}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},openSelectUser:function(){this.$refs.userSelectModal.showModal(),this.$refs.userSelect.blur()},onSelectUser:function(e){e.length&&(this.checkUserName=e[0].realname,this.checkUserId=e[0].id,this.$forceUpdate())}}},u=c,d=r("2877"),f=Object(d["a"])(u,a,n,!1,null,null,null);t["default"]=f.exports},"2e75":function(e,t,r){},"2f2f":function(e,t,r){},"310d":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("a-modal",{attrs:{title:"车辆设备选择",width:"80%",bodyStyle:{height:"83vh"},visible:e.visible,confirmLoading:e.confirmLoading,closable:!0,centered:"",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.close}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchQuery.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"名称"}},[t("a-input",{attrs:{placeholder:"名称或编码"},model:{value:e.queryParam.title,callback:function(t){e.$set(e.queryParam,"title",t)},expression:"queryParam.title"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"线路"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"bu_mtr_line,line_name,line_id"},on:{change:e.changeLine},model:{value:e.lineId_A,callback:function(t){e.lineId_A=t},expression:"lineId_A"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"车辆"}},[t("j-dict-select-seach-tag",{attrs:{triggerChange:!0,dictCode:e.dictTrainStr},model:{value:e.trainNo_A,callback:function(t){e.trainNo_A=t},expression:"trainNo_A"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"状态"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,placeholder:"请选择状态",dictCode:"bu_valid_status"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.searchQuery}},[e._v("查询")])],1)],1)])],1)],1)],1),t("div",{staticClass:"tableHeight"},[t("vxe-table",{ref:"listTable",attrs:{border:"",resizable:"","row-id":"id",align:e.allAlign,height:"auto",data:e.tableData,"show-overflow":"tooltip","max-height":"100%","radio-config":{trigger:e.multiple?"default":"row",highlight:!0,checkMethod:e.checkRadioMethod},"checkbox-config":{trigger:e.multiple?"row":"default",highlight:!0,checkStrictly:!0,checkMethod:e.checkRadioMethod},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40",fixed:"left"}}),t("vxe-table-column",{attrs:{field:"name",title:"名称","tree-node":"",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"code",title:"编码",width:"180"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",align:"center","header-align":"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("div",{style:{backgroundColor:e.statusColor[a.status+""],borderRadius:"4px"}},[e._v(" "+e._s(a.status_dictText)+" ")])]}}])}),t("vxe-table-column",{attrs:{field:"maximoAssetType",title:"maximo设备类型",width:"150",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"locationName",title:"位置",width:"400",align:"left","header-align":"center"}})],1)],1)])],1)},n=[],o=r("8fad"),i={props:{multiple:{type:Boolean,default:!0},trainNo:{type:[Number,String]},lineId:{type:[Number,String]}},data:function(){return{statusColor:{0:"#dedede",1:"#bad795"},dictTrainStr:"",trainNo_A:void 0,lineId_A:void 0,allAlign:"center",tableData:[],visible:!1,confirmLoading:!1,queryParam:{trainNo:"",searchText:"",status:1}}},created:function(){},methods:{changeLine:function(e,t){this.dictTrainStr="",e&&(this.dictTrainStr="bu_train_info,train_no,train_no,line_id="+e+"|train_struct_id")},checkRadioMethod:function(e){e.row;return!0},searchQuery:function(){this.findList()},loadChildrenMethod:function(e){var t=this,r=e.row,a={trainNo:this.trainNo_A,parentId:r.id,searchText:this.queryParam.searchText,status:this.queryParam.status};return new Promise((function(e){Object(o["Zb"])(a).then((function(r){r.success?e(r.result):t.$message.error("".concat(r.msg))}))}))},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),Array.from(e,(function(e,t){e.assetName=e.name})),this.$emit("ok",e),this.visible=!1},showModal:function(){this.visible=!0,this.lineId_A=this.lineId,this.trainNo_A=this.trainNo,this.findList()},close:function(){this.visible=!1},findList:function(){var e=this;this.queryParam.trainNo=this.trainNo_A,this.loading=!0,Object(o["Zb"])(this.queryParam).then((function(t){t.success&&(e.loading=!1,e.tableData=t.result)}))}}},l=i,s=(r("4677"),r("2877")),c=Object(s["a"])(l,a,n,!1,null,"3967f3d4",null);t["default"]=c.exports},3737:function(e,t,r){"use strict";r("2f2f")},37582:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:e.title,centered:"",bodyStyle:{height:"80vh"},visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("na-splitter",{staticStyle:{height:"calc(80vh - 15px)"},attrs:{defaultSize:200}},[t("div",{staticStyle:{"overflow-y":"auto","overflow-x":"hidden","padding-right":"2px"},attrs:{slot:"left-panel"},slot:"left-panel"},[t("a-menu",{attrs:{mode:"inline","default-selected-keys":e.defaultSelect},on:{click:e.handleMenuClick}},[t("a-menu-item",{key:1},[t("a-icon",{attrs:{type:"pie-chart"}}),t("span",[e._v("数据记录表")])],1),t("a-menu-item",{key:3},[t("a-icon",{attrs:{type:"pie-chart"}}),t("span",[e._v("作业记录表【新】")])],1),t("a-menu-item",{key:4},[t("a-icon",{attrs:{type:"pie-chart"}}),t("span",[e._v("检查记录表")])],1)],1)],1),t("div",{staticStyle:{"padding-left":"5px","padding-right":"3px"},attrs:{slot:"right-panel"},slot:"right-panel"},[t("div",[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"表单名称"}},[t("a-input",{attrs:{placeholder:"请输入表单名称"},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol,label:"线路"}},[t("line-select-list",{model:{value:e.queryParam.lineId,callback:function(t){e.$set(e.queryParam,"lineId",t)},expression:"queryParam.lineId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol,label:"所属修程"}},[t("j-dict-select-tag",{attrs:{triggerChange:"",dictCode:"bu_repair_program,name,id"},model:{value:e.queryParam.repairProId,callback:function(t){e.$set(e.queryParam,"repairProId",t)},expression:"queryParam.repairProId"}})],1)],1),t("a-col",{attrs:{md:3,sm:8}},[t("a-form-item",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 135px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 135px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"},"radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{title:"-",width:"80"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("span",[t("a",{on:{click:function(t){return t.stopPropagation(),e.handleSeeing(a)}}},[e._v("预览")])])]}}])}),t("vxe-table-column",{attrs:{field:"title",title:3===e.formType?"作业记录表名称":1===e.formType?"数据记录表":4===e.formType?"检查记录表":"",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{width:"100",align:"left","header-align":"center",field:"code",title:"编码"}}),t("vxe-table-column",{attrs:{field:"lineName",title:"线路",width:"100"}}),4===e.formType?t("vxe-table-column",{attrs:{field:"repairProName",title:"修程",width:"100"}}):e._e(),1===e.formType||3===e.formType?t("vxe-table-column",{attrs:{field:"repairProgramName",title:"修程",width:"100"}}):e._e(),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("div",{style:{backgroundColor:e.statusColor[a.status+""],borderRadius:"4px"}},[e._v(" "+e._s(a.status_dictText)+" ")])]}}])}),t("vxe-table-column",{attrs:{field:"reguName",title:"所属规程",width:"120"}}),t("vxe-table-column",{attrs:{field:"reguVersion",title:"规程版本",width:"100"}}),t("vxe-table-column",{attrs:{field:"remark",title:"备注",align:"left","header-align":"center"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)]),t("RecordTableView",{ref:"recordTableView"}),t("JobCheckTableView",{ref:"jobCheckTableView"}),t("FormViewModal",{ref:"formViewModal"})],1)])],1)},n=[],o=r("b7b4"),i=r("8fad"),l=r("4ec3"),s=r("e18e"),c=r("7e9e"),u=r("aaa8"),d=r("3dbe"),f=r("5633"),h={name:"FormsList",components:{NaSplitter:s["default"],RecordTableView:c["default"],FormViewModal:d["default"],LineSelectList:f["default"],JobCheckTableView:u["default"]},props:{title:{type:String,default:"表单选择"},multiple:{type:Boolean,default:!0}},data:function(){return{fileName:"",formItemLayout:{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},statusColor:{0:"#dedede",1:"#bad795"},queryParam:{name:"",workstationId:"",lineId:"",repairProId:"",status:1,pageNo:1,pageSize:10},formType:3,workRecordType:2,defaultSelect:[3],dictCode:"bu_mtr_workstation,name,id",allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,stationData:[],isShowPlan:!1}},methods:{handleSeeing:function(e){var t=this;3===this.formType&&1===this.workRecordType&&this.$refs.recordTableView.show(e.id),(1===this.formType||3===this.formType&&2===this.workRecordType)&&this.$refs.formViewModal.showModal(e.id),4===this.formType&&Object(o["y"])({id:e.id}).then((function(e){if(e.success&&e.result){var r=e.result;t.$refs.jobCheckTableView.show(r)}else t.$message.error("加载记录数据异常")}))},showModal:function(e){e&&e.lineId&&(this.queryParam.lineId=e.lineId),e&&e.repairProgramId&&(this.queryParam.repairProId=e.repairProgramId),this.visible=!0,this.isShowPlan=!1,this.formType=3,this.workRecordType=2,this.defaultSelect=[3],this.findList()},showModalByPlan:function(e){this.visible=!0,this.isShowPlan=!0,this.formType=3,this.workRecordType=2,this.defaultSelect=[3],this.queryParam.planId=e,this.findList()},initDictData:function(){var e=this;Object(l["u"])(this.dictCode)?this.stationData=Object(l["u"])(this.dictCode):Object(l["f"])(this.dictCode).then((function(t){t.success&&(e.stationData=t.result)}))},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},initParamByFormType:function(){3===this.formType&&(this.queryParam.category="1328995639249358850",this.queryParam.type=1,this.workRecordType=2),1===this.formType&&(this.queryParam.category="1328995580210335746",this.queryParam.type=1,this.workRecordType=0)},findList:function(){var e=this;this.loading=!0,this.initParamByFormType(),(1===this.formType||3===this.formType&&2===this.workRecordType)&&Object(i["Dc"])(this.queryParam).then((function(t){t.success&&(e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records)})),4===this.formType&&Object(i["mc"])(this.queryParam).then((function(t){t.success&&(e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records)}))},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord());var t="";1===this.formType&&(t="数据记录表"),3===this.formType&&(1===this.workRecordType&&(t="作业记录表(老)"),2===this.workRecordType&&(t="作业记录表(新)")),4===this.formType&&(t="检查记录表"),this.$emit("ok",{formType:this.formType,workRecordType:this.workRecordType,formTypeName:t,forms:e}),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},handleMenuClick:function(e){this.formType!==e.key&&(this.formType=e.key,this.queryParam.name="",this.initParamByFormType(),this.findList())}}},m=h,p=(r("3737"),r("2877")),g=Object(p["a"])(m,a,n,!1,null,"1ecb454d",null);t["default"]=g.exports},"3c2d":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%","overflow-x":"hidden"}},[t("a-button",{attrs:{"na-btn-type":"print",type:"primary"},on:{click:e.exportPrint}},[e._v("导出打印")]),t("div",{staticStyle:{margin:"0px",padding:"0px",width:"100%",height:"calc(100vh - 85px)"},attrs:{id:"luckysheet"}}),e.showLoading?t("div",{staticStyle:{width:"100%","text-align":"center",position:"absolute",top:"0px",height:"100%","font-size":"16px","z-index":"1000000000",background:"#fff"}},[e._m(0)]):e._e()],1)},n=[function(){var e=this,t=e._self._c;return t("div",{staticStyle:{position:"relative",top:"45%",width:"100%"}},[t("div",{staticClass:"luckysheetLoaderGif"}),t("span",[e._v("加载中...")])])}],o=r("8fad"),i=r("2410"),l=r.n(i),s=r("e24e"),c={name:"view",props:["customId","formName"],data:function(){return{showLoading:!1,defaultOptions:{container:"luckysheet",title:"sheet",column:26,row:50,lang:"zh",allowEdit:!0,showinfobar:!1,sheetFormulaBar:!1,showsheetbar:!1,showstatisticBar:!0,enableAddRow:!1,enableAddCol:!1,showtoolbar:!1}}},beforeDestroy:function(){luckysheet.destroy()},mounted:function(){var e=this,t=l()(this.defaultOptions);t.data=[{name:"Sheet1",color:"",status:"1",order:"0",index:0,ch_width:2044,rh_height:1080}],this.customId?Object(o["ub"])(this.customId).then((function(e){if(e.success){var r=JSON.parse(e.result);r.scrollLeft=0,r.scrollTop=0,t.showtoolbarConfig={},r.config.authority={sheet:1,hintText:"禁止编辑",allowRangeList:[]},t.data=[r],luckysheet.destroy(),luckysheet.create(t)}})).catch((function(r){e.$message.error("加载表单内容异常"),luckysheet.destroy(),luckysheet.create(t)})):(luckysheet.destroy(),luckysheet.create(t))},methods:{exportPrint:function(){try{var e=this.formName;e||(e="export"),Object(s["a"])(luckysheet.getAllSheets(),e)}catch(t){}}}},u=c,d=r("2877"),f=Object(d["a"])(u,a,n,!1,null,"22edf2fe",null);t["default"]=f.exports},"3dbe":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"表单查看",width:"100%",dialogClass:"fullDialog no-footer",visible:e.visible,footer:null,destroyOnClose:!0},on:{cancel:function(t){e.visible=!1}}},[t("FormView",{attrs:{"custom-id":e.customId,"form-name":e.formName}})],1)},n=[],o=r("3c2d"),i={name:"FormViewModal",components:{FormView:o["default"]},props:["formName"],data:function(){return{visible:!1,customId:null}},methods:{showModal:function(e){e&&(this.customId=e,this.visible=!0)}}},l=i,s=r("2877"),c=Object(s["a"])(l,a,n,!1,null,"65a9461c",null);t["default"]=c.exports},"3ff1":function(e,t,r){},"412f":function(e,t,r){},"45ff":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{ref:"calcHeight"})},n=[],o=r("e8ae"),i=r("21a6"),l=r("8fad"),s="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",c={name:"TableExport",data:function(){return{}},mounted:function(){},methods:{printById:function(e){var t=this;Object(l["Ab"])({id:e}).then((function(e){e.success?t.initWorkBook(e.result):t.$message.error("获取记录表详情失败")})).catch((function(e){t.$message.error("获取记录表详情异常")}))},printByData:function(e){this.initWorkBook(e)},initWorkBook:function(e){var t=new o["Workbook"];t.creator="GY",t.lastModifiedBy="2021-10-28",t.created=new Date,t.modified=new Date,t.lastPrinted=new Date;var r=t.addWorksheet("Sheet1",{properties:{defaultColWidth:22,alignment:{vertical:"middle",horizontal:"left",wrapText:!0}},pageSetup:{paperSize:9}}),a=[];r.mergeCells("A1:C1"),r.getCell("A1").value="车号："+(e.trainNo||""),a.push({cell:"A1",horizontal:"left",fill:!0,size:14,bold:!0}),0===e.updown?(r.mergeCells("A2:C2"),r.getCell("A2").value="部件号："+(e.manufNo||""),a.push({cell:"A2",horizontal:"left",fill:!0,size:14,bold:!0})):1===e.updown?(r.mergeCells("A2:C2"),r.getCell("A2").value="原部件序列号："+(e.manufNo||""),a.push({cell:"A2",horizontal:"left",fill:!0,size:14,bold:!0}),r.mergeCells("A3:C3"),r.getCell("A3").value="新部件序列号："+(e.manufNoUp||""),a.push({cell:"A3",horizontal:"left",fill:!0,size:14,bold:!0})):r.mergeCells("A1:C2"),1===e.updown?r.mergeCells("D1:F3"):r.mergeCells("D1:F2"),r.getCell("D1").value=e.title||e.workRecName||"",a.push({cell:"D1",fill:!0,size:14,bold:!0}),r.mergeCells("G1:H1"),r.getCell("G1").value="作业日期："+(e.workDate||""),a.push({cell:"G1",fill:!0,horizontal:"left",size:14,bold:!0}),r.mergeCells("I1:J1"),r.getCell("I1").value="完工日期："+(e.finishDate||""),a.push({cell:"I1",fill:!0,horizontal:"left",size:14,bold:!0}),1===e.updown?r.mergeCells("G2:J3"):r.mergeCells("G2:J2"),r.getCell("G2").value="作业班组："+(e.workGroupName||""),a.push({cell:"G2",fill:!0,horizontal:"left",size:14,bold:!0}),r.getColumn("A").width=15,r.getColumn("B").width=30,r.getColumn("C").width=60,r.getColumn("D").width=15,r.getColumn("E").width=60,r.getColumn("F").width=60,r.getRow(1).height=30,r.getRow(2).height=30,r.getRow(3).height=30,1===e.updown&&(r.getRow(4).height=30);var n={A:"序号",B:"项目",C:"作业内容",D:"控制点",E:"技术要求",F:"作业情况",G:"结果",H:"自检",I:"互检",J:"专检"};for(var l in n)r.getCell(l+(1===e.updown?4:3)).value=n[l],a.push({cell:l+(1===e.updown?4:3),fill:!0,size:14,bold:!0});var c=1===e.updown?5:4,u=0;e.categoryList.forEach((function(e,t){r.getCell("A".concat(c+t)).value=e.recIndex,a.push({cell:"A".concat(c+t)}),r.mergeCells("A".concat(c+t,":A").concat(c+t+e.detailList.length-1)),r.getCell("B".concat(c+t)).value=e.reguTitle,a.push({cell:"B".concat(c+t),horizontal:"left"}),r.mergeCells("B".concat(c+t,":B").concat(c+t+e.detailList.length-1)),e.detailList.forEach((function(e,n){r.getCell("C".concat(c+t+n)).value="\n".concat(e.workContent||"","\n"),a.push({cell:"C".concat(c+t+n),horizontal:"left"}),r.getCell("D".concat(c+t+n)).value=e.checkLevel_dictText||"",a.push({cell:"D".concat(c+t+n)}),r.getCell("E".concat(c+t+n)).value="\n".concat(e.techRequire||"","\n"),a.push({cell:"E".concat(c+t+n),horizontal:"left"}),r.getCell("F".concat(c+t+n)).value=0==e.isIgnore?e.workInfo:e.ignoreDesc,a.push({cell:"F".concat(c+t+n),horizontal:"left"}),r.getCell("G".concat(c+t+n)).value=e.result?"√":"□",a.push({cell:"G".concat(c+t+n)}),r.getCell("H".concat(c+t+n)).value=e.selfCheck||"",a.push({cell:"H".concat(c+t+n)}),r.getCell("I".concat(c+t+n)).value=e.guarderCheck||"",a.push({cell:"I".concat(c+t+n)}),r.getCell("J".concat(c+t+n)).value=e.monitorCheck||"",a.push({cell:"J".concat(c+t+n)})})),c+=e.detailList.length-1,u+=e.detailList.length})),u+=1===e.updown?5:4,r.mergeCells("A".concat(u,":J").concat(u)),r.getRow(u).height=30,a.push({cell:"A".concat(u),bold:!0}),u+=1;var d=e.measureToolList||[];d.length&&(r.mergeCells("A".concat(u,":B").concat(u+d.length-1)),r.getCell("A".concat(u)).value="计量器具使用",a.push({cell:"A".concat(u)}),d.forEach((function(e,t,n){r.mergeCells("C".concat(u+t,":D").concat(u+t)),r.getCell("C".concat(u+t)).value=" \n名称："+(e.name||"")+"\n",a.push({cell:"C".concat(u+t),horizontal:"left"}),r.getCell("E".concat(u+t)).value=" \n规格型号："+(e.model||"")+"\n",a.push({cell:"E".concat(u+t),horizontal:"left"}),r.getCell("F".concat(u+t)).value=" \n出厂编号："+(e.serialNo||"")+"\n",a.push({cell:"F".concat(u+t),horizontal:"left"}),r.mergeCells("G".concat(u+t,":H").concat(u+t)),r.getCell("G".concat(u+t)).value=" \n上次检验时间："+(e.lastCheckTime||"")+"\n",a.push({cell:"G".concat(u+t),horizontal:"left"}),r.mergeCells("I".concat(u+t,":J").concat(u+t)),r.getCell("I".concat(u+t)).value=" \n下次检验时间："+(e.nextCheckTime||"")+"\n",a.push({cell:"I".concat(u+t),horizontal:"left"})})),u+=d.length,r.mergeCells("A".concat(u,":J").concat(u)),r.getRow(u).height=30,a.push({cell:"A".concat(u),bold:!0}),u+=1);var f=["控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。","“自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。","“作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。","“结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。","作业内容中有数据要求的一并填入“作业情况”栏。"];r.mergeCells("A".concat(u,":J").concat(u));var h="";f.forEach((function(e,t,r){h+="".concat(t+1,"、").concat(e).concat(t<r.length-1?"\n":"")})),h="说明：\n"+h+"\n",h="\n检查结果：".concat(0===e.checkResult?"未通过":"通过","                                        检查日期：").concat(e.checkDate||"            ","                                        质量负责人：").concat(e.checkUserName||"            ","\n\n")+h,r.getCell("A".concat(u)).value=h,a.push({cell:"A".concat(u),horizontal:"left",border:top});var m=12*(f.length+4)+18;r.getRow(u).height=m,a.forEach((function(e,t,a){var n=r.getCell(e.cell);n.alignment={vertical:"middle",horizontal:e.horizontal||"center",wrapText:!0},e.fill&&(n.fill={type:"pattern",pattern:"darkGray",fgColor:{argb:"FFe9e9e9"}}),n.font={name:"黑体",family:4,size:e.size||12,underline:!1,bold:e.bold||!1},n.padding={top:10,left:10,bottom:10,right:10},n.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})),t.xlsx.writeBuffer().then((function(t){var r=new Blob([t],{type:s});i["saveAs"](r,"".concat(e.title||e.workRecName,".xlsx"))}))}}},u=c,d=r("2877"),f=Object(d["a"])(u,a,n,!1,null,"dac1198a",null);t["default"]=f.exports},4677:function(e,t,r){"use strict";r("412f")},"4a51":function(e,t,r){"use strict";r("612d")},"4b54":function(e,t,r){},5126:function(e,t,r){},"54f6":function(e,t,r){"use strict";function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,l(a.key),a)}}function i(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=s(e,"string");return"symbol"==a(t)?t:t+""}function s(e,t){if("object"!=a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}r.d(t,"a",(function(){return c}));var c=function(){function e(t,r){var a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(this,e),this.options={attrs:[]},Object.assign(this.options,o),this.options.attrs.find((function(e){return"edit"===e.key}))||this.options.attrs.push({key:"edit"}),this.options.attrs.forEach((function(e){Object.hasOwnProperty.call(e,"key")&&(a[e.key]=!1),Object.hasOwnProperty.call(e,"judge")||(e["judge"]=function(e){return!0})})),this.del=!1,this.nextTick=t.$nextTick,this.refs=t.$refs,this.refName=r,t.$nextTick((function(){a.vxeTable=t.$refs[r]}))}return i(e,[{key:"editRow",get:function(){if(this.edit){var e=this.vxeTable.getCheckboxRecords();return e.length?e[0]:{}}return{}}},{key:"update",value:function(){var e=this;this.nextTick((function(){e.vxeTable||(e.vxeTable=e.refs[e.refName]);var t=e.vxeTable.getCheckboxRecords();e.del=t.length>0,e.options.attrs.forEach((function(r){for(var a in r)Object.hasOwnProperty.call(r,a)&&(r["isDel"]?t.length?e[r.key]=t.length>0&&r.judge(t[0]):e[r.key]=!1:t.length?e[r.key]=1===t.length&&r.judge(t[0]):e[r.key]=!1)}))}))}}])}()},"60c8":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:800,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-form",{ref:"flex",staticStyle:{padding:"15px 24px"},attrs:{form:e.form,labelAlign:"left"}},[t("a-form-item",{attrs:{labelCol:{span:3},wrapperCol:{span:21},label:"模板选择",required:!0}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择表单",maxTagTextLength:10,open:!1,optionFilterProp:"formName"},on:{change:e.onFormSelectChange,dropdownVisibleChange:function(t){return e.openFormSelect()}},model:{value:e.queryParam.formName,callback:function(t){e.$set(e.queryParam,"formName",t)},expression:"queryParam.formName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},on:{click:function(t){return e.openFormSelect()}},slot:"suffixIcon"})],1)],1),t("a-form-item",{attrs:{label:"设备选择",labelCol:{span:3},wrapperCol:{span:21},required:!0}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择设备",open:!1,allowClear:""},on:{dropdownVisibleChange:function(t){return e.openAssetSelectModal()},change:e.onDeviceSelect},model:{value:e.queryParam.assetTypeName,callback:function(t){e.$set(e.queryParam,"assetTypeName",t)},expression:"queryParam.assetTypeName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1),t("a-form-item",{attrs:{label:"表单名称",labelCol:{span:3},wrapperCol:{span:21}}},[t("a-input",{attrs:{placeholder:"请输入表单名称",allowClear:""},model:{value:e.queryParam.title,callback:function(t){e.$set(e.queryParam,"title",t)},expression:"queryParam.title"}})],1)],1),t("FormsList",{ref:"multipleSelect",attrs:{multiple:!1},on:{ok:e.onFormSelect}}),t("CarDeviceSelectNew",{ref:"trainAssetSelectModal",attrs:{trainNo:e.trainNo,lineId:e.lineId,multiple:!1,canSelectType:[2,3,4]},on:{ok:e.onTrainAssetSelect,cancel:e.onCancelTrainAssetSelect}})],1)},n=[],o=r("37582"),i=r("e42a"),l=r("8fad"),s=r("310d"),c={props:{trainNo:{type:String,default:""},lineId:{type:String,default:""},repairId:{type:[Number,String],default:null},checkList:{type:Array,default:function(){return[]}},operator:{type:[String,Number],default:""}},name:"TaskFormModel",components:{FormsList:o["default"],CarDeviceSelect:i["default"],CarDeviceSelectNew:s["default"]},data:function(){return{title:"添加",detailIds:"",checkType:-1,value:1,status:1,confirmLoading:!1,switchCheck:!0,visible:!1,model:{},form:this.$form.createForm(this),queryParam:{assetTypeId:"",assetTypeName:"",code:"",copies:"",formName:"",title:"",formType:"",fromBy:"",id:"",objId:"",planId:"",remark:"",type:"",workRecordType:null}}},methods:{showModal:function(e){this.queryParam.planId=e,this.queryParam.assetTypeId="",this.queryParam.assetTypeName="",this.queryParam.code="",this.queryParam.copies="",this.queryParam.formName="",this.queryParam.title="",this.queryParam.formType="",this.queryParam.fromBy="",this.queryParam.id="",this.queryParam.objId="",this.queryParam.remark="",this.queryParam.type="",this.visible=!0},handleOk:function(){var e=this;this.queryParam.formName?this.queryParam.assetTypeId?this.checkList.find((function(t){return t.objId===e.queryParam.objId}))?this.$message.warn("".concat(this.checkList.find((function(t){return t.objId===e.queryParam.objId})).formName,"已经添加了")):Object(l["e"])(this.queryParam).then((function(t){t.success?(e.$message.success("执行成功"),e.$emit("ok"),e.visible=!1):e.$message.error(t.message)})):this.$message.warn("请选择设备"):this.$message.warn("请选择表单")},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},openFormSelect:function(){this.$refs.multipleSelect.showModal(1===this.operator&&{lineId:this.lineId,repairProgramId:this.repairId})},onFormSelect:function(e){if(e.forms.length){var t=e.forms[0];this.queryParam.code=t.code,this.queryParam.formName=t.title,this.queryParam.title=t.title,this.queryParam.formType=t.formType,this.queryParam.workRecordType=t.workRecordType,this.queryParam.objId=t.id,this.queryParam.fromBy=2}},onFormSelectChange:function(){this.queryParam.code="",this.queryParam.formName="",this.queryParam.formType="",this.queryParam.workRecordType=null,this.queryParam.type="",this.queryParam.objId=""},onDeviceSelect:function(e){e||(this.queryParam.assetTypeId="",this.queryParam.assetTypeName="",this.queryParam.trainStructId="",this.queryParam.trainStructName="",this.queryParam.assetId="",this.queryParam.assetName="")},openAssetSelectModal:function(){this.$refs.trainAssetSelectModal.showModal()},onTrainAssetSelect:function(e){if(e.length){var t=e[0];this.queryParam.assetTypeId=t.id,this.queryParam.assetTypeName=t.assetName,this.queryParam.trainStructId=t.id,this.queryParam.trainStructName=t.assetName,this.queryParam.assetId=t.id,this.queryParam.assetName=t.assetName}},onCancelTrainAssetSelect:function(){}}},u=c,d=(r("4a51"),r("2877")),f=Object(d["a"])(u,a,n,!1,null,"6a9b84db",null);t["default"]=f.exports},"612d":function(e,t,r){},7483:function(e,t,r){"use strict";r("2e75")},"7e9e":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,centered:"",width:"100%",dialogClass:"fullDialog no-footer",visible:e.visible,confirmLoading:e.loading,footer:null,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.close,cancel:e.close}},[t("a-button",{attrs:{"na-btn-type":"print",type:"primary"},on:{click:e.print}},[e._v("导出")]),t("RecordSheetTable",{directives:[{name:"show",rawName:"v-show",value:e.recordSheet,expression:"recordSheet"}],ref:"recordTable"}),t("div",{staticStyle:{height:"20px"}}),t("TableExport",{ref:"tablePrintRef"})],1)},n=[],o=r("8fad"),i=r("958d"),l=r("45ff"),s={name:"RecordTableView",components:{RecordSheetTable:i["default"],TableExport:l["default"]},props:{},data:function(){return{title:"记录表查看",visible:!1,loading:!1,recordId:"",recordSheet:{}}},mounted:function(){},methods:{show:function(e){this.recordId=e,this.loadData(),this.visible=!0},close:function(){this.$emit("close"),this.visible=!1},loadData:function(){var e=this;Object(o["Ab"])({id:this.recordId}).then((function(t){t.success?(e.recordSheet=t.result,e.$refs.recordTable.loadData(e.recordSheet)):e.$message.error("获取记录表详情失败")})).catch((function(t){e.$message.error("获取记录表详情异常")}))},print:function(){this.$refs.tablePrintRef.printById(this.recordId)}}},c=s,u=r("2877"),d=Object(u["a"])(c,a,n,!1,null,"a8b3abda",null);t["default"]=d.exports},8522:function(e,t,r){"use strict";r("f000")},"88da":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,centered:"",visible:e.visible,width:"100%",dialogClass:6===e.operator?"fullDialog":"fullDialog no-footer",destroyOnClose:!0},on:{cancel:function(t){e.visible=!1}}},[t("a-button",{attrs:{"na-btn-type":"print",type:"primary"},on:{click:e.exportPrint}},[e._v("导出打印")]),3===e.formType&&1===e.workRecordType?t("div",{staticClass:"table-page-body",staticStyle:{height:"100%","overflow-y":"auto"}},[t("RecordSheetTable",{directives:[{name:"show",rawName:"v-show",value:e.curRecordData,expression:"curRecordData"}],ref:"recordTable"})],1):e._e(),4===e.formType?t("div",{staticClass:"table-page-body",staticStyle:{height:"100%","overflow-y":"auto"}},[t("JobCheckSheetTable",{ref:"jobCheckTable",attrs:{data:e.sheetData}})],1):e._e(),1===e.formType||3===e.formType&&2===e.workRecordType?t("div",{staticClass:"table-page-body",staticStyle:{height:"100%"}},[t("div",{attrs:{id:"luckysheet"}})]):e._e(),6===e.operator?t("template",{slot:"footer"},[t("a-button",{attrs:{type:"primary"},on:{click:e.confirmForm}},[e._v(" 检查确认")]),t("a-button",{on:{click:function(t){e.visible=!1}}},[e._v(" 关闭")])],1):e._e(),t("ConfirmForm",{ref:"confirmForm",on:{ok:e.handleOk}}),t("WorkRecordPrint",{ref:"workRecordPrint",attrs:{luckySheetId:"luckysheet"},on:{sheetPrintOk:e.onSheetPrintOk}}),t("JobCheckTableExport",{ref:"tablePrintRef"}),t("TableExport",{ref:"tablePrintRef2"})],2)},n=[],o=r("b7b4"),i=r("b9c3"),l=r("958d"),s=r("e0ce"),c=r("3cf2"),u=r("45ff"),d=r("8fad"),f=r("7268"),h=r("25e0"),m=r("10f9"),p=r("e24e"),g={name:"ViewWorkForm",components:{RecordSheetTable:l["default"],ConfirmForm:h["default"],JobCheckSheetTable:s["default"],WorkRecordPrint:m["default"],JobCheckTableExport:c["default"],TableExport:u["default"]},props:{operator:{type:Number,default:0}},data:function(){return{sheetData:{},formType:1,workRecordType:0,formName:"",trainNo:"",groupName:"",visible:!1,fileUrl:"",tableData:[],curRecordData:[],curOnlineForm:null,formSheetId:"",formInfo:{},formInstId:"",onLineInstId:"",defaultOptions:{container:"luckysheet",title:"sheet",column:26,row:50,lang:"zh",allowEdit:!1,showinfobar:!1,sheetFormulaBar:!1,showsheetbar:!1,showstatisticBar:!0,enableAddRow:!1,enableAddCol:!1,showtoolbar:!1},printType:0,allItems:!0}},computed:{title:function(){return"表单查看-"+this.trainNo+"车 "+this.formName}},beforeDestroy:function(){luckysheet.destroy()},methods:{exportPrint:function(){try{var e="";switch(this.trainNo&&(e="-"+this.trainNo+"车"),this.formType){case 1:Object(p["a"])(luckysheet.getAllSheets(),this.formName+e);break;case 3:1===this.workRecordType?this.$refs.tablePrintRef2.printByData(this.curRecordData):2===this.workRecordType&&Object(p["a"])(luckysheet.getAllSheets(),this.formName+e);break;case 4:this.$refs.tablePrintRef.printByRow(this.sheetData)}}catch(t){}},initSheet:function(e){e.scrollLeft=0,e.scrollTop=0;var t=JSON.parse(JSON.stringify(this.defaultOptions));t.data=[e],luckysheet.destroy(),luckysheet.create(t)},showModal:function(e,t){try{this.formInfo=e,this.formType=e.instType,this.workRecordType=e.workRecordType,this.trainNo=t,this.formName=e.formName,this.formInstId=e.formInstId,this.allItems=!1,this.loadFormDetail(!1)}catch(r){}},showModalAllItem:function(e,t){try{this.formInfo=e,this.formType=e.instType,this.trainNo=t,this.formName=e.formName,this.formInstId=e.formInstId,this.allItems=!0,this.loadFormDetail(!0)}catch(r){}},loadFormDetail:function(e){this.printType=0;try{switch(this.formType){case 1:this.formInfo.formObjId=this.formInfo.id,this.loadOnlineFormDetail(this.formInfo.task2InstId,this.formInfo.formInstId);break;case 3:1===this.workRecordType?this.loadRecordTableDetail(this.formInfo.task2InstId,this.formInfo.formInstId,e):2===this.workRecordType&&this.loadWorkRecordDetail(this.formInfo.formObjId,this.formInfo.formInstId);break;case 4:this.loadWorkCheckFormDetail(this.formInfo.task2InstId,this.formInfo.formInstId,e)}}catch(t){}},loadWorkRecordDetail:function(e,t){var r=this,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.visible=!0,Object(d["ub"])(e).then((function(e){if(e.success){var n=JSON.parse(e.result);if(!a)return void r.initSheet(n);Object(i["U"])(t).then((function(e){if(e.success){if(e.result){var t=JSON.parse(e.result);n.data=[],n.celldata=luckysheet.transToCellData(t)}r.initSheet(n)}else r.initSheet(n)}))}else r.$message.error("获取作业记录表模板数据失败")}))},loadWorkCheckFormDetail:function(e,t){var r=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(i["P"])({task2InstId:e,formInstId:t,allItems:a}).then((function(e){if(e.success&&e.result){var t=e.result;r.sheetData=t,r.visible=!0}else r.$message.error("加载记录数据异常")}))},loadOnlineFormDetail:function(e,t){var r=this;this.visible=!0,Object(i["Q"])({task2InstId:e,formInstId:t,needValues:!1}).then((function(e){if(e.success){r.curOnlineForm=e.result;var t=null;if(r.curOnlineForm){if(r.curOnlineForm.result)try{t=JSON.parse(r.curOnlineForm.result)}catch(a){return void r.$message.error("转换表单填写结果异常")}Object(d["ub"])(r.curOnlineForm.formObjId).then((function(e){if(e.success){var a=JSON.parse(e.result);t&&(a.data=[],a.celldata=luckysheet.transToCellData(t)),r.initSheet(a)}else r.$message.error("获取表单模板数据失败")}))}else r.$message.error("获取作业表单数据失败")}else r.$message.error("获取记录表内容错误")}))},loadRecordTableDetail:function(e,t){var r=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(i["R"])({task2InstId:e,formInstId:t,needChecks:!0,needCategory:!0,allItems:a}).then((function(e){e.success&&e.result?(r.curRecordData=e.result,r.curRecordData.categoryList&&r.curRecordData.categoryList.sort((function(e,t){return e.recIndex-t.recIndex})),r.$nextTick((function(){r.$refs.recordTable.loadData(r.curRecordData)})),r.visible=!0):r.$message.error("加载记录数据异常")}))},confirmForm:function(){this.$refs.confirmForm.confirm(this.formInstId)},handleOk:function(e){if(3===this.formType&&2===this.workRecordType){var t=f["a"].searchCellByText("检查结果",luckysheet.getAllSheets()[0].data),r=t.c;if(t){var a=f["a"].getCellText(t.cell),n="1"===e.checkResult?"通过":"不通过";a=a.replace("检查结果：","检查结果："+n),f["a"].setCellValue(t.r,t.c,a)}t=f["a"].searchCellByText("检查日期",luckysheet.getAllSheets()[0].data);var o=t.c;if(t){var i=f["a"].getCellText(t.cell);i=i.replace("检查日期：","检查日期："+e.checkDate),f["a"].setCellValue(t.r,t.c,i)}t=f["a"].searchCellByText("质量负责人",luckysheet.getAllSheets()[0].data);var l=t.c;if(t){var s=f["a"].getCellText(t.cell);s=s.replace("质量负责人：","质量负责人："+e.checkUserName),f["a"].setCellValue(t.r,t.c,s)}if(r===o&&o===l){var c="1"===e.checkResult?"通过":"不通过",u="检查结果："+c;u+="          检查日期："+e.checkDate,u+="          质量负责人："+e.checkUserName,f["a"].setCellValue(t.r,t.c,u)}this.saveWorkRecord(!1)}this.$emit("checkSuccess",this.formInfo,e),this.visible=!1},saveWorkRecord:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=JSON.stringify(luckysheet.getAllSheets()[0].data),a={formInstId:this.formInfo.formInstId,xlsJson:r};Object(i["hb"])(a).then((function(r){r.success?t&&e.$message.success("保存作业记录表信息成功"):t&&e.$message.error("保存作业记录表信息失败")}))},print:function(){var e={id:this.formInfo.id,instType:this.formType,formInstId:this.formInfo.formInstId,formObjId:this.formInfo.formObjId,formName:this.formName,workRecordType:this.workRecordType};0===this.printType?this.$refs.workRecordPrint.print(e):1===this.printType&&this.$refs.workRecordPrint.printNoData(e)},onSheetPrintOk:function(){0===this.printType?this.loadFormDetail(this.allItems):1===this.printType&&this.loadFormDetailNoData()},showModalNoData:function(e,t){this.formInfo=e,this.formType=e.instType,this.trainNo=t,this.formName=e.formName,this.formInstId=e.formInstId,this.loadFormDetailNoData()},loadFormDetailNoData:function(){this.printType=1;try{switch(this.formType){case 1:this.formInfo.formObjId=this.formInfo.id,this.loadOnlineDetailNoData(this.formInfo.formInstId);break;case 3:1===this.workRecordType?this.loadRecordDetailNoData(this.formInfo.formInstId):2===this.workRecordType&&this.loadWorkRecordDetail(this.formInfo.formObjId||this.formInfo.id,this.formInfo.formInstId,!1);break;case 4:this.loadCheckDetailNoData(this.formInfo.formInstId)}}catch(e){}},loadRecordDetailNoData:function(e){var t=this;Object(d["Ab"])({id:e}).then((function(e){e.success&&e.result?(t.curRecordData=e.result,t.curRecordData.categoryList&&t.curRecordData.categoryList.sort((function(e,t){return e.recIndex-t.recIndex})),t.$nextTick((function(){t.$refs.recordTable.loadData(t.curRecordData)})),t.visible=!0):t.$message.error("加载记录数据异常")}))},loadCheckDetailNoData:function(e){var t=this;Object(o["y"])({id:e}).then((function(e){try{if(e.success&&e.result){var r=e.result;t.sheetData=r,t.visible=!0}else t.$message.error("加载记录数据异常")}catch(a){t.$message.error("加载记录数据异常")}}))},loadOnlineDetailNoData:function(e){var t=this;this.visible=!0,Object(d["ub"])(e).then((function(e){if(e.success){var r=JSON.parse(e.result);t.$nextTick((function(){t.initSheet(r)}))}}))}}},b=g,y=(r("f0c5"),r("8522"),r("2877")),v=Object(y["a"])(b,a,n,!1,null,"a7b5b52c",null);t["default"]=v.exports},"8cf3":function(e,t,r){"use strict";r("5126")},"90f1":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{ref:"tablePrint",attrs:{id:"tablePrintMain"}},[t("table",{staticClass:"table",staticStyle:{"font-size":"5px"}},[t("thead"),t("tr",[t("td",{staticStyle:{padding:"0"},attrs:{colspan:"4",rowspan:"2"},on:{click:e.print}},[e.recordSheet.assetTypeId?e._e():t("span",{staticStyle:{"padding-left":"5px"}},[e._v("车号："+e._s(e.recordSheet.trainNo))]),e.recordSheet.assetTypeId&&0===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",[e._v("部件号："+e._s(e.recordSheet.manufNo))])])]):e._e(),e.recordSheet.assetTypeId&&1===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",{staticClass:"bottom"},[e._v("原部件序列号："+e._s(e.recordSheet.manufNo))])]),t("tr",[t("td",[e._v("新部件序列号："+e._s(e.recordSheet.manufNoUp))])])]):e._e()]),t("td",{staticStyle:{"text-align":"center","font-weight":"bold"},attrs:{colspan:"3",rowspan:"2"}},[e._v(" "+e._s(e.recordSheet.title||e.recordSheet.workRecName)+" ")]),t("td",{attrs:{colspan:"3"}},[e._v("作业日期："+e._s(e.recordSheet.workDate)+" 完工日期: "+e._s(e.recordSheet.finishDate))])]),t("tr",[t("td",{attrs:{colspan:"3"}},[e._v("作业班组："+e._s(e.recordSheet.workGroupName))])]),e._m(0),e._l(e.recordSheet.categoryList,(function(r){return t("tbody",{key:r.id},e._l(r.detailList,(function(a,n){return t("tr",{key:a.id},[0===n?t("td",{attrs:{rowspan:r.detailList.length}},[e._v(" "+e._s(r.recIndex)+" ")]):e._e(),0===n?t("td",{attrs:{rowspan:r.detailList.length}},[e._v(" "+e._s(r.reguTitle)+" ")]):e._e(),t("td",[e._v(" "+e._s(a.workContent)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[e._v(" "+e._s(a.checkLevel_dictText)+" ")]),t("td",[e._v(" "+e._s(a.techRequire)+" ")]),t("td",[e._v(" "+e._s(0==a.isIgnore?a.workInfo:a.ignoreDesc)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[1===a.result?t("a-checkbox",{attrs:{checked:"",disabled:""}}):e._e(),0===a.result?t("a-checkbox",{attrs:{disabled:""}}):e._e()],1),t("td",[e._v(" "+e._s(a.selfCheck)+" ")]),t("td",[e._v(" "+e._s(a.guarderCheck)+" ")]),t("td",[e._v(" "+e._s(a.monitorCheck)+" ")])])})),0)})),e._l(e.recordSheet.measureToolList,(function(r,a){return t("tr",{key:a},[0===a?t("td",{attrs:{colspan:"2",rowspan:e.recordSheet.measureToolList.length}},[e._v("计量器具使用")]):e._e(),t("td",{attrs:{colspan:"2"}},[e._v("名称: "+e._s(r.name))]),t("td",[e._v("规格型号："+e._s(r.model))]),t("td",[e._v("出厂编号："+e._s(r.serialNo))]),t("td",{attrs:{colspan:"2"}},[e._v("上次检验时间："+e._s(r.lastCheckTime))]),t("td",{attrs:{colspan:"2"}},[e._v("下次检验时间："+e._s(r.nextCheckTime))])])})),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[e._v("情况说明："+e._s(e.recordSheet.remark))])]),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[t("span",{staticStyle:{"margin-left":"5%"}},[e._v("检查结果："+e._s(0===e.recordSheet.checkResult?"未通过":"通过")+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("检查日期："+e._s(e.recordSheet.checkDate)+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("质量负责人："+e._s(e.recordSheet.checkUserName)+" ")]),e._m(1)])])],2)])},n=[function(){var e=this,t=e._self._c;return t("tr",[t("th",{staticStyle:{width:"60px"}},[e._v("序号")]),t("th",{staticStyle:{width:"100px"}},[e._v("项目")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业内容")]),t("th",{staticStyle:{width:"60px"}},[e._v("控制点")]),t("th",{staticStyle:{width:"200px"}},[e._v("技术要求")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业情况")]),t("th",{staticStyle:{width:"80px"}},[e._v("结果")]),t("th",{staticStyle:{width:"60px"}},[e._v("自检")]),t("th",{staticStyle:{width:"60px"}},[e._v("互检")]),t("th",{staticStyle:{width:"60px"}},[e._v("专检")])])},function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"padding-top":"15px"}},[e._v(" 说明："),t("br"),e._v(" 1. 控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。"),t("br"),e._v(" 2. “自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。"),t("br"),e._v(" 3. “作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。"),t("br"),e._v(" 4. “结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。"),t("br"),e._v(" 5. 作业内容中有数据要求的一并填入“作业情况”栏 。 ")])}],o=r("8fad"),i={name:"TablePrint",data:function(){return{recordSheet:{}}},mounted:function(){},methods:{printById:function(e){var t=this;Object(o["Ab"])({id:e}).then((function(e){e.success?(t.recordSheet=e.result,t.$nextTick((function(){t.print()}))):t.$message.error("获取记录表详情失败")})).catch((function(e){t.$message.error("获取记录表详情异常")}))},printByData:function(e){var t=this;this.recordSheet=e,this.$nextTick((function(){t.print()}))},print:function(){var e=this.$refs.tablePrint.innerHTML,t=document.getElementById("printDom")||document.createElement("iframe");t.id="printDom",document.body.appendChild(t),this.$nextTick((function(){var t=document.getElementById("printDom");t.contentDocument.write(e);var r=t.contentDocument.getElementsByTagName("head").item(0),a=document.createElement("style");a.innerHTML=l,r.appendChild(a),t.contentWindow.print()}))}}},l=".table {\n        border-collapse: collapse;\n        border-spacing: 0;\n    }\n\n    .table td {\n        border-color: black;\n        border-style: solid;\n        border-width: 1px;\n        font-family: Arial, sans-serif;\n        font-size: 14px;\n        overflow: hidden;\n        padding: 10px 5px;\n        word-break: normal;\n    }\n\n    .table th {\n        border-color: black;\n        border-style: solid;\n        border-width: 1px;\n        font-family: Arial, sans-serif;\n        font-size: 14px;\n        font-weight: normal;\n        overflow: hidden;\n        padding: 10px 5px;\n        word-break: normal;\n    }\n\n    .table .tg-ld8d {\n        background-color: #f1f1f1;\n        border-color: inherit;\n        font-weight: bold;\n        text-align: left;\n        vertical-align: middle;\n    }\n\n    .table .tg-9wq8 {\n        border-color: inherit !important;\n        text-align: center !important;\n        vertical-align: middle !important;\n    }\n\n    .table .tg-87ij {\n        background-color: #f1f1f1;\n        border-color: inherit;\n        font-weight: bold;\n        text-align: center;\n        vertical-align: middle;\n    }\n\n    .table .tg-d1f0 {\n        background-color: #f1f1f1;\n        border-color: inherit;\n        font-size: 18px;\n        text-align: center;\n        vertical-align: top;\n    }\n\n    .table .tg-0pky {\n        border-color: inherit;\n        text-align: left;\n        vertical-align: top;\n    }\n\n    .qualityBox {\n        display: -ms-flexbox;\n        display: flex;\n        -ms-flex-align: end;\n        align-items: flex-end;\n    }\n\n    .qualityBox .flex1 {\n        -ms-flex: 1;\n        flex: 1;\n    }\n\n    .qualityBox .flex1 span {\n        margin-right: 15px;\n    }\n\n    .qualityBox [type='button'] {\n        margin-right: 15px;\n    }\n\n\n    .innerTable {\n        height: 100%;\n        width: 100%;\n        border-collapse: collapse;\n        border: 0;\n\n\n\n    }\n\n    .innerTable td {\n        border: 0;\n    }\n\n    .innerTable .bottom {\n        border-bottom: 1px solid #2d2a2a;\n    }\n\n    #tablePrintMain {\n        position: fixed;\n        background-color: #fff;\n        top: 120%;\n        opacity: 0;\n    }",s=i,c=(r("dc91"),r("2877")),u=Object(c["a"])(s,a,n,!1,null,"2cc9a1e0",null);t["default"]=u.exports},9527:function(e,t,r){},"958d":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("table",{staticClass:"table"},[t("thead",[t("tr",[t("td",{staticStyle:{padding:"0"},attrs:{colspan:"4",rowspan:"2"}},[e.recordSheet.assetTypeId?e._e():t("span",{staticStyle:{"padding-left":"5px"}},[e._v("车号："+e._s(e.recordSheet.trainNo))]),e.recordSheet.assetTypeId&&0===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",[e._v("部件号："+e._s(e.recordSheet.manufNo))])])]):e._e(),e.recordSheet.assetTypeId&&1===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",{staticClass:"bottom"},[e._v("原部件序列号："+e._s(e.recordSheet.manufNo))])]),t("tr",[t("td",[e._v("新部件序列号："+e._s(e.recordSheet.manufNoUp))])])]):e._e()]),t("td",{staticStyle:{"text-align":"center","font-weight":"bold"},attrs:{colspan:"3",rowspan:"2"}},[e._v(" "+e._s(e.recordSheet.title||e.recordSheet.workRecName)+" ")]),t("td",{attrs:{colspan:"3"}},[e._v("作业日期："+e._s(e.recordSheet.workDate)+" 完工日期: "+e._s(e.recordSheet.finishDate))])]),t("tr",[t("td",{attrs:{colspan:"3"}},[e._v("作业班组："+e._s(e.recordSheet.workGroupName))])]),e._m(0)]),e._l(e.recordSheet.categoryList,(function(r){return t("tbody",{key:r.id},e._l(r.detailList,(function(a,n){return t("tr",{key:a.id},[0===n?t("td",{attrs:{rowspan:r.detailList.length}},[e._v(" "+e._s(r.recIndex)+" ")]):e._e(),0===n?t("td",{attrs:{rowspan:r.detailList.length}},[e._v(" "+e._s(r.reguTitle)+" ")]):e._e(),t("td",[e._v(" "+e._s(a.workContent)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[e._v(" "+e._s(a.checkLevel_dictText)+" ")]),t("td",[e._v(" "+e._s(a.techRequire)+" ")]),t("td",[e._v(" "+e._s(0==a.isIgnore?a.workInfo:a.ignoreDesc)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[1===a.result?t("a-checkbox",{attrs:{checked:"",disabled:""}}):e._e(),0===a.result?t("a-checkbox",{attrs:{disabled:""}}):e._e()],1),t("td",[e._v(" "+e._s(a.selfCheck)+" ")]),t("td",[e._v(" "+e._s(a.guarderCheck)+" ")]),t("td",[e._v(" "+e._s(a.monitorCheck)+" ")])])})),0)})),e._l(e.recordSheet.measureToolList,(function(r,a){return t("tr",{key:a},[0===a?t("td",{attrs:{colspan:"2",rowspan:e.recordSheet.measureToolList.length}},[e._v("计量器具使用")]):e._e(),t("td",{attrs:{colspan:"2"}},[e._v("名称: "+e._s(r.name))]),t("td",[e._v("规格型号："+e._s(r.model))]),t("td",[e._v("出厂编号："+e._s(r.serialNo))]),t("td",{attrs:{colspan:"2"}},[e._v("上次检验时间："+e._s(r.lastCheckTime))]),t("td",{attrs:{colspan:"2"}},[e._v("下次检验时间："+e._s(r.nextCheckTime))])])})),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[e._v("情况说明："+e._s(e.recordSheet.remark))])]),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[t("span",{staticStyle:{"margin-left":"5%"}},[e._v("检查结果："+e._s(0===e.recordSheet.checkResult?"未通过":"通过")+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("检查日期："+e._s(e.recordSheet.checkDate)+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("质量负责人："+e._s(e.recordSheet.checkUserName)+" ")]),e._m(1)])])],2)])},n=[function(){var e=this,t=e._self._c;return t("tr",[t("th",{staticStyle:{width:"60px"}},[e._v("序号")]),t("th",{staticStyle:{width:"100px"}},[e._v("项目")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业内容")]),t("th",{staticStyle:{width:"60px"}},[e._v("控制点")]),t("th",{staticStyle:{width:"200px"}},[e._v("技术要求")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业情况")]),t("th",{staticStyle:{width:"80px"}},[e._v("结果")]),t("th",{staticStyle:{width:"60px"}},[e._v("自检")]),t("th",{staticStyle:{width:"60px"}},[e._v("互检")]),t("th",{staticStyle:{width:"60px"}},[e._v("专检")])])},function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"padding-top":"15px"}},[e._v(" 说明："),t("br"),e._v(" 1. 控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。"),t("br"),e._v(" 2. “自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。"),t("br"),e._v(" 3. “作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。"),t("br"),e._v(" 4. “结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。"),t("br"),e._v(" 5. 作业内容中有数据要求的一并填入“作业情况”栏 。 ")])}],o={name:"RecordSheetTable",data:function(){return{recordSheet:{}}},methods:{loadData:function(e){this.recordSheet=e}}},i=o,l=(r("d88b"),r("2877")),s=Object(l["a"])(i,a,n,!1,null,"197d5722",null);t["default"]=s.exports},9866:function(e,t,r){},b245:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"85%",title:"人员选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",bodyStyle:{height:"70vh"},destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{attrs:{md:4,sm:24}},[t("div",{staticStyle:{height:"calc(70vh - 20px)","border-right":"1px solid #e3e1e1","margin-right":"15px"}},[e.treeData&&e.treeData.length>0?t("a-tree",{staticClass:"limitHeight",attrs:{defaultSelectedKeys:[e.queryParam.depId],defaultExpandAll:!0,"tree-data":e.treeData},on:{select:e.onSelect}}):e._e()],1)]),t("a-col",{attrs:{md:20,sm:24}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"账号"}},[t("a-input",{attrs:{placeholder:"请输入用户账号"},model:{value:e.queryParam.username,callback:function(t){e.$set(e.queryParam,"username",t)},expression:"queryParam.username"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"真实名字"}},[t("a-input",{attrs:{placeholder:"请输入真实名字"},model:{value:e.queryParam.realname,callback:function(t){e.$set(e.queryParam,"realname",t)},expression:"queryParam.realname"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"手机号码"}},[t("a-input",{attrs:{placeholder:"请输入手机号码"},model:{value:e.queryParam.phone,callback:function(t){e.$set(e.queryParam,"phone",t)},expression:"queryParam.phone"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"角色"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"sys_role,role_name,id",placeholder:"选择角色"},model:{value:e.queryParam.roleId,callback:function(t){e.$set(e.queryParam,"roleId",t)},expression:"queryParam.roleId"}})],1)],1),t("a-col",{attrs:{md:2,sm:8}},[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(70vh - 130px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(70vh - 130px)"},attrs:{border:"",align:e.allAlign,data:e.tableData,"max-height":"100%","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"manual",mode:"row"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"5%"}}):t("vxe-table-column",{attrs:{type:"radio",width:"5%"}}),t("vxe-table-column",{attrs:{field:"workNo",title:"工号",width:"100",align:"center"}}),t("vxe-table-column",{attrs:{field:"username",title:"用户账号",width:"150",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"realname",title:"用户名字",width:"100",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"roleNames",title:"角色","min-width":"180",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"sex_dictText",title:"性别",width:"80"}}),t("vxe-table-column",{attrs:{field:"phone",title:"手机号码",width:"120"}}),t("vxe-table-column",{attrs:{field:"orgCode",title:"部门",width:"120",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"80"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)])],1)],1)},n=[],o=r("8fad"),i={name:"UserList",props:{multiple:{type:Boolean,default:!0},depId:{type:String,default:""}},data:function(){return{queryParam:{username:"",realname:"",phone:"",orgCode:"",roleId:void 0,pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,treeData:[]}},watch:{depId:function(e){this.$set(this.queryParam,"depId",e||"")}},mounted:function(){this.$set(this.queryParam,"depId",this.depId||"")},methods:{showModal:function(){this.visible=!0,this.findList(),this.getTreeList()},getTreeList:function(){var e=this;Object(o["pb"])().then((function(t){t.success&&(e.treeData=t.result)}))},onSelect:function(e,t){if(e.length){var r=t.node.dataRef;this.queryParam.depId=r.id,this.findList()}else this.queryParam.orgCode="",this.findList()},findList:function(){var e=this;this.loading=!0,Object(o["jc"])(this.queryParam).then((function(t){e.loading=!1,t.success?(e.totalResult=t.result.total,e.tableData=t.result.records):e.$message.error("加载用户数据失败")})).catch((function(t){e.$message.error("加载用户数据异常")})).finally((function(){}))},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,Object.assign(this.$data,this.$options.data())}}},l=i,s=(r("f76d"),r("2877")),c=Object(s["a"])(l,a,n,!1,null,"4aa7956f",null);t["default"]=c.exports},b9c3:function(e,t,r){"use strict";r.d(t,"lb",(function(){return i})),r.d(t,"f",(function(){return l})),r.d(t,"i",(function(){return s})),r.d(t,"v",(function(){return c})),r.d(t,"b",(function(){return f})),r.d(t,"l",(function(){return h})),r.d(t,"p",(function(){return m})),r.d(t,"G",(function(){return p})),r.d(t,"c",(function(){return d})),r.d(t,"B",(function(){return b})),r.d(t,"k",(function(){return v})),r.d(t,"A",(function(){return y})),r.d(t,"x",(function(){return k})),r.d(t,"g",(function(){return w})),r.d(t,"E",(function(){return x})),r.d(t,"C",(function(){return S})),r.d(t,"M",(function(){return I})),r.d(t,"kb",(function(){return C})),r.d(t,"O",(function(){return O})),r.d(t,"N",(function(){return P})),r.d(t,"jb",(function(){return j})),r.d(t,"t",(function(){return D})),r.d(t,"d",(function(){return R})),r.d(t,"W",(function(){return q})),r.d(t,"X",(function(){return $})),r.d(t,"e",(function(){return L})),r.d(t,"o",(function(){return F})),r.d(t,"V",(function(){return z})),r.d(t,"R",(function(){return E})),r.d(t,"Q",(function(){return B})),r.d(t,"K",(function(){return W})),r.d(t,"L",(function(){return U})),r.d(t,"fb",(function(){return be})),r.d(t,"bb",(function(){return Y})),r.d(t,"Y",(function(){return Q})),r.d(t,"J",(function(){return K})),r.d(t,"hb",(function(){return oe})),r.d(t,"U",(function(){return ie})),r.d(t,"eb",(function(){return Z})),r.d(t,"cb",(function(){return X})),r.d(t,"a",(function(){return ee})),r.d(t,"j",(function(){return ue})),r.d(t,"nb",(function(){return de})),r.d(t,"gb",(function(){return fe})),r.d(t,"m",(function(){return he})),r.d(t,"H",(function(){return ye})),r.d(t,"T",(function(){return J})),r.d(t,"S",(function(){return A})),r.d(t,"mb",(function(){return M})),r.d(t,"z",(function(){return me})),r.d(t,"db",(function(){return pe})),r.d(t,"y",(function(){return ge})),r.d(t,"u",(function(){return u})),r.d(t,"F",(function(){return g})),r.d(t,"ob",(function(){return N})),r.d(t,"q",(function(){return _})),r.d(t,"D",(function(){return T})),r.d(t,"ib",(function(){return te})),r.d(t,"n",(function(){return re})),r.d(t,"I",(function(){return H})),r.d(t,"P",(function(){return G})),r.d(t,"s",(function(){return le})),r.d(t,"Z",(function(){return se})),r.d(t,"ab",(function(){return ce})),r.d(t,"h",(function(){return ae})),r.d(t,"w",(function(){return ne})),r.d(t,"r",(function(){return V}));var a=r("0fea"),n=r("4328"),o=r.n(n),i=function(e){return Object(a["j"])("/group/fault/info/submit",e)},l=function(e){return Object(a["j"])("/group/fault/info/cancel",e)},s=function(e){return Object(a["j"])("/group/fault/info/delete",e)},c=function(e){return Object(a["d"])("/group/fault/info/page",e)},u=function(e){return Object(a["d"])("/group/fault/info/get",e)},d=function(e){return Object(a["j"])("/group/safeassume/read/add",e)},f=function(e){return Object(a["j"])("/group/safeassume/add",e)},h=function(e){return Object(a["j"])("/group/safeassume/delete",e)},m=function(e){return Object(a["j"])("/group/safeassume/edit",e)},p=function(e){return Object(a["d"])("/group/safeassume/page",e)},g=function(e){return Object(a["d"])("/group/safeassume/get",e)},b=function(e){return Object(a["d"])("/group/turnoverchange/page",e)},y=function(e){return Object(a["d"])("/material/spare-part/get",e)},v=function(e){return Object(a["j"])("/group/turnoverchange/delete",e)},k=function(e){return Object(a["d"])("/group/measurealert/page",e)},w=function(e){return Object(a["j"])("/group/measurealert/close",e)},x=function(e){return Object(a["d"])("/group/spare-part/page",e)},S=function(e){return Object(a["d"])("/group/spare-part/get",e)},T=function(e){return Object(a["d"])("/produce/train/history/asset/use/page",e)},I=function(e){return Object(a["d"])("/group/toolequipment/page",e)},C=function(e){return Object(a["j"])("/group/toolequipment/setStatus",e)},_=function(e){return Object(a["d"])("/group/toolequipment/usage",e)},O=function(e){return Object(a["d"])("/group/tool/page",e)},P=function(e){return Object(a["d"])("/group/tool/get",e)},j=function(e){return Object(a["j"])("/group/tool/setDutyUser",e)},N=function(e){return Object(a["d"])("/group/tool/usage",e)},D=function(e){return Object(a["d"])("/group/information/basic",e)},R=function(e){return Object(a["j"])("/group/information/tools/add",e)},q=function(e){return Object(a["d"])("/group/information/workstation/page-related",e)},$=function(e){return Object(a["d"])("/group/information/workstation/page-unrelated",e)},L=function(e){return Object(a["j"])("/group/information/workstation/add",e)},F=function(e){return Object(a["j"])("/group/information/workstation/delete",e)},A=function(e){return Object(a["d"])("/workGroup/workOrder/relevanceInfo/".concat(e))},M=function(e){return Object(a["j"])("/workGroup/workOrder/submit-to-dispatcher",o.a.stringify(e))},z=function(e){return Object(a["d"])("/workGroup/workRecord/list",e)},B=function(e){return Object(a["d"])("/serialPlan/plan/forms/online-form/get",e)},E=function(e){return Object(a["d"])("/serialPlan/plan/forms/work-record/get",e)},G=function(e){return Object(a["d"])("/serialPlan/plan/forms/check-record/get",e)},J=function(e){return Object(a["d"])("/workGroup/workOrder/page",e)},V=function(e){return Object(a["d"])("/workGroup/workOrder/apply/page",e)},W=function(e){return Object(a["d"])("/workGroup/workRecord/recordForm",e)},U=function(e){return Object(a["d"])("/workGroup/workRecord/relevanceInfo/".concat(e))},H=function(e){return Object(a["d"])("/workGroup/workRecord/relevanceInfo/bookSteps/".concat(e))},Y=function(e){return Object(a["j"])("/workGroup/workRecord/save/form-result",e)},Q=function(e){return Object(a["j"])("/workGroup/workRecord/check",e)},K=function(e){return Object(a["j"])("/workGroup/workRecord/getTaskQRCode",e)},Z=function(e){return Object(a["j"])("/workGroup/workRecord/work-record/save-manufNo",o.a.stringify(e))},X=function(e){return Object(a["j"])("/workGroup/workRecord/save/material",e)},ee=function(e){return Object(a["j"])("/workGroup/workRecord/save/actMaterial",e)},te=function(e){return Object(a["j"])("/workGroup/workRecord/save/work-time",e)},re=function(e){return Object(a["j"])("/workGroup/workRecord/arrange/delete",e)},ae=function(e){return Object(a["j"])("/workGroup/workOrder/material/commit-temp-apply",e)},ne=function(e){return Object(a["d"])("/workGroup/workOrder/material/apply/list",e)},oe=function(e){return Object(a["j"])("/workGroup/workRecord/check/saveExcelData",e)},ie=function(e){return Object(a["d"])("/workGroup/workRecord/get/excelData/".concat(e))},le=function(e){return Object(a["d"])("/serialPlan/plan/forms/check-record/item/list",e)},se=function(e){return Object(a["j"])("/workGroup/workRecord/check-record/set-check",e)},ce=function(e){return Object(a["j"])("/workGroup/workRecord/check-record/set-time",e)},ue=function(e){return Object(a["j"])("/workGroup/workRecord/delete/material",o.a.stringify(e))},de=function(e){return Object(a["j"])("/workGroup/workRecord/submit-task",e)},fe=function(e){return Object(a["j"])("/workGroup/workRecord/save/tool",e)},he=function(e){return Object(a["j"])("/workGroup/workRecord/delete/tool",o.a.stringify(e))},me=function(e){return Object(a["d"])("/workGroup/workRecord/outsourceOutin",e)},pe=function(e){return Object(a["j"])("/workGroup/workRecord/save/outsourceOutin",e)},ge=function(e){return Object(a["d"])("/workGroup/workRecord/outin/not-returns",e)},be=function(e){return Object(a["j"])("/group/safeassume/read/add",o.a.stringify(e))},ye=function(e){return Object(a["d"])("/serialPlan/plan/page",e)}},d1e3:function(e,t,r){"use strict";r("9866")},d88b:function(e,t,r){"use strict";r("3ff1")},dc91:function(e,t,r){"use strict";r("ed25")},de37:function(e,t,r){},e24e:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var a=r("e8ae"),n=r.n(a),o=r("21a6"),i=r.n(o),l=(r("7268"),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"),s=function(e,t){var r=new n.a.Workbook;"[object Object]"===Object.prototype.toString.call(e)&&(e=[e]),e.forEach((function(e){if(0===e.data.length)return!0;var t=r.addWorksheet(e.name),a=e.config&&e.config.merge||{},n=e.config&&e.config.borderInfo||{},o=e.config&&e.config.columnlen||{},i=e.images||{};return d(i,r,t),u(o,t),c(e.config,t),m(e.data,t),f(a,t),h(n,t),!0}));var a=r.xlsx.writeBuffer().then((function(e){var r=new Blob([e],{type:l});i.a.saveAs(r,"".concat(t,".xlsx"))}));return a},c=function(e,t){if(e&&e.rowlen)for(var r in e.rowlen){var a=parseInt(r),n=parseInt(e.rowlen[r]),o=t.getRow(a+1);o.height=n}},u=function(e,t){for(var r in e){var a=parseInt(r),n=parseInt(e[r]);t.getColumn(a+1).width=parseInt(n/7)}},d=function(e,t,r){for(var a in e){var n=e[a],o=n.src.split(";base64,"),i=o[0].replaceAll("data:image/",""),l=t.addImage({base64:n.src,extension:i}),s=luckysheet.location(n.default.left,n.default.top);r.addImage(l,{tl:{col:s.col,row:s.row},ext:{width:n.default.width,height:n.default.height}})}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=Object.values(e);r.forEach((function(e){t.mergeCells(e.r+1,e.c+1,e.r+e.rs,e.c+e.cs)}))},h=function(e,t){Array.isArray(e)&&e.forEach((function(e){if("range"===e.rangeType)for(var r=y(e.borderType,e.style,e.color),a=e.range[0],n=a.row,o=a.column,i=n[0]+1;i<n[1]+2;i++)for(var l=o[0]+1;l<o[1]+2;l++)t.getCell(i,l).border=r;if("cell"===e.rangeType){var s=e.value,c=s.col_index,u=s.row_index,d=Object.assign({},e.value);delete d.col_index,delete d.row_index;var f=v(d,u,c);t.getCell(u+1,c+1).border=f}}))},m=function(e,t){Array.isArray(e)&&e.forEach((function(e,r){e.every((function(e,a){if(!e)return!0;var n=p(e.bg),o=g(e.ff,e.fc,e.bl,e.it,e.fs,e.cl,e.ul),i=b(e.vt,e.ht,e.tb,e.tr),l="";e.f?l={formula:e.f,result:e.v}:!e.v&&e.ct&&e.ct.s?e.ct.s.forEach((function(e){l+=e.v})):l=e.v;var s=k(a),c=t.getCell(s+(r+1));for(var u in n){c.fill=n;break}return c.font=o,c.alignment=i,c.value=l,!0}))}))},p=function(e){if(!e)return{};var t={type:"pattern",pattern:"solid",fgColor:{argb:e.replace("#","")}};return t},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000000",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l={0:"微软雅黑",1:"宋体（Song）",2:"黑体（ST Heiti）",3:"楷体（ST Kaiti）",4:"仿宋（ST FangSong）",5:"新宋体（ST Song）",6:"华文新魏",7:"华文行楷",8:"华文隶书",9:"Arial",10:"Times New Roman ",11:"Tahoma ",12:"Verdana",num2bl:function(e){return 0!==e}},s={name:"number"===typeof e?l[e]:e,family:1,size:n,color:{argb:t.replace("#","")},bold:l.num2bl(r),italic:l.num2bl(a),underline:l.num2bl(i),strike:l.num2bl(o)};return s},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"default",n={vertical:{0:"middle",1:"top",2:"bottom",default:"top"},horizontal:{0:"center",1:"left",2:"right",default:"left"},wrapText:{0:!1,1:!1,2:!0,default:!1},textRotation:{0:0,1:45,2:-45,3:"vertical",4:90,5:-90,default:0}},o={vertical:n.vertical[e],horizontal:n.horizontal[t],wrapText:n.wrapText[r],textRotation:n.textRotation[a]};return o},y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000";if(!e)return{};var a={type:{"border-all":"all","border-top":"top","border-right":"right","border-bottom":"bottom","border-left":"left"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}},n={style:a.style[t],color:{argb:r.replace("#","")}},o={};return"all"===a.type[e]?(o["top"]=n,o["right"]=n,o["bottom"]=n,o["left"]=n):o[a.type[e]]=n,o};function v(e,t,r){var a={},n={type:{l:"left",r:"right",b:"bottom",t:"top"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}};for(var o in e)-1===e[o].color.indexOf("rgb")?a[n.type[o]]={style:n.style[e[o].style],color:{argb:e[o].color.replace("#","")}}:a[n.type[o]]={style:n.style[e[o].style],color:{argb:e[o].color}};return a}function k(e){var t="A".charCodeAt(0),r="Z".charCodeAt(0),a=r-t+1,n="";while(e>=0)n=String.fromCharCode(e%a+t)+n,e=Math.floor(e/a)-1;return n}},e42a:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("a-modal",{attrs:{title:"车辆设备选择",width:"80%",bodyStyle:{height:"60vh"},visible:e.visible,confirmLoading:e.confirmLoading,closable:!0,destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.close}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchQuery.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"名称"}},[t("a-input",{attrs:{placeholder:"名称或编码"},model:{value:e.queryParam.title,callback:function(t){e.$set(e.queryParam,"title",t)},expression:"queryParam.title"}})],1)],1),t("a-col",{attrs:{md:10,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.searchQuery}},[e._v("查询")])],1)],1)])],1)],1)],1),t("div",{staticClass:"tableHeight"},[t("vxe-table",{ref:"listTable",attrs:{border:"",resizable:"","row-id":"id",align:e.allAlign,height:"auto",data:e.tableData,"show-overflow":"tooltip","max-height":"100%","radio-config":{trigger:e.multiple?"default":"row",highlight:!0,checkMethod:e.checkRadioMethod},"checkbox-config":{trigger:e.multiple?"row":"default",highlight:!0,checkStrictly:!0,checkMethod:e.checkRadioMethod},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40",fixed:"left"}}),t("vxe-table-column",{attrs:{field:"assetName",title:"名称","tree-node":"",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"assetNo",title:"编码",width:"12%"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"100"}}),t("vxe-table-column",{attrs:{field:"structType_dictText",title:"类型",width:"10%"}}),t("vxe-table-column",{attrs:{field:"assetTypeName",title:"设备类型",width:"13%",align:"left","header-align":"center"}})],1)],1)])],1)},n=[],o=r("8fad"),i={props:{multiple:{type:Boolean,default:!0},trainNo:{required:!0},canSelectType:{type:Array,default:function(){return[1,2,3,4]}}},data:function(){return{allAlign:"center",tableData:[],visible:!1,confirmLoading:!1,queryParam:{code:"",title:""}}},created:function(){},methods:{checkRadioMethod:function(e){var t=e.row;return this.canSelectType.indexOf(t.structType)>-1},searchQuery:function(){this.findList()},loadChildrenMethod:function(e){var t=this,r=e.row,a={code:this.trainNo,id:r.id,searchText:this.queryParam.searchText};return new Promise((function(e){Object(o["Xb"])(a).then((function(r){r.success?e(r.result):t.$message.error("".concat(r.msg))}))}))},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},showModal:function(){this.visible=!0,this.queryParam.code=this.trainNo,this.findList()},close:function(){this.visible=!1},findList:function(){var e=this;this.loading=!0,Object(o["Xb"])(this.queryParam).then((function(t){t.success&&(e.loading=!1,e.tableData=t.result)}))}}},l=i,s=(r("14d0"),r("2877")),c=Object(s["a"])(l,a,n,!1,null,"0f6e3f94",null);t["default"]=c.exports},e89a:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"luckySheetPringContent"}},[t("div",{staticClass:"table-page-body",staticStyle:{position:"relative"}},[t("div",{ref:"printDom",staticClass:"ls-print",style:{height:e.lHeight},attrs:{id:e.luckySheetId}})])])},n=[],o=r("8fad"),i=(r("2410"),r("7268")),l={name:"LuckySheetPrint",props:{luckySheetId:{type:String,default:"luckySheetPring"}},data:function(){return{recordSheet:{},lHeight:"calc(100% - 0)"}},mounted:function(){},methods:{printById:function(e){var t=this;o["ub"].call(this,e).then((function(e){e.success&&t.printBySheet(JSON.parse(e.result))})).catch((function(e){t.$message.error("加载表单内容异常")}))},printByData:function(e){var t=this;this.recordSheet=e,this.$nextTick((function(){t.print()}))},printBySheet:function(e){var t=this,r=Object.assign({},i["a"].getDefaultOptions());r.container=this.luckySheetId;var a=0,n=0,o=0;e.celldata.forEach((function(e){e.c>a&&(a=e.c),e.r>n&&(n=e.r)})),a++,n++,o=e.visibledatarow[e.visibledatarow.length-1],r.column=a,r.row=n,delete e.luckysheet_select_save,r.data=[e],this.lHeight="".concat(o+40,"px"),luckysheet.destroy(),luckysheet.create(r),setTimeout((function(){var e=document.getElementById("luckysheet-sheettable_0"),r=document.getElementById("luckysheetTableContent"),a=r.getContext("2d").getImageData(42,17,e.offsetWidth,e.offsetHeight+10),n=document.createElement("canvas");n.width=e.offsetWidth,n.height=e.offsetHeight;var o=n.getContext("2d");o.putImageData(a,0,0);var i=n.toDataURL("image/png");t.print('<img id="printImage" src="'.concat(i,'">'))}),500)},print:function(e){var t=this,r=document.getElementById("printDom")||document.createElement("iframe");r.id="printDom",document.body.appendChild(r),this.$nextTick((function(){var a=document.getElementById("printDom");a.contentDocument.write(e),a.contentDocument.getElementById("printImage").onload=function(){a.contentWindow.print(),luckysheet.destroy(),t.$emit("sheetPrintOk"),document.body.removeChild(r)}}))}}},s=l,c=(r("d1e3"),r("2877")),u=Object(c["a"])(s,a,n,!1,null,"4cc670b2",null);t["default"]=u.exports},ed25:function(e,t,r){},f000:function(e,t,r){},f0c5:function(e,t,r){"use strict";r("4b54")},f76d:function(e,t,r){"use strict";r("9527")}}]);