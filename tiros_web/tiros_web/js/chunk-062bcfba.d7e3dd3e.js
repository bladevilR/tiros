(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-062bcfba","chunk-72e72170","chunk-2d20e8a3"],{3348:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"800px",visible:e.visible,title:"文件上传",centered:"",bodyStyle:{height:"500px"},confirmLoading:e.confirmLoading,destroyOnClose:!0,footer:null},on:{cancel:e.handleCancel}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",[t("DocUpload",{ref:"upload",attrs:{"default-file-list":e.defaultFileList,"show-upload":!1,path:e.save_path},on:{upLoadingEnd:e.upLoadingEnd,uploaded:e.successUploadFile,removed:e.onRemoveFile,uploadFail:e.uploadFail}})],1)],1)],1),t("a-row",[t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"是否共享？"}},[t("a-switch",{model:{value:e.shared,callback:function(t){e.shared=t},expression:"shared"}})],1)],1),e.shared?t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{label:"共享到"}},[t("a-tree-select",{attrs:{"tree-data-simple-mode":"","allow-clear":"","tree-data":e.selectTreeNode,replaceFields:{title:"title",value:"id"},placeholder:"请选择","load-data":e.loadSelectNodeMethod},model:{value:e.sharedId,callback:function(t){e.sharedId=t},expression:"sharedId"}})],1)],1):e._e()],1),t("a-row",{staticStyle:{"margin-top":"8px"},attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-textarea",{attrs:{maxLength:201,placeholder:"备注"},on:{change:e.remarkChange},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}})],1)],1)],1),t("div",{attrs:{id:"fileTag"}},[e._l(e.tags,(function(n){return[n.length>10?t("a-tooltip",{key:n,attrs:{title:n}},[t("a-tag",{key:n,attrs:{color:"blue",closable:!0},on:{close:function(){return e.handleClose(n)}}},[e._v(" "+e._s("".concat(n.slice(0,10),"..."))+" ")])],1):t("a-tag",{key:n,attrs:{color:"blue",closable:!0},on:{close:function(){return e.handleClose(n)}}},[e._v(" "+e._s(n)+" ")])]})),e.inputVisible?t("a-input",{ref:"input",style:{width:"78px"},attrs:{type:"text",value:e.inputValue},on:{change:e.handleInputChange,blur:e.handleInputConfirm,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm.apply(null,arguments)}}}):t("a-tag",{staticStyle:{background:"#fff",borderstyle:"dashed"},attrs:{color:"blue"},on:{click:e.showInput}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 添加标签 ")],1)],2),t("div",{staticStyle:{"margin-top":"80px",position:"absolute",bottom:"10px","text-align":"right","padding-right":"25px",width:"100%"}},[t("a-space",[t("a-button",{attrs:{type:"primary",loading:e.isLoading},on:{click:e.beginUpload}},[e._v("上传至服务器")]),t("a-button",{on:{click:function(t){e.visible=!1}}},[e._v("关闭")])],1)],1)],1)},a=[],r=n("b098"),o=n("8fad"),l=n("5371");function s(e){return f(e)||d(e)||c(e)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){if(e){if("string"==typeof e)return h(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function d(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function f(e){if(Array.isArray(e))return h(e)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}var p={name:"DocumentUpload",components:{JTreeSelect:r["default"],DocUpload:l["default"]},props:["save_path"],data:function(){return{selectTreeNode:[],form:this.$form.createForm(this),visible:!1,confirmLoading:!1,directoryId:"",isLoading:!1,defaultFileList:[],shared:!1,sharedId:"",tags:[],remark:"",inputVisible:!1,inputValue:"",labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:16}}}},watch:{shared:{immediate:!1,handler:function(e){e&&this.loadSelectNodeMethod(null)}}},methods:{loadSelectNodeMethod:function(e){var t=this;return new Promise((function(n){Object(o["Zb"])(null==e?"-1":e.dataRef.id).then((function(e){e.success?e.result.map((function(e){t.selectTreeNode=t.selectTreeNode.concat(t.genSelectTreeNode(e))})):t.$message.error(e.message)})),n()}))},genSelectTreeNode:function(e){return{id:e.id,pId:e.parentId,value:e.id,title:e.name,isLeaf:!e.hasChildren}},remarkChange:function(){return!(this.remark.length>200)||(this.$message.error("备注不能超过255个字符"),!1)},showModal:function(e){this.tags=[],this.remark="",this.shared=!1,this.sharedId="",this.directoryId=e,this.visible=!0},successUploadFile:function(e){var t=this;if(this.confirmLoading=!1,e&&!(e.length<1)){var n={directoryId:this.directoryId,sharedId:this.sharedId,remark:this.remark,fileTags:this.tags.length>0?this.tags.join(","):""};e.map((function(e){Object.assign(e,n)})),Object(o["d"])(e).then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok"),t.handleCancel()):t.$message.error(e.message)}))}},uploadFail:function(e){this.confirmLoading=!1,this.$message.error("上传失败！")},onRemoveFile:function(e){},handleClose:function(e){var t=this.tags.filter((function(t){return t!==e}));this.tags=t},showInput:function(){this.inputVisible=!0,this.$nextTick((function(){this.$refs.input.focus()}))},handleInputChange:function(e){this.inputValue=e.target.value},handleInputConfirm:function(){var e=this.inputValue,t=this.tags;e&&-1===t.indexOf(e)&&(t=[].concat(s(t),[e])),Object.assign(this,{tags:t,inputVisible:!1,inputValue:""})},beginUpload:function(){this.tags.length>10?this.$message.warn("最多只能添加10个标签！"):(this.isLoading=!0,this.confirmLoading=!0,this.$refs.upload.beginUpload())},upLoadingEnd:function(){this.isLoading=!1},handleCancel:function(){this.visible=!1,this.selectTreeNode=[]}}},m=p,g=(n("babc"),n("2877")),y=Object(g["a"])(m,i,a,!1,null,"7a8011c7",null);t["default"]=y.exports},5371:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e._self._c;return t("div",[t("a-row",{staticStyle:{"padding-bottom":"10px"},attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-upload",{attrs:{multiple:!0,"file-list":e.fileList,remove:e.handleRemove,"before-upload":e.beforeUpload,"default-file-list":e.defaultFileList}},[t("a-button",{staticClass:"border-primary-4"},[e._v("添加文件")])],1)],1)],1),t("a-row",[e.showUpload?t("a-col",{attrs:{span:5}},[t("a-button",{attrs:{type:"primary",loading:e.isLoading},on:{click:e.beginUpload}},[e._v("上传至服务器")])],1):e._e(),t("a-col",{staticStyle:{color:"#cccccc"},attrs:{span:19}},[e._v("一次最多上传"+e._s(e.fileSize)+"个文件，且单个文件不能超过10MB")])],1)],1)},a=[],r=n("e2aa");function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function r(n,i,a,r){var o=i&&i.prototype instanceof u?i:u,c=Object.create(o.prototype);return l(c,"_invoke",function(n,i,a){var r,o,l,u=0,c=a||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return r=t,o=0,l=e,f.n=n,s}};function h(n,i){for(o=n,l=i,t=0;!d&&u&&!a&&t<c.length;t++){var a,r=c[t],h=f.p,p=r[2];n>3?(a=p===i)&&(l=r[(o=r[4])?5:(o=3,3)],r[4]=r[5]=e):r[0]<=h&&((a=n<2&&h<r[1])?(o=0,f.v=i,f.n=r[1]):h<p&&(a=n<3||r[0]>i||i>p)&&(r[4]=n,r[5]=i,f.n=p,o=0))}if(a||n>1)return s;throw d=!0,i}return function(a,c,p){if(u>1)throw TypeError("Generator is already running");for(d&&1===c&&h(c,p),o=c,l=p;(t=o<2?e:l)||!d;){r||(o?o<3?(o>1&&(f.n=-1),h(o,l)):f.n=l:f.v=l);try{if(u=2,r){if(o||(a="next"),t=r[a]){if(!(t=t.call(r,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,o<2&&(o=0)}else 1===o&&(t=r.return)&&t.call(r),o<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),o=1);r=e}else if((t=(d=f.n<0)?l:n.call(i,f))!==s)break}catch(t){r=e,o=1,l=t}finally{u=1}}return{value:t,done:d}}}(n,a,r),!0),c}var s={};function u(){}function c(){}function d(){}t=Object.getPrototypeOf;var f=[][i]?t(t([][i]())):(l(t={},i,(function(){return this})),t),h=d.prototype=u.prototype=Object.create(f);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,a,"GeneratorFunction")),e.prototype=Object.create(h),e}return c.prototype=d,l(h,"constructor",d),l(d,"constructor",c),c.displayName="GeneratorFunction",l(d,a,"GeneratorFunction"),l(h),l(h,a,"Generator"),l(h,i,(function(){return this})),l(h,"toString",(function(){return"[object Generator]"})),(o=function(){return{w:r,m:p}})()}function l(e,t,n,i){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}l=function(e,t,n,i){function r(t,n){l(e,t,(function(e){return this._invoke(t,n,e)}))}t?a?a(e,t,{value:n,enumerable:!i,configurable:!i,writable:!i}):e[t]=n:(r("next",0),r("throw",1),r("return",2))},l(e,t,n,i)}function s(e,t,n,i,a,r,o){try{var l=e[r](o),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(i,a)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var r=e.apply(t,n);function o(e){s(r,i,a,o,l,"next",e)}function l(e){s(r,i,a,o,l,"throw",e)}o(void 0)}))}}var c={name:"DocUpload",props:{path:{type:String,default:""},fileSize:{type:Number,default:5},defaultFileList:{type:Array,default:[]},showUpload:{type:Boolean,default:!0},isFileEmpty:{type:Boolean,default:!1}},watch:{uploadFiles:{immediate:!1,handler:function(){var e=u(o().m((function e(t){return o().w((function(e){while(1)switch(e.n){case 0:if(t.length!==this.fileList.length){e.n=1;break}return e.n=1,this.$emit("uploaded",this.uploadFiles);case 1:return e.a(2)}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},data:function(){return{fileList:[],uploadFiles:[],isLoading:!1}},methods:{beforeUpload:function(e){var t=e.size/1024/1024<10;return t?(this.fileList.push(e),this.$emit("fileNum",this.fileList.length),this.$emit("setBforeUploadStatus",!1),!1):(this.$message.error("文件不得大于10MB!"),!1)},handleRemove:function(e){var t=this.fileList.indexOf(e),n=this.fileList.slice();n.splice(t,1),this.fileList=n,this.$emit("fileNum",this.fileList.length),this.$emit("removed",e)},beginUpload:function(){var e=this;return new Promise((function(t,n){var i=e.fileList,a=e.fileSize;if(!e.isFileEmpty&&0===i.length)return e.$emit("upLoadingEnd"),e.$message.warning("请选择要上传的文件"),void n();i.length>a?(e.$message.error("一次最多上传"+a+"个文件!"),n()):e.customRequest().then((function(){t()})).catch((function(e){n()}))}))},customRequest:function(){var e=this,t=this.fileList;if(t.length<1)return this.$emit("uploaded",[]),this.$emit("upLoadingEnd"),Promise.resolve();this.isLoading=!0;var n=[];return t.forEach((function(t){var i=new FormData;i.append("file",t),n.push(e.saveFile(i,t))})),Promise.all(n).finally((function(){e.isLoading=!1,e.$emit("upLoadingEnd")}))},saveFile:function(){var e=u(o().m((function e(t,n){var i=this;return o().w((function(e){while(1)switch(e.n){case 0:return e.a(2,Object(r["d"])(t,this.path).then((function(e){e.success?(i.getUploadData(n,e),i.$emit("setUpLoadingEndStatus",!0)):(i.$message.error(e.message),i.$emit("uploadFail",n))})))}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}(),getUploadData:function(e,t){var n=this.uploadFiles,i={name:e.name,type:this.handleFileName(e),fileSize:Math.round(e.size/1024),savepath:t.result};n.push(i)},handleFileName:function(e){var t=e.name.lastIndexOf("."),n=e.name.length,i=e.name.substring(t+1,n);return i}}},d=c,f=(n("9615"),n("2877")),h=Object(f["a"])(d,i,a,!1,null,"69990be1",null);t["default"]=h.exports},"94c2d":function(e,t,n){},9615:function(e,t,n){"use strict";n("94c2d")},"9ff8":function(e,t,n){},b098:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e._self._c;return t("a-tree-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",labelInValue:"",getPopupContainer:function(e){return e.parentNode},disabled:e.disabled,dropdownStyle:{maxHeight:"400px",overflow:"auto"},placeholder:e.placeholder,loadData:e.asyncLoadTreeData,value:e.treeValue,treeData:e.treeData,multiple:e.multiple},on:{change:e.onChange,search:e.onSearch}})},a=[],r=n("0fea");function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function l(e){return c(e)||u(e)||f(e)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function c(e){if(Array.isArray(e))return h(e)}function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=f(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw r}}}}function f(e,t){if(e){if("string"==typeof e)return h(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}var p={name:"JTreeSelect",props:{value:{type:String,required:!1},placeholder:{type:String,default:"请选择",required:!1},dict:{type:String,default:"",required:!1},pidField:{type:String,default:"pid",required:!1},pidValue:{type:String,default:"",required:!1},disabled:{type:Boolean,default:!1,required:!1},hasChildField:{type:String,default:"",required:!1},condition:{type:String,default:"",required:!1},multiple:{type:Boolean,default:!1},loadTriggleChange:{type:Boolean,default:!1,required:!1}},data:function(){return{treeValue:null,treeData:[],url:"/sys/dict/loadTreeData",view:"/sys/dict/loadDictItem/",tableName:"",text:"",code:""}},watch:{value:function(){this.loadItemByCode()},dict:function(){this.initDictInfo(),this.loadRoot()}},created:function(){var e=this;this.validateProp().then((function(){e.initDictInfo(),e.loadRoot(),e.loadItemByCode()}))},methods:{loadItemByCode:function(){var e=this;this.value&&"0"!=this.value?Object(r["d"])("".concat(this.view).concat(this.dict),{key:this.value}).then((function(t){if(t.success){var n=e.value.split(",");e.treeValue=t.result.map((function(e,t){return{key:n[t],value:n[t],label:e}})),e.onLoadTriggleChange(t.result[0])}})):this.treeValue=null},onLoadTriggleChange:function(e){!this.multiple&&this.loadTriggleChange&&this.$emit("change",this.value,e)},initDictInfo:function(){var e=this.dict.split(",");this.tableName=e[0],this.text=e[1],this.code=e[2]},asyncLoadTreeData:function(e){var t=this;return new Promise((function(n){if(e.$vnode.children)n();else{var i=e.$vnode.key,a={pid:i,tableName:t.tableName,text:t.text,code:t.code,pidField:t.pidField,hasChildField:t.hasChildField,condition:t.condition};Object(r["d"])(t.url,a).then((function(e){if(e.success){var a,r=d(e.result);try{for(r.s();!(a=r.n()).done;){var o=a.value;o.value=o.key,0==o.leaf?o.isLeaf=!1:1==o.leaf&&(o.isLeaf=!0)}}catch(s){r.e(s)}finally{r.f()}t.addChildren(i,e.result,t.treeData),t.treeData=l(t.treeData)}n()}))}}))},addChildren:function(e,t,n){if(n&&n.length>0){var i,a=d(n);try{for(a.s();!(i=a.n()).done;){var r=i.value;if(r.key==e){t&&0!=t.length?r.children=t:r.isLeaf=!0;break}this.addChildren(e,t,r.children)}}catch(o){a.e(o)}finally{a.f()}}},loadRoot:function(){var e=this,t={pid:this.pidValue,tableName:this.tableName,text:this.text,code:this.code,pidField:this.pidField,hasChildField:this.hasChildField,condition:this.condition};Object(r["d"])(this.url,t).then((function(t){if(t.success&&t.result){var n,i=d(t.result);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.value=a.key,0==a.leaf?a.isLeaf=!1:1==a.leaf&&(a.isLeaf=!0)}}catch(r){i.e(r)}finally{i.f()}e.treeData=l(t.result)}}))},onChange:function(e){e?e instanceof Array?(this.$emit("change",e.map((function(e){return e.value})).join(",")),this.treeValue=e):(this.$emit("change",e.value,e.label),this.treeValue=e):(this.$emit("change",""),this.treeValue=null)},onSearch:function(e){},getCurrTreeData:function(){return this.treeData},validateProp:function(){var e=this,t=this.condition;return new Promise((function(n,i){if(t)try{var a=JSON.parse(t);"object"==o(a)&&a?n():(e.$message.error("组件JTreeSelect-condition传值有误，需要一个json字符串!"),i())}catch(r){e.$message.error("组件JTreeSelect-condition传值有误，需要一个json字符串!"),i()}else n()}))}},model:{prop:"value",event:"change"}},m=p,g=n("2877"),y=Object(g["a"])(m,i,a,!1,null,null,null);t["default"]=y.exports},babc:function(e,t,n){"use strict";n("9ff8")}}]);