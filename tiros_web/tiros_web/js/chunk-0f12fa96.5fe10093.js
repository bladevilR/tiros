(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f12fa96","chunk-535429be"],{"3ff1":function(e,t,l){},"45ff":function(e,t,l){"use strict";l.r(t);var o=function(){var e=this,t=e._self._c;return t("div",{ref:"calcHeight"})},a=[],c=l("e8ae"),n=l("21a6"),r=l("8fad"),s="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",i={name:"TableExport",data:function(){return{}},mounted:function(){},methods:{printById:function(e){var t=this;Object(r["Ab"])({id:e}).then((function(e){e.success?t.initWorkBook(e.result):t.$message.error("获取记录表详情失败")})).catch((function(e){t.$message.error("获取记录表详情异常")}))},printByData:function(e){this.initWorkBook(e)},initWorkBook:function(e){var t=new c["Workbook"];t.creator="GY",t.lastModifiedBy="2021-10-28",t.created=new Date,t.modified=new Date,t.lastPrinted=new Date;var l=t.addWorksheet("Sheet1",{properties:{defaultColWidth:22,alignment:{vertical:"middle",horizontal:"left",wrapText:!0}},pageSetup:{paperSize:9}}),o=[];l.mergeCells("A1:C1"),l.getCell("A1").value="车号："+(e.trainNo||""),o.push({cell:"A1",horizontal:"left",fill:!0,size:14,bold:!0}),0===e.updown?(l.mergeCells("A2:C2"),l.getCell("A2").value="部件号："+(e.manufNo||""),o.push({cell:"A2",horizontal:"left",fill:!0,size:14,bold:!0})):1===e.updown?(l.mergeCells("A2:C2"),l.getCell("A2").value="原部件序列号："+(e.manufNo||""),o.push({cell:"A2",horizontal:"left",fill:!0,size:14,bold:!0}),l.mergeCells("A3:C3"),l.getCell("A3").value="新部件序列号："+(e.manufNoUp||""),o.push({cell:"A3",horizontal:"left",fill:!0,size:14,bold:!0})):l.mergeCells("A1:C2"),1===e.updown?l.mergeCells("D1:F3"):l.mergeCells("D1:F2"),l.getCell("D1").value=e.title||e.workRecName||"",o.push({cell:"D1",fill:!0,size:14,bold:!0}),l.mergeCells("G1:H1"),l.getCell("G1").value="作业日期："+(e.workDate||""),o.push({cell:"G1",fill:!0,horizontal:"left",size:14,bold:!0}),l.mergeCells("I1:J1"),l.getCell("I1").value="完工日期："+(e.finishDate||""),o.push({cell:"I1",fill:!0,horizontal:"left",size:14,bold:!0}),1===e.updown?l.mergeCells("G2:J3"):l.mergeCells("G2:J2"),l.getCell("G2").value="作业班组："+(e.workGroupName||""),o.push({cell:"G2",fill:!0,horizontal:"left",size:14,bold:!0}),l.getColumn("A").width=15,l.getColumn("B").width=30,l.getColumn("C").width=60,l.getColumn("D").width=15,l.getColumn("E").width=60,l.getColumn("F").width=60,l.getRow(1).height=30,l.getRow(2).height=30,l.getRow(3).height=30,1===e.updown&&(l.getRow(4).height=30);var a={A:"序号",B:"项目",C:"作业内容",D:"控制点",E:"技术要求",F:"作业情况",G:"结果",H:"自检",I:"互检",J:"专检"};for(var r in a)l.getCell(r+(1===e.updown?4:3)).value=a[r],o.push({cell:r+(1===e.updown?4:3),fill:!0,size:14,bold:!0});var i=1===e.updown?5:4,h=0;e.categoryList.forEach((function(e,t){l.getCell("A".concat(i+t)).value=e.recIndex,o.push({cell:"A".concat(i+t)}),l.mergeCells("A".concat(i+t,":A").concat(i+t+e.detailList.length-1)),l.getCell("B".concat(i+t)).value=e.reguTitle,o.push({cell:"B".concat(i+t),horizontal:"left"}),l.mergeCells("B".concat(i+t,":B").concat(i+t+e.detailList.length-1)),e.detailList.forEach((function(e,a){l.getCell("C".concat(i+t+a)).value="\n".concat(e.workContent||"","\n"),o.push({cell:"C".concat(i+t+a),horizontal:"left"}),l.getCell("D".concat(i+t+a)).value=e.checkLevel_dictText||"",o.push({cell:"D".concat(i+t+a)}),l.getCell("E".concat(i+t+a)).value="\n".concat(e.techRequire||"","\n"),o.push({cell:"E".concat(i+t+a),horizontal:"left"}),l.getCell("F".concat(i+t+a)).value=0==e.isIgnore?e.workInfo:e.ignoreDesc,o.push({cell:"F".concat(i+t+a),horizontal:"left"}),l.getCell("G".concat(i+t+a)).value=e.result?"√":"□",o.push({cell:"G".concat(i+t+a)}),l.getCell("H".concat(i+t+a)).value=e.selfCheck||"",o.push({cell:"H".concat(i+t+a)}),l.getCell("I".concat(i+t+a)).value=e.guarderCheck||"",o.push({cell:"I".concat(i+t+a)}),l.getCell("J".concat(i+t+a)).value=e.monitorCheck||"",o.push({cell:"J".concat(i+t+a)})})),i+=e.detailList.length-1,h+=e.detailList.length})),h+=1===e.updown?5:4,l.mergeCells("A".concat(h,":J").concat(h)),l.getRow(h).height=30,o.push({cell:"A".concat(h),bold:!0}),h+=1;var d=e.measureToolList||[];d.length&&(l.mergeCells("A".concat(h,":B").concat(h+d.length-1)),l.getCell("A".concat(h)).value="计量器具使用",o.push({cell:"A".concat(h)}),d.forEach((function(e,t,a){l.mergeCells("C".concat(h+t,":D").concat(h+t)),l.getCell("C".concat(h+t)).value=" \n名称："+(e.name||"")+"\n",o.push({cell:"C".concat(h+t),horizontal:"left"}),l.getCell("E".concat(h+t)).value=" \n规格型号："+(e.model||"")+"\n",o.push({cell:"E".concat(h+t),horizontal:"left"}),l.getCell("F".concat(h+t)).value=" \n出厂编号："+(e.serialNo||"")+"\n",o.push({cell:"F".concat(h+t),horizontal:"left"}),l.mergeCells("G".concat(h+t,":H").concat(h+t)),l.getCell("G".concat(h+t)).value=" \n上次检验时间："+(e.lastCheckTime||"")+"\n",o.push({cell:"G".concat(h+t),horizontal:"left"}),l.mergeCells("I".concat(h+t,":J").concat(h+t)),l.getCell("I".concat(h+t)).value=" \n下次检验时间："+(e.nextCheckTime||"")+"\n",o.push({cell:"I".concat(h+t),horizontal:"left"})})),h+=d.length,l.mergeCells("A".concat(h,":J").concat(h)),l.getRow(h).height=30,o.push({cell:"A".concat(h),bold:!0}),h+=1);var u=["控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。","“自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。","“作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。","“结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。","作业内容中有数据要求的一并填入“作业情况”栏。"];l.mergeCells("A".concat(h,":J").concat(h));var f="";u.forEach((function(e,t,l){f+="".concat(t+1,"、").concat(e).concat(t<l.length-1?"\n":"")})),f="说明：\n"+f+"\n",f="\n检查结果：".concat(0===e.checkResult?"未通过":"通过","                                        检查日期：").concat(e.checkDate||"            ","                                        质量负责人：").concat(e.checkUserName||"            ","\n\n")+f,l.getCell("A".concat(h)).value=f,o.push({cell:"A".concat(h),horizontal:"left",border:top});var p=12*(u.length+4)+18;l.getRow(h).height=p,o.forEach((function(e,t,o){var a=l.getCell(e.cell);a.alignment={vertical:"middle",horizontal:e.horizontal||"center",wrapText:!0},e.fill&&(a.fill={type:"pattern",pattern:"darkGray",fgColor:{argb:"FFe9e9e9"}}),a.font={name:"黑体",family:4,size:e.size||12,underline:!1,bold:e.bold||!1},a.padding={top:10,left:10,bottom:10,right:10},a.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})),t.xlsx.writeBuffer().then((function(t){var l=new Blob([t],{type:s});n["saveAs"](l,"".concat(e.title||e.workRecName,".xlsx"))}))}}},h=i,d=l("2877"),u=Object(d["a"])(h,o,a,!1,null,"dac1198a",null);t["default"]=u.exports},"7e9e":function(e,t,l){"use strict";l.r(t);var o=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,centered:"",width:"100%",dialogClass:"fullDialog no-footer",visible:e.visible,confirmLoading:e.loading,footer:null,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.close,cancel:e.close}},[t("a-button",{attrs:{"na-btn-type":"print",type:"primary"},on:{click:e.print}},[e._v("导出")]),t("RecordSheetTable",{directives:[{name:"show",rawName:"v-show",value:e.recordSheet,expression:"recordSheet"}],ref:"recordTable"}),t("div",{staticStyle:{height:"20px"}}),t("TableExport",{ref:"tablePrintRef"})],1)},a=[],c=l("8fad"),n=l("958d"),r=l("45ff"),s={name:"RecordTableView",components:{RecordSheetTable:n["default"],TableExport:r["default"]},props:{},data:function(){return{title:"记录表查看",visible:!1,loading:!1,recordId:"",recordSheet:{}}},mounted:function(){},methods:{show:function(e){this.recordId=e,this.loadData(),this.visible=!0},close:function(){this.$emit("close"),this.visible=!1},loadData:function(){var e=this;Object(c["Ab"])({id:this.recordId}).then((function(t){t.success?(e.recordSheet=t.result,e.$refs.recordTable.loadData(e.recordSheet)):e.$message.error("获取记录表详情失败")})).catch((function(t){e.$message.error("获取记录表详情异常")}))},print:function(){this.$refs.tablePrintRef.printById(this.recordId)}}},i=s,h=l("2877"),d=Object(h["a"])(i,o,a,!1,null,"a8b3abda",null);t["default"]=d.exports},"958d":function(e,t,l){"use strict";l.r(t);var o=function(){var e=this,t=e._self._c;return t("div",[t("table",{staticClass:"table"},[t("thead",[t("tr",[t("td",{staticStyle:{padding:"0"},attrs:{colspan:"4",rowspan:"2"}},[e.recordSheet.assetTypeId?e._e():t("span",{staticStyle:{"padding-left":"5px"}},[e._v("车号："+e._s(e.recordSheet.trainNo))]),e.recordSheet.assetTypeId&&0===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",[e._v("部件号："+e._s(e.recordSheet.manufNo))])])]):e._e(),e.recordSheet.assetTypeId&&1===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",{staticClass:"bottom"},[e._v("原部件序列号："+e._s(e.recordSheet.manufNo))])]),t("tr",[t("td",[e._v("新部件序列号："+e._s(e.recordSheet.manufNoUp))])])]):e._e()]),t("td",{staticStyle:{"text-align":"center","font-weight":"bold"},attrs:{colspan:"3",rowspan:"2"}},[e._v(" "+e._s(e.recordSheet.title||e.recordSheet.workRecName)+" ")]),t("td",{attrs:{colspan:"3"}},[e._v("作业日期："+e._s(e.recordSheet.workDate)+" 完工日期: "+e._s(e.recordSheet.finishDate))])]),t("tr",[t("td",{attrs:{colspan:"3"}},[e._v("作业班组："+e._s(e.recordSheet.workGroupName))])]),e._m(0)]),e._l(e.recordSheet.categoryList,(function(l){return t("tbody",{key:l.id},e._l(l.detailList,(function(o,a){return t("tr",{key:o.id},[0===a?t("td",{attrs:{rowspan:l.detailList.length}},[e._v(" "+e._s(l.recIndex)+" ")]):e._e(),0===a?t("td",{attrs:{rowspan:l.detailList.length}},[e._v(" "+e._s(l.reguTitle)+" ")]):e._e(),t("td",[e._v(" "+e._s(o.workContent)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[e._v(" "+e._s(o.checkLevel_dictText)+" ")]),t("td",[e._v(" "+e._s(o.techRequire)+" ")]),t("td",[e._v(" "+e._s(0==o.isIgnore?o.workInfo:o.ignoreDesc)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[1===o.result?t("a-checkbox",{attrs:{checked:"",disabled:""}}):e._e(),0===o.result?t("a-checkbox",{attrs:{disabled:""}}):e._e()],1),t("td",[e._v(" "+e._s(o.selfCheck)+" ")]),t("td",[e._v(" "+e._s(o.guarderCheck)+" ")]),t("td",[e._v(" "+e._s(o.monitorCheck)+" ")])])})),0)})),e._l(e.recordSheet.measureToolList,(function(l,o){return t("tr",{key:o},[0===o?t("td",{attrs:{colspan:"2",rowspan:e.recordSheet.measureToolList.length}},[e._v("计量器具使用")]):e._e(),t("td",{attrs:{colspan:"2"}},[e._v("名称: "+e._s(l.name))]),t("td",[e._v("规格型号："+e._s(l.model))]),t("td",[e._v("出厂编号："+e._s(l.serialNo))]),t("td",{attrs:{colspan:"2"}},[e._v("上次检验时间："+e._s(l.lastCheckTime))]),t("td",{attrs:{colspan:"2"}},[e._v("下次检验时间："+e._s(l.nextCheckTime))])])})),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[e._v("情况说明："+e._s(e.recordSheet.remark))])]),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[t("span",{staticStyle:{"margin-left":"5%"}},[e._v("检查结果："+e._s(0===e.recordSheet.checkResult?"未通过":"通过")+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("检查日期："+e._s(e.recordSheet.checkDate)+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("质量负责人："+e._s(e.recordSheet.checkUserName)+" ")]),e._m(1)])])],2)])},a=[function(){var e=this,t=e._self._c;return t("tr",[t("th",{staticStyle:{width:"60px"}},[e._v("序号")]),t("th",{staticStyle:{width:"100px"}},[e._v("项目")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业内容")]),t("th",{staticStyle:{width:"60px"}},[e._v("控制点")]),t("th",{staticStyle:{width:"200px"}},[e._v("技术要求")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业情况")]),t("th",{staticStyle:{width:"80px"}},[e._v("结果")]),t("th",{staticStyle:{width:"60px"}},[e._v("自检")]),t("th",{staticStyle:{width:"60px"}},[e._v("互检")]),t("th",{staticStyle:{width:"60px"}},[e._v("专检")])])},function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"padding-top":"15px"}},[e._v(" 说明："),t("br"),e._v(" 1. 控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。"),t("br"),e._v(" 2. “自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。"),t("br"),e._v(" 3. “作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。"),t("br"),e._v(" 4. “结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。"),t("br"),e._v(" 5. 作业内容中有数据要求的一并填入“作业情况”栏 。 ")])}],c={name:"RecordSheetTable",data:function(){return{recordSheet:{}}},methods:{loadData:function(e){this.recordSheet=e}}},n=c,r=(l("d88b"),l("2877")),s=Object(r["a"])(n,o,a,!1,null,"197d5722",null);t["default"]=s.exports},d88b:function(e,t,l){"use strict";l("3ff1")}}]);