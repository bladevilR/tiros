(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user","chunk-cfabea7e","chunk-515436c0","chunk-7f2e6344","chunk-c4a86784","chunk-778b2285","chunk-1f3e9269","chunk-a28989ae","chunk-ba247034","chunk-3a7672aa","chunk-7955a39f","chunk-05ad0f38"],{1037:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("result",{attrs:{isSuccess:!0,content:!1,title:e.email}},[t("template",{slot:"action"},[t("a-button",{staticStyle:{"margin-left":"8px"},attrs:{size:"large"},on:{click:e.goHomeHandle}},[e._v("返回首页")])],1)],2)},r=[],i=a("9a3d"),n={name:"RegisterResult",components:{Result:i["default"]},data:function(){return{form:{}}},computed:{email:function(){var e=this.form?this.form.username||this.form.mobile:" XXX ",t="你的账户：".concat(e," 注册成功");return this.username=e,t}},created:function(){this.form=this.$route.params},methods:{goHomeHandle:function(){var e={};e.username=this.form.username,e.password=this.form.password,this.$router.push({name:"login",params:e})}}},o=n,c=a("2877"),l=Object(c["a"])(o,s,r,!1,null,"3a0e8d1e",null);t["default"]=l.exports},1348:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=this,a=t._self._c;return a("div",{staticClass:"main user-layout-register"},[t._m(0),a("a-form",{ref:"formRegister",attrs:{autoFormCreate:function(t){e.form=t},id:"formRegister"}},[a("a-form-item",{attrs:{fieldDecoratorId:"username",fieldDecoratorOptions:{rules:[{required:!0,message:"用户名不能为空"},{validator:this.checkUsername}],validateTrigger:["change","blur"],validateFirst:!0}}},[a("a-input",{attrs:{size:"large",type:"text",autocomplete:"false",placeholder:"请输入用户名"}})],1),a("a-popover",{attrs:{placement:"rightTop",trigger:"click",visible:t.state.passwordLevelChecked}},[a("template",{slot:"content"},[a("div",{style:{width:"240px"}},[a("div",{class:["user-register",t.passwordLevelClass]},[t._v("强度："),a("span",[t._v(t._s(t.passwordLevelName))])]),a("a-progress",{attrs:{percent:t.state.percent,showInfo:!1,strokeColor:t.passwordLevelColor}}),a("div",{staticStyle:{"margin-top":"10px"}},[a("span",[t._v("请至少输入 8 个字符。请不要使用容易被猜到的密码。")])])],1)]),a("a-form-item",{attrs:{fieldDecoratorId:"password",fieldDecoratorOptions:{rules:[{required:!1},{validator:this.handlePasswordLevel}],validateTrigger:["change","blur"],validateFirst:!0}}},[a("a-input",{attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"至少8位密码，区分大小写"},on:{click:t.handlePasswordInputClick}})],1)],2),a("a-form-item",{attrs:{fieldDecoratorId:"password2",fieldDecoratorOptions:{rules:[{required:!0,message:"至少8位密码，区分大小写"},{validator:this.handlePasswordCheck}],validateTrigger:["change","blur"],validateFirst:!0}}},[a("a-input",{attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"确认密码"}})],1),a("a-form-item",{attrs:{fieldDecoratorId:"email",fieldDecoratorOptions:{rules:[{required:!0,type:"email",message:"请输入正确的邮箱地址"},{validator:this.handleEmailCheck}],validateTrigger:["change","blur"],validateFirst:!0}}},[a("a-input",{attrs:{size:"large",type:"text",placeholder:"邮箱"}})],1),a("a-form-item",{attrs:{fieldDecoratorId:"mobile",fieldDecoratorOptions:{rules:[{required:!0,pattern:/^1[3456789]\d{9}$/,message:"请输入正确的手机号"},{validator:this.handlePhoneCheck}],validateTrigger:["change","blur"],validateFirst:!0}}},[a("a-input",{attrs:{size:"large",placeholder:"11 位手机号"}},[a("a-select",{attrs:{slot:"addonBefore",size:"large",defaultValue:"+86"},slot:"addonBefore"},[a("a-select-option",{attrs:{value:"+86"}},[t._v("+86")]),a("a-select-option",{attrs:{value:"+87"}},[t._v("+87")])],1)],1)],1),a("a-row",{attrs:{gutter:16}},[a("a-col",{staticClass:"gutter-row",attrs:{span:16}},[a("a-form-item",{attrs:{fieldDecoratorId:"captcha",fieldDecoratorOptions:{rules:[{required:!0,message:"请输入验证码"}],validateTrigger:"blur",validateFirst:!0}}},[a("a-input",{attrs:{size:"large",type:"text",placeholder:"验证码"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1)],1),a("a-col",{staticClass:"gutter-row",attrs:{span:8}},[a("a-button",{staticClass:"getCaptcha",attrs:{size:"large",disabled:t.state.smsSendBtn},domProps:{textContent:t._s(t.state.smsSendBtn?t.state.time+" s":"获取验证码")},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.getCaptcha.apply(null,arguments)}}})],1)],1),a("a-form-item",[a("a-button",{staticClass:"register-button",attrs:{size:"large",type:"primary",htmlType:"submit",loading:t.registerBtn,disabled:t.registerBtn},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[t._v("注册 ")]),a("router-link",{staticClass:"login",attrs:{to:{name:"login"}}},[t._v("使用已有账户登录")])],1)],1)],1)},r=[function(){var e=this,t=e._self._c;return t("h3",[t("span",[e._v("注册")])])}],i=a("ac0d"),n=(a("7ded"),a("0fea")),o=a("4ec3");function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){d(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function d(e,t,a){return(t=p(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p(e){var t=f(e,"string");return"symbol"==c(t)?t:t+""}function f(e,t){if("object"!=c(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=c(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var m={0:"低",1:"低",2:"中",3:"强"},h={0:"error",1:"error",2:"warning",3:"success"},v={0:"#ff0000",1:"#ff0000",2:"#ff7e05",3:"#52c41a"},g={name:"Register",components:{},mixins:[i["b"]],data:function(){return{form:null,state:{time:60,smsSendBtn:!1,passwordLevel:0,passwordLevelChecked:!1,percent:10,progressColor:"#FF0000"},registerBtn:!1}},computed:{passwordLevelClass:function(){return h[this.state.passwordLevel]},passwordLevelName:function(){return m[this.state.passwordLevel]},passwordLevelColor:function(){return v[this.state.passwordLevel]}},methods:{checkUsername:function(e,t,a){var s={username:t};Object(o["h"])(s).then((function(e){e.success?a():a("用户名已存在!")}))},handleEmailCheck:function(e,t,a){var s={email:t};Object(o["h"])(s).then((function(e){e.success?a():a("邮箱已存在!")}))},handlePasswordLevel:function(e,t,a){var s=0,r=/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[~!@#$%^&*()_+`\-={}:";'<>?,./]).{8,}$/;r.test(t)||a(new Error("密码由8位数字、大小写字母和特殊符号组成!")),/[0-9]/.test(t)&&s++,/[a-zA-Z]/.test(t)&&s++,/[^0-9a-zA-Z_]/.test(t)&&s++,this.state.passwordLevel=s,this.state.percent=30*s,s>=2?(s>=3&&(this.state.percent=100),a()):(0===s&&(this.state.percent=10),a(new Error("密码强度不够")))},handlePasswordCheck:function(e,t,a){var s=this.form.getFieldValue("password");void 0===t&&a(new Error("请输入密码")),t&&s&&t.trim()!==s.trim()&&a(new Error("两次密码不一致")),a()},handlePhoneCheck:function(e,t,a){var s={phone:t};Object(o["h"])(s).then((function(e){e.success?a():a("手机号已存在!")}))},handlePasswordInputClick:function(){this.isMobile()?this.state.passwordLevelChecked=!1:this.state.passwordLevelChecked=!0},handleSubmit:function(){var e=this;this.form.validateFields((function(t,a){if(!t){var s={username:a.username,password:a.password,email:a.email,phone:a.mobile,smscode:a.captcha};Object(n["j"])("/sys/user/register",s).then((function(t){t.success?e.$router.push({name:"registerResult",params:u({},a)}):e.registerFailed(t.message)}))}}))},getCaptcha:function(e){var t=this;e.preventDefault();var a=this;this.form.validateFields(["mobile"],{force:!0},(function(e,s){if(!e){t.state.smsSendBtn=!0;var r=window.setInterval((function(){a.state.time--<=0&&(a.state.time=60,a.state.smsSendBtn=!1,window.clearInterval(r))}),1e3),i=t.$message.loading("验证码发送中..",0),o={mobile:s.mobile,smsmode:"1"};Object(n["j"])("/sys/sms",o).then((function(e){e.success||(t.registerFailed(e.message),setTimeout(i,0)),setTimeout(i,500)})).catch((function(e){setTimeout(i,1),clearInterval(r),a.state.time=60,a.state.smsSendBtn=!1,t.requestFailed(e)}))}}))},registerFailed:function(e){this.$notification["error"]({message:"注册失败",description:e,duration:2})},requestFailed:function(e){this.$notification["error"]({message:"错误",description:((e.response||{}).data||{}).message||"请求出现错误，请稍后再试",duration:4}),this.registerBtn=!1}},watch:{"state.passwordLevel":function(e){}}},b=g,w=(a("745d"),a("3d33"),a("2877")),C=Object(w["a"])(b,s,r,!1,null,"fa568c6c",null);t["default"]=C.exports},1450:function(e,t,a){},"1f43":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bgm"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.departVisible,expression:"!departVisible"}],attrs:{id:"loader-wrapper"}},[t("div",{attrs:{id:"loader"}}),t("div",{staticClass:"loader-section section-left"}),t("div",{staticClass:"loader-section section-right"}),t("div",{staticClass:"load_title"},[e._v("正在加载,请耐心等待")])]),t("a-modal",{attrs:{title:"登录部门选择",width:450,visible:e.departVisible,closable:!1,maskClosable:!1}},[t("template",{slot:"footer"},[t("a-button",{attrs:{type:"primary"},on:{click:e.departOk}},[e._v("确认")])],1),t("a-form",[t("a-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{labelCol:{span:4},wrapperCol:{span:20},"validate-status":e.validate_status}},[t("a-tooltip",{attrs:{placement:"topLeft"}},[t("template",{slot:"title"},[t("span",[e._v("您隶属于多部门，请选择登录部门")])]),t("a-avatar",{staticStyle:{backgroundColor:"#87d068"},attrs:{icon:"gold"}})],2),t("a-select",{class:{"valid-error":"error"==e.validate_status},staticStyle:{"margin-left":"10px",width:"80%"},attrs:{placeholder:"请选择登录部门"},on:{change:e.departChange}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"gold"},slot:"suffixIcon"}),e._l(e.departList,(function(a){return t("a-select-option",{key:a.id,attrs:{value:a.orgCode}},[e._v(" "+e._s(a.departName)+" ")])}))],2)],1)],1)],2)],1)},r=[],i=a("9fb0"),n=a("2ca2"),o=a("2f62"),c=a("ca00"),l=a("2b0e"),u=a("0fea"),d=a("9da4"),p=a("4360"),f=a("ed3b"),m=a("4328"),h=a.n(m);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){w(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e,t,a){return(t=C(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function C(e){var t=y(e,"string");return"symbol"==v(t)?t:t+""}function y(e,t){if("object"!=v(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=v(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var S={components:{TwoStepCaptcha:n["default"]},data:function(){return{departList:[],departVisible:!1,departSelected:"",validate_status:""}},created:function(){this.currdatetime=(new Date).getTime(),l["default"].ls.remove(i["a"]),this.getRouterData(),f["a"].destroyAll()},mounted:function(){var e=this,t=h.a.parse(location.search.substring(1)),a=t.token;if(a)try{l["default"].ls.set(i["n"],new Date),this.ThirdLogin(a).then((function(t){t.success?e.departConfirm(t):e.requestFailed(t)}))}catch(s){}else this.$router.push("/sso/check")},methods:b(b({},Object(o["b"])(["ThirdLogin"])),{},{requestFailed:function(e){this.$notification["error"]({message:"登录失败",description:((e.response||{}).data||{}).message||e.message||"请求出现错误，请稍后再试",duration:4})},departConfirm:function(e){if(e.success){this.departList=e.result.departs;var t=e.result.multi_depart;0===t?(this.loginSuccess(),this.$notification.warn({message:"提示",description:"您尚未归属部门,请确认账号信息",duration:3})):2===t?(this.departVisible=!0,this.departList=e.result.departs):this.loginSuccess()}else this.requestFailed(e),this.Logout()},departOk:function(){var e=this;if(!this.departSelected)return this.validate_status="error",!1;var t={orgCode:this.departSelected,username:this.form.getFieldValue("username")};Object(u["k"])("/sys/selectDepart",t).then((function(t){if(t.success){var a=t.result.userInfo;l["default"].ls.set(i["s"],a,6048e5),p["a"].commit("SET_INFO",a),e.loginSuccess(),e.departClear()}else e.requestFailed(t),e.Logout().then((function(){e.departClear()}))}))},departClear:function(){this.departList=[],this.departSelected="",this.currentUsername="",this.departVisible=!1,this.validate_status=""},departChange:function(e){this.validate_status="success",this.departSelected=e},getRouterData:function(){var e=this;this.$nextTick((function(){e.$route.params.username&&e.form.setFieldsValue({username:e.$route.params.username})}))},loginSuccess:function(){var e=this.$store.getters.userInfo.departId;if(this.departList&&this.departList.length>0){var t=this.departList.filter((function(t){return t.id===e}));t&&t.length>0&&p["a"].commit("SET_DEPARTNAME",t[0].departName)}this.$router.push({path:i["m"]}),this.$notification.success({message:"欢迎",description:"".concat(Object(c["s"])(),"，欢迎回来")})},getEncrypte:function(){var e=this,t=l["default"].ls.get(i["k"]);null==t?Object(d["a"])().then((function(t){e.encryptedString=t})):this.encryptedString=t}})},A=S,x=(a("67ee"),a("2877")),O=Object(x["a"])(A,s,r,!1,null,"394bb65c",null);t["default"]=O.exports},2037:function(e,t,a){"use strict";a("c1fe")},"2ffd":function(e,t,a){},"355f":function(e,t,a){},"3d33":function(e,t,a){"use strict";a("355f")},5086:function(e,t,a){},"623a":function(e,t,a){"use strict";a("f8b18")},"67ee":function(e,t,a){"use strict";a("2ffd")},6948:function(e,t,a){},7389:function(e,t,a){},"745d":function(e,t,a){"use strict";a("bd0d")},"8e46":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("a-form",{staticStyle:{margin:"40px auto 0"}},[t("result",{attrs:{title:"更改密码成功","is-success":!0}},[t("div",{staticClass:"toLogin"},[t("h3",[e._v("将在"),t("span",[e._v(e._s(e.time))]),e._v("秒后返回登录页面.")])])])],1)],1)},r=[],i=a("9a3d"),n={name:"Step4",props:["userList"],components:{Result:i["default"]},data:function(){return{loading:!1,time:0}},methods:{countDown:function(){var e=this;e.time--}},mounted:function(){var e=this;e.time=5,setInterval(e.countDown,1e3)},watch:{time:function(e,t){if(0==e){var a={username:this.userList.username};this.$router.push({name:"login",params:a})}}}},o=n,c=(a("dc39"),a("2877")),l=Object(c["a"])(o,s,r,!1,null,"02373d6c",null);t["default"]=l.exports},"92c5":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"loader-wrapper"}},[t("div",{attrs:{id:"loader"}}),t("div",{staticClass:"loader-section section-left"}),t("div",{staticClass:"loader-section section-right"}),t("div",{staticClass:"load_title",on:{click:e.goMyLogin}},[e._v("正在加载,请耐心等待")])])},r=[],i=a("2b0e"),n=a("9fb0"),o={name:"SsoLoginCheck",data:function(){},mounted:function(){var e=i["default"].ls.get(n["a"]),t=window._CONFIG["domianURL"]+"/oauth2/login?token="+e;this.timeoutProcess=setTimeout((function(){window.location.href=t}),3e3)},methods:{goMyLogin:function(){this.timeoutProcess&&clearTimeout(this.timeoutProcess),this.$router.push("/user/login")}}},c=o,l=(a("2037"),a("2877")),u=Object(l["a"])(c,s,r,!1,null,"00981156",null);t["default"]=u.exports},9979:function(e,t,a){"use strict";a("7389")},"9a3d":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"result"},[t("div",[t("a-icon",{class:[e.isSuccess?"success":"error","icon"],attrs:{type:e.isSuccess?"check-circle":"close-circle"}})],1),e.title?t("div",{staticClass:"title"},[e._v(e._s(e.title))]):e._e(),e.description?t("div",{staticClass:"description"},[e._v(e._s(e.description))]):e._e(),e.content?t("div",{staticClass:"content"},[e._t("default")],2):e._e(),t("div",{staticClass:"action"},[e._t("action")],2)])},r=[],i={name:"Result",props:{isSuccess:{type:Boolean,default:!1},title:{type:String,default:""},description:{type:String,default:""},content:{type:Boolean,default:!0}}},n=i,o=(a("b4aa"),a("2877")),c=Object(o["a"])(n,s,r,!1,null,"5cd17224",null);t["default"]=c.exports},"9d66":function(e,t,a){},a551:function(e,t,a){"use strict";a("1450")},ac2a:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main"},[t("a-form",{ref:"formLogin",staticClass:"user-layout-login",attrs:{form:e.form,id:"formLogin"}},[t("a-form-item",[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",{initialValue:"",rules:e.validatorRules.username.rules}],expression:"['username',{initialValue:'', rules: validatorRules.username.rules}]"}],ref:"userName",attrs:{size:"large",type:"text",placeholder:"请输入帐户名"}},[t("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),t("a-form-item",[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{initialValue:"",rules:e.validatorRules.password.rules}],expression:"['password',{initialValue:'', rules: validatorRules.password.rules}]"}],attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"密码"}},[t("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),e.NeedValid?t("a-row",{attrs:{gutter:0}},[t("a-col",{attrs:{span:16}},[t("a-form-item",[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["inputCode",e.validatorRules.inputCode],expression:"['inputCode',validatorRules.inputCode]"}],attrs:{size:"large",type:"text",placeholder:"请输入验证码"},on:{change:e.inputCodeChange}},[t("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"smile"},slot:"prefix"})],1)],1)],1),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:8}},[e.requestCodeSuccess?t("img",{staticStyle:{"margin-top":"2px"},attrs:{src:e.randCodeImage},on:{click:e.handleChangeCheckCode}}):t("img",{staticStyle:{"margin-top":"2px"},attrs:{src:a("d5ac")},on:{click:e.handleChangeCheckCode}})])],1):e._e(),t("a-form-item",[t("a-checkbox",{directives:[{name:"decorator",rawName:"v-decorator",value:["rememberMe",{initialValue:!0,valuePropName:"checked"}],expression:"['rememberMe', {initialValue: true, valuePropName: 'checked'}]"}]},[e._v("记住密码")]),t("a-checkbox",{directives:[{name:"decorator",rawName:"v-decorator",value:["autoLogin",{initialValue:!0,valuePropName:"checked"}],expression:"['autoLogin', {initialValue: true, valuePropName: 'checked'}]"}],staticStyle:{float:"right"}},[e._v("自动登陆")])],1),t("div",{staticStyle:{"margin-top":"24px"}},[t("a-row",{attrs:{gutter:10}},[t("a-col",{attrs:{span:24}},[t("a-button",{staticClass:"login-button",attrs:{size:"large",type:"primary",htmlType:"submit",loading:e.loginBtn,disabled:e.loginBtn},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[e._v(e._s(e.sumitText)+" ")])],1)],1)],1)],1),e.requiredTwoStepCaptcha?t("two-step-captcha",{attrs:{visible:e.stepCaptchaVisible},on:{success:e.stepCaptchaSuccess,cancel:e.stepCaptchaCancel}}):e._e(),t("a-modal",{attrs:{title:"登录部门选择",width:450,visible:e.departVisible,closable:!1,maskClosable:!1}},[t("template",{slot:"footer"},[t("a-button",{attrs:{type:"primary"},on:{click:e.departOk}},[e._v("确认")])],1),t("a-form",[t("a-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{labelCol:{span:4},wrapperCol:{span:20},"validate-status":e.validate_status}},[t("a-tooltip",{attrs:{placement:"topLeft"}},[t("template",{slot:"title"},[t("span",[e._v("您隶属于多部门，请选择登录部门")])]),t("a-avatar",{staticStyle:{backgroundColor:"#87d068"},attrs:{icon:"gold"}})],2),t("a-select",{class:{"valid-error":"error"==e.validate_status},staticStyle:{"margin-left":"10px",width:"80%"},attrs:{placeholder:"请选择登录部门"},on:{change:e.departChange}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"gold"},slot:"suffixIcon"}),e._l(e.departList,(function(a){return t("a-select-option",{key:a.id,attrs:{value:a.orgCode}},[e._v(" "+e._s(a.departName)+" ")])}))],2)],1)],1)],2)],1)},r=[],i=a("9fb0"),n=a("2ca2"),o=a("2f62"),c=a("ca00"),l=a("2b0e"),u=a("0fea"),d=a("9da4"),p=a("4360"),f=a("ed3b");function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){v(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function v(e,t,a){return(t=g(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function g(e){var t=b(e,"string");return"symbol"==w(t)?t:t+""}function b(e,t){if("object"!=w(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=w(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}var C={components:{TwoStepCaptcha:n["default"]},data:function(){return{sumitText:"确定",customActiveKey:"tab1",loginBtn:!1,loginType:0,inputCodeNull:!0,requiredTwoStepCaptcha:!1,stepCaptchaVisible:!1,form:this.$form.createForm(this),encryptedString:{key:"",iv:""},state:{time:60,smsSendBtn:!1},validatorRules:{username:{rules:[{required:!0,message:"请输入用户名!"},{validator:this.handleUsernameOrEmail}]},password:{rules:[{required:!0,message:"请输入密码!",validator:"click"}]},mobile:{rules:[{validator:this.validateMobile}]},inputCode:{rules:[{required:!0,message:"请输入验证码!"}]}},verifiedCode:"",inputCodeContent:"",NeedValid:!1,departList:[],departVisible:!1,departSelected:"",currentUsername:"",validate_status:"",currdatetime:"",randCodeImage:"",requestCodeSuccess:!1,ssoLoginUrl:window._CONFIG["domianURL"]+"/sso/login"}},created:function(){this.currdatetime=(new Date).getTime(),l["default"].ls.remove(i["a"]),this.getRouterData(),this.handleChangeCheckCode(),f["a"].destroyAll()},mounted:function(){this.$refs.userName.focus()},methods:h(h({},Object(o["b"])(["Login","Logout","PhoneLogin","ThirdLogin"])),{},{ssoLogin:function(){var e=this.ssoLoginUrl,t=850,a=500,s=(window.screen.height-30-a)/2,r=(window.screen.width-10-t)/2,i=window.open(e,"单点登录","height="+a+", width="+t+", top="+s+", left="+r+", toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");window.onfocus=function(){i.focus()},window.onclick=function(){i.focus()}},onThirdLogin:function(e){var t=window._CONFIG["domianURL"]+"/thirdLogin/render/".concat(e);window.open(t,"login ".concat(e),"height=500, width=500, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=n o, status=no");var a=this,s=function(e){e.origin;var t=e.data;a.ThirdLogin(t).then((function(e){e.success?a.loginSuccess():a.requestFailed(e)}))};window.addEventListener("message",s,!1)},handleUsernameOrEmail:function(e,t,a){var s=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;s.test(t)?this.loginType=0:this.loginType=1,a()},handleTabClick:function(e){this.customActiveKey=e},handleSubmit:function(){var e=this,t=this,a={};if(t.loginBtn=!0,"tab1"===t.customActiveKey){var s=["username","password","rememberMe","autoLogin"];this.NeedValid&&s.push("inputCode"),t.form.validateFields(s,{force:!0},(function(s,r){s?t.loginBtn=!1:(a.username=r.username,a.password=r.password,a.captcha=t.inputCodeContent,a.checkKey=t.currdatetime,t.Login(a).then((function(t){if(t.success&&200==t.code){var a={username:r.username,password:r.rememberMe?r.password:"",rememberMe:!!r.rememberMe,autoLogin:!!r.autoLogin};l["default"].ls.set("LOGIN_INFO",a)}e.departConfirm(t)})).catch((function(e){t.requestFailed(e)})))}))}else t.form.validateFields(["mobile","captcha","rememberMe"],{force:!0},(function(s,r){s||(a.mobile=r.mobile,a.captcha=r.captcha,a.remember_me=r.rememberMe,t.PhoneLogin(a).then((function(t){e.departConfirm(t)})).catch((function(e){t.requestFailed(e)})))}))},getCaptcha:function(e){var t=this;e.preventDefault();var a=this;this.form.validateFields(["mobile"],{force:!0},(function(e,s){if(s.mobile){if(!e){t.state.smsSendBtn=!0;var r=window.setInterval((function(){a.state.time--<=0&&(a.state.time=60,a.state.smsSendBtn=!1,window.clearInterval(r))}),1e3),i=t.$message.loading("验证码发送中..",0),n={};n.mobile=s.mobile,n.smsmode="0",Object(u["j"])("/sys/sms",n).then((function(e){e.success||(setTimeout(i,0),t.cmsFailed(e.message)),setTimeout(i,500)})).catch((function(e){setTimeout(i,1),clearInterval(r),a.state.time=60,a.state.smsSendBtn=!1,t.requestFailed(e)}))}}else a.cmsFailed("请输入手机号")}))},stepCaptchaSuccess:function(){this.loginSuccess()},stepCaptchaCancel:function(){var e=this;this.Logout().then((function(){e.loginBtn=!1,e.stepCaptchaVisible=!1}))},handleChangeCheckCode:function(){var e=this;this.currdatetime=(new Date).getTime(),Object(u["d"])("/sys/randomImage/".concat(this.currdatetime)).then((function(t){t.success?"NoNeed"===t.result?e.NeedValid=!1:(e.randCodeImage=t.result,e.requestCodeSuccess=!0,e.NeedValid=!0):(e.$message.error(t.message),e.requestCodeSuccess=!1)})).catch((function(){e.requestCodeSuccess=!1}))},loginSuccess:function(){var e=this.$store.getters.userInfo.departId;if(this.departList&&this.departList.length>0){var t=this.departList.filter((function(t){return t.id===e}));t&&t.length>0&&p["a"].commit("SET_DEPARTNAME",t[0].departName)}this.$router.push({path:i["m"]}),this.$notification.success({message:"欢迎",description:"".concat(Object(c["s"])(),"，欢迎回来")})},cmsFailed:function(e){this.$notification["error"]({message:"登录失败",description:e,duration:4})},requestFailed:function(e){this.$notification["error"]({message:"登录失败",description:((e.response||{}).data||{}).message||e.message||"请求出现错误，请稍后再试",duration:4}),this.loginBtn=!1},validateMobile:function(e,t,a){!t||new RegExp(/^1([38][0-9]|4[579]|5[0-3,5-9]|6[6]|7[0135678]|9[89])\d{8}$/).test(t)?a():a("您的手机号码格式不正确!")},validateInputCode:function(e,t,a){t&&this.verifiedCode!=this.inputCodeContent?a("您输入的验证码不正确!"):a()},generateCode:function(e){this.verifiedCode=e.toLowerCase()},inputCodeChange:function(e){this.inputCodeContent=e.target.value},departConfirm:function(e){if(e.success){this.departList=e.result.departs;var t=e.result.multi_depart;0===t?(this.loginSuccess(),this.$notification.warn({message:"提示",description:"您尚未归属部门,请确认账号信息",duration:3})):2===t?(this.departVisible=!0,this.currentUsername=this.form.getFieldValue("username"),this.departList=e.result.departs):this.loginSuccess()}else this.requestFailed(e),this.Logout()},departOk:function(){var e=this;if(!this.departSelected)return this.validate_status="error",!1;var t={orgCode:this.departSelected,username:this.form.getFieldValue("username")};Object(u["k"])("/sys/selectDepart",t).then((function(t){if(t.success){var a=t.result.userInfo;l["default"].ls.set(i["s"],a,6048e5),p["a"].commit("SET_INFO",a),e.loginSuccess(),e.departClear()}else e.requestFailed(t),e.Logout().then((function(){e.departClear()}))}))},departClear:function(){this.departList=[],this.departSelected="",this.currentUsername="",this.departVisible=!1,this.validate_status=""},departChange:function(e){this.validate_status="success",this.departSelected=e},getRouterData:function(){var e=this;this.$nextTick((function(){var t=l["default"].ls.get("LOGIN_INFO");t?(e.form.setFieldsValue(h({},t)),t.autoLogin&&e.$nextTick((function(){e.sumitText="自动登录中...",e.handleSubmit()}))):e.form.setFieldsValue({rememberMe:!1,autoLogin:!1})}))},getEncrypte:function(){var e=this,t=l["default"].ls.get(i["k"]);null==t?Object(d["a"])().then((function(t){e.encryptedString=t})):this.encryptedString=t}})},y=C,S=(a("b74a"),a("efa6"),a("2877")),A=Object(S["a"])(y,s,r,!1,null,"619ba687",null);t["default"]=A.exports},b4aa:function(e,t,a){"use strict";a("9d66")},b74a:function(e,t,a){"use strict";a("f024")},ba6d:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("a-form",{staticStyle:{"max-width":"500px",margin:"40px auto 0"},attrs:{form:e.form},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.nextStep.apply(null,arguments)}}},[t("a-form-item",{attrs:{label:"账号名",labelCol:{span:5},wrapperCol:{span:19}}},[t("a-input",{style:{width:"310px"},attrs:{type:"text",autocomplete:"false",value:e.accountName,disabled:""}})],1),t("a-form-item",{attrs:{label:"手机",labelCol:{span:5},wrapperCol:{span:19}}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phone",{initialValue:e.defaultPhone,rules:e.validatorRules.phone.rule}],expression:"['phone',{initialValue: defaultPhone, rules: validatorRules.phone.rule}]"}],style:{width:"310px"},attrs:{type:"text",autocomplete:"false",placeholder:"请输入手机号"}},[t("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"phone"},slot:"prefix"})],1)],1),e.show?t("a-form-item",{attrs:{label:"验证码",labelCol:{span:5},wrapperCol:{span:19}}},[t("a-row",{staticStyle:{"margin-left":"2px"},attrs:{gutter:16}},[t("a-col",{staticClass:"gutter-row",attrs:{span:12}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["captcha",e.validatorRules.captcha],expression:"['captcha',validatorRules.captcha]"}],attrs:{type:"text",placeholder:"手机短信验证码"}})],1),t("a-col",{staticClass:"gutter-row",attrs:{span:8}},[t("a-button",{attrs:{tabindex:"-1",size:"default",disabled:e.state.smsSendBtn},domProps:{textContent:e._s(e.state.smsSendBtn?e.state.time+" s":"获取验证码")},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.getCaptcha.apply(null,arguments)}}})],1)],1)],1):e._e(),t("a-form-item",{attrs:{wrapperCol:{span:19,offset:5}}},[t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.prevStep}},[e._v("上一步")]),t("a-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:e.nextStep}},[e._v("下一步")])],1)],1)],1)},r=[],i=a("0fea"),n={name:"Step2",props:["userList"],data:function(){return{form:this.$form.createForm(this),loading:!1,accountName:this.userList.username,dropList:"0",captcha:"",show:!0,state:{time:60,smsSendBtn:!1},formLogin:{captcha:"",mobile:""},validatorRules:{captcha:{rule:[{required:!0,message:"请输入短信验证码!"},{validator:this.validateCaptcha}]},phone:{rule:[{required:!0,message:"请输入手机号码!"}]}}}},computed:{defaultPhone:function(){return this.userList.isPhone?this.userList.phone:null}},methods:{nextStep:function(){var e=this,t=this;t.loading=!0,this.form.validateFields((function(a,s){if(!a&&"0"==t.dropList)if(void 0==s.captcha)e.cmsFailed("请输入短信验证码!");else{var r={};r.phone=e.userList.phone,r.smscode=s.captcha,Object(i["j"])("/sys/user/phoneVerification",r).then((function(a){if(a.success){var s={username:e.userList.username,phone:e.userList.phone,smscode:a.result};setTimeout((function(){t.$emit("nextStep",s)}),0)}else e.cmsFailed(a.message)}))}}))},prevStep:function(){this.$emit("prevStep",this.userList)},getCaptcha:function(e){var t=this;e.preventDefault();var a=this;this.state.smsSendBtn=!0;var s=window.setInterval((function(){a.state.time--<=0&&(a.state.time=60,a.state.smsSendBtn=!1,window.clearInterval(s))}),1e3),r=this.$message.loading("验证码发送中..",0),n={mobile:this.userList.phone,smsmode:"2"};Object(i["j"])("/sys/sms",n).then((function(e){e.success||(setTimeout(r,1),t.cmsFailed(e.message)),setTimeout(r,500)}))},cmsFailed:function(e){this.$notification["error"]({message:"验证错误",description:e,duration:4})},handleChangeSelect:function(e){var t=this;0==e?(t.dropList="0",t.show=!0):(t.dropList="1",t.show=!1)}}},o=n,c=(a("a551"),a("2877")),l=Object(c["a"])(o,s,r,!1,null,"0d38e0f0",null);t["default"]=l.exports},bd0d:function(e,t,a){},c1fe:function(e,t,a){},d5ac:function(e,t){e.exports="data:image/png;base64,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"},dc39:function(e,t,a){"use strict";a("5086")},efa6:function(e,t,a){"use strict";a("6948")},f024:function(e,t,a){},f14a:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main"},[t("a-form",{staticStyle:{"max-width":"500px",margin:"40px auto 0"},attrs:{form:e.form},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.nextStep.apply(null,arguments)}}},[t("a-form-item",[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",e.validatorRules.username],expression:"['username',validatorRules.username]"}],attrs:{size:"large",type:"text",autocomplete:"false",placeholder:"请输入用户账号或手机号"}},[t("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),t("a-row",{attrs:{gutter:0}},[t("a-col",{attrs:{span:14}},[t("a-form-item",[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["inputCode",e.validatorRules.inputCode],expression:"['inputCode',validatorRules.inputCode]"}],attrs:{size:"large",type:"text",placeholder:"请输入验证码"},on:{change:e.inputCodeChange}},[e.inputCodeContent==e.verifiedCode?t("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"smile"},slot:"prefix"}):t("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"frown"},slot:"prefix"})],1)],1)],1),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:10}},[e.requestCodeSuccess?t("img",{staticStyle:{"margin-top":"2px"},attrs:{src:e.randCodeImage},on:{click:e.handleChangeCheckCode}}):t("img",{staticStyle:{"margin-top":"2px"},attrs:{src:a("d5ac")},on:{click:e.handleChangeCheckCode}})])],1),t("a-form-item",{attrs:{wrapperCol:{span:19,offset:5}}},[t("router-link",{staticStyle:{float:"left","line-height":"40px"},attrs:{to:{name:"login"}}},[e._v("使用已有账户登录")]),t("a-button",{attrs:{type:"primary"},on:{click:e.nextStep}},[e._v("下一步")])],1)],1)],1)},r=[],i=a("0fea"),n=a("4ec3"),o={name:"Step1",data:function(){return{form:this.$form.createForm(this),inputCodeContent:"",inputCodeNull:!0,verifiedCode:"",validatorRules:{username:{rules:[{required:!1},{validator:this.validateInputUsername}]},inputCode:{rules:[{required:!0,message:"请输入验证码!"}]}},randCodeImage:"",requestCodeSuccess:!0,currdatetime:""}},created:function(){this.handleChangeCheckCode()},methods:{handleChangeCheckCode:function(){var e=this;this.currdatetime=(new Date).getTime(),Object(i["d"])("/sys/randomImage/".concat(this.currdatetime)).then((function(t){t.success?(e.randCodeImage=t.result,e.requestCodeSuccess=!0):(e.$message.error(t.message),e.requestCodeSuccess=!1)})).catch((function(){e.requestCodeSuccess=!1}))},nextStep:function(){var e=this;this.form.validateFields((function(t,a){if(!t){var s=!1,r={},n=/^[1-9]\d*$|^0$/,o=a.username;1==n.test(o)?(r.phone=o,s=!0):r.username=o,e.validateInputCode().then((function(){Object(i["d"])("/sys/user/querySysUser",r).then((function(t){if(t.success){var a={username:t.result.username,phone:t.result.phone,isPhone:s};setTimeout((function(){e.$emit("nextStep",a)}))}}))}))}}))},validateInputCode:function(){var e=this;return new Promise((function(t,a){Object(i["j"])("/sys/checkCaptcha",{captcha:e.inputCodeContent,checkKey:e.currdatetime}).then((function(s){s.success?t():(e.$message.error(s.message),a())}))}))},inputCodeChange:function(e){this.inputCodeContent=e.target.value,e.target.value&&0!=e.target.value?(this.inputCodeContent=this.inputCodeContent.toLowerCase(),this.inputCodeNull=!1):this.inputCodeNull=!0},generateCode:function(e){this.verifiedCode=e.toLowerCase()},validateInputUsername:function(e,t,a){var s=/^[0-9]+.?[0-9]*/;if(t||a("请输入用户名和手机号！"),s.test(t)){var r={phone:t};Object(n["h"])(r).then((function(e){e.success?a("用户名不存在!"):a()}))}else{r={username:t};Object(n["h"])(r).then((function(e){e.success?a("用户名不存在!"):a()}))}}}},c=o,l=a("2877"),u=Object(l["a"])(c,s,r,!1,null,"deafc256",null);t["default"]=u.exports},f6d9:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("a-form",{staticStyle:{"max-width":"500px",margin:"40px auto 0"},attrs:{form:e.form}},[t("a-form-item",{attrs:{label:"账号名",labelCol:{span:5},wrapperCol:{span:19}}},[t("a-input",{attrs:{type:"text",autocomplete:"false",value:e.accountName,disabled:""}})],1),t("a-form-item",{staticClass:"stepFormText",attrs:{label:"新密码",labelCol:{span:5},wrapperCol:{span:19}}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",e.validatorRules.password],expression:"['password',validatorRules.password]"}],attrs:{type:"password",autocomplete:"false"}})],1),t("a-form-item",{staticClass:"stepFormText",attrs:{label:"确认密码",labelCol:{span:5},wrapperCol:{span:19}}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["confirmPassword",e.validatorRules.confirmPassword],expression:"['confirmPassword',validatorRules.confirmPassword]"}],attrs:{type:"password",autocomplete:"false"}})],1),t("a-form-item",{attrs:{wrapperCol:{span:19,offset:5}}},[t("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.prevStep}},[e._v("上一步")]),t("a-button",{staticStyle:{"margin-left":"20px"},attrs:{loading:e.loading,type:"primary"},on:{click:e.nextStep}},[e._v("提交")])],1)],1)],1)},r=[],i=a("0fea"),n={name:"Step3",props:["userList"],data:function(){return{loading:!1,form:this.$form.createForm(this),accountName:this.userList.username,validatorRules:{username:{rules:[{required:!0,message:"用户名不能为空!"}]},password:{rules:[{required:!0,pattern:/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[~!@#$%^&*()_+`\-={}:";'<>?,.\/]).{8,}$/,message:"密码由8位数字、大小写字母和特殊符号组成!!"},{validator:this.handlePasswordLevel}]},confirmPassword:{rules:[{required:!0,message:"密码不能为空!"},{validator:this.handlePasswordCheck}]}}}},methods:{nextStep:function(){var e=this,t=this;t.loading=!0,this.form.validateFields((function(a,s){if(a)t.loading=!1;else{var r={};r.username=e.userList.username,r.password=s.password,r.smscode=e.userList.smscode,r.phone=e.userList.phone,Object(i["d"])("/sys/user/passwordChange",r).then((function(a){if(a.success){var s={username:e.userList.username};setTimeout((function(){t.$emit("nextStep",s)}),1500)}else e.passwordFailed(a.message),t.loading=!1}))}}))},prevStep:function(){this.$emit("prevStep",this.userList)},handlePasswordCheck:function(e,t,a){var s=this.form.getFieldValue("password");t&&s&&t.trim()!==s.trim()&&a(new Error("两次密码不一致")),a()},passwordFailed:function(e){this.$notification["error"]({message:"更改密码失败",description:e,duration:4})}}},o=n,c=(a("9979"),a("2877")),l=Object(c["a"])(o,s,r,!1,null,"1bbf13ad",null);t["default"]=l.exports},f8b18:function(e,t,a){},ffc3:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("a-card",{staticStyle:{width:"130%","text-align":"center","margin-left":"-10%"},attrs:{bordered:!1}},[t("a-steps",{staticClass:"steps",attrs:{current:e.currentTab}},[t("a-step",{attrs:{title:"用户账户"}}),t("a-step",{attrs:{title:"手机验证"}}),t("a-step",{attrs:{title:"密码"}}),t("a-step",{attrs:{title:"完成"}})],1),t("div",{staticClass:"content"},[0===e.currentTab?t("step1",{on:{nextStep:e.nextStep}}):e._e(),1===e.currentTab?t("step2",{attrs:{userList:e.userList},on:{nextStep:e.nextStep,prevStep:e.prevStep}}):e._e(),2===e.currentTab?t("step3",{attrs:{userList:e.userList},on:{nextStep:e.nextStep,prevStep:e.prevStep}}):e._e(),3===e.currentTab?t("step4",{attrs:{userList:e.userList},on:{prevStep:e.prevStep,finish:e.finish}}):e._e()],1)],1)},r=[],i=a("f14a"),n=a("ba6d"),o=a("f6d9"),c=a("8e46"),l={name:"Alteration",components:{Step1:i["default"],Step2:n["default"],Step3:o["default"],Step4:c["default"]},data:function(){return{description:"将一个冗长或用户不熟悉的表单任务分成多个步骤，指导用户完成。",currentTab:0,userList:{},form:null}},methods:{nextStep:function(e){this.userList=e,this.currentTab<4&&(this.currentTab+=1)},prevStep:function(e){this.userList=e,this.currentTab>0&&(this.currentTab-=1)},finish:function(){this.currentTab=0}}},u=l,d=(a("623a"),a("2877")),p=Object(d["a"])(u,s,r,!1,null,"63c12498",null);t["default"]=p.exports}}]);