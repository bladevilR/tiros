(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7dfcdc66","chunk-0c48cede","chunk-2d0b2759"],{"23ce":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"详情",width:"70%",visible:e.visible,confirmLoading:e.confirmLoading,footer:null,destroyOnClose:!0},on:{cancel:e.handleCancel}},[t("div",{staticStyle:{height:"70vh"}},[t("a-descriptions",{attrs:{bordered:"",column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}}},[t("a-descriptions-item",{attrs:{label:"物资编码"}},[e._v(" "+e._s(e.borrowDetail.materialTypeCode)+" ")]),t("a-descriptions-item",{attrs:{label:"物资名称"}},[e._v(" "+e._s(e.borrowDetail.materialTypeName)+" ")]),t("a-descriptions-item",{attrs:{label:"物资描述"}},[e._v(" "+e._s(e.borrowDetail.materialTypeSpec)+" ")]),t("a-descriptions-item",{attrs:{label:"借用数量"}},[e._v(" "+e._s(e.borrowDetail.amount)+" ")]),t("a-descriptions-item",{attrs:{label:"物资单位"}},[e._v(" "+e._s(e.borrowDetail.materialTypeUnit)+" ")]),t("a-descriptions-item",{attrs:{label:"所属仓库"}},[e._v(" "+e._s(e.borrowDetail.warehouseName)+" ")]),t("a-descriptions-item",{attrs:{label:"借用组织"}},[e._v(" "+e._s(e.borrowDetail.deptName)+" ")]),t("a-descriptions-item",{attrs:{label:"借用人员"}},[e._v(" "+e._s(e.borrowDetail.borrowUserName)+" ")]),t("a-descriptions-item",{attrs:{label:"借用日期"}},[e._v(" "+e._s(e.borrowDetail.borrowDate)+" ")]),t("a-descriptions-item",{attrs:{label:"归还类型"}},[e._v(" "+e._s(e.borrowDetail.returnType_dictText)+" ")]),t("a-descriptions-item",{attrs:{label:"归还状态"}},[e._v(" "+e._s(e.borrowDetail.returnStatus_dictText)+" ")]),t("a-descriptions-item",{attrs:{label:"备注"}},[e._v(" "+e._s(e.borrowDetail.remark)+" ")])],1)],1)])},i=[],o={name:"BorrowDetail",data:function(){return{visible:!1,confirmLoading:!1,borrowDetail:""}},methods:{detail:function(e){this.visible=!0,this.borrowDetail=e},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},n=o,l=a("2877"),s=Object(l["a"])(n,r,i,!1,null,null,null);t["default"]=s.exports},b0cd:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"选择部门",width:e.modalWidth,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭"},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[t("a-spin",{attrs:{tip:"Loading...",spinning:!1}},[t("a-input-search",{staticStyle:{"margin-bottom":"1px"},attrs:{placeholder:"请输入部门名称按回车进行搜索"},on:{search:e.onSearch}}),t("a-tree",{attrs:{checkable:"",treeData:e.treeData,checkStrictly:!0,autoExpandParent:e.autoExpandParent,expandedKeys:e.expandedKeys,checkedKeys:e.checkedKeys},on:{check:e.onCheck,select:e.onSelect,expand:e.onExpand},scopedSlots:e._u([{key:"title",fn:function(a){var r=a.title;return[r.indexOf(e.searchValue)>-1?t("span",[e._v(" "+e._s(r.substr(0,r.indexOf(e.searchValue)))+" "),t("span",{staticStyle:{color:"#f50"}},[e._v(e._s(e.searchValue))]),e._v(" "+e._s(r.substr(r.indexOf(e.searchValue)+e.searchValue.length))+" ")]):t("span",[e._v(e._s(r))])]}}])})],1)],1)},i=[],o=a("4ec3");function n(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=d(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return n=e.done,e},e:function(e){l=!0,o=e},f:function(){try{n||null==a.return||a.return()}finally{if(l)throw o}}}}function l(e){return u(e)||c(e)||d(e)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){if(e){if("string"==typeof e)return h(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?h(e,t):void 0}}function c(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function u(e){if(Array.isArray(e))return h(e)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=Array(t);a<t;a++)r[a]=e[a];return r}var m={name:"JSelectDepartModal",props:["modalWidth","multi","rootOpened","departId"],data:function(){return{visible:!1,confirmLoading:!1,treeData:[],autoExpandParent:!0,expandedKeys:[],dataList:[],checkedKeys:[],checkedRows:[],searchValue:""}},created:function(){this.loadDepart()},watch:{departId:function(){this.initDepartComponent()},visible:{handler:function(){this.departId?this.checkedKeys=this.departId.split(","):this.checkedKeys=[]}}},methods:{show:function(){this.visible=!0,this.checkedRows=[],this.checkedKeys=[]},loadDepart:function(){var e=this;Object(o["H"])().then((function(t){if(t.success){var a=l(t.result);e.reWriterWithSlot(a),e.treeData=a,e.initDepartComponent(),e.rootOpened&&e.initExpandedKeys(t.result)}}))},initDepartComponent:function(){var e="";if(this.departId){var t,a=this.departId,r=n(this.dataList);try{for(r.s();!(t=r.n()).done;){var i=t.value;a.indexOf(i.key)>=0&&(e+=","+i.title)}}catch(o){r.e(o)}finally{r.f()}e&&(e=e.substring(1))}this.$emit("initComp",e)},reWriterWithSlot:function(e){var t,a=n(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(r.children&&r.children.length>0){this.reWriterWithSlot(r.children);var i=Object.assign({},r);i.children={},this.dataList.push(i)}else this.dataList.push(r),r.scopedSlots={title:"title"}}}catch(o){a.e(o)}finally{a.f()}},initExpandedKeys:function(e){if(e&&e.length>0){var t,a=[],r=n(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.children&&i.children.length>0&&a.push(i.id)}}catch(o){r.e(o)}finally{r.f()}this.expandedKeys=[].concat(a)}else this.expandedKeys=[]},onCheck:function(e,t){var a=this;if(this.multi)this.checkedKeys=e.checked,this.checkedRows=this.getCheckedRows(this.checkedKeys);else{var r=e.checked.filter((function(e){return a.checkedKeys.indexOf(e)<0}));this.checkedKeys=l(r),this.checkedRows=0===this.checkedKeys.length?[]:[t.node.dataRef]}},onSelect:function(e,t){var a=[];if(a.push(e[0]),this.checkedKeys&&0!==this.checkedKeys.length&&this.multi){var r,i=t.node.dataRef.key;if(this.checkedKeys.indexOf(i)>=0)this.checkedKeys=this.checkedKeys.filter((function(e){return e!==i}));else(r=this.checkedKeys).push.apply(r,a)}else this.checkedKeys=[].concat(a),this.checkedRows=[t.node.dataRef];this.checkedRows=this.getCheckedRows(this.checkedKeys)},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},handleSubmit:function(){this.checkedKeys&&0!=this.checkedKeys.length?this.$emit("ok",this.checkedRows,this.checkedKeys.join(",")):this.$emit("ok",""),this.handleClear()},handleCancel:function(){this.handleClear()},handleClear:function(){this.visible=!1,this.checkedKeys=[]},getParentKey:function(e,t){for(var a,r=0;r<t.length;r++){var i=t[r];i.children&&(i.children.some((function(t){return t.key===e}))?a=i.key:this.getParentKey(e,i.children)&&(a=this.getParentKey(e,i.children)))}return a},onSearch:function(e){var t=this,a=this.dataList.map((function(a){return a.title.indexOf(e)>-1?t.getParentKey(a.key,t.treeData):null})).filter((function(e,t,a){return e&&a.indexOf(e)===t}));Object.assign(this,{expandedKeys:a,searchValue:e,autoExpandParent:!0})},getCheckedRows:function(e){var t,a=function(e,t){var r,i=n(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.id===t)return o;if(o.children instanceof Array){var l=a(o.children,t);if(null!=l)return l}}}catch(s){i.e(s)}finally{i.f()}return null},r=[],i=n(e);try{for(i.s();!(t=i.n()).done;){var o=t.value,l=a(this.treeData,o);null!=l&&r.push(l)}}catch(s){i.e(s)}finally{i.f()}return r}}},p=m,f=a("2877"),y=Object(f["a"])(p,r,i,!1,null,"4907a211",null);t["default"]=y.exports},b805:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bodyWrapper"},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:4,sm:12}},[t("a-form-item",{attrs:{label:"物资"}},[t("a-input",{attrs:{placeholder:"物资编码或者名称"},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:3,sm:12}},[t("a-form-item",{attrs:{label:"借用"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_date_type"},model:{value:e.queryParam.dateType,callback:function(t){e.$set(e.queryParam,"dateType",t)},expression:"queryParam.dateType"}})],1)],1),"1"===e.queryParam.dateType||1===e.queryParam.dateType||"2"===e.queryParam.dateType?t("a-col",{attrs:{md:3,sm:12}},[t("a-form-item",[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{mode:"year",placeholder:"请选择年份",format:"YYYY",open:e.yearPickShow},on:{panelChange:e.handlePanelChange,openChange:e.handleOpenChange,change:e.handleChanYearChange},model:{value:e.year,callback:function(t){e.year=t},expression:"year"}})],1)],1):e._e(),"2"===e.queryParam.dateType?t("a-col",{attrs:{md:3,sm:12}},[t("a-form-item",[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_quarter_type"},model:{value:e.queryParam.quarter,callback:function(t){e.$set(e.queryParam,"quarter",t)},expression:"queryParam.quarter"}})],1)],1):e._e(),"3"===e.queryParam.dateType?t("a-col",{attrs:{md:3,sm:12}},[t("a-form-item",[t("a-month-picker",{attrs:{placeholder:"选择月份"},on:{change:e.handleMonthChange},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}})],1)],1):e._e(),"4"===e.queryParam.dateType?t("a-col",{attrs:{md:4,sm:12}},[t("a-form-item",[t("a-range-picker",{model:{value:e.rangeDate,callback:function(t){e.rangeDate=t},expression:"rangeDate"}})],1)],1):e._e(),e.toggleSearchStatus?[t("a-col",{attrs:{md:4,sm:12}},[t("a-form-item",{attrs:{label:"归还类型"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_material_return_type"},model:{value:e.queryParam.returnType,callback:function(t){e.$set(e.queryParam,"returnType",t)},expression:"queryParam.returnType"}})],1)],1),t("a-col",{attrs:{md:4,sm:12}},[t("a-form-item",{attrs:{label:"归还状态"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_material_return_status"},model:{value:e.queryParam.returnStatus,callback:function(t){e.$set(e.queryParam,"returnStatus",t)},expression:"queryParam.returnStatus"}})],1)],1)]:e._e(),t("a-col",{attrs:{md:8,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")]),t("a-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增")]),t("a-button",{on:{click:e.deleteRecord}},[e._v("删除")]),t("a-button",{on:{click:e.handlerReturn}},[e._v("已归还")]),t("a",{on:{click:function(t){return t.stopPropagation(),e.handleToggleSearch.apply(null,arguments)}}},[e._v(" "+e._s(e.toggleSearchStatus?"收起":"更多")+" "),t("a-icon",{attrs:{type:e.toggleSearchStatus?"up":"down"}})],1)],1)],1)])],2)],1)],1),t("div",{style:e.tableHeight.top},[t("vxe-table",{ref:"listTable",style:e.tableHeight.bottom,attrs:{border:"",align:e.allAlign,"max-height":e.tableHeight.size,data:e.tableData,"show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{trigger:"manual",mode:"row"}}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}),t("vxe-table-column",{attrs:{field:"materialTypeCode",title:"物资编码",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("a",{on:{click:function(t){return t.stopPropagation(),e.borrowDetail(r)}}},[e._v(e._s(r.materialTypeCode))])]}}])}),t("vxe-table-column",{attrs:{field:"materialTypeName",title:"物资名称",width:"150","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"materialTypeSpec",title:"物资描述",width:"200","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"amount",title:"借用数量",width:"100","header-align":"center",align:"right"}}),t("vxe-table-column",{attrs:{field:"materialTypeUnit",title:"物资单位",width:"100"}}),t("vxe-table-column",{attrs:{field:"warehouseName",title:"所属仓库",width:"120"}}),t("vxe-table-column",{attrs:{field:"deptName",title:"借用组织",width:"120"}}),t("vxe-table-column",{attrs:{field:"borrowUserName",title:"借用人员",width:"100"}}),t("vxe-table-column",{attrs:{field:"borrowDate",title:"借用日期",width:"100"}}),t("vxe-table-column",{attrs:{field:"returnType_dictText",title:"归还类型",width:"120"}}),t("vxe-table-column",{attrs:{field:"returnStatus_dictText",title:"归还状态",width:"120"}}),t("vxe-table-column",{attrs:{field:"remark",title:"备注","min-width":"100","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{title:"操作",width:"80",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("a",{on:{click:function(t){return t.stopPropagation(),e.handleEdit(r)}}},[e._v("编辑")])]}}])})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1),t("borrow-item-modal",{ref:"modalForm",on:{ok:function(t){return e.loadData()}}}),t("borrow-detail-modal",{ref:"detailForm"})],1)},i=[],o=a("c54ca"),n=a("c54c"),l=a("23ce"),s=a("c1df"),d=a.n(s),c=(a("5c3a"),a("ca00")),u={name:"Borrow",components:{BorrowItemModal:n["default"],BorrowDetailModal:l["default"]},data:function(){return{year:null,month:null,component:null,rangeDate:[],toggleSearchStatus:!1,queryParam:{searchText:"",returnStatus:"",returnType:"",quarter:"",year:"",month:"",endDate:"",startDate:"",dateType:"",pageNo:1,pageSize:10},totalResult:0,allAlign:"center",tableData:[],yearPick:null,yearPickShow:!1,tableHeight:{top:"height: calc(100vh - 225px)",bottom:"height: calc(100vh - 225px)",size:"100%"}}},created:function(){this.findList()},watch:{"queryParam.dateType":{immediate:!0,deep:!0,handler:function(e){this.queryParam.quarter="",this.queryParam.year="",this.queryParam.month="",this.queryParam.endDate="",this.queryParam.startDate="",this.year=null,this.month=null,this.changeHeight()}}},methods:{findList:function(){var e=this,t=this.queryParam,a=t.dateType,r=t.year,i=t.quarter;t.month;switch(a){case"1":if(Object(c["e"])(r))return void this.$message.warning("请选择年份！");break;case"2":if(Object(c["e"])(r))return void this.$message.warning("请选择年份！");if(Object(c["e"])(i))return void this.$message.warning("请选择季度！");break;case"3":if(Object(c["e"])(this.month))return void this.$message.warning("请选择月份！");break;case"4":if(Object(c["e"])(this.rangeDate))return void this.$message.warning("请选择时间段！");break;default:break}Object(c["e"])(this.rangeDate)||"4"!==a||(this.queryParam.startDate=d()(this.rangeDate[0]).format("YYYY-MM-DD"),this.queryParam.endDate=d()(this.rangeDate[1]).format("YYYY-MM-DD")),Object(c["e"])(this.month)||"3"!==a||(this.queryParam.year=d()(this.month).year(),this.queryParam.month=d()(this.month).month()+1),Object(o["Z"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},changeHeight:function(){this.toggleSearchStatus&&!Object(c["e"])(this.queryParam.dateType)?this.tableHeight={top:"height: calc(100vh - 265px)",bottom:"height: calc(100vh - 265px)",size:"100%"}:this.tableHeight={top:"height: calc(100vh - 225px)",bottom:"height: calc(100vh - 225px)",size:"100%"}},loadData:function(){this.findList(),this.$emit("load")},handleAdd:function(){this.$refs.modalForm.add(),this.$refs.modalForm.title="新增"},handleEdit:function(e){this.$refs.modalForm.edit(e),this.$refs.modalForm.title="编辑"},deleteRecord:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();t.length>0?this.$confirm({content:"是否删除选中".concat(t.length,"数据？"),onOk:function(){var a=t.map((function(e,t){return e.id})).join(",");Object(o["r"])("ids="+a).then((function(t){e.findList(),e.$message.success(t.message)}))}}):this.$message.error("尚未选中任何数据!")},handlerReturn:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();t.length>0?this.$confirm({content:"是否设置选中".concat(t.length,"数据为已归还？"),onOk:function(){var a=t.map((function(e,t){return e.id})).join(",");Object(o["o"])("ids="+a).then((function(t){e.findList(),e.$message.success(t.message)}))}}):this.$message.error("尚未选中任何数据!")},borrowDetail:function(e){this.$refs.detailForm.detail(e)},handlerReadyMaterial:function(){var e=this.$refs.listTable.getCheckboxRecords();e.length>0?e.length>1?this.$message.warning("只能选中一条数据!"):this.$refs.readyMaterial.edit(row.id):this.$message.error("尚未选中任何数据!")},handleOpenChange:function(e){this.yearPickShow=e},handlePanelChange:function(e){this.year=e,this.queryParam.year=d()(e).format("YYYY"),this.yearPickShow=!1},handleChanYearChange:function(e){Object(c["e"])(e)&&(this.queryParam.year="")},handleMonthChange:function(e){Object(c["e"])(e)&&(this.queryParam.year="",this.queryParam.month="")},handleToggleSearch:function(){this.toggleSearchStatus=!this.toggleSearchStatus,this.changeHeight()}}},h=u,m=a("2877"),p=Object(m["a"])(h,r,i,!1,null,null,null);t["default"]=p.exports},c54c:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:"90%",visible:e.visible,confirmLoading:e.confirmLoading,bodyStyle:{minHeight:"450px"},destroyOnClose:!0,cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属仓库"}},[t("j-tree-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["warehouseId",e.validatorRules.warehouseId],expression:"[ 'warehouseId',validatorRules.warehouseId]",modifiers:{trim:!0}}],attrs:{placeholder:"请选择",dict:"bu_mtr_warehouse,name,id",pidField:"parent_id"},on:{change:e.handleWarehouseChange}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"借用物料"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["materialTypeName",e.validatorRules.materialTypeName],expression:"['materialTypeName', validatorRules.materialTypeName]",modifiers:{trim:!0}}],ref:"mySelect",attrs:{placeholder:"请选择",open:!1,showArrow:!0},on:{focus:e.openModal}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"物资编码"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["materialTypeCode"],expression:"[ 'materialTypeCode']",modifiers:{trim:!0}}],attrs:{placeholder:"请输入物资编码",disabled:""}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"借用数量"}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["amount",e.validatorRules.amount],expression:"[ 'amount', validatorRules.amount]",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{min:1,max:99999999}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"归还类型"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["returnType",e.validatorRules.returnType],expression:"[ 'returnType', validatorRules.returnType]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,placeholder:"请选择",dictCode:"bu_material_return_type",allowClear:!0}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"归还状态"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["returnStatus",e.validatorRules.returnStatus],expression:"[ 'returnStatus', validatorRules.returnStatus]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,placeholder:"请选择",dictCode:"bu_material_return_status",allowClear:!0}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"借用组织"}},[t("j-select-depart",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["deptId",e.validatorRules.deptId],expression:"[ 'deptId',validatorRules.deptId]",modifiers:{trim:!0}}],attrs:{rootOpened:!1},on:{change:e.handleDept}})],1)],1),""!==e.deptId&&null!=e.deptId?t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"借用人员"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["borrowUserId",e.validatorRules.borrowUserId],expression:"[ 'borrowUserId', validatorRules.borrowUserId]",modifiers:{trim:!0}}],attrs:{allowClear:!0,placeholder:"请选择人员"}},e._l(e.userList,(function(a){return t("a-select-option",{key:a.id,attrs:{value:a.id}},[e._v(e._s(a.realname))])})),1)],1)],1):e._e(),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"借用日期"}},[t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["borrowDate",e.validatorRules.borrowDate],expression:"[ 'borrowDate',validatorRules.borrowDate]",modifiers:{trim:!0}}],staticStyle:{width:"100%"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{label:"借用描述"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark",e.validatorRules.remark],expression:"[ 'remark',validatorRules.remark]"}]})],1)],1)],1)],1)],1),t("material-list",{ref:"MaterialModalForm",attrs:{multiple:!1,disabled:!0,"default-checked-keys":e.defaultChecked},on:{ok:e.addTarget}})],1)},i=[],o=a("c54ca"),n=a("b098"),l=a("c1df"),s=a.n(l),d=a("7164"),c=a("fe54"),u=a("4ec3"),h=a("ca00"),m={name:"BorrowItemModal",components:{JTreeSelect:n["default"],MaterialList:d["default"],JSelectDepart:c["default"]},data:function(){return{title:"操作",visible:!1,materialTypeId:"",materialTypeName:"",defaultChecked:"",model:{},userList:[],labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:14}},confirmLoading:!1,form:this.$form.createForm(this),deptId:"",validatorRules:{warehouseId:{rules:[{required:!0,message:"请选择所属仓库!"}]},materialTypeName:{rules:[{required:!0,message:"请选择借用物资!"}]},amount:{rules:[{required:!0,message:"请输入借用数量!"}],initialValue:1},returnType:{rules:[{required:!0,message:"请输选择归还类型!"}]},returnStatus:{rules:[{required:!0,message:"请选择归还状态!"}]},borrowUserId:{rules:[{required:!0,message:"请选择借用人员!"}]},borrowDate:{rules:[{required:!0,message:"请选择借用日期!"}]},deptId:{rules:[{required:!0,message:"请选择借用组织!"}]},remark:{rules:[{max:200,message:"输入长度不能超过200字符!"}]}}}},created:function(){},methods:{handleWarehouseChange:function(e){this.materialTypeId="",this.form.setFieldsValue({materialTypeName:"",materialTypeCode:""}),this.defaultChecked=e},handleDept:function(e){var t=this;this.deptId=e;var a={id:e};Object(u["C"])(a).then((function(e){e.success&&(t.userList=e.result)}))},openModal:function(){Object(h["e"])(this.defaultChecked)?this.$message.warn("请先选择仓库！"):(this.$refs.MaterialModalForm.showModal(),this.$refs.mySelect.blur())},addTarget:function(e){e&&1===e.length&&null!=e[0]&&(this.materialTypeId=e[0].id,this.form.setFieldsValue({materialTypeName:e[0].name,materialTypeCode:e[0].code,amount:e[0].num}))},add:function(){this.edit({})},edit:function(e){var t=this;this.form.resetFields(),this.visible=!0,this.model=Object.assign({},e,{borrowDate:s()(e.borrowDate||void 0)}),e.id&&(this.materialTypeId=e.materialTypeId,this.defaultChecked=e.warehouseId,this.deptId=e.deptId,this.$nextTick((function(){t.form.setFieldsValue({warehouseId:t.model.warehouseId,materialTypeName:t.model.materialTypeName,amount:t.model.amount,materialTypeCode:t.model.materialTypeCode,returnType:t.model.returnType,returnStatus:t.model.returnStatus,borrowUserId:t.model.borrowUserId,borrowDate:t.model.borrowDate,remark:t.model.remark,deptId:t.model.deptId})})))},handleOk:function(){var e=this,t=this;t.form.validateFields((function(a,r){if(!a){t.confirmLoading=!0;var i,n=Object.assign(t.model,r,{borrowDate:s()(r.borrowDate).format("YYYY-MM-DD"),materialTypeId:e.materialTypeId});i=t.model.id?Object(o["F"])(n):Object(o["b"])(n),i.then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok"),t.close()):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,this.defaultChecked=""}}},p=m,f=a("2877"),y=Object(f["a"])(p,r,i,!1,null,null,null);t["default"]=y.exports},c94f:function(e,t,a){"use strict";a("fef4")},fe54:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"components-input-demo-presuffix"},[t("a-input",{attrs:{placeholder:"请点击选择部门",readOnly:"",disabled:e.disabled},on:{click:e.openModal},model:{value:e.departNames,callback:function(t){e.departNames=t},expression:"departNames"}},[t("a-icon",{attrs:{slot:"prefix",type:"cluster",title:"部门选择控件"},slot:"prefix"}),e.departIds?t("a-icon",{attrs:{slot:"suffix",type:"close-circle",title:"清空"},on:{click:e.handleEmpty},slot:"suffix"}):e._e()],1),t("j-select-depart-modal",{ref:"innerDepartSelectModal",attrs:{"modal-width":e.modalWidth,multi:e.multi,rootOpened:e.rootOpened,"depart-id":e.departIds},on:{ok:e.handleOK,initComp:e.initComp}})],1)},i=[],o=a("b0cd"),n={name:"JSelectDepart",components:{JSelectDepartModal:o["default"]},props:{modalWidth:{type:Number,default:500,required:!1},multi:{type:Boolean,default:!1,required:!1},rootOpened:{type:Boolean,default:!0,required:!1},value:{type:String,required:!1},disabled:{type:Boolean,required:!1,default:!1},customReturnField:{type:String,default:"id"}},data:function(){return{visible:!1,confirmLoading:!1,departNames:"",departIds:""}},mounted:function(){this.departIds=this.value},watch:{value:function(e){"id"===this.customReturnField&&(this.departIds=e)}},methods:{initComp:function(e){this.departNames=e},openModal:function(){this.$refs.innerDepartSelectModal.show()},handleOK:function(e,t){var a=this,r="";!e&&e.length<=0?(this.departNames="",this.departIds=""):(r=e.map((function(e){return e[a.customReturnField]})).join(","),this.departNames=e.map((function(e){return e["departName"]})).join(","),this.departIds=t),this.$emit("change",r)},getDepartNames:function(){return this.departNames},handleEmpty:function(){this.handleOK("")}},model:{prop:"value",event:"change"}},l=n,s=(a("c94f"),a("2877")),d=Object(s["a"])(l,r,i,!1,null,"4d448922",null);t["default"]=d.exports},fef4:function(e,t,a){}}]);