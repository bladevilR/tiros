(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48276b74","chunk-681a2b9e","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7"],{"38b9":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:500,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"逾期原因"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["delayReason",e.validatorRules.delayReason],expression:"[ 'delayReason',validatorRules.delayReason]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入逾期原因"}})],1)],1)],1)],1)],1)],1)},i=[],r=a("d214"),s={name:"PerformItemModal",data:function(){return{title:"操作",visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:15}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{delayReason:{rules:[{max:64,message:"输入长度不能超过64字符!"}]}}}},created:function(){},methods:{add:function(){this.edit({})},edit:function(e){var t=this;this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue({delayReason:t.model.delayReason})}))},handleOk:function(){var e=this,t=this;t.form.validateFields((function(a,n){if(!a){t.confirmLoading=!0;var i=Object.assign(t.model,n);Object(r["jb"])(i).then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok")):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1,t.close()})),e.visible=!1}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},l=s,o=a("2877"),c=Object(o["a"])(l,n,i,!1,null,null,null);t["default"]=c.exports},"39af":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{id:"performCard"}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"部件名称"}},[t("a-input",{attrs:{placeholder:"部件名称",allowClear:""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"线路"}},[t("line-select-list",{on:{change:e.changeLine},model:{value:e.queryParam.lineId,callback:function(t){e.$set(e.queryParam,"lineId",t)},expression:"queryParam.lineId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"车号"}},[t("j-dict-select-seach-tag",{attrs:{placeholder:"请选择",dictCode:e.dictTrainStr},on:{focus:e.handleSysFocus},model:{value:e.queryParam.trainNo,callback:function(t){e.$set(e.queryParam,"trainNo",t)},expression:"queryParam.trainNo"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"状态"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_perform_status"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",{attrs:{md:2,sm:8}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)]),t("a-col",{attrs:{md:24,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{attrs:{type:"primary",disabled:!e.btnStatus.handlePerformDetail},on:{click:e.handlePerformDetail}},[e._v("执行管理")]),t("a-button",{attrs:{disabled:!e.btnStatus.handleDelayReason},on:{click:e.handleDelayReason}},[e._v("设置逾期原因")])],1)],1)])],1)],1)],1),t("div",{staticStyle:{height:"calc(100vh - 282px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(100vh - 282px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{trigger:"manual",mode:"row"}},on:{"checkbox-change":e.rowSelectChange,"checkbox-all":function(t){return e.btnStatus.update()}}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}),t("vxe-table-column",{attrs:{field:"lineName",title:"线路",width:"100"}}),t("vxe-table-column",{attrs:{field:"trainNo",title:"车号",width:"100"}}),t("vxe-table-column",{attrs:{field:"assetName",title:"委外部件","min-width":"120"}}),t("vxe-table-column",{attrs:{field:"supplierName",align:"left","header-align":"center",title:"委外厂商","min-width":"120"}}),t("vxe-table-column",{attrs:{field:"contractName",align:"left","header-align":"center",title:"合同","min-width":"120"}}),t("vxe-table-column",{attrs:{field:"sendGroupName",align:"left","header-align":"center",title:"送检班组",width:"100"}}),t("vxe-table-column",{attrs:{field:"transferDate",title:"送检日期",width:"100"}}),t("vxe-table-column",{attrs:{field:"returnTime",title:"计划返厂",width:"100"}}),t("vxe-table-column",{attrs:{field:"actReturnTime",title:"实际返厂",width:"100"}}),t("vxe-table-column",{attrs:{field:"supervisor",align:"left","header-align":"center",title:"监造人员",width:"100"}}),t("vxe-table-column",{attrs:{field:"trainIndex",align:"left","header-align":"center",title:"第几列车",width:"12%"}}),t("vxe-table-column",{attrs:{field:"curTrain",title:"执行车号",width:"12%"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"80"}}),t("vxe-table-column",{attrs:{field:"delayDays",title:"逾期天数",width:"80","header-align":"center",align:"right"}}),t("vxe-table-column",{attrs:{field:"delayReason",title:"逾期原因","min-width":"120","header-align":"center",align:"left"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1),t("perform-item-module",{ref:"modalForm",on:{ok:function(t){return e.loadData()}}}),t("perform-detail",{ref:"performDetail",on:{ok:function(t){return e.loadData()}}})],1)},i=[],r=a("d214"),s=a("38b9"),l=a("1afe"),o=a("5633"),c=a("54f6"),d={name:"RightPerform",props:["id","contractIds"],components:{PerformItemModule:s["default"],PerformDetail:l["default"],LineSelectList:o["default"]},data:function(){return{btnStatus:new c["a"](this,"listTable",{attrs:[{key:"handlePerformDetail"},{key:"handleDelayReason"}]}),dictTrainStr:"",queryParam:{lineId:"",searchText:"",trainNo:"",contactId:"",status:null,pageNo:1,pageSize:10},totalResult:0,allAlign:"center",tableData:[]}},watch:{id:{immediate:!0,handler:function(e){this.queryParam.id=e,this.findList()}},contractIds:{immediate:!0,handler:function(e){this.findList()}}},created:function(){this.findList()},methods:{handleSysFocus:function(){this.queryParam.lineId||this.$message.warn("请先选择线路!")},changeLine:function(e,t){this.dictTrainStr="",e&&(this.dictTrainStr="bu_train_info,train_no,train_no,line_id="+e+"|train_struct_id")},rowSelectChange:function(){this.btnStatus.update()},findList:function(){var e=this;this.queryParam.id=null,this.queryParam.contractIds=this.contractIds,Object(r["X"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records,e.btnStatus.update()}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},loadData:function(){this.findList(),this.$emit("load")},handleDelayReason:function(){var e=this.$refs.listTable.getCheckboxRecords(),t=e[0];if(null==t.delayDays||0===t.delayDays)this.$message.warn("该委外设备没有逾期，无法设置逾期原因!");else{var a={id:t.id,delayReason:t.delayReason};this.$refs.modalForm.edit(a),this.$refs.modalForm.title="编辑"}},handlePerformDetail:function(){var e=this.$refs.listTable.getCheckboxRecords();1===e.length?this.$refs.performDetail.show(e[0]):e.length>1?this.$message.error("只能选中一条数据!"):this.$message.error("尚未选中任何数据!")}}},u=d,h=(a("47b7"),a("2877")),f=Object(h["a"])(u,n,i,!1,null,null,null);t["default"]=f.exports},"3c550":function(e,t,a){},"47b7":function(e,t,a){"use strict";a("3c550")},"54f6":function(e,t,a){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function s(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=o(e,"string");return"symbol"==n(t)?t:t+""}function o(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}a.d(t,"a",(function(){return c}));var c=function(){function e(t,a){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i(this,e),this.options={attrs:[]},Object.assign(this.options,r),this.options.attrs.find((function(e){return"edit"===e.key}))||this.options.attrs.push({key:"edit"}),this.options.attrs.forEach((function(e){Object.hasOwnProperty.call(e,"key")&&(n[e.key]=!1),Object.hasOwnProperty.call(e,"judge")||(e["judge"]=function(e){return!0})})),this.del=!1,this.nextTick=t.$nextTick,this.refs=t.$refs,this.refName=a,t.$nextTick((function(){n.vxeTable=t.$refs[a]}))}return s(e,[{key:"editRow",get:function(){if(this.edit){var e=this.vxeTable.getCheckboxRecords();return e.length?e[0]:{}}return{}}},{key:"update",value:function(){var e=this;this.nextTick((function(){e.vxeTable||(e.vxeTable=e.refs[e.refName]);var t=e.vxeTable.getCheckboxRecords();e.del=t.length>0,e.options.attrs.forEach((function(a){for(var n in a)Object.hasOwnProperty.call(a,n)&&(a["isDel"]?t.length?e[a.key]=t.length>0&&a.judge(t[0]):e[a.key]=!1:t.length?e[a.key]=1===t.length&&a.judge(t[0]):e[a.key]=!1)}))}))}}])}()},5633:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("span",[t("a-select",{key:e.key,attrs:{"allow-clear":"",value:e.getValueSting,disabled:e.disabled,placeholder:"线路"},on:{change:e.handleChange,select:e.onSelect}},[t("a-select-option",{attrs:{value:void 0}},[e._v("请选择")]),e._l(e.optionData,(function(a,n){return t("a-select-option",{key:n,attrs:{value:a.lineId}},[t("span",{staticStyle:{display:"inline-block",width:"100%"},attrs:{title:a.lineName}},[e._v(" "+e._s(a.lineName)+" ")])])}))],2)],1)},i=[],r=a("8fad"),s={name:"LineSelectList",props:{value:[String],triggerChange:Boolean,disabled:Boolean,defaultFirst:Boolean},data:function(){return{optionData:[],selectValue:"",key:0}},created:function(){this.findList()},computed:{getValueSting:function(){return null!=this.value?this.value.toString():void 0}},methods:{findList:function(){var e=this;Object(r["Jb"])().then((function(t){t.success&&(e.optionData=t.result,e.defaultFirst&&e.optionData&&e.optionData.length>0&&setTimeout((function(){e.$emit("change",e.optionData[0].lineId),e.$emit("input",e.optionData[0].lineId)}),500))}))},handleChange:function(e,t){var a="";if(t&&t.componentOptions.children[0].data&&(a=t.componentOptions.children[0].data.attrs.title),this.$emit("change",e),this.$emit("input",e),this.$emit("changeName",a),this.triggerChange)if(e){var n=this.optionData[t.key];this.$emit("change",e,n)}else this.$emit("change",e,null)},onSelect:function(e,t){if(e){var a=this.optionData[t.data.key];this.$emit("select",e,a)}else this.$emit("select","",null)}}},l=s,o=a("2877"),c=Object(o["a"])(l,n,i,!1,null,"77265147",null);t["default"]=c.exports},6893:function(e,t,a){"use strict";a("83e8")},"73a9":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{id:"leftPerform"}},[t("div",{staticClass:"typeTitle"},[t("a-icon",{staticStyle:{"margin-right":"4px"},attrs:{type:"read"}}),e._v(" 合同列表 ")],1),t("div",{staticClass:"table-page-search-wrapper",staticStyle:{"margin-top":"2px"}},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:12}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"车型"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择车型",dictCode:"bu_train_type,name,id"},model:{value:e.trainTypeId,callback:function(t){e.trainTypeId=t},expression:"trainTypeId"}})],1)],1),t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"名称"}},[t("a-input",{attrs:{placeholder:"请输入内容",allowClear:""},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}})],1)],1)],1),t("a-row",[t("a-form-item",[t("a-button",{attrs:{type:"primary",block:""},on:{click:e.onSearch}},[e._v("搜索")])],1)],1)],1)],1),t("div",{staticStyle:{width:"80%",margin:"0 auto"}},[e.treeData.length?t("a-tree",{attrs:{"tree-data":e.treeData,"auto-expand-parent":e.autoExpandParent,"expanded-keys":e.expandedKeys,selectedKeys:e.selectedKeys,replaceFields:{title:"name",key:"id"}},on:{expand:e.onExpand,select:e.onSelect},scopedSlots:e._u([{key:"title",fn:function(a){var n=a.name;return[n.indexOf(e.searchValue)>-1?t("span",[e._v(" "+e._s(n.substr(0,n.indexOf(e.searchValue)))+" "),t("span",{staticStyle:{color:"#f50"}},[e._v(e._s(e.searchValue))]),e._v(" "+e._s(n.substr(n.indexOf(e.searchValue)+e.searchValue.length))+" ")]):t("span",[e._v(e._s(n))])]}}],null,!1,367957347)}):e._e()],1)])},i=[],r=a("d214"),s=a("ca00"),l={name:"LeftPerform",props:["contractIds"],data:function(){return{searchName:"",selectedKeys:[],treeData:[],dataList:[],autoExpandParent:!0,expandedKeys:[],titleTree:{title:"title"},searchValue:"",trainTypeId:"",labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}}},watch:{trainTypeId:{immediate:!1,handler:function(e){this.selectTree(e)}},searchValue:{immediate:!1,handler:function(e){Object(s["e"])(e)&&(this.$emit("input",""),this.selectedKeys=[])}}},methods:{generateList:function(e){for(var t=0;t<e.length;t++){var a=e[t],n=a.id;this.dataList.push({key:n,title:a.name}),a.children&&this.generateList(a.children)}},setScopedSlots:function(e){var t=this;return e.forEach((function(e){e["scopedSlots"]=t.titleTree,e.children&&t.setScopedSlots(e.children)})),e},selectTree:function(e){var t=this;Object(r["kb"])({trainTypeId:e}).then((function(e){e.success&&(t.treeData=t.setScopedSlots(e.result),t.generateList(t.treeData))}))},onExpand:function(e){this.expandedKeys=e,this.autoExpandParent=!1},getParentKey:function(e,t){for(var a,n=this,i=function(){var i=t[r];i.children&&i.children.map((function(t){t.name===e?a=i.id:n.getParentKey(e,i.children)&&(a=n.getParentKey(e,i.children))}))},r=0;r<t.length;r++)i();return a},onSearch:function(){var e=this;this.selectedKeys=[],this.$emit("input","");var t=this.searchName,a=this.dataList.map((function(a){if(a.title.indexOf(t)>-1)return e.getParentKey(a.title,e.treeData)})).filter((function(e,t,a){return e&&a.indexOf(e)===t}));Object.assign(this,{expandedKeys:a,searchValue:t,autoExpandParent:!0})},onSelect:function(e,t){var a;e.length>0?(this.selectedKeys=e,this.$emit("input",this.selectedKeys[0]),a=t.node.dataRef.contractIds,this.$emit("changeContractIds",a)):(this.selectedKeys=[],this.$emit("changeContractIds",""))}}},o=l,c=(a("6893"),a("2877")),d=Object(c["a"])(o,n,i,!1,null,null,null);t["default"]=d.exports},"83e8":function(e,t,a){},ade2:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{type:"flex",gutter:16}},[t("a-col",{attrs:{md:4,sm:24}},[t("left-perform",{attrs:{"contract-ids":e.contractIds},on:{changeContractIds:e.changeContractIds},model:{value:e.id,callback:function(t){e.id=t},expression:"id"}})],1),t("a-col",{attrs:{md:20,sm:24}},[t("right-perform",{attrs:{id:e.id,"contract-ids":e.contractIds}})],1)],1)},i=[],r=a("73a9"),s=a("39af"),l={name:"Perform",components:{LeftPerform:r["default"],RightPerform:s["default"]},data:function(){return{id:"",contractIds:""}},methods:{changeContractIds:function(e){this.contractIds=e}}},o=l,c=a("2877"),d=Object(c["a"])(o,n,i,!1,null,"52e07be2",null);t["default"]=d.exports}}]);