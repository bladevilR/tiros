(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65f784c8","chunk-6b918856","chunk-29096d72"],{"2cb5":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",centered:"",title:e.title,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchQuery.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"名称"}},[t("a-input",{attrs:{placeholder:"名称或编码","allow-clear":""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"状态"}},[t("j-dict-select-tag",{attrs:{dictCode:"bu_enable"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",{attrs:{md:3,sm:12}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-button",{on:{click:e.searchQuery}},[e._v("查询")])],1)])],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 85px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 85px)"},attrs:{border:"","max-height":"100%","row-id":"id",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row",checkMethod:e.checkRadioMethod},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,checkMethod:e.checkRadioMethod}:{},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"name",title:"名称","tree-node":"",align:"left"}}),t("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"code",title:"编码",width:"15%"}}),t("vxe-table-column",{attrs:{field:"structType_dictText",title:"类型",width:"10%"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"10%"}}),t("vxe-table-column",{attrs:{field:"placeCode",title:"位置编码",width:"15%"}}),t("vxe-table-column",{attrs:{field:"placeDesc",title:"位置描述",width:"15%"}})],1)],1)])},l=[],r=a("8fad"),s={name:"TrainAssetType",props:{trainTypeId:{type:String,default:""},parentId:{type:String,default:null},multiple:{type:Boolean,default:!0},title:{type:String,default:"设备类型选择"},canSelectType:{type:Array,default:function(){return[1,2,3,4]}}},data:function(){return{queryParam:{trainTypeId:"",id:"",searchText:"",status:null,structType:null},allAlign:"center",tableData:[],treeData:[],selectParent:"",visible:!1,confirmLoading:!1}},mounted:function(){},methods:{showModal:function(){this.visible=!0,this.queryParam.trainTypeId=this.trainTypeId,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.$emit("cancel"),this.close()},close:function(){this.$emit("close"),this.visible=!1},findList:function(){var e=this;this.loading=!0,this.parentId&&(this.queryParam.id=this.parentId),this.selectParent&&(this.queryParam.id=this.selectParent),Object(r["Qd"])(this.queryParam).then((function(t){t.success&&(e.loading=!1,e.tableData=t.result)}))},findSelectList:function(){var e=this,t={id:this.parentId,trainTypeId:this.trainTypeId};this.parentId&&(t.id=this.parentId),Object(r["Qd"])(t).then((function(t){t.success&&(e.loading=!1,e.treeData=t.result.map((function(t){return e.genSelectTreeNode(t)})))}))},loadChildrenMethod:function(e){var t=this,a=e.row,i={trainTypeId:this.trainTypeId,id:a.id};return new Promise((function(e){Object(r["Qd"])(i).then((function(a){a.success?e(a.result):t.$message.error("".concat(a.msg))}))}))},loadSelectNodeMethod:function(e){var t=this,a={trainTypeId:this.trainTypeId,id:e.dataRef.id,searchText:this.queryParam.searchText,status:this.queryParam.status,structType:this.queryParam.structType};return new Promise((function(e){Object(r["Qd"])(a).then((function(e){e.success?e.result.map((function(e){t.treeData=t.treeData.concat(t.genSelectTreeNode(e))})):t.$message.warning(e.message)})),e()}))},genSelectTreeNode:function(e){return{id:e.id,pId:e.parentId,value:e.id,title:e.name,isLeaf:!e.hasChildren}},searchQuery:function(){this.findList()},checkRadioMethod:function(e){var t=e.row;return this.canSelectType.indexOf(t.structType)>-1}}},n=s,o=(a("9589"),a("2877")),c=Object(o["a"])(n,i,l,!1,null,"52968c59",null);t["default"]=c.exports},7237:function(e,t,a){},9589:function(e,t,a){"use strict";a("7237")},af67:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:800,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:20,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"暂缓项目内容"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["leaveContent",e.validatorRules.leaveContent],expression:"['leaveContent', validatorRules.leaveContent]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入暂缓项目内容"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:20,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"专业系统"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["assetTypeName",e.validatorRules.assetTypeName],expression:"['assetTypeName', validatorRules.assetTypeName]",modifiers:{trim:!0}}],ref:"myAssetTypeSelect",attrs:{placeholder:"请选择",open:!1,showArrow:!0},on:{focus:e.openAssetTypeModal}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:20,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"工序名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["operation",e.validatorRules.operation],expression:"['operation', validatorRules.operation]",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入工序名称"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:20,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"暂缓原因"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["reason",e.validatorRules.reason],expression:"['reason', validatorRules.reason]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入暂缓原因"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:20,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"计划处理措施"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["planHandle",e.validatorRules.planHandle],expression:"['planHandle', validatorRules.planHandle]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入计划处理措施"}})],1)],1)],1)],1),t("train-asset-type",{ref:"assetTypeForm",attrs:{multiple:!1,"train-type-id":e.trainTypeId},on:{ok:e.addTarget}})],1)],1)},l=[],r=(a("b47d"),a("2cb5")),s=a("ca00"),n={name:"OpenItemModal",components:{TrainAssetType:r["default"]},props:["trainTypeId","exchangeId"],data:function(){return{title:"操作",visible:!1,activeIndex:null,model:{},labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}},assetTypeId:"",confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{leaveContent:{rules:[{required:!0,message:"请输入暂缓项目内容!"},{max:255,message:"输入长度不能超过255字符!"}]},assetTypeName:{rules:[{required:!0,message:"请选择专业系统!"}]},operation:{rules:[{required:!0,message:"请输入工序名称!"},{max:64,message:"输入长度不能超过64字符!"}]},reason:{rules:[{required:!0,message:"请输入暂缓原因!"},{max:255,message:"输入长度不能超过255字符!"}]},planHandle:{rules:[{max:500,message:"输入长度不能超过500字符!"}]}}}},created:function(){},methods:{openAssetTypeModal:function(){this.$refs.assetTypeForm.showModal(),this.$refs.myAssetTypeSelect.blur()},addTarget:function(e){Object(s["e"])(e)||(this.assetTypeId=e[0].id,this.form.setFieldsValue({assetTypeName:e[0].name}))},add:function(){this.edit({})},edit:function(e,t){var a=this;this.activeIndex=t,this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,e.id&&(this.assetTypeId=e.assetTypeId),this.$nextTick((function(){a.form.setFieldsValue({leaveContent:a.model.leaveContent,assetTypeName:a.model.assetTypeName,operation:a.model.operation,reason:a.model.reason,planHandle:a.model.planHandle})}))},handleOk:function(){var e=this;this.form.validateFields((function(t,a){if(!t){e.confirmLoading=!0;var i=Object.assign(e.model,a,{assetTypeId:e.assetTypeId});e.$emit("addItem",i,e.activeIndex),e.$message.success("添加成功！"),e.$emit("ok"),e.close(),e.activeIndex=null,e.confirmLoading=!1}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},o=n,c=a("2877"),d=Object(c["a"])(o,i,l,!1,null,"3a122558",null);t["default"]=d.exports},cd04:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bodyWrapper"},[e.isReadonly?e._e():t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:8}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增")]),t("a-button",{on:{click:e.handleDel}},[e._v("删除")])],1)],1)])],1)],1)],1),t("div",{style:"height: calc(100vh - ".concat(e.isReadonly?"134":"240","px)")},[t("vxe-table",{ref:"listTable",style:"height: calc(100vh - ".concat(e.isReadonly?"134":"239","px)"),attrs:{border:"","auto-resize":"","max-height":"90%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{trigger:"manual",mode:"row"}},on:{"checkbox-all":e.selectAllRowsIds,"checkbox-change":e.selectRowsIds}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{type:"seq",title:"序号",width:"80"}}),t("vxe-table-column",{attrs:{field:"leaveContent",title:"暂缓项目内容","min-width":"100",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"assetTypeName",title:"专业系统","min-width":"100"}}),t("vxe-table-column",{attrs:{field:"operation",title:"工序名称","min-width":"100",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"reason",title:"暂缓原因","min-width":"120",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"planHandle",title:"计划处理措施","min-width":"140",align:"left","header-align":"center"}}),e.isReadonly?e._e():t("vxe-table-column",{attrs:{title:"操作",width:"80",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){var i=a.row,l=a.rowIndex;return[t("a",{on:{click:function(t){return t.stopPropagation(),e.handleEdit(i,l)}}},[e._v("编辑")])]}}],null,!1,2479697564)})],1)],1),t("open-item-modal",{ref:"openItemModal",attrs:{trainTypeId:e.trainTypeId,exchangeId:e.exchangeId},on:{ok:function(t){e.loading=!1},addItem:e.addItem}})],1)},l=[],r=a("b47d"),s=a("af67"),n=a("ca00"),o={name:"ReceiveCarOpenItem",components:{OpenItemModal:s["default"]},props:["trainTypeId","exchangeId","isReadonly"],data:function(){return{queryParam:{exchangeId:"",pageNo:1,pageSize:999},totalResult:0,allAlign:"center",tableData:[],multipleSelection:[]}},mounted:function(){this.findList()},methods:{findList:function(){var e=this;Object(n["e"])(this.exchangeId)||(this.queryParam.exchangeId=this.exchangeId,Object(r["V"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records,e.$bus.$emit("setReceiveCarOpenItemData",e.tableData)})))},selectAllRowsIds:function(e){var t=this;e.records.length?e.records.map((function(e,a){t.multipleSelection.push(e._XID)})):t.multipleSelection=[]},selectRowsIds:function(e){this.multipleSelection.includes(e.rowid)?this.multipleSelection.splice(this.multipleSelection.indexOf(e.rowid),1):this.multipleSelection.push(e.rowid)},addItem:function(e,t){if(t||0==t)for(var a in e)this.$set(this.tableData[t],a,e[a]),this.$forceUpdate();else this.tableData.unshift(e),this.$refs.listTable.clearCheckboxRow(),this.multipleSelection=[];this.$bus.$emit("setReceiveCarOpenItemData",this.tableData)},handleAdd:function(){this.$refs.openItemModal.title="新增",this.$refs.openItemModal.add()},handleEdit:function(e,t){this.$refs.openItemModal.title="编辑",this.$refs.openItemModal.edit(e,t)},handleDel:function(){var e=this,t=this;t.multipleSelection.length>0?t.$confirm({content:"是否删除选中".concat(t.multipleSelection.length,"数据？"),onOk:function(){t.multipleSelection.map((function(e,a){for(var i=0;i<t.tableData.length;i++){var l=t.tableData[i];if(l._XID==e)return void t.tableData.splice(i,1)}})),e.$refs.listTable.clearCheckboxRow(),e.multipleSelection=[],e.$bus.$emit("setReceiveCarOpenItemData",e.tableData)}}):t.$message.error("尚未选中任何数据!")},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()}}},c=o,d=a("2877"),u=Object(d["a"])(c,i,l,!1,null,"934c7562",null);t["default"]=u.exports}}]);