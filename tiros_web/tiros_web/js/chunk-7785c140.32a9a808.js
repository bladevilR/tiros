(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7785c140","chunk-02917ab2","chunk-5a535414","chunk-7c50f59e","chunk-29096d72","chunk-b8fe6362","chunk-2d0df437","chunk-2d0df437"],{"0f5b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bodyWrapper"},[t("div",{staticStyle:{height:"100%"}},[t("a-row",{staticStyle:{height:"100%"},attrs:{type:"flex",gutter:16}},[t("a-col",{attrs:{md:5,sm:24}},[t("train-type-sys-composition-left",{ref:"trainTypeLeft",attrs:{trainTypeId:e.trainTypeId},model:{value:e.sysInfo,callback:function(t){e.sysInfo=t},expression:"sysInfo"}})],1),t("a-col",{attrs:{md:19,sm:24}},[t("train-type-sys-composition-right",{ref:"trainTypeRight",attrs:{trainTypeId:e.trainTypeId},model:{value:e.sysInfo,callback:function(t){e.sysInfo=t},expression:"sysInfo"}})],1)],1)],1)])},i=[],s=a("ddc0"),n=a("f14a2"),l=a("8fad"),o={name:"TrainSysComposition",components:{TrainTypeSysCompositionLeft:s["default"],TrainTypeSysCompositionRight:n["default"]},data:function(){return{trainTypeId:void 0,sysInfo:""}},mounted:function(){var e=this;Object(l["sc"])().then((function(t){t.success?t.result.length>0&&(e.trainTypeId=t.result[0].id,e.$refs.trainTypeLeft.trainChange(e.trainTypeId)):e.$message.error(t.message)}))},methods:{}},c=o,d=a("2877"),u=Object(d["a"])(c,r,i,!1,null,null,null);t["default"]=u.exports},1684:function(e,t,a){},"22de":function(e,t,a){},"2cb5":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",centered:"",title:e.title,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchQuery.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"名称"}},[t("a-input",{attrs:{placeholder:"名称或编码","allow-clear":""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"状态"}},[t("j-dict-select-tag",{attrs:{dictCode:"bu_enable"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",{attrs:{md:3,sm:12}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-button",{on:{click:e.searchQuery}},[e._v("查询")])],1)])],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 85px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 85px)"},attrs:{border:"","max-height":"100%","row-id":"id",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row",checkMethod:e.checkRadioMethod},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,checkMethod:e.checkRadioMethod}:{},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"name",title:"名称","tree-node":"",align:"left"}}),t("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"code",title:"编码",width:"15%"}}),t("vxe-table-column",{attrs:{field:"structType_dictText",title:"类型",width:"10%"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"10%"}}),t("vxe-table-column",{attrs:{field:"placeCode",title:"位置编码",width:"15%"}}),t("vxe-table-column",{attrs:{field:"placeDesc",title:"位置描述",width:"15%"}})],1)],1)])},i=[],s=a("8fad"),n={name:"TrainAssetType",props:{trainTypeId:{type:String,default:""},parentId:{type:String,default:null},multiple:{type:Boolean,default:!0},title:{type:String,default:"设备类型选择"},canSelectType:{type:Array,default:function(){return[1,2,3,4]}}},data:function(){return{queryParam:{trainTypeId:"",id:"",searchText:"",status:null,structType:null},allAlign:"center",tableData:[],treeData:[],selectParent:"",visible:!1,confirmLoading:!1}},mounted:function(){},methods:{showModal:function(){this.visible=!0,this.queryParam.trainTypeId=this.trainTypeId,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.$emit("cancel"),this.close()},close:function(){this.$emit("close"),this.visible=!1},findList:function(){var e=this;this.loading=!0,this.parentId&&(this.queryParam.id=this.parentId),this.selectParent&&(this.queryParam.id=this.selectParent),Object(s["Qd"])(this.queryParam).then((function(t){t.success&&(e.loading=!1,e.tableData=t.result)}))},findSelectList:function(){var e=this,t={id:this.parentId,trainTypeId:this.trainTypeId};this.parentId&&(t.id=this.parentId),Object(s["Qd"])(t).then((function(t){t.success&&(e.loading=!1,e.treeData=t.result.map((function(t){return e.genSelectTreeNode(t)})))}))},loadChildrenMethod:function(e){var t=this,a=e.row,r={trainTypeId:this.trainTypeId,id:a.id};return new Promise((function(e){Object(s["Qd"])(r).then((function(a){a.success?e(a.result):t.$message.error("".concat(a.msg))}))}))},loadSelectNodeMethod:function(e){var t=this,a={trainTypeId:this.trainTypeId,id:e.dataRef.id,searchText:this.queryParam.searchText,status:this.queryParam.status,structType:this.queryParam.structType};return new Promise((function(e){Object(s["Qd"])(a).then((function(e){e.success?e.result.map((function(e){t.treeData=t.treeData.concat(t.genSelectTreeNode(e))})):t.$message.warning(e.message)})),e()}))},genSelectTreeNode:function(e){return{id:e.id,pId:e.parentId,value:e.id,title:e.name,isLeaf:!e.hasChildren}},searchQuery:function(){this.findList()},checkRadioMethod:function(e){var t=e.row;return this.canSelectType.indexOf(t.structType)>-1}}},l=n,o=(a("9589"),a("2877")),c=Object(o["a"])(l,r,i,!1,null,"52968c59",null);t["default"]=c.exports},4065:function(e,t,a){"use strict";a("22de")},7204:function(e,t,a){"use strict";a("1684")},7237:function(e,t,a){},"791d":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-drawer",{attrs:{title:e.title,width:800,maskClosable:!1,closable:!0,visible:e.visible},on:{close:e.handleCancel}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{staticStyle:{width:"100%"}},[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"结构编码"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["code",e.validatorRules.code],expression:"['code', validatorRules.code]",modifiers:{trim:!0}}],attrs:{maxLength:33,placeholder:"结构编码"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"结构名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["name",e.validatorRules.name],expression:"['name', validatorRules.name]",modifiers:{trim:!0}}],attrs:{maxLength:33,placeholder:"结构名称"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"短名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["shortName",e.validatorRules.shortName],expression:"['shortName',validatorRules.shortName]",modifiers:{trim:!0}}],attrs:{maxLength:33,placeholder:"结构名称"}})],1)],1)],1),t("a-row",{staticStyle:{width:"100%"}},[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"上级结构"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["parentName",e.validatorRules.parentName],expression:"['parentName', validatorRules.parentName]",modifiers:{trim:!0}}],ref:"mySelect",attrs:{placeholder:"请选择",open:!1,showArrow:!0},on:{focus:e.openModal}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"排序"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["sortNum",e.validatorRules.sortNum],expression:"['sortNum', validatorRules.sortNum]",modifiers:{trim:!0}}],attrs:{placeholder:"排序",maxLength:17}})],1)],1)],1),t("a-row",{staticStyle:{width:"100%"}},[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"初始数量"}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["initNum",e.validatorRules.initNum],expression:"['initNum', validatorRules.initNum ]",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{max:9999,id:"inputNumber"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"单位"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["unit",e.validatorRules.unit],expression:"['unit', validatorRules.unit]",modifiers:{trim:!0}}],attrs:{maxLength:17,placeholder:"请输入内容"}})],1)],1)],1),t("a-row",{staticStyle:{width:"100%"}},[t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{labelCol:e.labelColX2,wrapperCol:e.wrapperColX2,label:"是否虚拟"}},[t("a-switch",{on:{change:e.changeSubjunctive},model:{value:e.switchChecked.subjunctive,callback:function(t){e.$set(e.switchChecked,"subjunctive",t)},expression:"switchChecked.subjunctive"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{labelCol:e.labelColX2,wrapperCol:e.wrapperColX2,label:"是否BOM"}},[t("a-switch",{on:{change:e.changeBom},model:{value:e.switchChecked.bom,callback:function(t){e.$set(e.switchChecked,"bom",t)},expression:"switchChecked.bom"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{labelCol:e.labelColX2,wrapperCol:e.wrapperColX2,label:"是否周转件"}},[t("a-switch",{on:{change:e.changeTurnover},model:{value:e.switchChecked.turnover,callback:function(t){e.$set(e.switchChecked,"turnover",t)},expression:"switchChecked.turnover"}})],1)],1),t("a-col",{attrs:{span:6}},[t("a-form-item",{attrs:{labelCol:e.labelColX2,wrapperCol:e.wrapperColX2,label:"是否启用"}},[t("a-switch",{on:{change:e.changeStatus},model:{value:e.switchChecked.status,callback:function(t){e.$set(e.switchChecked,"status",t)},expression:"switchChecked.status"}})],1)],1)],1),t("a-row",{staticStyle:{width:"100%"}},[t("a-col",{attrs:{span:24}},[t("a-form-item",{attrs:{labelCol:e.labelColX1,wrapperCol:e.wrapperColX1,label:"备注"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark",e.validatorRules.remark],expression:"['remark',validatorRules.remark]"}],attrs:{maxLength:201}})],1)],1)],1)],1),t("div",{staticClass:"drawer-bootom-button"},[t("a-space",[t("a-button",{on:{click:e.handleCancel}},[e._v("取消")]),t("a-button",{attrs:{type:"primary",loading:e.confirmLoading},on:{click:e.handleOk}},[e._v("提交")])],1)],1),t("train-asset-type",{ref:"selectModal",attrs:{multiple:!1,trainTypeId:e.trainTypeId},on:{ok:e.selectParent}})],1)},i=[],s=a("2cb5"),n=a("8fad"),l=a("4ec3"),o=a("ca00"),c={name:"TrainTypeSysModal",props:["parent","trainTypeId"],components:{TrainAssetType:s["default"]},data:function(){return{value:1,title:"操作",visible:!1,sortNum:"",parentName:"",parentId:"",model:{},switchChecked:{subjunctive:!1,bom:!1,turnover:!1,status:!0},selectedName:"",selectTreeNode:[],labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}},labelColX1:{xs:{span:24},sm:{span:3}},wrapperColX1:{xs:{span:24},sm:{span:21}},labelColX2:{xs:{span:24},sm:{span:12}},wrapperColX2:{xs:{span:24},sm:{span:12}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{code:{rules:[{required:!0,message:"请输入结构编码!"},{validator:this.validateCode},{max:32,message:"输入长度不能超过32字符!"}]},name:{rules:[{required:!0,message:"请输入结构名称!"},{max:32,message:"输入长度不能超过32字符!"}]},shortName:{rules:[{required:!0,message:"请输入短名称!"},{max:32,message:"输入长度不能超过32字符!"}]},parentName:{rules:[{required:!0,message:"请选择上级结构!"}]},sortNum:{rules:[{max:16,message:"输入长度不能超过16字符!"}]},initNum:{rules:[{required:!0,message:"请输入初始数量!"}],initialValue:1},unit:{rules:[{required:!1,message:"请选输入单位!"},{max:16,message:"输入长度不能超过16字符!"}]},remark:{rules:[{max:200,message:"输入长度不能超过200字符!"}]}}}},methods:{changeSubjunctive:function(e){this.switchChecked.subjunctive=e},changeBom:function(e){this.switchChecked.bom=e},changeTurnover:function(e){this.switchChecked.turnover=e},changeStatus:function(e){this.switchChecked.status=e},openModal:function(){this.$refs.selectModal.showModal(),this.$refs.mySelect.blur()},validateCode:function(e,t,a){var r={tableName:"bu_train_asset_type",fieldName:"code",fieldVal:t,dataId:this.model.id,filterFields:[{name:"train_type_id",val:this.trainTypeId}]};Object(o["e"])(t)?a():Object(l["m"])(r).then((function(e){e.success?a():a(e.message)}))},selectParent:function(e){Object(o["e"])(e)||(this.form.setFieldsValue({parentName:e[0].name}),this.parentId=e[0].id)},add:function(){this.edit({})},edit:function(e){var t=this;if(this.form.resetFields(),this.visible=!0,this.model=Object.assign({},e),e.id){for(var a in this.parentId=e.parentId,this.parentName=e.parentName,this.switchChecked)this.switchChecked[a]=!!e[a];this.$nextTick((function(){t.form.setFieldsValue({code:t.model.code,name:t.model.name,shortName:t.model.shortName,initNum:t.model.initNum,unit:t.model.unit,parentName:t.parentName,remark:t.model.remark,sortNum:t.model.sortNum})}))}else{for(var a in this.parentId=this.parent.sysId,this.parentName=this.parent.sysName,this.switchChecked)this.switchChecked[a]="bom"==a||"status"==a;this.$nextTick((function(){t.form.setFieldsValue({parentName:t.parentName})}))}},handleOk:function(){var e=this,t=this;t.form.validateFields((function(a,r){if(!a){t.confirmLoading=!0;var i={};for(var s in t.switchChecked)t.$set(i,s,t.switchChecked[s]?1:0);var l,o=Object.assign(t.model,r,i,{trainTypeId:e.trainTypeId,parentId:e.parentId});l=t.model.id?Object(n["rb"])(o):Object(n["r"])(o),l.then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok"),t.close(),t.visible=!1):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},d=c,u=(a("7204"),a("2877")),m=Object(u["a"])(d,r,i,!1,null,"4edbe764",null);t["default"]=m.exports},"7dae":function(e,t,a){"use strict";a("a81f")},"88bc":function(e,t,a){(function(t){var a=1/0,r=9007199254740991,i="[object Arguments]",s="[object Function]",n="[object GeneratorFunction]",l="[object Symbol]",o="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,d=o||c||Function("return this")();function u(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function m(e,t){var a=-1,r=e?e.length:0,i=Array(r);while(++a<r)i[a]=t(e[a],a,e);return i}function h(e,t){var a=-1,r=t.length,i=e.length;while(++a<r)e[i+a]=t[a];return e}var p=Object.prototype,f=p.hasOwnProperty,b=p.toString,y=d.Symbol,v=p.propertyIsEnumerable,g=y?y.isConcatSpreadable:void 0,w=Math.max;function C(e,t,a,r,i){var s=-1,n=e.length;a||(a=I),i||(i=[]);while(++s<n){var l=e[s];t>0&&a(l)?t>1?C(l,t-1,a,r,i):h(i,l):r||(i[i.length]=l)}return i}function T(e,t){return e=Object(e),x(e,t,(function(t,a){return a in e}))}function x(e,t,a){var r=-1,i=t.length,s={};while(++r<i){var n=t[r],l=e[n];a(l,n)&&(s[n]=l)}return s}function k(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var a=arguments,r=-1,i=w(a.length-t,0),s=Array(i);while(++r<i)s[r]=a[t+r];r=-1;var n=Array(t+1);while(++r<t)n[r]=a[r];return n[t]=s,u(e,this,n)}}function I(e){return $(e)||S(e)||!!(g&&e&&e[g])}function N(e){if("string"==typeof e||L(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function S(e){return O(e)&&f.call(e,"callee")&&(!v.call(e,"callee")||b.call(e)==i)}var $=Array.isArray;function j(e){return null!=e&&R(e.length)&&!P(e)}function O(e){return _(e)&&j(e)}function P(e){var t=q(e)?b.call(e):"";return t==s||t==n}function R(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}function q(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function _(e){return!!e&&"object"==typeof e}function L(e){return"symbol"==typeof e||_(e)&&b.call(e)==l}var D=k((function(e,t){return null==e?{}:T(e,m(C(t,1),N))}));e.exports=D}).call(this,a("c8ba"))},9589:function(e,t,a){"use strict";a("7237")},a81f:function(e,t,a){},c03a:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:600,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"系统编码"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["code",e.validatorRules.code],expression:"[ 'code', validatorRules.code]",modifiers:{trim:!0}}]})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"系统名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["name",e.validatorRules.name],expression:"[ 'name', validatorRules.name]",modifiers:{trim:!0}}]})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"短名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["shortName"],expression:"[ 'shortName' ]",modifiers:{trim:!0}}]})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"排序"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sortNum",e.validatorRules.sortNum],expression:"[ 'sortNum',validatorRules.sortNum]"}]})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"备注描述"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark",e.validatorRules.remark],expression:"[ 'remark',validatorRules.remark]"}]})],1)],1)],1)],1)},i=[],s=a("88bc"),n=a.n(s),l=a("8fad"),o=a("4ec3"),c=a("ca00"),d={name:"TrainTypeSysItemModal",props:["trainTypeId"],data:function(){return{value:1,title:"操作",visibleCheck:!0,visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{code:{rules:[{required:!0,message:"请输入内容!"},{validator:this.validateCode},{max:32,message:"输入长度不能超过32字符!"}]},name:{rules:[{required:!0,message:"请输入内容!"},{max:32,message:"输入长度不能超过32字符!"}]},remark:{rules:[{max:255,message:"输入长度不能超过255字符!"}]},sortNum:{rules:[{max:16,message:"输入长度不能超过16字符!"}]}}}},created:function(){},methods:{validateCode:function(e,t,a){var r={tableName:"bu_train_asset_type",fieldName:"code",fieldVal:t,dataId:this.model.id};Object(c["e"])(t)?a():Object(o["m"])(r).then((function(e){e.success?a():a(e.message)}))},add:function(){this.edit({})},edit:function(e){var t=this;this.form.resetFields(),this.model=Object.assign({},e,{trainTypeId:this.trainTypeId}),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue(n()(t.model,"code","name","shortName","remark","sortNum"))}))},handleOk:function(){var e=this;e.form.validateFields((function(t,a){if(!t){e.confirmLoading=!0;var r,i=Object.assign(e.model,a);r=e.model.id?Object(l["rb"])(i):Object(l["r"])(i),r.then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok",e.model.id?e.model:void 0),e.close()):e.$message.error(t.message)})).finally((function(){e.confirmLoading=!1}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},u=d,m=a("2877"),h=Object(m["a"])(u,r,i,!1,null,null,null);t["default"]=h.exports},ddc0:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{id:"trainSysLeftContent"}},[t("div",{staticClass:"typeTitle"},[e._v("系统名称")]),t("a-spin",{attrs:{spinning:e.loading}},[t("div",{staticStyle:{width:"70%",margin:"0px auto","margin-top":"15px","margin-bottom":"10px"}},[t("j-dict-select-tag",{staticClass:"na-display-jselect-clear-btn",staticStyle:{width:"100%"},attrs:{dictCode:"bu_train_type,name,id"},on:{select:e.trainChange},model:{value:e.trainTypeSelectId,callback:function(t){e.trainTypeSelectId=t},expression:"trainTypeSelectId"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"opBtn"},[t("a-config-provider",{attrs:{"auto-insert-space-in-button":!1}},[t("a-button",{attrs:{size:"small"},on:{click:e.handleAdd}},[e._v("新增")])],1),t("a-config-provider",{attrs:{"auto-insert-space-in-button":!1}},[t("a-button",{staticStyle:{"margin-left":"5px"},attrs:{size:"small"},on:{click:e.handleEdit}},[e._v("修改")])],1),t("a-config-provider",{attrs:{"auto-insert-space-in-button":!1}},[t("a-button",{staticStyle:{"margin-left":"5px"},attrs:{size:"small"},on:{click:e.handleDel}},[e._v("删除")])],1)],1),t("div",{staticStyle:{width:"70%",margin:"0 auto"}},[t("a-tree",{attrs:{showLine:"",checkStrictly:"",dropdownStyle:{maxHeight:"200px",overflow:"auto"},replaceFields:{title:"nameAndShortName",key:"id"},treeData:e.treeDataSource,selectedKeys:e.defaultKey},on:{select:e.handleTreeSelect}})],1)]),t("train-type-sys-item-modal",{ref:"modalForm",attrs:{trainTypeId:e.trainTypeSelectId},on:{ok:e.loadData}})],1)},i=[],s=a("8fad"),n=a("c03a"),l=a("ca00"),o={name:"TrainTypeSysCompositionLeft",props:["trainTypeId","value"],components:{TrainTypeSysItemModal:n["default"]},data:function(){return{cardLoading:!0,loading:!1,treeDataSource:[],selectedNode:{},defaultKey:[],tStyle:{"text-align":"center"},trainTypeSelectId:""}},created:function(){this.queryTreeData(),this.trainTypeSelectId=this.trainTypeId},methods:{queryTreeData:function(){var e=this;Object(l["e"])(this.trainTypeSelectId)||Object(s["Qd"])({trainTypeId:this.trainTypeSelectId}).then((function(t){if(t.success){if(t.result&&t.result.length>0){e.$set(e.defaultKey,0,t.result[0].id),e.selectedNode=t.result[0];var a={sysId:t.result[0].id,sysName:e.selectedNode.name,trainTypeId:e.trainTypeSelectId};e.$emit("input",a)}e.treeDataSource=t.result,e.treeDataSource.map((function(e){e.nameAndShortName=e.name+"（简称:"+e.shortName+"）"}))}})).finally((function(){e.loading=!1,e.cardLoading=!1}))},handleTreeSelect:function(e,t){if(e.length>0){this.selectedNode=t.node.dataRef;var a={sysId:t.node.dataRef.id,sysName:t.node.dataRef.name,trainTypeId:this.trainTypeSelectId};this.$emit("input",a),this.$set(this.defaultKey,0,e[0])}else this.selectedNode={},this.defaultKey=[],this.$emit("input",void 0)},handleAdd:function(){this.$refs.modalForm.add(),this.$refs.modalForm.title="新增"},handleEdit:function(){this.selectedNode.id?(this.$refs.modalForm.edit(this.selectedNode),this.$refs.modalForm.title="编辑"):this.$message.error("请先选择一条数据！")},handleDel:function(){var e=this;this.selectedNode.id?this.$confirm({content:"此操作将删除当前系统及其子级数据，是否继续？",okText:"确认",cancelText:"取消",onOk:function(){Object(s["U"])({ids:e.selectedNode.id}).then((function(t){t.success?(e.$message.success(t.message),e.loadData()):e.$message.error(t.message)}))}}):this.$message.error("请先选择一条数据！")},loadData:function(){this.queryTreeData()},trainChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;e&&(this.trainTypeSelectId=e),Object(l["e"])(this.trainTypeSelectId)||this.queryTreeData()}}},c=o,d=(a("7dae"),a("2877")),u=Object(d["a"])(c,r,i,!1,null,null,null);t["default"]=u.exports},f14a2:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{id:"trainSysRightContent"}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchQuery.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"名称"}},[t("a-input",{attrs:{placeholder:"名称或编码","allow-clear":""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"状态"}},[t("j-dict-select-tag",{attrs:{dictCode:"bu_enable"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",[t("span",{staticClass:"table-page-search-submitButtons"},[t("a-space",[t("a-button",{on:{click:e.searchQuery}},[e._v("查询")]),t("a-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增")]),t("a-button",{attrs:{disabled:!(1==e.records.length&&e.records[0].parentId)},on:{click:function(t){return e.handleEdit(e.records[0])}}},[e._v("编辑")]),t("a-button",{attrs:{disabled:e.records.length<1},on:{click:e.handleDel}},[e._v("删除")])],1)],1)])],1)],1)],1),t("div",{staticStyle:{height:"calc(100% - 67px)"}},[t("vxe-table",{ref:"listTable",attrs:{height:"auto",border:"","row-id":"id",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod},"checkbox-config":{trigger:"row",highlight:!0,checkStrictly:!0}},on:{"checkbox-change":e.checkboxChange,"checkbox-all":e.checkboxChange}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{field:"name",title:"名称","tree-node":"",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"code",align:"left","header-align":"center",title:"编码",width:"120"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"100"}}),t("vxe-table-column",{attrs:{field:"structType_dictText",title:"类型",width:"100"}}),t("vxe-table-column",{attrs:{field:"turnover_dictText",title:"是否周转件",width:"100"}})],1)],1),t("train-type-sys-modal",{ref:"modalForm",attrs:{parent:e.selectParent,trainTypeId:e.trainTypeId},on:{ok:function(t){return e.loadData()}}})],1)},i=[],s=a("791d"),n=a("8fad"),l=a("ca00"),o={components:{TrainTypeSysModal:s["default"]},name:"TrainTypeSysCompositionRight",props:["trainTypeId","value"],data:function(){return{records:[],queryParam:{trainTypeId:this.trainTypeId,id:"",searchText:"",status:null,structType:null},queryParamId:"",allAlign:"center",tableData:[],selectTreeNode:[],selectParent:{},parentId:""}},watch:{value:{immediate:!1,handler:function(e){this.queryParam.id=e?e.sysId:"",this.parentId=e?e.sysId:"",this.queryParam.trainTypeId=e?e.trainTypeId:"",this.selectParent=e||{},this.queryParamId="",this.dataSource=[],this.findList()}}},methods:{checkboxChange:function(e){this.records=e.records},findList:function(){var e=this;this.loading=!0,Object(n["Qd"])(this.queryParam).then((function(t){t.success&&(e.loading=!1,e.records=[],e.tableData=t.result)}))},findSelectList:function(){var e=this;Object(n["Qd"])({trainTypeId:this.trainTypeId}).then((function(t){t.success&&(e.loading=!1,e.selectTreeNode=t.result.map((function(t){return e.genSelectTreeNode(t)})))}))},loadChildrenMethod:function(e){var t=this,a=e.row,r={trainTypeId:this.trainTypeId,id:a.id,searchText:this.queryParam.searchText,status:this.queryParam.status};return new Promise((function(e){Object(n["Qd"])(r).then((function(a){a.success?e(a.result):t.$message.error("".concat(a.msg))}))}))},loadSelectNodeMethod:function(e){var t=this,a={trainTypeId:this.trainTypeId,id:e.dataRef.id};return new Promise((function(e){Object(n["Qd"])(a).then((function(e){if(e.success)e.result.map((function(e){t.selectTreeNode=t.selectTreeNode.concat(t.genSelectTreeNode(e))}));else t.$message.warning(e.message)})),e()}))},genSelectTreeNode:function(e){return{id:e.id,pId:e.parentId,value:e.id,title:e.name,isLeaf:!e.hasChildren}},searchQuery:function(){Object(l["e"])(this.queryParamId)?this.queryParam.id=this.parentId:this.queryParam.id=this.queryParamId,this.findList()},handleAdd:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();if(t.length>0){if(1!=t.length)return void this.$message.error("只能选择一个上级节点!");this.selectParent={sysId:t[0].id,sysName:t[0].name}}else this.selectParent=this.value;setTimeout((function(){e.$refs.modalForm.add(),e.$refs.modalForm.title="新增"}),0)},handleEdit:function(e){this.$refs.modalForm.edit(e),this.$refs.modalForm.title="编辑"},handleDel:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();t.length>0?this.$confirm({content:"此操作将删除当前设备及其子级数据，是否继续？",okText:"确认",cancelText:"取消",onOk:function(){var a=t.map((function(e,t){return e.id})).join(",");Object(n["U"])({ids:a}).then((function(t){t.success?(e.$message.success(t.message),e.loadData()):e.$message.error(t.message)}))}}):this.$message.error("尚未选中任何数据!")},loadData:function(){this.findList()},handleBack:function(){this.$emit("close")}}},c=o,d=(a("4065"),a("2877")),u=Object(d["a"])(c,r,i,!1,null,null,null);t["default"]=u.exports}}]);