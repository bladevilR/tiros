(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b75ea18"],{"3cf2":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div")},c=[],o=n("e8ae"),a=n("21a6"),i=n("b7b4"),u="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",l={name:"JobCheckTableExport",data:function(){return{}},props:{},created:function(){},mounted:function(){},methods:{sortArray:function(e){return e.sort(this.compare("sortNo")),e},compare:function(e){return function(t,n){return t[e]-n[e]}},printByRow:function(e){e.itemList=this.sortArray(e.itemList),this.initWorkBook(e)},printById:function(e){var t=this;Object(i["y"])({id:e}).then((function(e){e.success&&(e.result.itemList=t.sortArray(e.result.itemList),t.initWorkBook(e.result))}))},initWorkBook:function(e){var t=new o["Workbook"];t.creator="GY",t.lastModifiedBy="2021-10-28",t.created=new Date,t.modified=new Date,t.lastPrinted=new Date;var n=t.addWorksheet("Sheet1",{properties:{defaultRowHeight:30,defaultColWidth:22},pageSetup:{paperSize:9}});n.addRows([["车辆连挂作业过程检查项点"]]),n.getCell("A2").value="车号："+(e.trainNo||""),n.getCell("D2").value="部件名称："+(e.assetName||""),n.getCell("G2").value="作业周期："+(e.period||""),n.getCell("A3").value="部件编号："+(e.assetNo||""),n.getCell("D3").value="作业位置："+(e.location||""),n.getCell("G3").value="作业班组："+(e.groupName||""),n.getColumn("A").width=15,n.getColumn("B").width=30,n.getColumn("C").width=60,n.mergeCells("A1:J1"),n.mergeCells("A2:C2"),n.mergeCells("D2:F2"),n.mergeCells("G2:J2"),n.mergeCells("A3:C3"),n.mergeCells("D3:F3"),n.mergeCells("G3:J3"),n.addRows([["序号","项点","检查内容","等级","检查情况","结果","作业时间","检查方式","检查人","检查时间"]]);var r=[];(e.itemList||[]).forEach((function(e,t,n){for(var c="",o=0,a=5;o<a;o++)e.checkLevel>o?c+="★":c+="☆";r.push([e.sortNo||"",e.title||"",e.content||"",c,e.checkDesc||"",e.checkUserName?e.checkResult_dictText:"",e.workTime||"",e.checkMethod||"",e.checkUserName||"",e.checkTime||""])})),n.addRows(r);var c=4+(e.itemList||[]).length+1;n.mergeCells("A".concat(c,":J").concat(c)),n.getCell("A".concat(c+1)).value="参考工艺文件",n.mergeCells("A".concat(c+1,":B").concat(c+1)),n.mergeCells("C".concat(c+1,":J").concat(c+1));var i="";(e.techLinkList||[]).forEach((function(e,t,n){i+="".concat(t+1,"、").concat(e.teckBookName).concat(t<n.length-1?"\n":"")})),n.getCell("C".concat(c+1)).value=i;var l=12*((e.techLinkList||[]).length||1)+18,d=c+2;n.mergeCells("A".concat(d,":J").concat(d)),n.mergeCells("A".concat(d+1,":G").concat(d+1)),n.getCell("A".concat(d+1)).value="不合格项汇总",n.getCell("H".concat(d+1)).value="整改情况",n.getCell("I".concat(d+1)).value="复查时间",n.getCell("J".concat(d+1)).value="复查人",(e.rectifyList||[]).forEach((function(e,t,r){n.mergeCells("A".concat(d+t+2,":G").concat(d+t+2)),n.getCell("A".concat(d+t+2)).value=e.itemInfo,n.getCell("H".concat(d+t+2)).value=e.rectifyDesc,n.getCell("I".concat(d+t+2)).value=e.reviewTime,n.getCell("J".concat(d+t+2)).value=e.reviewUserName}));var f=d+(e.rectifyList||[]).length+2;n.mergeCells("A".concat(f,":J").concat(f)),n.getCell("A".concat(f+1)).value="评定",n.mergeCells("A".concat(f+1,":B").concat(f+1)),n.mergeCells("C".concat(f+1,":J").concat(f+1));var s="";(e.judgeList||[]).forEach((function(e,t,n){s+="评定人：".concat(e.jdUserName,"；评定时间：").concat(e.jdTime,"；评定内容：").concat(e.jdContent,"；").concat(t<n.length-1?"\n":"")})),n.getCell("C".concat(f+1)).value=s;var m=12*((e.judgeList||[]).length||1)+18,h=f+2;n.mergeCells("A".concat(h,":J").concat(h));var g=["表中只列出关键项点，检查人员在检查时参照工艺文件标准执行。","检查人员必须对当天作业内容进行检查。","表中所有内容全部现场检查时填写完成，并悬挂于部件上，随部件流转。","作业时间由作业班组填写，其余由检查人员填写。“检查情况”一栏详细记录检查情况；“结果”一栏对检查合格的画“√”不合格的画“×”；“检查方式”一栏写明检查手段，如：目视、测量、操作等。","检查人员对不合格项视情节严重情况开具整改单，及时提出整改意见，并督促整改，整改完成后及时进行复查。","由检查人员、质量工程师及专业工程师对整体作业质量做出最终判定。"];n.getCell("A".concat(h+1)).value="说明",n.mergeCells("A".concat(h+1,":B").concat(h+1)),n.mergeCells("C".concat(h+1,":J").concat(h+1));var C="";g.forEach((function(e,t,n){C+="".concat(t+1,"、").concat(e).concat(t<n.length-1?"\n":"")})),n.getCell("C".concat(h+1)).value=C;var v=12*(g.length||1)+18;n._rows.forEach((function(t,r){n.getRow(r+1).height=c==r?l:f==r?m:h==r?v:30,t._cells.forEach((function(t,o){var a=n.getCell(t._address);a.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},[1,2].indexOf(r)>-1||r-3>=0&&r-3<=e.itemList.length&&[1,2,4].indexOf(o)>-1||c==r&&o>=2||f>r&&d<r&&o<7||f==r&&o>=2||h==r&&o>=2?a.alignment={vertical:"middle",horizontal:"left",wrapText:!0}:a.alignment={vertical:"middle",horizontal:"center",wrapText:!0},[0,1,2,3,d].indexOf(r)>-1?(a.fill={type:"pattern",pattern:"darkGray",fgColor:{argb:"FFe9e9e9"}},a.font={name:"黑体",family:4,size:14,underline:!1,bold:!0}):a.font=r<c&&3==o?{name:"黑体",family:4,size:18,underline:!1,bold:!1}:{name:"黑体",family:4,size:12,underline:!1,bold:!1}}))})),t.xlsx.writeBuffer().then((function(t){var n=new Blob([t],{type:u});a["saveAs"](n,"".concat(e.title,".xlsx"))}))}}},d=l,f=n("2877"),s=Object(f["a"])(d,r,c,!1,null,"188fb66a",null);t["default"]=s.exports},b7b4:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"i",(function(){return o})),n.d(t,"l",(function(){return a})),n.d(t,"c",(function(){return u})),n.d(t,"t",(function(){return l})),n.d(t,"v",(function(){return i})),n.d(t,"n",(function(){return f})),n.d(t,"C",(function(){return s})),n.d(t,"D",(function(){return m})),n.d(t,"p",(function(){return h})),n.d(t,"m",(function(){return C})),n.d(t,"j",(function(){return v})),n.d(t,"w",(function(){return j})),n.d(t,"a",(function(){return y})),n.d(t,"h",(function(){return b})),n.d(t,"k",(function(){return O})),n.d(t,"q",(function(){return k})),n.d(t,"z",(function(){return w})),n.d(t,"r",(function(){return q})),n.d(t,"e",(function(){return A})),n.d(t,"s",(function(){return L})),n.d(t,"B",(function(){return N})),n.d(t,"x",(function(){return x})),n.d(t,"y",(function(){return J})),n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return B})),n.d(t,"o",(function(){return g})),n.d(t,"A",(function(){return D})),n.d(t,"E",(function(){return E})),n.d(t,"g",(function(){return R})),n.d(t,"u",(function(){return d}));var r=n("0fea"),c=function(e){return Object(r["j"])("/quality/rectify/add",e)},o=function(e){return Object(r["j"])("/quality/rectify/delete",e)},a=function(e){return Object(r["j"])("/quality/rectify/edit",e)},i=function(e){return Object(r["d"])("/quality/rectify/page",e)},u=function(e){return Object(r["j"])("/quality/rectify/close",e)},l=function(e){return Object(r["d"])("/quality/rectify/get",e)},d=function(e){return Object(r["d"])("/quality/rectify/getCode",e)},f=function(e){return Object(r["d"])("/quality/measurealert/page",e)},s=function(e){return Object(r["d"])("/quality/measurethreshold/form/page-data-form",e)},m=function(e){return Object(r["j"])("/quality/measurethreshold/threshold/save",e)},h=function(e){return Object(r["d"])("/quality/measurethreshold/threshold/list/".concat(e))},g=function(e){return Object(r["d"])("/serialPlan/plan/forms/online-form/alert-records",{dataRecordId:e})},C=function(e){return Object(r["j"])("/quality/measurethreshold/threshold/edit",e)},v=function(e){return Object(r["j"])("/quality/measurethreshold/threshold/delete",e)},j=function(e){return Object(r["d"])("/quality/measurethreshold/threshold/get",e)},y=function(e){return Object(r["j"])("/quality/leaverecord/add",e)},b=function(e){return Object(r["j"])("/quality/leaverecord/delete",e)},p=function(e){return Object(r["j"])("/quality/leaverecord/close",e)},O=function(e){return Object(r["j"])("/quality/leaverecord/edit",e)},k=function(e){return Object(r["d"])("/quality/leaverecord/page",e)},w=function(e,t){return Object(r["c"])("/quality/leaverecord/workLeaveRecordExport",e,t)},q=function(e){return Object(r["d"])("/quality/record-confirm/list",e)},A=function(e){return Object(r["j"])("/quality/record-confirm/confirm",e)},L=function(e){return Object(r["d"])("/quality/record-confirm/work-record/get",e)},x=function(e){return Object(r["d"])("/serialPlan/plan/forms/check-record/get",e)},J=function(e){return Object(r["d"])("/workcheck/get",e)},B=function(e){return Object(r["j"])("/quality/record-confirm/confirm",e)},N=function(e){return Object(r["d"])("/quality/record-confirm/page",e)},D=function(e){return Object(r["d"])("/quality/record-confirm/page/check-record",e)},E=function(e){return Object(r["j"])("/serialPlan/plan/forms/judge/save",e)},R=function(e){return Object(r["j"])("/serialPlan/plan/forms/judge/delete",e)}}}]);