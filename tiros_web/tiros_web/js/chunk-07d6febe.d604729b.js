(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07d6febe","chunk-8f95e8e6","chunk-2d0c89b7"],{"05d5":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"表单查看-"+e.trainNo+"车 "+e.formName,centered:"",visible:e.visible,width:"100%",footer:null,dialogClass:"fullDialog no-title no-footer",destroyOnClose:!0},on:{cancel:function(t){e.visible=!1}}},[t("div",{staticClass:"table-page-body",staticStyle:{height:"calc(100% - 50px)"}},[t("div",{attrs:{id:"luckysheet"}})])])},n=[],o=a("8fad"),r=a("b9c3"),l=a("7268"),s={name:"FormTemplate",data:function(){return{formName:"",trainNo:"",groupName:"",visible:!1,fileUrl:"",tableData:[],defaultOptions:{container:"luckysheet",title:"sheet",column:26,row:50,lang:"zh",allowEdit:!1,showinfobar:!1,sheetFormulaBar:!1,showsheetbar:!1,showstatisticBar:!0,enableAddRow:!1,enableAddCol:!1,showtoolbar:!1}}},beforeDestroy:function(){luckysheet.destroy()},methods:{initSheet:function(e){var t=JSON.parse(JSON.stringify(this.defaultOptions));t.data=[e],luckysheet.destroy(),luckysheet.create(t)},showModal:function(e){this.formName=e.formObjName,this.groupName=e.groupName,this.loadOnlineFormDetail(e.id,e.formInstId),this.visible=!0},showModal2:function(e,t,a,i){this.formName=e,this.groupName=t,this.loadOnlineFormDetail("task2InstId",a),this.visible=!0},loadOnlineFormDetail:function(e,t){var a=this,i={task2InstId:e,formInstId:t,needValues:!1};Object(r["Q"])(i).then((function(e){if(e.success){var t=e.result;if(a.trainNo=t.trainNo,t&&t.result)try{var i=JSON.parse(t.result);Object(o["rb"])(t.formObjId).then((function(e){if(e.success){var n=JSON.parse(e.result);i&&(n.data=[],n.celldata=luckysheet.transToCellData(i)),a.initSheet(n),setTimeout((function(){l["a"].setRangeConditionalOncell(t.formObjId,t.id)}),200)}else a.$message.error("获取表单模板数据失败")}))}catch(n){return void a.$message.error("转换表单填写结果异常")}else a.$message.error("获取作业表单数据失败")}else a.$message.error("获取记录表内容错误")})).catch((function(e){a.$message.error("获取记录表内容异常")}))}}},c=s,d=(a("5577"),a("2877")),u=Object(d["a"])(c,i,n,!1,null,"7efb72d8",null);t["default"]=u.exports},"27b5":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"预警"}},[t("a-input",{attrs:{placeholder:"预警描述",allowClear:""},model:{value:e.queryParam.alertDescribe,callback:function(t){e.$set(e.queryParam,"alertDescribe",t)},expression:"queryParam.alertDescribe"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"状态"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_work_measure_alert_status"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"测量日期"}},[t("a-date-picker",{staticClass:"datePaddingRight",model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")]),t("a-button",{attrs:{disabled:!e.selectedRow||0!=e.selectedRow.status},on:{click:function(t){return e.handleClose(e.selectedRow)}}},[e._v("修复关闭")]),t("a-button",{attrs:{disabled:!e.selectedRow||0!=e.selectedRow.status},on:{click:function(t){return e.createFault(e.selectedRow)}}},[e._v("转为故障")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(100vh - 225px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(100vh - 225px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0}},on:{"checkbox-change":e.rowSelectChange}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{title:"表单查看","min-width":"150",align:"left","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(a){var i=a.row;return[t("a",{on:{click:function(t){return t.stopPropagation(),e.jumpInfo(i)}}},[e._v(e._s(i.formObjName))])]}}])}),t("vxe-table-column",{attrs:{field:"alertTime",title:"测量时间",width:"160"}}),t("vxe-table-column",{attrs:{field:"groupName",title:"作业工班",width:"120"}}),t("vxe-table-column",{attrs:{field:"taskName",title:"作业工序","min-width":"140",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"80"}}),t("vxe-table-column",{attrs:{field:"alertValue",title:"测量原始值",width:"100"}}),t("vxe-table-column",{attrs:{field:"thresholdValueDesc",title:"阈值",width:"120"}}),t("vxe-table-column",{attrs:{field:"fixedValue",title:"修复值",width:"100"}}),t("vxe-table-column",{attrs:{field:"fixDesc",align:"left","header-align":"center",title:"备注","min-width":"100"}}),t("vxe-table-column",{attrs:{field:"alertMessage",title:"预警描述","min-width":"240",align:"left","header-align":"center"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1),t("warning-off-modal",{ref:"modalForm",on:{ok:function(t){return e.loadData()}}}),t("form-template",{ref:"formTemplate"}),t("BreakdownModal",{ref:"breakdownModal",on:{ok:function(t){return e.loadData()}}})],1)},n=[],o=a("c1df"),r=a.n(o),l=a("b9c3"),s=a("f33f"),c=a("ab7d"),d=a("05d5"),u={name:"WarningOffPage",components:{WarningOffModal:s["default"],FormTemplate:d["default"],BreakdownModal:c["default"]},data:function(){return{date:null,queryParam:{alertDescribe:"",workstationId:"",status:"",alertTime:null,pageNo:1,pageSize:10},totalResult:0,allAlign:"center",tableData:[],count:"",selectedRow:null}},created:function(){this.findList()},methods:{findList:function(){var e=this;this.loading=!0,this.date?this.queryParam.alertTime=r()(this.date).format("YYYY-MM-DD"):this.queryParam.alertTime="",Object(l["x"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},loadData:function(){this.findList()},handleClose:function(e){this.$refs.modalForm.edit(e),this.$refs.modalForm.title="修复关闭"},createFault:function(e){this.$refs.breakdownModal.edit({workOrderId:e.orderId,orderTaskId:e.orderTaskId,formValueId:e.id,formType:2,createType:2,happenTime:e.alertTime,faultDesc:e.alertMessage,phase:1})},jumpInfo:function(e){this.$refs.formTemplate.showModal2(e.formObjName,e.groupName,e.formDataRecordId,e.formObjId)},rowSelectChange:function(){var e=this.$refs.listTable.getCheckboxRecords();e&&1==e.length?this.selectedRow=e[0]:this.selectedRow=null}}},f=u,m=a("2877"),h=Object(m["a"])(f,i,n,!1,null,"0a6744ae",null);t["default"]=h.exports},"51cf":function(e,t,a){},"52d1":function(e,t,a){},5577:function(e,t,a){"use strict";a("52d1")},5633:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("span",[t("a-select",{key:e.key,attrs:{"allow-clear":"",value:e.getValueSting,disabled:e.disabled,placeholder:"线路"},on:{change:e.handleChange,select:e.onSelect}},[t("a-select-option",{attrs:{value:void 0}},[e._v("请选择")]),e._l(e.optionData,(function(a,i){return t("a-select-option",{key:i,attrs:{value:a.lineId}},[t("span",{staticStyle:{display:"inline-block",width:"100%"},attrs:{title:a.lineName}},[e._v(" "+e._s(a.lineName)+" ")])])}))],2)],1)},n=[],o=a("8fad"),r={name:"LineSelectList",props:{value:[String],triggerChange:Boolean,disabled:Boolean,defaultFirst:Boolean},data:function(){return{optionData:[],selectValue:"",key:0}},created:function(){this.findList()},computed:{getValueSting:function(){return null!=this.value?this.value.toString():void 0}},methods:{findList:function(){var e=this;Object(o["wb"])().then((function(t){t.success&&(e.optionData=t.result,e.defaultFirst&&e.optionData&&e.optionData.length>0&&setTimeout((function(){e.$emit("change",e.optionData[0].lineId),e.$emit("input",e.optionData[0].lineId)}),500))}))},handleChange:function(e,t){var a="";if(t&&t.componentOptions.children[0].data&&(a=t.componentOptions.children[0].data.attrs.title),this.$emit("change",e),this.$emit("input",e),this.$emit("changeName",a),this.triggerChange)if(e){var i=this.optionData[t.key];this.$emit("change",e,i)}else this.$emit("change",e,null)},onSelect:function(e,t){if(e){var a=this.optionData[t.data.key];this.$emit("select",e,a)}else this.$emit("select","",null)}}},l=r,s=a("2877"),c=Object(s["a"])(l,i,n,!1,null,"77265147",null);t["default"]=c.exports},7068:function(e,t,a){"use strict";a("51cf")},ab7d:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"故障编辑",width:"100%",centered:"",visible:e.visible,dialogClass:"fullDialog",confirmLoading:e.confirmLoading,cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticStyle:{height:"calc(100vh - 5px)","overflow-y":"auto"}},[e.visible?t("BreakdownFormItem",{ref:"breakdownForm",attrs:{fromWriteReport:e.fromWriteReport,workStationsList:e.workStationsList},on:{ok:e.onSaveOk,fail:e.onSaveFail,cancel:e.onSaveCancel}}):e._e()],1)])},n=[],o=a("d0ca"),r={name:"BreakdownModal",components:{BreakdownFormItem:o["default"]},props:{showWorkStation:{type:Boolean,default:!1},fromWriteReport:{type:Boolean,default:!1}},data:function(){return{visible:!1,confirmLoading:!1,workStationsList:[]}},created:function(){},methods:{setWorkStations:function(e){var t=this;this.workStationsList.length=0,e.forEach((function(e){t.workStationsList.find((function(t){return t.workstationId===e.workstationId}))||t.workStationsList.push(e)}))},add:function(e,t,a){this.edit({workOrderId:e,orderTaskId:t,formType:a,createType:a})},edit:function(e){var t=this;this.visible=!0,this.$nextTick((function(){t.$refs.breakdownForm.edit(e)}))},handleOk:function(){this.confirmLoading=!0,this.$refs.breakdownForm.save()},onSaveOk:function(){this.confirmLoading=!1,this.visible=!1,this.$message.success("保存成功"),this.$emit("ok")},onSaveFail:function(){this.$message.error("保存失败"),this.confirmLoading=!1},onSaveCancel:function(){this.confirmLoading=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.confirmLoading=!1,this.visible=!1}}},l=r,s=(a("7068"),a("2877")),c=Object(s["a"])(l,i,n,!1,null,"12e1d6e2",null);t["default"]=c.exports},f33f:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{centered:"",title:e.title,width:600,bodyStyle:{height:"300px"},visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"新的测量"}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["newValue",e.validatorRules.newValue],expression:"['newValue', validatorRules.newValue]",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{max:999999999,placeholder:"请输入"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"备注描述"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["remark",e.validatorRules.remark],expression:"['remark', validatorRules.remark]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入",maxLength:201,"auto-size":{minRows:3,maxRows:10}}})],1)],1)],1)],1)],1)],1)},n=[],o=(a("c1df"),a("b9c3")),r={name:"WarningOffModal",data:function(){return{title:"操作",visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}},isClose:!1,confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{newValue:{rules:[{required:!0,message:"请输入新的测量内容!"}]},remark:{rules:[{max:200,message:"不能超过200个字符"}]}}}},created:function(){},methods:{changeClose:function(e){this.isClose=e},edit:function(e){var t=this;e.id?this.isClose=!(!e["close"]||1!=e["close"]):this.isClose=!1,this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue({newValue:t.model.newValue,remark:t.model.remark})}))},handleOk:function(){var e=this,t=this;t.form.validateFields((function(a,i){if(!a){t.confirmLoading=!0;var n,r=Object.assign(t.model,i);n=Object(o["g"])(r),n.then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok")):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1,t.close()})),e.visible=!1}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},l=r,s=a("2877"),c=Object(s["a"])(l,i,n,!1,null,"90c5b484",null);t["default"]=c.exports}}]);