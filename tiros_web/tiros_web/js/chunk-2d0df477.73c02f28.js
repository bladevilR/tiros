(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0df477"],{"88de":function(e,r,t){"use strict";t.r(r);var o=function(){var e=this,r=e._self._c;return r("a-modal",{attrs:{title:"导入EXCEL",width:600,visible:e.visible,confirmLoading:e.uploading},on:{cancel:e.handleClose}},[r("a-form-model",{attrs:{form:e.form}},[r("a-row",[r("a-col",[r("a-form-model-item",{attrs:{prop:"fileList",labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"请选择文件"}},[r("a-upload",{attrs:{name:"file",multiple:!1,accept:".xls,.xlsx",fileList:e.form.fileList,remove:e.handleRemove,beforeUpload:e.beforeUpload}},[r("a-button",{attrs:{disabled:e.form.fileList.length>=e.sum}},[r("a-icon",{attrs:{type:"upload"}}),e._v(" 选择导入文件 ")],1)],1)],1)],1),r("a-col",[r("a-form-model-item",{attrs:{prop:"lineId",labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属线路"}},[r("line-select-list",{attrs:{value:e.form.lineId},on:{change:function(r){return e.form.lineId=r}}})],1)],1),r("a-col",[r("a-form-model-item",{attrs:{prop:"repairProgramId",labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属修程"}},[r("j-dict-select-tag",{attrs:{triggerChange:!0,placeholder:"请选择",dictCode:"bu_repair_program,name,id"},model:{value:e.form.repairProgramId,callback:function(r){e.$set(e.form,"repairProgramId",r)},expression:"form.repairProgramId"}})],1)],1),r("a-col",[r("a-form-model-item",{attrs:{prop:"",labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"清除原有线路、修程"}},[r("a-switch",{model:{value:e.form.clear,callback:function(r){e.$set(e.form,"clear",r)},expression:"form.clear"}})],1)],1)],1)],1),r("template",{slot:"footer"},[r("a-button",{on:{click:e.handleClose}},[e._v("关闭")]),r("a-button",{attrs:{type:"primary",disabled:0===e.form.fileList.length||!e.form.lineId||!e.form.repairProgramId,loading:e.uploading},on:{click:e.handleImport}},[e._v(" "+e._s(e.uploading?"导入中...":"开始导入")+" ")])],1)],2)},a=[],i=t("0fea"),l=t("5633");function n(e){return d(e)||f(e)||p(e)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,r){if(e){if("string"==typeof e)return m(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?m(e,r):void 0}}function f(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function d(e){if(Array.isArray(e))return m(e)}function m(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=Array(r);t<r;t++)o[t]=e[t];return o}var c={name:"willChangeImport",components:{LineSelectList:l["default"]},props:{url:{type:String,default:"",required:!1},biz:{type:String,default:"",required:!1},sum:{type:Number,default:1}},data:function(){return{visible:!1,uploading:!1,form:{fileList:[],lineId:void 0,repairProgramId:void 0,clear:!0},uploadAction:"",foreignKeys:"",labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}}},watch:{url:function(e){e&&(this.uploadAction=e)}},created:function(){this.uploadAction=this.url},mounted:function(){},methods:{handleClose:function(){this.visible=!1},show:function(e){Object.assign(this.form,this.$options.data().form),this.uploading=!1,this.visible=!0,this.foreignKeys=e},handleRemove:function(e){var r=this.form.fileList.indexOf(e),t=this.form.fileList;t.splice(r,1),this.fileList=JSON.parse(JSON.stringify(t))},beforeUpload:function(e){return this.form.fileList=[].concat(n(this.form.fileList),[e]),!1},handleImport:function(){var e=this,r=this.form.fileList,t=new FormData;this.biz&&t.append("isSingleTableImport",this.biz),this.foreignKeys&&this.foreignKeys.length>0&&t.append("foreignKeys",this.foreignKeys),r.forEach((function(e){t.append("file",e)})),t.append("lineId",this.form.lineId),t.append("repairProgramId",this.form.repairProgramId),t.append("clear",this.form.clear),this.uploading=!0,Object(i["j"])(this.uploadAction,t).then((function(r){e.uploading=!1,r.success?(e.$message.success(r.message),e.visible=!1,e.$emit("ok"),Object.assign(e.form,e.$options.data().form)):e.$message.error(r.message)}))}}},u=c,h=t("2877"),b=Object(h["a"])(u,o,a,!1,null,"15090af3",null);r["default"]=b.exports}}]);