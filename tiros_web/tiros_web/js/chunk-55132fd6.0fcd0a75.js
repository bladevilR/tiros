(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-55132fd6"],{1175:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",bodyStyle:{height:"60vh"},destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[e._t("title",(function(){return[t("div",{staticClass:"limitTitle"},[e._v("上级结构选择")])]})),t("div",{staticClass:"limitHeight"},[t("vxe-table",{ref:"listTable",attrs:{border:"","row-id":"id",align:e.allAlign,data:e.tableData,"show-overflow":"ellipsis","edit-config":{trigger:"manual",mode:"row"},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"5%"}}),t("vxe-table-column",{attrs:{field:"name",title:"名称","tree-node":""}}),t("vxe-table-column",{attrs:{field:"code",title:"编码",width:"15%"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"10%"}}),t("vxe-table-column",{attrs:{field:"structType_dictText",title:"类型",width:"10%"}}),t("vxe-table-column",{attrs:{field:"placeCode",title:"位置编码",width:"15%"}}),t("vxe-table-column",{attrs:{field:"placeDesc",title:"位置描述",width:"15%"}})],1)],1)],2)},s=[],i=a("8fad"),l={name:"SelectParent",props:{trainStructId:{type:String,default:""},multiple:{type:Boolean,default:!0}},data:function(){return{queryParam:{trainStructId:"",id:""},allAlign:"center",tableData:[],selectTreeNode:[],visible:!1,confirmLoading:!1}},methods:{showModal:function(){this.visible=!0,this.queryParam.trainStructId=this.trainStructId,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.close()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,this.queryParam.id=""},findList:function(e){var t=this;this.loading=!0,Object(i["ec"])(this.queryParam).then((function(e){e.success&&(t.loading=!1,t.tableData=e.result)}))},loadChildrenMethod:function(e){var t=this,a=e.row;return this.queryParam.id=a.id,new Promise((function(e){Object(i["ec"])(t.queryParam).then((function(a){a.success?e(a.result):t.$message.error("".concat(a.message))}))}))}}},o=l,n=(a("a743"),a("2877")),c=Object(n["a"])(o,r,s,!1,null,"286ea981",null);t["default"]=c.exports},"2cb5":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",centered:"",title:e.title,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchQuery.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"名称"}},[t("a-input",{attrs:{placeholder:"名称或编码","allow-clear":""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"状态"}},[t("j-dict-select-tag",{attrs:{dictCode:"bu_enable"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",{attrs:{md:3,sm:12}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-button",{on:{click:e.searchQuery}},[e._v("查询")])],1)])],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 85px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 85px)"},attrs:{border:"","max-height":"100%","row-id":"id",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row",checkMethod:e.checkRadioMethod},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,checkMethod:e.checkRadioMethod}:{},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"name",title:"名称","tree-node":"",align:"left"}}),t("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"code",title:"编码",width:"15%"}}),t("vxe-table-column",{attrs:{field:"structType_dictText",title:"类型",width:"10%"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"10%"}}),t("vxe-table-column",{attrs:{field:"placeCode",title:"位置编码",width:"15%"}}),t("vxe-table-column",{attrs:{field:"placeDesc",title:"位置描述",width:"15%"}})],1)],1)])},s=[],i=a("8fad"),l={name:"TrainAssetType",props:{trainTypeId:{type:String,default:""},parentId:{type:String,default:null},multiple:{type:Boolean,default:!0},title:{type:String,default:"设备类型选择"},canSelectType:{type:Array,default:function(){return[1,2,3,4]}}},data:function(){return{queryParam:{trainTypeId:"",id:"",searchText:"",status:null,structType:null},allAlign:"center",tableData:[],treeData:[],selectParent:"",visible:!1,confirmLoading:!1}},mounted:function(){},methods:{showModal:function(){this.visible=!0,this.queryParam.trainTypeId=this.trainTypeId,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.$emit("cancel"),this.close()},close:function(){this.$emit("close"),this.visible=!1},findList:function(){var e=this;this.loading=!0,this.parentId&&(this.queryParam.id=this.parentId),this.selectParent&&(this.queryParam.id=this.selectParent),Object(i["gd"])(this.queryParam).then((function(t){t.success&&(e.loading=!1,e.tableData=t.result)}))},findSelectList:function(){var e=this,t={id:this.parentId,trainTypeId:this.trainTypeId};this.parentId&&(t.id=this.parentId),Object(i["gd"])(t).then((function(t){t.success&&(e.loading=!1,e.treeData=t.result.map((function(t){return e.genSelectTreeNode(t)})))}))},loadChildrenMethod:function(e){var t=this,a=e.row,r={trainTypeId:this.trainTypeId,id:a.id};return new Promise((function(e){Object(i["gd"])(r).then((function(a){a.success?e(a.result):t.$message.error("".concat(a.msg))}))}))},loadSelectNodeMethod:function(e){var t=this,a={trainTypeId:this.trainTypeId,id:e.dataRef.id,searchText:this.queryParam.searchText,status:this.queryParam.status,structType:this.queryParam.structType};return new Promise((function(e){Object(i["gd"])(a).then((function(e){e.success?e.result.map((function(e){t.treeData=t.treeData.concat(t.genSelectTreeNode(e))})):t.$message.warning(e.message)})),e()}))},genSelectTreeNode:function(e){return{id:e.id,pId:e.parentId,value:e.id,title:e.name,isLeaf:!e.hasChildren}},searchQuery:function(){this.findList()},checkRadioMethod:function(e){var t=e.row;return this.canSelectType.indexOf(t.structType)>-1}}},o=l,n=(a("9589"),a("2877")),c=Object(n["a"])(o,r,s,!1,null,"52968c59",null);t["default"]=c.exports},4564:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-drawer",{attrs:{title:e.title,width:800,maskClosable:!0,closable:!0,visible:e.visible},on:{close:e.handleCancel}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{staticStyle:{width:"100%"}},[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"上级结构"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["parentName",e.validatorRules.parentName],expression:"['parentName', validatorRules.parentName]",modifiers:{trim:!0}}],ref:"myParentSelect",attrs:{placeholder:"请选择上级结构",open:!1,showArrow:!0,disabled:!0},on:{focus:e.openParentModal}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"设备类型"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["assetTypeName",e.validatorRules.assetTypeName],expression:"['assetTypeName', validatorRules.assetTypeName]",modifiers:{trim:!0}}],ref:"mySelect",attrs:{placeholder:"请选择设备类型",open:!1,showArrow:!0},on:{focus:e.openModal}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1)],1),t("a-row",{staticStyle:{width:"100%"}},[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属类型"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["structType",e.validatorRules.structType],expression:"[ 'structType', validatorRules.structType ]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,placeholder:"请选择",dictCode:"bu_train_asset_type"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"结构编码"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["code",e.validatorRules.code],expression:"[ 'code', validatorRules.code]",modifiers:{trim:!0}}],attrs:{maxLength:33,placeholder:"结构编码"}})],1)],1)],1),t("a-row",{staticStyle:{width:"100%"}},[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"结构名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["name",e.validatorRules.name],expression:"[ 'name', validatorRules.name]",modifiers:{trim:!0}}],attrs:{maxLength:33,placeholder:"结构名称"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"短名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["shortName",e.validatorRules.shortName],expression:"[ 'shortName', validatorRules.shortName ]",modifiers:{trim:!0}}],attrs:{maxLength:33,placeholder:"短名称"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"排序"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["sortNo",e.validatorRules.sortNo],expression:"[ 'sortNo', validatorRules.sortNo]",modifiers:{trim:!0}}],attrs:{maxLength:17,placeholder:"排序"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属位置"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["placeId",e.validatorRules.placeId],expression:"['placeId', validatorRules.placeId]",modifiers:{trim:!0}}],attrs:{maxLength:33,placeholder:"请输入内容"}})],1)],1)],1),t("a-row",{staticStyle:{width:"100%"}},[t("a-col",{attrs:{span:24}},[t("a-form-item",{attrs:{labelCol:e.labelColX1,wrapperCol:e.wrapperColX1,label:"位置描述"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["placeDesc",e.validatorRules.placeDesc],expression:"[ 'placeDesc', validatorRules.placeDesc]",modifiers:{trim:!0}}],attrs:{maxLength:65,placeholder:"请输入内容"}})],1)],1)],1),t("a-row",{staticStyle:{width:"100%"}},[t("a-col",{attrs:{span:24}},[t("a-col",{attrs:{span:8}},[t("a-form-item",{attrs:{labelCol:e.labelCol1,wrapperCol:e.wrapperCol1,label:"是否虚拟"}},[t("a-switch",{on:{change:e.changeStatusS},model:{value:e.switchChecked.subjunctive,callback:function(t){e.$set(e.switchChecked,"subjunctive",t)},expression:"switchChecked.subjunctive"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-item",{attrs:{labelCol:e.labelCol1,wrapperCol:e.wrapperCol1,label:"是否周转件"}},[t("a-switch",{on:{change:e.changeStatusT},model:{value:e.switchChecked.turnover,callback:function(t){e.$set(e.switchChecked,"turnover",t)},expression:"switchChecked.turnover"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-item",{attrs:{labelCol:e.labelCol1,wrapperCol:e.wrapperCol1,label:"是否有效"}},[t("a-switch",{on:{change:e.changeStatus},model:{value:e.switchChecked.status,callback:function(t){e.$set(e.switchChecked,"status",t)},expression:"switchChecked.status"}})],1)],1)],1)],1),t("a-row",{staticStyle:{width:"100%"}},[t("a-row",{staticStyle:{width:"100%"}},[t("a-col",{attrs:{span:24}},[t("a-form-item",{attrs:{labelCol:e.labelColX1,wrapperCol:e.wrapperColX1,label:"备注"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark",e.validatorRules.remark],expression:"[ 'remark', validatorRules.remark]"}],attrs:{maxLength:201}})],1)],1)],1)],1)],1),t("div",{staticClass:"drawer-bootom-button"},[t("a-popconfirm",{attrs:{title:"确定放弃编辑？",okText:"确定",cancelText:"取消"},on:{confirm:e.handleCancel}},[t("a-button",{staticStyle:{"margin-right":".8rem"}},[e._v("取消")])],1),t("a-button",{attrs:{type:"primary",loading:e.confirmLoading},on:{click:e.handleOk}},[e._v("提交")])],1),t("train-asset-type",{ref:"selectModal",attrs:{multiple:!1,trainTypeId:""!==e.trainTypeId&&null!=e.trainTypeId?e.trainTypeId:e.parent.trainTypeId},on:{ok:e.selectAssetType}}),t("select-parent",{ref:"selectParentModal",attrs:{multiple:!1,trainStructId:e.trainStructId},on:{ok:e.selectParent}})],1)},s=[],i=a("8fad"),l=a("2cb5"),o=a("1175"),n=a("4ec3"),c=a("ca00"),d={name:"RightItemModal",props:["trainStructId","trainTypeId","parent"],components:{TrainAssetType:l["default"],SelectParent:o["default"]},data:function(){return{value:1,title:"操作",visible:!1,trainType:"",trainStruct:"",structType_dictText:"",model:{},switchChecked:{turnover:!1,subjunctive:!1,status:!1},sortNo:"",parentName:"",parentId:"",assetTypeId:"",hasLabel:!1,typeTreeNode:[],labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}},labelCol1:{xs:{span:24},sm:{span:12}},wrapperCol1:{xs:{span:24},sm:{span:12}},labelColX1:{xs:{span:24},sm:{span:3}},wrapperColX1:{xs:{span:24},sm:{span:21}},labelColX2:{xs:{span:24},sm:{span:12}},wrapperColX2:{xs:{span:24},sm:{span:12}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{code:{rules:[{required:!0,message:"请输入结构编码!"},{validator:this.validateCode},{max:32,message:"输入长度不能超过32字符!"}]},name:{rules:[{required:!0,message:"请输入结构名称!"},{max:32,message:"输入长度不能超过32字符!"}]},shortName:{rules:[{required:!0,message:"请输入短名称!"},{max:32,message:"输入长度不能超过32字符!"}]},sortNo:{rules:[{max:16,message:"输入长度不能超过16字符!"}]},structType:{rules:[{required:!0,message:"请选择所属类型!"}]},assetTypeName:{rules:[{required:!0,message:"请选择设备类型!"}]},placeId:{rules:[{max:32,message:"输入长度不能超过32字符!"}]},placeDesc:{rules:[{max:64,message:"输入长度不能超过64字符!"}]},remark:{rules:[{max:200,message:"输入长度不能超过200字符!"}]},parentName:{rules:[]}}}},watch:{trainStructId:{immediate:!0,handler:function(e){this.trainStruct=e}}},methods:{validateCode:function(e,t,a){var r={tableName:"bu_train_structure_detail",fieldName:"code",fieldVal:t,dataId:this.model.id,filterFields:[{name:"train_struct_id",val:this.trainStruct}]};Object(c["e"])(t)?a():Object(n["m"])(r).then((function(e){e.success?a():a(e.message)}))},openModal:function(){this.$refs.selectModal.showModal(),this.$refs.mySelect.blur()},selectAssetType:function(e){var t=this;this.$nextTick((function(){t.form.setFieldsValue({assetTypeName:e[0].name,structType:e[0].structType})})),this.structType_dictText=e[0].structType_dictText,this.structType=e[0].structType,this.assetTypeId=e[0].id},openParentModal:function(){this.$refs.selectParentModal.showModal(),this.$refs.myParentSelect.blur()},selectParent:function(e){this.form.setFieldsValue({parentName:e[0].name}),this.parentId=e[0].id},changeStatusS:function(e){this.switchChecked.subjunctive=e},changeStatusT:function(e){this.switchChecked.turnover=e},changeStatus:function(e){this.switchChecked.status=e},add:function(){this.switchChecked.turnover=!1,this.switchChecked.subjunctive=!1,this.switchChecked.status=!0,this.edit({})},edit:function(e){var t=this;if(e.id)for(var a in this.hasLabel=!0,this.assetTypeId=e.assetTypeId,this.parentId=e.parentId,this.parentName=e.parentName,this.trainStruct=e.trainStructId,this.switchChecked)this.switchChecked[a]=!!e[a];else this.assetTypeId="",this.parentId=this.parent.id,this.parentName=this.parent.name,Object(c["e"])(this.parent)?this.trainStruct=this.trainStructId:this.trainStruct=this.parent.trainStructId;this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue({code:t.model.code,name:t.model.name,shortName:t.model.shortName,placeId:t.model.placeId,placeDesc:t.model.placeDesc,structType:t.model.structType,assetTypeName:t.model.assetTypeName,initNum:t.model.initNum,parentName:t.parentName,remark:t.model.remark,sortNo:t.model.sortNo})}))},handleOk:function(){var e=this,t=this;t.form.validateFields((function(a,r){if(!a){t.confirmLoading=!0;var s={};for(var l in t.switchChecked)t.$set(s,l,t.switchChecked[l]?1:0);var o,n=Object.assign(t.model,r,s,{trainStructId:e.trainStruct,assetTypeId:e.assetTypeId,parentId:e.parentId,structType_dictText:e.structType_dictText},t.selectTargetId);o=t.model.id?Object(i["ib"])(n):Object(i["p"])(n),o.then((function(e){e.success?(t.$message.success(e.message),t.close(),t.$emit("ok")):t.$message.error(e.message)})).finally((function(){t.confirmLoading=!1}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},u=d,h=(a("9203"),a("2877")),m=Object(h["a"])(u,r,s,!1,null,"1d3d9bb6",null);t["default"]=m.exports},7237:function(e,t,a){},9203:function(e,t,a){"use strict";a("b90a")},9589:function(e,t,a){"use strict";a("7237")},a743:function(e,t,a){"use strict";a("db1d")},b90a:function(e,t,a){},db1d:function(e,t,a){}}]);