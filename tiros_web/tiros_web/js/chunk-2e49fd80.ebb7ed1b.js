(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e49fd80","chunk-4def5374"],{"0c04":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:t.title,visible:t.visible,confirmLoading:t.confirmLoading,cancelText:"关闭",destroyOnClose:!0,centered:""},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("a-spin",{attrs:{spinning:t.confirmLoading}},[e("a-form",{attrs:{form:t.form}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"标题"}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["title",t.validatorRules.title],expression:"[ 'title', validatorRules.title]",modifiers:{trim:!0}}]})],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"车辆设备"}},[e("div",{on:{click:t.openAssetSelectModal}},[e("a-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["trainStructName",t.validatorRules.trainStructName],expression:"['trainStructName', validatorRules.trainStructName]",modifiers:{trim:!0}}],ref:"trainAssetSelect",staticStyle:{width:"100%"},attrs:{placeholder:"请选择作业目标设备",open:!1}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)])],1)],1)],1),e("CarDeviceSelectNew",{ref:"trainAssetSelectModal",attrs:{trainNo:t.trainNo,lineId:t.lineId,multiple:!1,canSelectType:[2,3,4]},on:{ok:t.onTrainAssetSelect,cancel:t.onCancelTrainAssetSelect}})],1)],1)},r=[],l=a("310d"),n=a("b47d"),s={name:"TaskFormEditModel",components:{CarDeviceSelectNew:l["default"]},props:["lineId","trainNo"],data:function(){return{title:"编辑",visible:!1,trainStructId:"",model:{},confirmLoading:!1,form:this.$form.createForm(this),labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}},validatorRules:{title:{rules:[{required:!0,message:"请输入标题!"},{max:64,message:"输入长度不能超过64字符!"}]},trainStructName:{rules:[{required:!0,message:"请选择车辆设备!"}]}}}},methods:{edit:function(t){var e=this;this.form.resetFields(),this.model=Object.assign({},t),this.visible=!0,this.$nextTick((function(){e.form.setFieldsValue({title:e.model.title,trainStructName:e.model.structDetailName}),e.trainStructId=e.model.trainStructId}))},handleOk:function(){var t=this;t.form.validateFields((function(e,a){if(!e){t.confirmLoading=!0;var i=Object.assign(t.model,a,{trainStructId:t.trainStructId,formType:t.model.formType});Object(n["Rb"])(i).then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok"),t.close()):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1}))}}))},openAssetSelectModal:function(){this.$refs.trainAssetSelectModal.showModal()},onTrainAssetSelect:function(t){var e=this;if(t.length){var a=t[0];this.trainStructId=a.id,this.$nextTick((function(){e.form.setFieldsValue({trainStructName:a.assetName})}))}},onCancelTrainAssetSelect:function(){},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},o=s,c=a("2877"),d=Object(c["a"])(o,i,r,!1,null,"5f227585",null);e["default"]=d.exports},"310d":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",[e("a-modal",{attrs:{title:"车辆设备选择",width:"80%",bodyStyle:{height:"83vh"},visible:t.visible,confirmLoading:t.confirmLoading,closable:!0,centered:"",destroyOnClose:!0},on:{ok:t.handleOk,cancel:t.close}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchQuery.apply(null,arguments)}}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"名称"}},[e("a-input",{attrs:{placeholder:"名称或编码"},model:{value:t.queryParam.title,callback:function(e){t.$set(t.queryParam,"title",e)},expression:"queryParam.title"}})],1)],1),e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"线路"}},[e("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"bu_mtr_line,line_name,line_id"},on:{change:t.changeLine},model:{value:t.lineId_A,callback:function(e){t.lineId_A=e},expression:"lineId_A"}})],1)],1),e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"车辆"}},[e("j-dict-select-seach-tag",{attrs:{triggerChange:!0,dictCode:t.dictTrainStr},model:{value:t.trainNo_A,callback:function(e){t.trainNo_A=e},expression:"trainNo_A"}})],1)],1),e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"状态"}},[e("j-dict-select-tag",{attrs:{triggerChange:!0,placeholder:"请选择状态",dictCode:"bu_valid_status"},model:{value:t.queryParam.status,callback:function(e){t.$set(t.queryParam,"status",e)},expression:"queryParam.status"}})],1)],1),e("a-col",{attrs:{md:5,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[e("a-space",[e("a-button",{on:{click:t.searchQuery}},[t._v("查询")])],1)],1)])],1)],1)],1),e("div",{staticClass:"tableHeight"},[e("vxe-table",{ref:"listTable",attrs:{border:"",resizable:"","row-id":"id",align:t.allAlign,height:"auto",data:t.tableData,"show-overflow":"tooltip","max-height":"100%","radio-config":{trigger:t.multiple?"default":"row",highlight:!0,checkMethod:t.checkRadioMethod},"checkbox-config":{trigger:t.multiple?"row":"default",highlight:!0,checkStrictly:!0,checkMethod:t.checkRadioMethod},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:t.loadChildrenMethod}}},[t.multiple?e("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}):e("vxe-table-column",{attrs:{type:"radio",width:"40",fixed:"left"}}),e("vxe-table-column",{attrs:{field:"name",title:"名称","tree-node":"",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"code",title:"编码",width:"180"}}),e("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",align:"center","header-align":"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){var i=a.row;return[e("div",{style:{backgroundColor:t.statusColor[i.status+""],borderRadius:"4px"}},[t._v(" "+t._s(i.status_dictText)+" ")])]}}])}),e("vxe-table-column",{attrs:{field:"maximoAssetType",title:"maximo设备类型",width:"150",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{field:"locationName",title:"位置",width:"400",align:"left","header-align":"center"}})],1)],1)])],1)},r=[],l=a("8fad"),n={props:{multiple:{type:Boolean,default:!0},trainNo:{type:[Number,String]},lineId:{type:[Number,String]}},data:function(){return{statusColor:{0:"#dedede",1:"#bad795"},dictTrainStr:"",trainNo_A:void 0,lineId_A:void 0,allAlign:"center",tableData:[],visible:!1,confirmLoading:!1,queryParam:{trainNo:"",searchText:"",status:1}}},created:function(){},methods:{changeLine:function(t,e){this.dictTrainStr="",t&&(this.dictTrainStr="bu_train_info,train_no,train_no,line_id="+t+"|train_struct_id")},checkRadioMethod:function(t){t.row;return!0},searchQuery:function(){this.findList()},loadChildrenMethod:function(t){var e=this,a=t.row,i={trainNo:this.trainNo_A,parentId:a.id,searchText:this.queryParam.searchText,status:this.queryParam.status};return new Promise((function(t){Object(l["kc"])(i).then((function(a){a.success?t(a.result):e.$message.error("".concat(a.msg))}))}))},handleOk:function(){var t=[];this.multiple?t=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&t.push(this.$refs.listTable.getRadioRecord()),Array.from(t,(function(t,e){t.assetName=t.name})),this.$emit("ok",t),this.visible=!1},showModal:function(){this.visible=!0,this.lineId_A=this.lineId,this.trainNo_A=this.trainNo,this.findList()},close:function(){this.visible=!1},findList:function(){var t=this;this.queryParam.trainNo=this.trainNo_A,this.loading=!0,Object(l["kc"])(this.queryParam).then((function(e){e.success&&(t.loading=!1,t.tableData=e.result)}))}}},s=n,o=(a("4677"),a("2877")),c=Object(o["a"])(s,i,r,!1,null,"3967f3d4",null);e["default"]=c.exports},"412f":function(t,e,a){},4677:function(t,e,a){"use strict";a("412f")}}]);