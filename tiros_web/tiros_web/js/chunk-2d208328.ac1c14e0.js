(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d208328"],{a487:function(e,a,t){"use strict";t.r(a);var l=function(){var e=this,a=e._self._c;return a("a-modal",{attrs:{title:e.title,width:900,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form-model",{ref:"form",attrs:{model:e.model,rules:e.validatorRules,"label-col":{span:6},"wrapper-col":{span:16}}},[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"项目名称",prop:"projectName"}},[a("a-input",{attrs:{placeholder:"请输入项目名称"},model:{value:e.model.projectName,callback:function(a){e.$set(e.model,"projectName",a)},expression:"model.projectName"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"计划ID"}},[a("a-input",{attrs:{placeholder:"请输入计划ID"},model:{value:e.model.planId,callback:function(a){e.$set(e.model,"planId",a)},expression:"model.planId"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"车号"}},[a("a-input",{attrs:{placeholder:"请输入车号"},model:{value:e.model.trainNo,callback:function(a){e.$set(e.model,"trainNo",a)},expression:"model.trainNo"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"车型"}},[a("a-input",{attrs:{placeholder:"请输入车型"},model:{value:e.model.trainType,callback:function(a){e.$set(e.model,"trainType",a)},expression:"model.trainType"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:24}},[a("a-form-model-item",{attrs:{label:"数据汇总","label-col":{span:3},"wrapper-col":{span:20}}},[a("a-space",[a("a-button",{attrs:{type:"dashed",icon:"sync",loading:e.refreshLoading},on:{click:e.handleAutoRefresh}},[e._v("自动汇总")]),a("span",{staticStyle:{color:"rgba(0, 0, 0, 0.45)"}},[e._v("根据计划ID+车号自动汇总工单与质量问题数据")])],1)],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"质量等级"}},[a("a-select",{attrs:{placeholder:"请选择质量等级"},model:{value:e.model.qualityLevel,callback:function(a){e.$set(e.model,"qualityLevel",a)},expression:"model.qualityLevel"}},[a("a-select-option",{attrs:{value:"A"}},[e._v("A")]),a("a-select-option",{attrs:{value:"B"}},[e._v("B")]),a("a-select-option",{attrs:{value:"C"}},[e._v("C")]),a("a-select-option",{attrs:{value:"D"}},[e._v("D")])],1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"进度"}},[a("a-input",{attrs:{placeholder:"请输入进度(%)"},model:{value:e.model.progress,callback:function(a){e.$set(e.model,"progress",a)},expression:"model.progress"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"已完成工序数"}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:e.model.completedProcesses,callback:function(a){e.$set(e.model,"completedProcesses",a)},expression:"model.completedProcesses"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"总工序数"}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:e.model.totalProcesses,callback:function(a){e.$set(e.model,"totalProcesses",a)},expression:"model.totalProcesses"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"质量问题数"}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:e.model.qualityIssues,callback:function(a){e.$set(e.model,"qualityIssues",a)},expression:"model.qualityIssues"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"未关闭问题数"}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:e.model.openIssues,callback:function(a){e.$set(e.model,"openIssues",a)},expression:"model.openIssues"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:24}},[a("a-form-model-item",{attrs:{label:"工序流程(JSON)","label-col":{span:3},"wrapper-col":{span:20}}},[a("a-textarea",{attrs:{rows:3,placeholder:"请输入工序流程JSON"},model:{value:e.model.processFlow,callback:function(a){e.$set(e.model,"processFlow",a)},expression:"model.processFlow"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:24}},[a("a-form-model-item",{attrs:{label:"质检点(JSON)","label-col":{span:3},"wrapper-col":{span:20}}},[a("a-textarea",{attrs:{rows:3,placeholder:"请输入质检点JSON"},model:{value:e.model.qualityPoints,callback:function(a){e.$set(e.model,"qualityPoints",a)},expression:"model.qualityPoints"}})],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:24}},[a("a-form-model-item",{attrs:{label:"备注","label-col":{span:3},"wrapper-col":{span:20}}},[a("a-textarea",{attrs:{rows:2,placeholder:"请输入备注"},model:{value:e.model.remark,callback:function(a){e.$set(e.model,"remark",a)},expression:"model.remark"}})],1)],1)],1)],1)],1)],1)},o=[],s=t("8fad"),r={name:"QualityVisualModal",data:function(){return{title:"",visible:!1,confirmLoading:!1,refreshLoading:!1,model:{},validatorRules:{projectName:[{required:!0,message:"请输入项目名称",trigger:"blur"}]}}},methods:{add:function(){this.title="新增质量可视化",this.visible=!0,this.model={trainType:"电客车",qualityLevel:"A",completedProcesses:0,totalProcesses:0,qualityIssues:0,openIssues:0}},edit:function(e){this.title="编辑质量可视化",this.visible=!0,this.model=Object.assign({},e)},handleAutoRefresh:function(){var e=this;this.model.planId&&this.model.trainNo?(this.refreshLoading=!0,Object(s["fd"])({planId:this.model.planId,trainNo:this.model.trainNo,trainType:this.model.trainType,projectName:this.model.projectName}).then((function(a){a.success&&a.result?(e.model=Object.assign({},e.model,a.result),e.$message.success("自动汇总成功，已回填数据")):e.$message.error(a.message||"自动汇总失败")})).finally((function(){e.refreshLoading=!1}))):this.$message.warning("请先输入计划ID和车号")},handleOk:function(){var e=this;this.$refs.form.validate((function(a){if(a){if(e.model.completedProcesses>e.model.totalProcesses)return void e.$message.warning("已完成工序数不能大于总工序数");e.confirmLoading=!0;var t=e.model.id?Object(s["Ud"])(e.model):Object(s["td"])(e.model);t.then((function(a){a.success?(e.$message.success(e.model.id?"修改成功":"新增成功"),e.visible=!1,e.$emit("ok")):e.$message.error(a.message||"操作失败")})).finally((function(){e.confirmLoading=!1}))}}))},handleCancel:function(){this.visible=!1,this.$refs.form.resetFields()}}},n=r,i=t("2877"),m=Object(i["a"])(n,l,o,!1,null,null,null);a["default"]=m.exports}}]);