(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a287119","chunk-8f94e15e","chunk-8b53dbe6","chunk-cfac6c42","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0d7a63"],{1158:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:"工位选择",centered:"",bodyStyle:{height:"80vh"},visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{staticStyle:{"border-right":"1px dotted #D3E1F1",height:"calc(80vh - 20px)","margin-right":"8px",padding:"0px"},attrs:{md:4,sm:24}},[e.treeData.length?t("a-tree",{attrs:{defaultExpandAll:"","tree-data":e.treeData,"default-selected-keys":e.defaultKey,dropdownStyle:{maxHeight:"200px",overflow:"auto"},replaceFields:{title:"name",key:"id"}},on:{select:e.onSelect}}):e._e()],1),t("a-col",{attrs:{md:19,sm:24}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getWorkStation.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"工位"}},[t("a-input",{attrs:{placeholder:"请输入工位名称","allow-clear":""},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"班组"}},[t("j-dict-select-tag",{attrs:{dictCode:"sys_depart,depart_name,id,org_category=4",placeholder:"请选择"},model:{value:e.queryParam.groupId,callback:function(t){e.$set(e.queryParam,"groupId",t)},expression:"queryParam.groupId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-space",[t("a-button",{on:{click:e.getWorkStation}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticClass:"limitHeight"},[t("vxe-table",{ref:"listTable",staticStyle:{height:"100%"},attrs:{border:"","row-id":"id",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"},"radio-config":{trigger:"row"},"checkbox-config":{trigger:"row",highlight:!0,range:!0,checkStrictly:!0},"max-height":"100%"}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"stationNo",title:"工位号",width:"100"}}),t("vxe-table-column",{attrs:{field:"name",title:"工位名称",width:"20%",align:"left"}}),t("vxe-table-column",{attrs:{field:"groupName",title:"所属班组",width:"20%",align:"left"}}),t("vxe-table-column",{attrs:{field:"location",title:"位置",width:"100",align:"left"}}),t("vxe-table-column",{attrs:{field:"content",title:"作业内容",width:"25%",align:"left"}}),t("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"10%",align:"left"}})],1)],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.page.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)],1)],1)},r=[],n=a("8fad"),l={name:"WorkStationList",props:{multiple:{type:Boolean,default:!1},groupId:{type:String,default:null}},data:function(){return{visible:!1,confirmLoading:!1,treeData:[],tableData:[],allAlign:"center",defaultKey:[],queryParam:{id:"",name:"",groupId:"",pageNo:1,pageSize:10},page:{currentPage:1,pageSize:10,totalResult:3}}},mounted:function(){this.groupId&&(this.queryParam.groupId=this.groupId)},methods:{showModal:function(){this.visible=!0,this.getTreeList()},getTreeList:function(){var e=this;Object(n["fc"])().then((function(t){t.success&&(e.treeData=t.result,e.defaultKey[0]=t.result[0].id,e.queryParam.id=t.result[0].id,e.getWorkStation())}))},getWorkStation:function(){var e=this;Object(n["ec"])(this.queryParam).then((function(t){e.page.totalResult=t.result.total,e.tableData=t.result.records}))},onSelect:function(e,t){var a=t.node.dataRef;e.length>0&&(this.queryParam.id=a.id,this.queryParam.pageNo=1,this.getWorkStation())},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.getTreeList()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},s=l,o=(a("7483"),a("2877")),c=Object(o["a"])(s,i,r,!1,null,"ea42f1f8",null);t["default"]=c.exports},"1a6f":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",[t("div",{style:e.containerHeightStyle},[t("div",{staticClass:"info-wrapper info-top-wrapper",staticStyle:{"margin-top":"10px"}},[t("h4",[e._v("故障信息")]),t("a-descriptions",{attrs:{size:"default",bordered:"",column:6}},[t("a-descriptions-item",{attrs:{label:"故障编号",span:2}},[e._v(" "+e._s(e.detail.faultSn)+" ")]),t("a-descriptions-item",{attrs:{label:"发现时间",span:2}},[e._v(" "+e._s(e.detail.happenTime)+" ")]),t("a-descriptions-item",{attrs:{label:"线路",span:2}},[e._v(" "+e._s(e.detail.lineName)+" ")]),t("a-descriptions-item",{attrs:{label:"车辆",span:2}},[e._v(" "+e._s(e.detail.trainNo)+" ")]),t("a-descriptions-item",{attrs:{label:"系统",span:2}},[e._v(" "+e._s(e.detail.sysName)+" ")]),t("a-descriptions-item",{attrs:{label:"子系统",span:2}},[e._v(" "+e._s(e.detail.subSysName)+" ")]),t("a-descriptions-item",{attrs:{label:"部件",span:2}},[e._v(" "+e._s(e.detail.faultAssetName)+" ")]),t("a-descriptions-item",{attrs:{label:"发现阶段",span:2}},[e._v(" "+e._s(e.detail.phase_dictText)+" ")]),t("a-descriptions-item",{attrs:{label:"故障等级",span:2}},[e._v(" "+e._s(e.detail.faultLevel_dictText)+" ")]),t("a-descriptions-item",{attrs:{label:"是否正线",span:2}},[e._v(" "+e._s(e.detail.faultOnline_dictText)+" ")]),t("a-descriptions-item",{attrs:{label:"是否委外",span:2}},[e._v(" "+e._s(e.detail.outsource_dictText)+" ")]),1==e.detail.outsource?t("a-descriptions-item",{attrs:{label:"所属厂商",span:6}},[e._v(" "+e._s(e.detail.outSupplierName)+" ")]):e._e(),t("a-descriptions-item",{attrs:{label:"列计划",span:6}},[e._v(" "+e._s(e.detail.planName)+" ")]),t("a-descriptions-item",{attrs:{label:"故障描述",span:6}},[e._v(" "+e._s(e.detail.faultDesc)+" ")]),t("a-descriptions-item",{attrs:{label:"故障代码",span:6}},[e._v(" "+e._s(e.detail.faultCodeCode)+" "),t("span",{staticStyle:{color:"#c1c1c1","margin-left":"20px"}},[e._v(" （ "),t("a-space",[e._l(e.getFaultdetailList,(function(a,i){return t("span",{key:i},[e._v("故障"+e._s(a.fltLevel_dictText)+"："+e._s(a.fltCode)+"-"+e._s(a.fltName)+"；")])})),t("span",[e._v("故障部件："+e._s(e.detail.faultCodeCode)+"-"+e._s(e.detail.faultCodeCodeDes))])],2),e._v(" ） ")],1)]),t("a-descriptions-item",{attrs:{label:"故障状态",span:6}},[e._v(" "+e._s(e.detail.status_dictText)+" ")])],1)],1),t("div",{staticClass:"info-wrapper info-top-wrapper"},[t("h4",[e._v("提报信息")]),t("a-descriptions",{attrs:{bordered:"",column:6}},[t("a-descriptions-item",{attrs:{label:"提报班组",span:2}},[e._v(" "+e._s(e.detail.reportGroupName)+" ")]),t("a-descriptions-item",{attrs:{label:"提报人员",span:2}},[e._v(" "+e._s(e.detail.reportUserName)+" ")]),t("a-descriptions-item",{attrs:{label:"提报时间",span:2}},[e._v(" "+e._s(e.detail.reportTime)+" ")]),t("a-descriptions-item",{attrs:{label:"责任工程师",span:2}},[e._v(" "+e._s(e.detail.dutyEngineerName)+" ")])],1)],1),t("div",{staticClass:"info-wrapper info-top-wrapper"},[t("h4",[e._v("处理信息")]),t("a-descriptions",{attrs:{bordered:"",column:6}},[t("a-descriptions-item",{attrs:{label:"处理班组",span:2}},[e._v(" "+e._s(e.handleModel.solutionGroupName)+" ")]),t("a-descriptions-item",{attrs:{label:"处理人员",span:2}},[e._v(" "+e._s(e.handleModel.solutionUserName)+" ")]),t("a-descriptions-item",{attrs:{label:"处理时间",span:2}},[e._v(" "+e._s(e.handleModel.solutionTime)+" ")]),t("a-descriptions-item",{attrs:{label:"处理结果",span:6}},[e._v(" "+e._s(e.detail.handleStatus_dictText)+" ")]),t("a-descriptions-item",{attrs:{label:"关闭时间",span:2}},[e._v(" "+e._s(e.detail.closeTime)+" ")]),t("a-descriptions-item",{attrs:{label:"关闭人员",span:4}},[e._v(" "+e._s(e.detail.closeUserName)+" ")]),t("a-descriptions-item",{attrs:{label:"原因描述",span:4}},[e._v(" "+e._s(e.handleModel.reasonDesc)+" ")]),t("a-descriptions-item",{attrs:{label:"措施描述",span:4}},[e._v(" "+e._s(e.handleModel.solutionDesc)+" ")])],1)],1),t("div",{staticClass:"info-wrapper info-top-wrapper"},[t("h4",[e._v("附件")]),0===e.annexList.length?t("div",[e._v("暂无数据")]):t("div",e._l(e.annexList,(function(a,i){return t("ul",{key:i},[t("li",[t("a-icon",{attrs:{type:"file"}}),t("a",{on:{click:function(t){return e.handleSeeing(a)}}},[e._v(" "+e._s(a.name))])],1)])})),0)]),t("doc-preview-modal",{ref:"docPreview",attrs:{title:e.fileName}})],1)])},r=[],n=a("b47d"),l=a("ca00"),s=a("353a"),o={data:function(){return{fileName:"",annexList:[],detail:{},handleModel:{},getFaultdetailList:[],containerHeightStyle:{height:this.height,overflowY:"auto"}}},components:{DocPreviewModal:s["default"]},props:{businessKey:{type:String,default:null},isReadonly:{type:Boolean,default:!0},fromFlow:{type:Boolean,default:!1},height:{type:String,default:"100%"}},mounted:function(){this.businessKey&&this.show(this.businessKey)},methods:{getFaultdetail:function(e){var t=this;this.getFaultdetailLoading=!0,Object(n["db"])({code:e}).then((function(e){e.success&&e.result.length&&(t.getFaultdetailList=e.result.filter((function(e){return 0!=e.fltLevel&&3!=e.fltLevel}))),t.getFaultdetailLoading=!1,t.$emit("loaded")})).catch((function(e){t.getFaultdetailLoading=!1}))},show:function(e){var t=this;Object(l["e"])(e)||Object(n["P"])({id:e}).then((function(e){var a=e.result;t.detail=a,a.faultCodeId&&t.getFaultdetail(a.faultCodeId),t.annexList=a.annexList,Object(l["e"])(a.handleRecordList)||(t.handleModel=a.handleRecordList[0]),t.$emit("loaded")}))},handleSeeing:function(e){this.fileName=e.name,this.$refs.docPreview.handleFilePath(e.savepath)}}},c=o,d=(a("3206"),a("2877")),u=Object(d["a"])(c,i,r,!1,null,"21f53256",null);t["default"]=u.exports},"2e75":function(e,t,a){},3206:function(e,t,a){"use strict";a("932f")},3281:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"详情",width:"100%",centered:"",visible:e.visible,dialogClass:"fullDialog no-footer",footer:null,destroyOnClose:!0,cancelText:"关闭"},on:{cancel:e.handleCancel}},[t("BreakdowmDetailItem",{ref:"BreakdowmDetailItem"})],1)},r=[],n=a("1a6f"),l={name:"BreakdownModal",components:{BreakdowmDetailItem:n["default"]},data:function(){return{visible:!1}},created:function(){},methods:{show:function(e){var t=this;this.visible=!0,this.$nextTick((function(){t.$refs.BreakdowmDetailItem.show(e)}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},s=l,o=a("2877"),c=Object(o["a"])(s,i,r,!1,null,"7dee63a6",null);t["default"]=c.exports},"51cf":function(e,t,a){},5633:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("span",[t("a-select",{key:e.key,attrs:{"allow-clear":"",value:e.getValueSting,disabled:e.disabled,placeholder:"线路"},on:{change:e.handleChange,select:e.onSelect}},[t("a-select-option",{attrs:{value:void 0}},[e._v("请选择")]),e._l(e.optionData,(function(a,i){return t("a-select-option",{key:i,attrs:{value:a.lineId}},[t("span",{staticStyle:{display:"inline-block",width:"100%"},attrs:{title:a.lineName}},[e._v(" "+e._s(a.lineName)+" ")])])}))],2)],1)},r=[],n=a("8fad"),l={name:"LineSelectList",props:{value:[String],triggerChange:Boolean,disabled:Boolean,defaultFirst:Boolean},data:function(){return{optionData:[],selectValue:"",key:0}},created:function(){this.findList()},computed:{getValueSting:function(){return null!=this.value?this.value.toString():void 0}},methods:{findList:function(){var e=this;Object(n["Jb"])().then((function(t){t.success&&(e.optionData=t.result,e.defaultFirst&&e.optionData&&e.optionData.length>0&&setTimeout((function(){e.$emit("change",e.optionData[0].lineId),e.$emit("input",e.optionData[0].lineId)}),500))}))},handleChange:function(e,t){var a="";if(t&&t.componentOptions.children[0].data&&(a=t.componentOptions.children[0].data.attrs.title),this.$emit("change",e),this.$emit("input",e),this.$emit("changeName",a),this.triggerChange)if(e){var i=this.optionData[t.key];this.$emit("change",e,i)}else this.$emit("change",e,null)},onSelect:function(e,t){if(e){var a=this.optionData[t.data.key];this.$emit("select",e,a)}else this.$emit("select","",null)}}},s=l,o=a("2877"),c=Object(o["a"])(s,i,r,!1,null,"77265147",null);t["default"]=c.exports},"5eda":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bodyWrapper"},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline",form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"来源"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"fault_from_type"},model:{value:e.queryParam.fromType,callback:function(t){e.$set(e.queryParam,"fromType",t)},expression:"queryParam.fromType"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"线路"}},[t("line-select-list",{model:{value:e.lineId,callback:function(t){e.lineId=t},expression:"lineId"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"车辆"}},[t("j-dict-select-seach-tag",{attrs:{dictCode:e.dictTrainStr,"trigger-change":!0},on:{focus:e.handleTrainFocus,change:e.handleTrainNo},model:{value:e.queryParam.trainNo,callback:function(t){e.$set(e.queryParam,"trainNo",t)},expression:"queryParam.trainNo"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"处理"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_fault_status"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",{attrs:{md:4,sm:12}},[t("a-form-item",{attrs:{label:"时间"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_date_type"},model:{value:e.queryParam.dateType,callback:function(t){e.$set(e.queryParam,"dateType",t)},expression:"queryParam.dateType"}})],1)],1),"1"===e.queryParam.dateType||1===e.queryParam.dateType||"2"===e.queryParam.dateType?t("a-col",{attrs:{md:4,sm:12}},[t("a-form-item",[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{mode:"year",placeholder:"请选择年份",format:"YYYY",open:e.yearPickShow},on:{panelChange:e.handlePanelChange,openChange:e.handleOpenChange},model:{value:e.year,callback:function(t){e.year=t},expression:"year"}})],1)],1):e._e(),"2"===e.queryParam.dateType?t("a-col",{attrs:{md:4,sm:12}},[t("a-form-item",[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_quarter_type"},model:{value:e.queryParam.quarter,callback:function(t){e.$set(e.queryParam,"quarter",t)},expression:"queryParam.quarter"}})],1)],1):e._e(),"3"===e.queryParam.dateType?t("a-col",{attrs:{md:4,sm:12}},[t("a-form-item",[t("a-month-picker",{attrs:{placeholder:"选择月份"},model:{value:e.month,callback:function(t){e.month=t},expression:"month"}})],1)],1):e._e(),"4"===e.queryParam.dateType?t("a-col",{attrs:{md:6,sm:12}},[t("a-form-item",[t("a-range-picker",{attrs:{defaultPickerValue:e.defaultDateRange},model:{value:e.rangeDate,callback:function(t){e.rangeDate=t},expression:"rangeDate"}})],1)],1):e._e()],1),t("a-row",{style:{display:e.expand?"block":"none"},attrs:{gutter:24}},[t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"工班"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:e.dictGroupStr},model:{value:e.reportGroupId,callback:function(t){e.reportGroupId=t},expression:"reportGroupId"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-model-item",{attrs:{label:"部件"}},[t("a-select",{ref:"faultAssetSelect",attrs:{allowClear:"",placeholder:"请选择",open:!1,showArrow:!0},on:{change:e.allowClearCHange,dropdownVisibleChange:e.showAssetModal},model:{value:e.faultAssetName,callback:function(t){e.faultAssetName=t},expression:"faultAssetName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"工位"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:e.dictCodeStrWork},model:{value:e.queryParam.workstationId,callback:function(t){e.$set(e.queryParam,"workstationId",t)},expression:"queryParam.workstationId"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"等级"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_fault_level"},model:{value:e.queryParam.level,callback:function(t){e.$set(e.queryParam,"level",t)},expression:"queryParam.level"}})],1)],1)],1),t("a-row",{style:{display:e.expand?"block":"none"},attrs:{gutter:24}},[t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"阶段"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_fault_phase"},model:{value:e.queryParam.phase,callback:function(t){e.$set(e.queryParam,"phase",t)},expression:"queryParam.phase"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"正线"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_state"},model:{value:e.queryParam.online,callback:function(t){e.$set(e.queryParam,"online",t)},expression:"queryParam.online"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"有责"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_state"},model:{value:e.queryParam.hasDuty,callback:function(t){e.$set(e.queryParam,"hasDuty",t)},expression:"queryParam.hasDuty"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"取消"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_state"},model:{value:e.queryParam.canceled,callback:function(t){e.$set(e.queryParam,"canceled",t)},expression:"queryParam.canceled"}})],1)],1)],1),t("a-row",{style:{display:e.expand?"block":"none"},attrs:{gutter:24}},[t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"系统"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_train_asset_type,name,id,struct_type=1 and parent_id is null"},model:{value:e.queryParam.sysId,callback:function(t){e.$set(e.queryParam,"sysId",t)},expression:"queryParam.sysId"}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{label:"列计划"}},[t("a-select",{ref:"planSelect",attrs:{placeholder:"请选择列计划",open:!1,showArrow:!0},on:{focus:e.openTrainPlanModal},model:{value:e.planName,callback:function(t){e.planName=t},expression:"planName"}},[t("div",{attrs:{slot:"suffixIcon"},slot:"suffixIcon"},[e.queryParam.planId?t("a-icon",{staticStyle:{"padding-right":"3px"},attrs:{type:"close-circle"},on:{click:function(t){return t.stopPropagation(),e.clearValue.apply(null,arguments)}}}):t("a-icon",{attrs:{type:"ellipsis"}})],1)])],1)],1)],1),t("a-row",[t("a-col",[t("span",{staticClass:"table-page-search-submitButtons"},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")]),t("a-button",{on:{click:e.resetSearch}},[e._v("重置")]),t("a-button",{attrs:{disabled:!(1==e.records.length&&2!==e.records[0].status)},on:{click:function(t){return t.stopPropagation(),e.handleEdit(e.records[0])}}},[e._v("编辑")]),t("a-button",{attrs:{disabled:1!==e.records.length},on:{click:e.createExceptionTransfer}},[e._v("例外转序")]),t("a-button",{attrs:{disabled:e.records.length<1},on:{click:e.deleteRecord}},[e._v("取消")]),t("a-button",[t("a",{style:{fontSize:"12px"},on:{click:e.toggle}},[e._v(" 更多条件 "),t("a-icon",{attrs:{type:e.expand?"up":"down"}})],1)])],1)],1)])],1)],1)],1),t("div",{style:e.tableHeight.top},[t("vxe-table",{ref:"listTable",style:e.tableHeight.bottom,attrs:{border:"","max-height":e.tableHeight.size,align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"},"checkbox-config":{trigger:"row",highlight:!0,range:!0}},on:{"checkbox-change":e.checkboxChange,"checkbox-all":e.checkboxChange}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{field:"faultSn",title:"故障编号",width:"140"},scopedSlots:e._u([{key:"default",fn:function(a){var i=a.row;return[t("a",{on:{click:function(t){return t.stopPropagation(),e.faultDetail(i)}}},[e._v(e._s(i.faultSn))])]}}])}),t("vxe-table-column",{attrs:{field:"fromType_dictText",title:"来源",width:"120"}}),t("vxe-table-column",{attrs:{field:"lineName",title:"线路",width:"80"}}),t("vxe-table-column",{attrs:{field:"trainNo",title:"车号",width:"80"}}),t("vxe-table-column",{attrs:{field:"sysName",title:"故障系统","min-width":"100"}}),t("vxe-table-column",{attrs:{field:"faultAssetName",align:"left","header-align":"center",title:"故障部件","min-width":"100"}}),t("vxe-table-column",{attrs:{field:"faultDesc",title:"故障描述","min-width":"160",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"happenTime",title:"发现时间",width:"100"}}),t("vxe-table-column",{attrs:{field:"reportUserName",align:"left","header-align":"center",title:"提报人员",width:"100"}}),t("vxe-table-column",{attrs:{field:"reportTime",title:"提报日期",width:"100"}}),t("vxe-table-column",{attrs:{field:"status_dictText",align:"left","header-align":"center",title:"故障状态",width:"80"}}),t("vxe-table-column",{attrs:{field:"submitStatus_dictText",title:"提交状态",width:"80"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1),t("BreakdownModal",{ref:"breakdownModal",on:{ok:function(t){return e.loadData()}}}),t("breakdown-detail-modal",{ref:"breakdownDetail"}),t("TrainPlanList",{ref:"trainPlanModal",on:{ok:e.onSelectPlan}}),t("CarDeviceSelectNew",{ref:"assetSelect",attrs:{canSelectType:[3,4],trainNo:e.queryParam.trainNo,lineId:e.queryParam.lineId,multiple:!1},on:{ok:e.addFaultAsset}})],1)},r=[],n=a("c1df"),l=a.n(n),s=a("b47d"),o=a("ab7d"),c=a("3281"),d=a("ca00"),u=a("5633"),h=a("d214"),m=a("785a"),f=a("310d"),p=a("60e2"),g={name:"BreakDownPage",components:{BreakdownModal:o["default"],BreakdownDetailModal:c["default"],TrainAssetList:m["default"],LineSelectList:u["default"],CarDeviceSelectNew:f["default"],TrainPlanList:p["default"]},data:function(){return{month:void 0,planName:"",records:[],date:null,dictGroupStr:"bu_mtr_workshop_group,group_name,id,workshop_id='"+this.$store.getters.userInfo.workshopId+"'|workshop_id",dictCodeStrWork:"bu_mtr_workstation,name,id,workshop_id='"+this.$store.getters.userInfo.workshopId+"'|workshop_id",year:null,queryParam:{fromType:1,planId:"",trainNo:"",lineId:"",faultAssetId:"",reportGroupId:"",placeId:"",online:null,hasDuty:null,canceled:null,phase:"",status:"",level:"",sysId:"",quarter:"",year:"",month:"",endDate:"",startDate:"",dateType:"",workstationId:"",pageNo:1,pageSize:10},totalResult:0,allAlign:"center",tableData:[],count:"",expand:!1,yearPick:null,yearPickShow:!1,form:this.$form.createForm(this),lineId:"",reportGroupId:"",rangeDate:[],trainStructId:"",dictTrainStr:"",faultAssetName:"",tableHeight:{top:"height: calc(100vh - 267px)",bottom:"height: calc(100vh - 267px)",size:"100%"}}},watch:{lineId:function(e,t){this.dictTrainStr=e?"bu_train_info,train_no,train_no,line_id="+e+"|train_struct_id":""},reportGroupId:function(e,t){this.dictCodeStrWork=e?"bu_mtr_workstation,name,id,id in (select workstation_id from bu_group_workstation where group_id='".concat(e,"')"):"bu_mtr_workstation,name,id"}},created:function(){this.findList()},methods:{openTrainPlanModal:function(){this.$refs.trainPlanModal.showModal(),this.$refs.planSelect.blur()},clearValue:function(){this.queryParam.planId="",this.planName=""},onSelectPlan:function(e){var t=this;e.forEach((function(e){t.queryParam.trainNo=e.trainNo,t.queryParam.lineId=e.lineId,t.lineId=e.lineId,t.queryParam.planId=e.id,t.planName=e.planName}))},checkboxChange:function(e){this.records=e.records},handleTrainFocus:function(){this.lineId||this.$message.warn("请先选择线路!")},handleAssetFocus:function(){this.queryParam.trainNo||this.$message.warn("请先选择车辆!")},handleTrainNo:function(e,t){e&&t.extFields&&(this.trainStructId=t.extFields[0].train_struct_id)},allowClearCHange:function(e){e||(this.queryParam.faultAssetId=void 0,this.faultAssetName=void 0)},showAssetModal:function(e){this.queryParam.trainNo?(this.$refs.assetSelect.showModal(),this.$refs.faultAssetSelect.blur()):this.$message.warn("请先选择车辆!")},addFaultAsset:function(e){Object(d["e"])(e)||(this.queryParam.faultAssetId=e[0].id,this.faultAssetName=e[0].assetName)},faultDetail:function(e){this.$refs.breakdownDetail.show(e.id)},findList:function(){var e=this;this.loading=!0,this.rangeDate.length>0&&"4"===this.queryParam.dateType&&(this.queryParam.startDate=l()(this.rangeDate[0]).format("YYYY-MM-DD"),this.queryParam.endDate=l()(this.rangeDate[1]).format("YYYY-MM-DD")),this.month&&"3"===this.queryParam.dateType&&(this.queryParam.year=l()(this.month).year(),this.queryParam.month=l()(this.month).month()+1),this.queryParam.lineId=this.lineId,this.queryParam.reportGroupId=this.reportGroupId,Object(h["L"])(this.queryParam).then((function(t){t.result&&(e.totalResult=t.result.total,e.records=[],e.tableData=t.result.records),e.loading=!1}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},loadData:function(){this.findList()},handleEdit:function(e){var t=this;Object(s["P"])({id:e.id}).then((function(e){var a=e.result;a["formType"]=1,t.$refs.breakdownModal.edit(a)}))},deleteRecord:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();if(t.length>0){var a=t.filter((function(e){return 0!==e.status}));if(a.length>0)return void this.$message.warn("已关闭或者已处理的故障不可以取消");var i=t.filter((function(e){return 2===e.submitStatus}));if(i.length>0)return void this.$message.warn("所选数据存在故障已经取消,无需再取消!");this.$confirm({content:"是否取消选中".concat(t.length,"数据？"),onOk:function(){var a=t.map((function(e,t){return e.id})).join(",");Object(s["o"])("ids="+a).then((function(t){e.findList(),e.$message.success(t.message)}))}})}else this.$message.error("尚未选中任何数据!")},createExceptionTransfer:function(){var e=this.$refs.listTable.getCheckboxRecords();if(e&&1===e.length){var t=e[0];t.workOrderId?this.$router.push({path:"/tiros/quality/exception-transfer",query:{create:"1",faultId:t.id||"",faultSn:t.faultSn||"",orderId:t.workOrderId||"",orderTaskId:t.orderTaskId||"",processName:t.sysName||"",transferDesc:t.faultDesc||""}}):this.$message.warning("所选故障未关联工单，无法发起例外转序")}else this.$message.warning("请选择一条故障记录")},handleOpenChange:function(e){this.yearPickShow=e},handlePanelChange:function(e){this.year=e,this.queryParam.year=l()(e).format("YYYY"),this.yearPickShow=!1},toggle:function(){this.expand=!this.expand,this.expand?this.tableHeight={top:"height: calc(100vh - 387px)",bottom:"height: calc(100vh - 387px)",size:"90%"}:this.tableHeight={top:"height: calc(100vh - 267px)",bottom:"height: calc(100vh - 267px)",size:"100%"}},resetSearch:function(){this.queryParam={pageNo:1,pageSize:10},this.faultAssetName="",this.lineId="",this.year=null,this.rangeDate=[],this.clearValue()}}},b=g,y=a("2877"),v=Object(y["a"])(b,i,r,!1,null,"449d7675",null);t["default"]=v.exports},7068:function(e,t,a){"use strict";a("51cf")},7483:function(e,t,a){"use strict";a("2e75")},"785a":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"80%",title:"设备选择",visible:e.visible,confirmLoading:e.loading,centered:"",cancelText:"关闭",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.loading}},[t("na-splitter",{staticStyle:{height:"calc(80vh - 15px)"},attrs:{defaultSize:250}},[t("div",{staticStyle:{"overflow-y":"auto","overflow-x":"hidden","padding-right":"2px"},attrs:{slot:"left-panel"},slot:"left-panel"},[t("a-tree",{attrs:{"tree-data":e.treeData,replaceFields:{title:"name",key:"id"},"load-data":e.onLoadTreeData},on:{select:e.onSelectTreeNode}})],1),t("div",{staticStyle:{"padding-left":"5px","padding-right":"3px",height:"calc(100% - 0px)"},attrs:{slot:"right-panel"},slot:"right-panel"},[t("vxe-table",{ref:"listTable",attrs:{border:"","row-id":"id",align:"center",data:e.tableData,"show-overflow":"tooltip",height:"auto","max-height":"100%","edit-config":{trigger:"manual",mode:"row"},"radio-config":e.multiple?{}:{trigger:"row",checkMethod:e.selectAbleCheck},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,checkStrictly:!0,checkMethod:e.selectAbleCheck}:{}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"assetName",title:"名称","tree-node":"",align:"left","header-align":"center","min-width":"180"}}),t("vxe-table-column",{attrs:{field:"assetNo",title:"编码",width:"150"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"100"}}),t("vxe-table-column",{attrs:{field:"structType_dictText",title:"类型",width:"100"}}),t("vxe-table-column",{attrs:{field:"assetTypeName",title:"设备类型",width:"100",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"placeDesc",title:"位置描述",width:"250",align:"left","header-align":"center"}})],1)],1)])],1)],1)},r=[],n=a("8fad");function l(e){return d(e)||c(e)||o(e)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e,t){if(e){if("string"==typeof e)return u(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?u(e,t):void 0}}function c(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function d(e){if(Array.isArray(e))return u(e)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=Array(t);a<t;a++)i[a]=e[a];return i}var h={name:"TrainAssetList",props:{multiple:{type:Boolean,default:!1},canSelectType:{type:Array,default:function(){return[1,2,3,4]}}},data:function(){return{visible:!1,loading:!1,treeData:[],tableData:[],defaultSelectedKeys:[],queryParam:{trainNo:"",structDetailId:""}}},methods:{showModal:function(e,t){this.queryParam.trainNo=e,this.trainStructId=t,this.queryParam.structDetailId=t,this.visible=!0,this.queryTreeData(),this.loadTableData()},queryTreeData:function(){var e=this,t={trainStructId:this.trainStructId};Object(n["pc"])(t).then((function(t){t.success?e.treeData=t.result:e.$message.warning("获取车辆结构树失败")}))},onLoadTreeData:function(e){var t=this,a={trainStructId:this.trainStructId,id:e.dataRef.id};return new Promise((function(i){e.dataRef.children&&e.dataRef.children.length>0?i():Object(n["pc"])(a).then((function(a){a.success?(e.dataRef.children=a.result,e.dataRef.children.map((function(e){e.isLeaf=!e.hasChildren})),t.treeData=l(t.treeData)):t.$message.warning("获取车辆结构树失败"),i()}))}))},onSelectTreeNode:function(e){!e||e.length<1?this.queryParam.structDetailId="":this.queryParam.structDetailId=e[0],this.loadTableData()},loadTableData:function(){var e=this;this.loading=!0,Object(n["jc"])(this.queryParam).then((function(t){t.success?e.tableData=t.result:e.$message.error("加载车辆设备数据失败"),e.loading=!1}))},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,Object.assign(this.$data,this.$options.data())},selectAbleCheck:function(e){e.row;return!0}}},m=h,f=a("2877"),p=Object(f["a"])(m,i,r,!1,null,"60221f2c",null);t["default"]=p.exports},"932f":function(e,t,a){},ab7d:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"故障编辑",width:"100%",centered:"",visible:e.visible,dialogClass:"fullDialog",confirmLoading:e.confirmLoading,cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticStyle:{height:"calc(100vh - 5px)","overflow-y":"auto"}},[e.visible?t("BreakdownFormItem",{ref:"breakdownForm",attrs:{fromWriteReport:e.fromWriteReport,workStationsList:e.workStationsList},on:{ok:e.onSaveOk,fail:e.onSaveFail,cancel:e.onSaveCancel}}):e._e()],1)])},r=[],n=a("d0ca"),l={name:"BreakdownModal",components:{BreakdownFormItem:n["default"]},props:{showWorkStation:{type:Boolean,default:!1},fromWriteReport:{type:Boolean,default:!1}},data:function(){return{visible:!1,confirmLoading:!1,workStationsList:[]}},created:function(){},methods:{setWorkStations:function(e){var t=this;this.workStationsList.length=0,e.forEach((function(e){t.workStationsList.find((function(t){return t.workstationId===e.workstationId}))||t.workStationsList.push(e)}))},add:function(e,t,a){this.edit({workOrderId:e,orderTaskId:t,formType:a,createType:a})},edit:function(e){var t=this;this.visible=!0,this.$nextTick((function(){t.$refs.breakdownForm.edit(e)}))},handleOk:function(){this.confirmLoading=!0,this.$refs.breakdownForm.save()},onSaveOk:function(){this.confirmLoading=!1,this.visible=!1,this.$message.success("保存成功"),this.$emit("ok")},onSaveFail:function(){this.$message.error("保存失败"),this.confirmLoading=!1},onSaveCancel:function(){this.confirmLoading=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.confirmLoading=!1,this.visible=!1}}},s=l,o=(a("7068"),a("2877")),c=Object(o["a"])(s,i,r,!1,null,"12e1d6e2",null);t["default"]=c.exports}}]);