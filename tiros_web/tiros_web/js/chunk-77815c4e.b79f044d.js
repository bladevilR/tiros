(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77815c4e","chunk-43aeb9c8","chunk-68c48932","chunk-1945f686","chunk-58d495c5","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7"],{1968:function(e,t,r){"use strict";r("e31f")},"3c2d":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%","overflow-x":"hidden"}},[t("a-button",{attrs:{"na-btn-type":"print",type:"primary"},on:{click:e.exportPrint}},[e._v("导出打印")]),t("div",{staticStyle:{margin:"0px",padding:"0px",width:"100%",height:"calc(100vh - 85px)"},attrs:{id:"luckysheet"}}),e.showLoading?t("div",{staticStyle:{width:"100%","text-align":"center",position:"absolute",top:"0px",height:"100%","font-size":"16px","z-index":"1000000000",background:"#fff"}},[e._m(0)]):e._e()],1)},o=[function(){var e=this,t=e._self._c;return t("div",{staticStyle:{position:"relative",top:"45%",width:"100%"}},[t("div",{staticClass:"luckysheetLoaderGif"}),t("span",[e._v("加载中...")])])}],n=r("8fad"),l=r("2410"),i=r.n(l),c=r("e24e"),s={name:"view",props:["customId","formName"],data:function(){return{showLoading:!1,defaultOptions:{container:"luckysheet",title:"sheet",column:26,row:50,lang:"zh",allowEdit:!0,showinfobar:!1,sheetFormulaBar:!1,showsheetbar:!1,showstatisticBar:!0,enableAddRow:!1,enableAddCol:!1,showtoolbar:!1}}},beforeDestroy:function(){luckysheet.destroy()},mounted:function(){var e=this,t=i()(this.defaultOptions);t.data=[{name:"Sheet1",color:"",status:"1",order:"0",index:0,ch_width:2044,rh_height:1080}],this.customId?Object(n["Db"])(this.customId).then((function(e){if(e.success){var r=JSON.parse(e.result);r.scrollLeft=0,r.scrollTop=0,t.showtoolbarConfig={},r.config.authority={sheet:1,hintText:"禁止编辑",allowRangeList:[]},t.data=[r],luckysheet.destroy(),luckysheet.create(t)}})).catch((function(r){e.$message.error("加载表单内容异常"),luckysheet.destroy(),luckysheet.create(t)})):(luckysheet.destroy(),luckysheet.create(t))},methods:{exportPrint:function(){try{var e=this.formName;e||(e="export"),Object(c["a"])(luckysheet.getAllSheets(),e)}catch(t){}}}},d=s,u=r("2877"),h=Object(u["a"])(d,a,o,!1,null,"22edf2fe",null);t["default"]=h.exports},"3dbe":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"表单查看",width:"100%",dialogClass:"fullDialog no-footer",visible:e.visible,footer:null,destroyOnClose:!0},on:{cancel:function(t){e.visible=!1}}},[t("FormView",{attrs:{"custom-id":e.customId,"form-name":e.formName}})],1)},o=[],n=r("3c2d"),l={name:"FormViewModal",components:{FormView:n["default"]},props:["formName"],data:function(){return{visible:!1,customId:null}},methods:{showModal:function(e){e&&(this.customId=e,this.visible=!0)}}},i=l,c=r("2877"),s=Object(c["a"])(i,a,o,!1,null,"65a9461c",null);t["default"]=s.exports},5633:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("span",[t("a-select",{key:e.key,attrs:{"allow-clear":"",value:e.getValueSting,disabled:e.disabled,placeholder:"线路"},on:{change:e.handleChange,select:e.onSelect}},[t("a-select-option",{attrs:{value:void 0}},[e._v("请选择")]),e._l(e.optionData,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.lineId}},[t("span",{staticStyle:{display:"inline-block",width:"100%"},attrs:{title:r.lineName}},[e._v(" "+e._s(r.lineName)+" ")])])}))],2)],1)},o=[],n=r("8fad"),l={name:"LineSelectList",props:{value:[String],triggerChange:Boolean,disabled:Boolean,defaultFirst:Boolean},data:function(){return{optionData:[],selectValue:"",key:0}},created:function(){this.findList()},computed:{getValueSting:function(){return null!=this.value?this.value.toString():void 0}},methods:{findList:function(){var e=this;Object(n["Jb"])().then((function(t){t.success&&(e.optionData=t.result,e.defaultFirst&&e.optionData&&e.optionData.length>0&&setTimeout((function(){e.$emit("change",e.optionData[0].lineId),e.$emit("input",e.optionData[0].lineId)}),500))}))},handleChange:function(e,t){var r="";if(t&&t.componentOptions.children[0].data&&(r=t.componentOptions.children[0].data.attrs.title),this.$emit("change",e),this.$emit("input",e),this.$emit("changeName",r),this.triggerChange)if(e){var a=this.optionData[t.key];this.$emit("change",e,a)}else this.$emit("change",e,null)},onSelect:function(e,t){if(e){var r=this.optionData[t.data.key];this.$emit("select",e,r)}else this.$emit("select","",null)}}},i=l,c=r("2877"),s=Object(c["a"])(i,a,o,!1,null,"77265147",null);t["default"]=s.exports},9866:function(e,t,r){},a957:function(e,t,r){"use strict";r("d64c")},d1e3:function(e,t,r){"use strict";r("9866")},d64c:function(e,t,r){},d884:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"customForm"}},[t("na-splitter",{attrs:{defaultSize:200}},[t("div",{attrs:{slot:"left-panel"},slot:"left-panel"},[t("a-tree",{attrs:{"tree-data":e.treeData,selectedKeys:e.selectedKeys,"load-data":e.loadTreeChild},on:{select:e.selectTreeNode}})],1),t("div",{staticStyle:{height:"calc(100vh - 115px)"},attrs:{slot:"right-panel"},slot:"right-panel"},[t("div",{staticStyle:{"padding-top":"5px","padding-left":"5px"}},[t("a-spin",{attrs:{spinning:e.loading}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loadDataList.apply(null,arguments)}}},[t("a-row",{staticStyle:{margin:"0"},attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"名称"}},[t("a-input",{attrs:{placeholder:"编码或名称","allow-clear":""},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"修程"}},[t("j-dict-select-tag",{attrs:{triggerChange:"",dictCode:"bu_repair_program,name,id"},on:{change:e.handleProgram},model:{value:e.queryParam.repairProId,callback:function(t){e.$set(e.queryParam,"repairProId",t)},expression:"queryParam.repairProId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"规程"}},[t("j-dict-select-tag",{attrs:{triggerChange:"",dictCode:e.dicStr},on:{focus:e.handleFocusRegu},model:{value:e.queryParam.reguId,callback:function(t){e.$set(e.queryParam,"reguId",t)},expression:"queryParam.reguId"}})],1)],1),t("a-col",{attrs:{md:10,sm:24}},[t("a-space",[t("a-button",{on:{click:e.loadDataList}},[e._v("查询")]),t("a-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增")]),t("a-button",{attrs:{disabled:1!==e.records.length},on:{click:function(t){return e.handleEdit(e.records[0])}}},[e._v("编辑")]),t("a-button",{attrs:{disabled:e.records.length<1},on:{click:e.validRecord}},[e._v("启用")]),t("a-button",{attrs:{disabled:e.records.length<1},on:{click:e.invalidRecord}},[e._v("禁用")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(100vh - 232px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(100vh - 232px)"},attrs:{border:"","max-height":"100%",align:"center",data:e.tableData,"auto-resize":"","show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{trigger:"manual",mode:"row"}},on:{"checkbox-change":e.checkboxChange,"checkbox-all":e.checkboxChange}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{field:"name",title:"表单名称",align:"left","header-align":"center","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("a",{attrs:{href:"javascript:;"},on:{click:function(t){return t.stopPropagation(),e.viewForm(a)}}},[e._v(e._s(a.name))])]}}])}),t("vxe-table-column",{attrs:{field:"code",title:"表单编码",align:"left","header-align":"center",width:"80"}}),t("vxe-table-column",{attrs:{field:"categoryName",title:"所属分类",align:"center","header-align":"center",width:"100"}}),t("vxe-table-column",{attrs:{field:"type_dictText",title:"表单类型",align:"center","header-align":"center",width:"80"}}),t("vxe-table-column",{attrs:{field:"reguName",title:"技术规程",width:"200"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[a.reguName?t("span",[e._v(e._s(a.reguName+(a.reguVersion?"(".concat(a.reguVersion,")"):"")))]):e._e()]}}])}),t("vxe-table-column",{attrs:{field:"lineName",title:"线路",width:"100"}}),t("vxe-table-column",{attrs:{field:"repairProgramName",title:"修程",width:"100"}}),t("vxe-table-column",{attrs:{field:"createGroupName",align:"left","header-align":"center",title:"创建班组",width:"150"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",align:"center","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("div",{style:{backgroundColor:e.statusColor[a.status+""],borderRadius:"4px"}},[e._v(" "+e._s(a.status_dictText)+" ")])]}}])}),t("vxe-table-column",{attrs:{width:"150",field:"remark",title:"备注",align:"left","header-align":"center"}})],1),t("vxe-pager",{attrs:{perfect:"",loading:e.loading,"current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.loadDataList}})],1)])],1)])]),t("LuckySheetPrint",{ref:"luckySheetPrint"}),t("a-modal",{attrs:{centered:"",width:"100%",dialogClass:"fullDialog no-title no-footer",visible:e.editVisible,footer:null,destroyOnClose:!0},on:{cancel:function(t){e.editVisible=!1}}},[t("formEdit",{attrs:{formInfo:e.curForm,visible:e.editVisible},on:{"update:visible":function(t){e.editVisible=t},saveSuccess:e.saveSuccess}})],1),t("FormViewModal",{ref:"viewModal",attrs:{"form-name":e.curForm?e.curForm.name:""}})],1)},o=[],n=r("0fea"),l=function(e){return Object(n["d"])("/sys/category/loadTreeRoot",e)},i=r("8fad"),c=r("f916"),s=r("e18e"),d=r("e89a"),u=r("5633"),h=r("3dbe"),f=r("ca00");function m(e){return v(e)||y(e)||p(e)||g()}function g(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,t){if(e){if("string"==typeof e)return x(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(e,t):void 0}}function y(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function v(e){if(Array.isArray(e))return x(e)}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}var w={name:"list",components:{NaSplitter:s["default"],formEdit:c["default"],LuckySheetPrint:d["default"],LineSelectList:u["default"],FormViewModal:h["default"]},data:function(){return{records:[],selectedKeys:[],treeData:[],tableData:[],totalResult:0,loading:!1,dicStr:"",statusColor:{0:"#dedede",1:"#bad795"},queryParam:{category:"",createGroupId:"",name:"",repairProId:"",reguId:"",lineId:"",pageNo:1,pageSize:10},editVisible:!1,curForm:null,curCategory:null}},mounted:function(){this.queryTreeData()},methods:{handleFocusRegu:function(){var e=this.queryParam.repairProId;Object(f["e"])(e)&&this.$message.warn("请先选择修程类型")},handleProgram:function(e){e?this.dicStr="bu_repair_regu_info,name,id,status=1 and repair_pro_id='".concat(e,"'"):(this.queryParam.reguId="",this.dicStr="")},checkboxChange:function(e){this.records=e.records},queryTreeData:function(){var e=this,t={async:!1,pcode:"B03"};l(t).then((function(t){t.success?(e.treeData=t.result,e.selectedKeys=[],e.treeData.length>0&&(e.selectedKeys.push(e.treeData[0].key),e.loadDataList())):e.$message.warning(t.message)}))},loadTreeChild:function(e){var t=this,r={async:!1,pcode:e?e.dataRef.code:""};e.dataRef.children?resolve():l(r).then((function(r){r.success?(e.dataRef.children=r.result,e.dataRef.children.map((function(e){e.isLeaf=!e.hasChildren})),t.treeData=m(t.treeData)):t.$message.warning(r.message),resolve()}))},selectTreeNode:function(e){this.selectedKeys=e,this.selectedKeys&&this.selectedKeys.length>0&&(this.curCategory=this.selectedKeys[0]),this.loadDataList()},loadDataList:function(){var e=this;this.queryParam.category="",this.selectedKeys.length>0&&(this.queryParam.category=this.selectedKeys[0]),this.loading=!0,Object(i["Sc"])(this.queryParam).then((function(t){t.success?(e.totalResult=t.result.total,e.records=[],e.tableData=t.result.records):e.$message.error("加载列表数据失败"),e.loading=!1})).catch((function(t){e.loading=!1}))},handleAdd:function(){this.curForm={category:this.selectedKeys[0]},this.editVisible=!0},handleEdit:function(e){this.curForm=e,this.editVisible=!0},saveSuccess:function(){this.loadDataList()},deleteRecord:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();t.length>0?this.$confirm({content:"是否删除选中".concat(t.length,"条数据？"),onOk:function(){var r=t.map((function(e,t){return e.id})).join(",");Object(i["W"])({ids:r}).then((function(t){t.success?(e.$message.success("删除成功"),e.loadDataList()):e.$message.error("删除失败")})).catch((function(t){e.$message.error("删除异常")}))}}):this.$message.error("尚未选中任何数据!")},validRecord:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();if(t.length>0){if(t.filter((function(e){return 1===e.status})).length>0)return void this.$message.warn("有效的数据不能启用");this.$confirm({content:"是否启用选中的表单？",okText:"确定",cancelText:"取消",onOk:function(){var r=t.map((function(e,t){return e.id})).join(",");Object(i["Zd"])("ids="+r).then((function(t){t.success?(e.$message.success("启用成功"),e.loadDataList()):e.$message.error(t.message)})).catch((function(t){e.$message.error("启用异常")}))}})}else this.$message.error("尚未选中数据!")},invalidRecord:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();if(t.length>0){if(t.filter((function(e){return 0===e.status})).length>0)return void this.$message.warn("无效的数据不能禁用");this.$confirm({content:"是否禁用选中的表单？",okText:"确定",cancelText:"取消",onOk:function(){var r=t.map((function(e,t){return e.id})).join(",");Object(i["Gc"])("ids="+r).then((function(t){t.success?(e.$message.success("禁用成功"),e.loadDataList()):e.$message.error(t.message)})).catch((function(t){e.$message.error("禁用异常")}))}})}else this.$message.error("尚未选中数据!")},print:function(){var e=this.$refs.listTable.getCheckboxRecords()[0];this.$refs.luckySheetPrint.printById(e.id)},viewForm:function(e){this.$refs.viewModal.showModal(e.id)}}},b=w,I=r("2877"),k=Object(I["a"])(b,a,o,!1,null,"8c629a12",null);t["default"]=k.exports},e24e:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var a=r("e8ae"),o=r.n(a),n=r("21a6"),l=r.n(n),i=(r("7268"),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"),c=function(e,t){var r=new o.a.Workbook;"[object Object]"===Object.prototype.toString.call(e)&&(e=[e]),e.forEach((function(e){if(0===e.data.length)return!0;var t=r.addWorksheet(e.name),a=e.config&&e.config.merge||{},o=e.config&&e.config.borderInfo||{},n=e.config&&e.config.columnlen||{},l=e.images||{};return u(l,r,t),d(n,t),s(e.config,t),m(e.data,t),h(a,t),f(o,t),!0}));var a=r.xlsx.writeBuffer().then((function(e){var r=new Blob([e],{type:i});l.a.saveAs(r,"".concat(t,".xlsx"))}));return a},s=function(e,t){if(e&&e.rowlen)for(var r in e.rowlen){var a=parseInt(r),o=parseInt(e.rowlen[r]),n=t.getRow(a+1);n.height=o}},d=function(e,t){for(var r in e){var a=parseInt(r),o=parseInt(e[r]);t.getColumn(a+1).width=parseInt(o/7)}},u=function(e,t,r){for(var a in e){var o=e[a],n=o.src.split(";base64,"),l=n[0].replaceAll("data:image/",""),i=t.addImage({base64:o.src,extension:l}),c=luckysheet.location(o.default.left,o.default.top);r.addImage(i,{tl:{col:c.col,row:c.row},ext:{width:o.default.width,height:o.default.height}})}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=Object.values(e);r.forEach((function(e){t.mergeCells(e.r+1,e.c+1,e.r+e.rs,e.c+e.cs)}))},f=function(e,t){Array.isArray(e)&&e.forEach((function(e){if("range"===e.rangeType)for(var r=v(e.borderType,e.style,e.color),a=e.range[0],o=a.row,n=a.column,l=o[0]+1;l<o[1]+2;l++)for(var i=n[0]+1;i<n[1]+2;i++)t.getCell(l,i).border=r;if("cell"===e.rangeType){var c=e.value,s=c.col_index,d=c.row_index,u=Object.assign({},e.value);delete u.col_index,delete u.row_index;var h=x(u,d,s);t.getCell(d+1,s+1).border=h}}))},m=function(e,t){Array.isArray(e)&&e.forEach((function(e,r){e.every((function(e,a){if(!e)return!0;var o=g(e.bg),n=p(e.ff,e.fc,e.bl,e.it,e.fs,e.cl,e.ul),l=y(e.vt,e.ht,e.tb,e.tr),i="";e.f?i={formula:e.f,result:e.v}:!e.v&&e.ct&&e.ct.s?e.ct.s.forEach((function(e){i+=e.v})):i=e.v;var c=w(a),s=t.getCell(c+(r+1));for(var d in o){s.fill=o;break}return s.font=n,s.alignment=l,s.value=i,!0}))}))},g=function(e){if(!e)return{};var t={type:"pattern",pattern:"solid",fgColor:{argb:e.replace("#","")}};return t},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000000",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,i={0:"微软雅黑",1:"宋体（Song）",2:"黑体（ST Heiti）",3:"楷体（ST Kaiti）",4:"仿宋（ST FangSong）",5:"新宋体（ST Song）",6:"华文新魏",7:"华文行楷",8:"华文隶书",9:"Arial",10:"Times New Roman ",11:"Tahoma ",12:"Verdana",num2bl:function(e){return 0!==e}},c={name:"number"===typeof e?i[e]:e,family:1,size:o,color:{argb:t.replace("#","")},bold:i.num2bl(r),italic:i.num2bl(a),underline:i.num2bl(l),strike:i.num2bl(n)};return c},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"default",o={vertical:{0:"middle",1:"top",2:"bottom",default:"top"},horizontal:{0:"center",1:"left",2:"right",default:"left"},wrapText:{0:!1,1:!1,2:!0,default:!1},textRotation:{0:0,1:45,2:-45,3:"vertical",4:90,5:-90,default:0}},n={vertical:o.vertical[e],horizontal:o.horizontal[t],wrapText:o.wrapText[r],textRotation:o.textRotation[a]};return n},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000";if(!e)return{};var a={type:{"border-all":"all","border-top":"top","border-right":"right","border-bottom":"bottom","border-left":"left"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}},o={style:a.style[t],color:{argb:r.replace("#","")}},n={};return"all"===a.type[e]?(n["top"]=o,n["right"]=o,n["bottom"]=o,n["left"]=o):n[a.type[e]]=o,n};function x(e,t,r){var a={},o={type:{l:"left",r:"right",b:"bottom",t:"top"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}};for(var n in e)-1===e[n].color.indexOf("rgb")?a[o.type[n]]={style:o.style[e[n].style],color:{argb:e[n].color.replace("#","")}}:a[o.type[n]]={style:o.style[e[n].style],color:{argb:e[n].color}};return a}function w(e){var t="A".charCodeAt(0),r="Z".charCodeAt(0),a=r-t+1,o="";while(e>=0)o=String.fromCharCode(e%a+t)+o,e=Math.floor(e/a)-1;return o}},e31f:function(e,t,r){},e89a:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"luckySheetPringContent"}},[t("div",{staticClass:"table-page-body",staticStyle:{position:"relative"}},[t("div",{ref:"printDom",staticClass:"ls-print",style:{height:e.lHeight},attrs:{id:e.luckySheetId}})])])},o=[],n=r("8fad"),l=(r("2410"),r("7268")),i={name:"LuckySheetPrint",props:{luckySheetId:{type:String,default:"luckySheetPring"}},data:function(){return{recordSheet:{},lHeight:"calc(100% - 0)"}},mounted:function(){},methods:{printById:function(e){var t=this;n["Db"].call(this,e).then((function(e){e.success&&t.printBySheet(JSON.parse(e.result))})).catch((function(e){t.$message.error("加载表单内容异常")}))},printByData:function(e){var t=this;this.recordSheet=e,this.$nextTick((function(){t.print()}))},printBySheet:function(e){var t=this,r=Object.assign({},l["a"].getDefaultOptions());r.container=this.luckySheetId;var a=0,o=0,n=0;e.celldata.forEach((function(e){e.c>a&&(a=e.c),e.r>o&&(o=e.r)})),a++,o++,n=e.visibledatarow[e.visibledatarow.length-1],r.column=a,r.row=o,delete e.luckysheet_select_save,r.data=[e],this.lHeight="".concat(n+40,"px"),luckysheet.destroy(),luckysheet.create(r),setTimeout((function(){var e=document.getElementById("luckysheet-sheettable_0"),r=document.getElementById("luckysheetTableContent"),a=r.getContext("2d").getImageData(42,17,e.offsetWidth,e.offsetHeight+10),o=document.createElement("canvas");o.width=e.offsetWidth,o.height=e.offsetHeight;var n=o.getContext("2d");n.putImageData(a,0,0);var l=o.toDataURL("image/png");t.print('<img id="printImage" src="'.concat(l,'">'))}),500)},print:function(e){var t=this,r=document.getElementById("printDom")||document.createElement("iframe");r.id="printDom",document.body.appendChild(r),this.$nextTick((function(){var a=document.getElementById("printDom");a.contentDocument.write(e),a.contentDocument.getElementById("printImage").onload=function(){a.contentWindow.print(),luckysheet.destroy(),t.$emit("sheetPrintOk"),document.body.removeChild(r)}}))}}},c=i,s=(r("d1e3"),r("2877")),d=Object(s["a"])(c,a,o,!1,null,"4cc670b2",null);t["default"]=d.exports},f916:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"overflow-x":"hidden"}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form-model",{ref:"form",attrs:{layout:"inline",model:e.form,rules:e.rules}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:3}},[t("a-form-model-item",{attrs:{prop:"code",label:"编码"}},[t("a-input",{attrs:{placeholder:"表单编码"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1)],1),t("a-col",{attrs:{span:3}},[t("a-form-model-item",{attrs:{prop:"code",label:"分类"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,placeholder:"请选择",dictCode:"sys_category,name,id,id!='1328995025744318466'"},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}})],1)],1),t("a-col",{attrs:{span:5}},[t("a-form-model-item",{attrs:{prop:"name",label:"名称"}},[t("a-input",{attrs:{placeholder:"表单名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),t("a-col",{attrs:{span:5}},[t("a-form-model-item",{staticClass:"a-form-item-width-gy",attrs:{prop:"reguId",label:"技术规程"}},[t("a-select",{attrs:{allowClear:""},on:{change:e.reguDetaiChange},model:{value:e.form.reguId,callback:function(t){e.$set(e.form,"reguId",t)},expression:"form.reguId"}},e._l(e.treeDataSource,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.id}},[e._v(" "+e._s(r.name+(r.version?"(".concat(r.version,")"):""))+" ")])})),1)],1)],1),t("a-col",{attrs:{span:4}},[t("a-form-model-item",{attrs:{prop:"lineId",label:"所属线路"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,placeholder:"请选择",dictCode:"bu_mtr_line,line_name,line_id|train_type_id"},model:{value:e.form.lineId,callback:function(t){e.$set(e.form,"lineId",t)},expression:"form.lineId"}})],1)],1),t("a-col",{attrs:{span:3}},[t("a-form-model-item",{attrs:{prop:"repairProgramId",label:"所属修程"}},[t("j-dict-select-tag",{ref:"lineSelect",attrs:{triggerChange:!0,placeholder:"请选择",dictCode:"bu_repair_program,name,id"},model:{value:e.form.repairProgramId,callback:function(t){e.$set(e.form,"repairProgramId",t)},expression:"form.repairProgramId"}})],1)],1)],1),t("a-row",[t("a-col",{attrs:{span:4}},[t("a-form-model-item",{attrs:{label:"当前选中"}},[e._v(" "+e._s(e.curRange)+" "),e.curRange&&!e.manyCell?t("span",[e._v("["+e._s(e.curIsAllow?"可编辑":"不可编辑")+"]")]):e._e()])],1),t("a-col",{attrs:{span:5}},[t("a-space",[t("a-button",{attrs:{type:"dashed"},on:{click:function(t){return e.setCellEditAble(null,!0)}}},[e._v("可编辑")]),"1328995639249358850"!==e.form.category?t("a-button",{attrs:{type:"dashed"},on:{click:function(t){return e.allEditAble(!0)}}},[e._v("全部可编辑")]):e._e(),t("a-button",{attrs:{type:"dashed"},on:{click:function(t){return e.setCellEditAble(null,!1)}}},[e._v("不可编辑")])],1)],1),t("a-col",{staticClass:"space-btn",attrs:{span:5}},[t("a-button",{attrs:{type:"primary"},on:{click:e.onSave}},[e._v("保存")]),t("a-button",{on:{click:e.openFile}},[e._v(" 导入表格 "),t("input",{ref:"file",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.uploadExcel}})])],1)],1)],1)],1),t("div",{staticStyle:{margin:"0px",padding:"0px",width:"100%",height:"calc(100vh - 127px)"},attrs:{id:"luckysheet"}}),e.showLoading?t("div",{staticStyle:{width:"100%","text-align":"center",position:"absolute",top:"0px",height:"100%","font-size":"16px","z-index":"1000000000",background:"#fff"}},[e._m(0)]):e._e()])},o=[function(){var e=this,t=e._self._c;return t("div",{staticStyle:{position:"relative",top:"45%",width:"100%"}},[t("div",{staticClass:"luckysheetLoaderGif"}),t("span",[e._v("加载中...")])])}],n=r("8fad"),l=r("ca00"),i=r("2410"),c=r.n(i),s=r("7268");function d(e){return m(e)||f(e)||h(e)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(e,t){if(e){if("string"==typeof e)return g(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}function f(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function m(e){if(Array.isArray(e))return g(e)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}var p={name:"edit",props:["formInfo"],data:function(){var e=this;return{treeDataSource:[],showLoading:!1,form:{code:"",name:"",category:"",content:"",type:1,lineId:"",repairProgramId:"",createGroupId:"",reguId:"",datajson:""},rules:{code:[{required:!0,message:"请输入表单编码",trigger:"blur"},{max:7,message:"输入长度不能超过7字符!",trigger:"blur"}],name:[{required:!0,message:"请输入表单名称",trigger:"blur"},{max:100,message:"输入长度不能超过100字符!",trigger:"blur"}],lineId:[{required:!0,message:"请选择线路",trigger:"blur"}],repairProgramId:[{required:!0,message:"请选择修程",trigger:"blur"}]},curRange:"",curIsAllow:!1,manyCell:!1,allowRange:"",colNames:[],defaultOptions:{container:"luckysheet",title:"sheet",column:26,row:50,lang:"zh",allowEdit:!0,showinfobar:!1,sheetFormulaBar:!0,showsheetbar:!1,showstatisticBar:!0,enableAddRow:!1,enableAddCol:!1,showtoolbar:!0,hook:{sheetMouseup:function(t,r,a,o){e.onSelectRange()},workbookCreateAfter:function(t){"1328995639249358850"===e.form.category&&luckysheet.getLuckysheetfile().forEach((function(t,r){e.setDefaultAllowEdit(t)}))}}}}},beforeDestroy:function(){luckysheet.destroy()},mounted:function(){var e=this;this.queryTreeData();for(var t=65;t<91;t++)this.colNames.push(String.fromCharCode(t));this.formInfo&&Object.assign(this.form,this.formInfo);var r=c()(this.defaultOptions);r.data=[{name:"Sheet1",color:"",status:"1",order:"0",index:0,ch_width:2044,rh_height:1080}],this.form.id?Object(n["Db"])(this.form.id).then((function(e){if(e.success){var t=JSON.parse(e.result);r.data=[t],luckysheet.destroy(),luckysheet.create(r)}})).catch((function(t){e.$message.error("加载表单内容异常"),luckysheet.destroy(),luckysheet.create(r)})):(luckysheet.destroy(),luckysheet.create(r))},methods:{reguDetaiChange:function(e){if(e){var t=this.treeDataSource.filter((function(t,r){return t.id===e}));t.length>0&&(t=t[0],this.form.lineId=t.lineId,this.form.repairProgramId=t.repairProId,this.$forceUpdate())}},queryTreeData:function(){var e=this;Object(n["Wb"])().then((function(t){t.success&&(e.treeDataSource=t.result)}))},onSave:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;var r=luckysheet.getAllSheets()[0];if("1328995639249358850"===e.form.category)try{var a=e.getMetadata(r,!0);a&&(e.form.datajson=JSON.stringify(a))}catch(o){}r.scrollLeft=0,r.scrollTop=0,r.data=[],r.luckysheet_select_save=[],e.form.content=JSON.stringify(r),e.form.createGroupId||(e.form.createGroupId=e.$store.getters.userInfo.departId),e.form.id?Object(n["Rd"])(e.form).then((function(t){t.success?(e.$message.success("保存成功"),e.$emit("saveSuccess"),e.closeWindow()):e.$message.error("保存失败")})).catch((function(t){e.$message.error("保存自定义表单异常")})):Object(n["b"])(e.form).then((function(t){t.success?(e.$message.success("保存成功"),e.$emit("saveSuccess"),e.closeWindow()):e.$message.error("保存失败")})).catch((function(t){e.$message.error("保存自定义表单异常")}))}))},closeWindow:function(){luckysheet.destroy(),this.$emit("update:visible",!1)},openFile:function(){this.$refs.file.dispatchEvent(new MouseEvent("click"))},uploadExcel:function(e){var t=this;this.showLoading=!0;var r=e.target.files;if(null!=r&&0!==r.length){var a="";try{var o=r[0].name.split(".");a=o[o.length-1]}catch(n){a=""}if(""===a||"xlsx"!==a)return this.$message.error("不是有效的EXCEL文件,只支持xlsx格式的EXCEL文件"),void(this.showLoading=!1);LuckyExcel.transformExcelToLucky(r[0],(function(r,a){if(null==r.sheets||0===r.sheets.length)return t.$message.error("读取EXCEL文件失败, 当前不支持xls格式的excel文件!"),void(t.showLoading=!1);var o=c()(t.defaultOptions);r.sheets.forEach((function(e){e.config.authority={sheet:0,hintText:"禁止编辑",allowRangeList:[]}})),o.data=r.sheets,luckysheet.destroy(),t.showLoading=!1,luckysheet.create(o),t.form.name=r.info.name.replace(".xlsx",""),t.form.remark=r.info.name,t.form.code=Object(l["n"])(6)+"",t.$forceUpdate(),setTimeout((function(){if("1328995639249358850"===t.form.category)try{var r=luckysheet.getLuckysheetfile()[0],a=t.getMetadata(r,!0);a&&(t.form.datajson=JSON.stringify(a))}catch(e){}}),2e3)}))}else this.showLoading=!1},setDefaultAllowEdit:function(e){if(s["a"].checkProperty(e.config,"authority")&&!(e.config.authority.allowRangeList&&e.config.authority.allowRangeList.length>0)){e.config.authority.sheet=1;var t=[];e.celldata.forEach((function(e){t.push({r:e.r,c:e.c})}));var r=this.getSelectCells(e,t);this.setCellEditAble(e,!0,r)}},getShowRowIndex:function(e){return e+1},onSelectRange:function(){var e=luckysheet.getLuckysheetfile()[0],t=luckysheet.getRange()[0];this.curRange=this.colNames[t.column[0]]+this.getShowRowIndex(t.row[0])+":"+this.colNames[t.column[1]]+this.getShowRowIndex(t.row[1]),e.config.authority&&e.config.authority.allowRangeList&&(this.curIsAllow=!!this.searchAllowRange(t,e.config.authority.allowRangeList),this.manyCell=t.column[0]!==t.column[1]||t.row[0]!==t.row[1])},searchAllowRange:function(e,t){var r=null;if(!t||t.length<1)return null;var a="$"+this.colNames[e.column[0]]+"$"+this.getShowRowIndex(e.row[0]),o=e.column[0]===e.column[1]&&e.row[0]===e.row[1];return o||(a+=":$"+this.colNames[e.column[1]]+"$"+this.getShowRowIndex(e.row[1])),t.forEach((function(e,t){if(e.sqref===a)return!0,r=e,r["index"]=t,!0})),r},setCellEditAble:function(e,t){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null==e&&(e=luckysheet.getLuckysheetfile()[0]),a||(a=this.getSelectCells(e)),a.length<1||a.forEach((function(a){var o=null;if(s["a"].checkProperty(a,"mc")){if(!s["a"].checkProperty(a.mc,"rs")||!s["a"].checkProperty(a.mc,"cs"))return;o={row:[a.mc.r,a.mc.r+a.mc.rs-1],column:[a.mc.c,a.mc.c+a.mc.cs-1]}}else o={row:[a.r,a.r],column:[a.c,a.c]};var n=r.searchAllowRange(o,e.config.authority.allowRangeList);if(n)t||e.config.authority.allowRangeList.splice(n.index,1);else if(t){var l="$"+r.colNames[o.column[0]]+"$"+r.getShowRowIndex(o.row[0]),i=o.column[0]===o.column[1]&&o.row[0]===o.row[1];i||(l+=":$"+r.colNames[o.column[1]]+"$"+r.getShowRowIndex(o.row[1]));var c="area_"+l,d=r.buildAllowRange(c,l);e.config.authority.allowRangeList.push(d)}}))},allEditAble:function(e){var t=luckysheet.getLuckysheetfile()[0];e?t.config.authority.sheet=0:(t.config.authority.sheet=1,t.config.authority.allowRangeList=[]),this.$message.success("设置成功，注意保存设置！")},getSelectCells:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t||(t=luckysheet.getRangeWithFlatten());var r=[];return t.forEach((function(t){var a=e.data[t.r][t.c];a?r.push(Object.assign({r:t.r,c:t.c},a)):r.push({r:t.r,c:t.c})})),r},buildAllowRange:function(e,t){return{name:e,hintText:"",algorithmName:"None",saltValue:null,sqref:t}},getRangeWithFlatten:function(e){for(var t=[],r=e.row[0];r<=e.row[1];r++)for(var a=e.column[0];a<=e.column[1];a++)t.push({r:r,c:a});return t},getMetadata:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=luckysheet.transToData(e.celldata),a={checkDetail:{id:"checkDetail",name:"作业记录表作业项明细",type:"zone",rowIndex:-1,colIndex:0,rowIndexTo:-1,colIndexTo:-1,rows:[]}},o=[],n=0;n<r.length;n++){var l=r[n],i=[];o.push(i);for(var c=0;c<l.length;c++){var u=l[c];if(u){var h=s["a"].getCellText(u);if(!h&&s["a"].checkProperty(u,"mc")){var f=u.mc;if(s["a"].checkProperty(f,"r")&&s["a"].checkProperty(f,"c")&&s["a"].checkProperty(f,"rs")&&s["a"].checkProperty(f,"cs"));else if(s["a"].checkProperty(f,"r")&&s["a"].checkProperty(f,"c")){var m=o[f.r][f.c];h=m||""}}h?i.push(h):i.push("")}else i.push("")}if(i.includes("结果")&&i.includes("自检")&&i.includes("互检")){var g={id:"detailTitle",name:"明细标题行",type:"row",rowIndex:n,rowIndexTo:n,cells:{}};a.checkDetail.rows.push(g),a.checkDetail.rowIndex=n;for(var p=0;p<l.length;p++){var y=l[p];if(y){a.checkDetail.colIndexTo=p;var v=s["a"].getCellText(y);if(v){var x=s["a"].getCellLocation(n,p,y);switch(v){case"序号":g.cells.xh={id:"xh",name:"序号",type:"cell",cellType:"title",rowIndex:x.rowIndex,rowIndexTo:x.rowIndexTo,colIndex:x.colIndex,colIndexTo:x.colIndexTo};break;case"项目":g.cells.xm={id:"xm",name:"项目",type:"cell",cellType:"title",rowIndex:x.rowIndex,rowIndexTo:x.rowIndexTo,colIndex:x.colIndex,colIndexTo:x.colIndexTo};break;case"位置":case"作业内容":g.cells.zynr={id:"zynr",name:"作业内容",type:"cell",cellType:"title",rowIndex:x.rowIndex,rowIndexTo:x.rowIndexTo,colIndex:x.colIndex,colIndexTo:x.colIndexTo};break;case"控制点":g.cells.kzd={id:"kzd",name:"控制点",type:"cell",cellType:"title",rowIndex:x.rowIndex,rowIndexTo:x.rowIndexTo,colIndex:x.colIndex,colIndexTo:x.colIndexTo};break;case"技术要求":g.cells.jsyq={id:"jsyq",name:"技术要求",type:"cell",cellType:"title",rowIndex:x.rowIndex,rowIndexTo:x.rowIndexTo,colIndex:x.colIndex,colIndexTo:x.colIndexTo};break;case"作业情况":g.cells.zyqk={id:"zyqk",name:"作业情况",type:"cell",cellType:"title",rowIndex:x.rowIndex,rowIndexTo:x.rowIndexTo,colIndex:x.colIndex,colIndexTo:x.colIndexTo};break;case"结果":g.cells.jg={id:"jg",name:"结果",type:"cell",cellType:"title",rowIndex:x.rowIndex,rowIndexTo:x.rowIndexTo,colIndex:x.colIndex,colIndexTo:x.colIndexTo};break;case"自检":g.cells.zijian={id:"zijian",name:"自检",type:"cell",cellType:"title",rowIndex:x.rowIndex,rowIndexTo:x.rowIndexTo,colIndex:x.colIndex,colIndexTo:x.colIndexTo};break;case"互检":g.cells.hujian={id:"hujian",name:"互检",type:"cell",cellType:"title",rowIndex:x.rowIndex,rowIndexTo:x.rowIndexTo,colIndex:x.colIndex,colIndexTo:x.colIndexTo};break;case"专检":g.cells.zhuanjian={id:"zhuanjian",name:"专检",type:"cell",cellType:"title",rowIndex:x.rowIndex,rowIndexTo:x.rowIndexTo,colIndex:x.colIndex,colIndexTo:x.colIndexTo};default:}}}}}if(a.checkDetail.rowIndex>-1&&a.checkDetail.rows.length>0){var w=a.checkDetail.rows[0].cells,b=i[w.xh.colIndex];if(b&&parseInt(b)>0){a.checkDetail.rowIndexTo=n;var I=l[w.zynr.colIndex],k=!1;if(I)if(s["a"].checkProperty(I,"mc")){var T=I.mc;s["a"].checkProperty(T,"r")&&s["a"].checkProperty(T,"c")&&s["a"].checkProperty(T,"rs")&&s["a"].checkProperty(T,"cs")?k=!0:s["a"].checkProperty(T,"r")&&s["a"].checkProperty(T,"c")&&(k=!1)}else k=!0;k&&a.checkDetail.rows.push({xh:{id:"xh",name:i[w.xh.colIndex],type:"cell",cellType:"title",rowIndex:n,rowIndexTo:n,colIndex:w.xh.colIndex,colIndexTo:w.xh.colIndexTo},xm:{id:"xm",name:i[w.xm.colIndex],type:"cell",cellType:"title",rowIndex:n,rowIndexTo:n,colIndex:w.xm.colIndex,colIndexTo:w.xm.colIndexTo},zynr:{id:"zynr",name:i[w.zynr.colIndex],type:"cell",cellType:"title",rowIndex:n,rowIndexTo:n,colIndex:w.zynr.colIndex,colIndexTo:w.zynr.colIndexTo},kzd:{id:"kzd",name:i[w.kzd.colIndex],type:"cell",cellType:"title",rowIndex:n,rowIndexTo:n,colIndex:w.kzd.colIndex,colIndexTo:w.kzd.colIndexTo},jsyq:{id:"jsyq",name:i[w.jsyq.colIndex],type:"cell",cellType:"title",rowIndex:n,rowIndexTo:n,colIndex:w.jsyq.colIndex,colIndexTo:w.jsyq.colIndexTo}})}}}var S=!0;if(a.checkDetail.rows.length<1||-1===a.checkDetail.rowIndex||-1===a.checkDetail.rowIndexTo)S=!1,t&&this.$message.warn("该作业记录表不是标准格式，无法找到作业项，请知晓");else{var D=a.checkDetail.rows[0].cells,C=[];s["a"].checkProperty(D,"zyqk")&&C.push.apply(C,d(this.getRangeWithFlatten({row:[a.checkDetail.rowIndex,a.checkDetail.rowIndexTo],column:[D.zyqk.colIndex,D.zyqk.colIndex]}))),s["a"].checkProperty(D,"jg")&&C.push.apply(C,d(this.getRangeWithFlatten({row:[a.checkDetail.rowIndex,a.checkDetail.rowIndexTo],column:[D.jg.colIndex,D.jg.colIndex]}))),s["a"].checkProperty(D,"zijian")&&C.push.apply(C,d(this.getRangeWithFlatten({row:[a.checkDetail.rowIndex,a.checkDetail.rowIndexTo],column:[D.zijian.colIndex,D.zijian.colIndex]}))),s["a"].checkProperty(D,"hujian")&&C.push.apply(C,d(this.getRangeWithFlatten({row:[a.checkDetail.rowIndex,a.checkDetail.rowIndexTo],column:[D.hujian.colIndex,D.hujian.colIndex]}))),s["a"].checkProperty(D,"zhuanjian")&&C.push.apply(C,d(this.getRangeWithFlatten({row:[a.checkDetail.rowIndex,a.checkDetail.rowIndexTo],column:[D.zhuanjian.colIndex,D.zhuanjian.colIndex]}))),this.setCellEditAble(e,!1,this.getSelectCells(e,C))}if(S){var _=s["a"].searchCellByText("检查结果",r);if(_&&_.r!==a.checkDetail.rowIndex){a["checkResult"]={id:"checkResult",name:"检查结果",type:"cell",cellType:"write",isJoin:!1,original:"",rowIndex:_.r,colIndex:_.c,rowIndexTo:_.r,colIndexTo:_.c};var $={r:_.r,c:_.c};_.mc&&_.mc.rs&&_.mc.cs&&($={r:_.mc.r,c:_.mc.c});var P=this.getSelectCells(e,[$]);this.setCellEditAble(e,!1,P)}else t&&this.$message.warn("该作业记录表不是标准格式，无法找到 '检查结果' 输入处，请知晓");return a}e.config.authority.sheet=0}}},y=p,v=(r("1968"),r("a957"),r("2877")),x=Object(v["a"])(y,a,o,!1,null,null,null);t["default"]=x.exports}}]);