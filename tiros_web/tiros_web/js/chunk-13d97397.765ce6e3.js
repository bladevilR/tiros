(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13d97397","chunk-2d0df437","chunk-2d0df437"],{"88bc":function(e,r,a){(function(r){var a=1/0,t=9007199254740991,i="[object Arguments]",o="[object Function]",l="[object GeneratorFunction]",n="[object Symbol]",s="object"==typeof r&&r&&r.Object===Object&&r,c="object"==typeof self&&self&&self.Object===Object&&self,d=s||c||Function("return this")();function u(e,r,a){switch(a.length){case 0:return e.call(r);case 1:return e.call(r,a[0]);case 2:return e.call(r,a[0],a[1]);case 3:return e.call(r,a[0],a[1],a[2])}return e.apply(r,a)}function p(e,r){var a=-1,t=e?e.length:0,i=Array(t);while(++a<t)i[a]=r(e[a],a,e);return i}function m(e,r){var a=-1,t=r.length,i=e.length;while(++a<t)e[i+a]=r[a];return e}var f=Object.prototype,h=f.hasOwnProperty,v=f.toString,b=d.Symbol,g=f.propertyIsEnumerable,w=b?b.isConcatSpreadable:void 0,C=Math.max;function y(e,r,a,t,i){var o=-1,l=e.length;a||(a=j),i||(i=[]);while(++o<l){var n=e[o];r>0&&a(n)?r>1?y(n,r-1,a,t,i):m(i,n):t||(i[i.length]=n)}return i}function I(e,r){return e=Object(e),k(e,r,(function(r,a){return a in e}))}function k(e,r,a){var t=-1,i=r.length,o={};while(++t<i){var l=r[t],n=e[l];a(n,l)&&(o[l]=n)}return o}function x(e,r){return r=C(void 0===r?e.length-1:r,0),function(){var a=arguments,t=-1,i=C(a.length-r,0),o=Array(i);while(++t<i)o[t]=a[r+t];t=-1;var l=Array(r+1);while(++t<r)l[t]=a[t];return l[r]=o,u(e,this,l)}}function j(e){return O(e)||R(e)||!!(w&&e&&e[w])}function L(e){if("string"==typeof e||T(e))return e;var r=e+"";return"0"==r&&1/e==-a?"-0":r}function R(e){return P(e)&&h.call(e,"callee")&&(!g.call(e,"callee")||v.call(e)==i)}var O=Array.isArray;function $(e){return null!=e&&_(e.length)&&!N(e)}function P(e){return q(e)&&$(e)}function N(e){var r=F(e)?v.call(e):"";return r==o||r==l}function _(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=t}function F(e){var r=typeof e;return!!e&&("object"==r||"function"==r)}function q(e){return!!e&&"object"==typeof e}function T(e){return"symbol"==typeof e||q(e)&&v.call(e)==n}var A=x((function(e,r){return null==e?{}:I(e,p(y(r,1),L))}));e.exports=A}).call(this,a("c8ba"))},f9332:function(e,r,a){"use strict";a.r(r);var t=function(){var e=this,r=e._self._c;return r("a-modal",{attrs:{title:e.title,width:"80%",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[r("a-spin",{attrs:{spinning:e.confirmLoading}},[r("a-form",{attrs:{form:e.form}},[r("a-row",{staticStyle:{width:"100%"}},[r("a-col",{attrs:{span:12}},[r("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"规程编码"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["code",e.validatorRules.code],expression:"['code', validatorRules.code]",modifiers:{trim:!0}}]})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"规程名称"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["name",e.validatorRules.name],expression:"['name', validatorRules.name]",modifiers:{trim:!0}}]})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属修程"}},[r("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["repairProId",e.validatorRules.repairProId],expression:"['repairProId', validatorRules.repairProId]"}],attrs:{triggerChange:"",dictCode:"bu_repair_program,name,id"},on:{change:e.handlerRepairPro}})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属车间"}},[r("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["workshopId",e.validatorRules.workshopId],expression:"['workshopId', validatorRules.workshopId]"}],attrs:{triggerChange:"",dictCode:"bu_mtr_workshop,name,id"}})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属线路"}},[r("line-select-list",{directives:[{name:"decorator",rawName:"v-decorator",value:["lineId",e.validatorRules.lineId],expression:"['lineId', validatorRules.lineId]"}],attrs:{"trigger-change":!0},on:{change:e.handlerLine}})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"版本号"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["version",e.validatorRules.version],expression:"['version', validatorRules.version]"}]})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"备注描述"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark",e.validatorRules.remark],expression:"['remark', validatorRules.remark]"}]})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"导入规程"}},[r("a-upload",{attrs:{multiple:!1,"file-list":e.fileList,accept:".xlsx,.xls",remove:e.handleRemove,"before-upload":e.beforeUpload}},[r("a-button",{attrs:{type:"primary"}},[e._v("添加文件")])],1)],1)],1)],1)],1)],1)],1)},i=[],o=a("88bc"),l=a.n(o),n=a("8fad"),s=a("4ec3"),c=a("ca00"),d=a("5633"),u={name:"LeftItemModal",components:{LineSelectList:d["default"]},data:function(){return{value:1,title:"操作",visibleCheck:!0,visible:!1,model:{},fileList:[],trainTypeId:"",labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{code:{rules:[{required:!0,message:"请输入规程编码!"},{validator:this.validateCode},{max:32,message:"输入长度不能超过32字符!"}]},name:{rules:[{required:!0,message:"请输入规程名称!"},{max:32,message:"输入长度不能超过32字符!"}]},repairProId:{rules:[{required:!0,message:"请选择所属修程!"}]},lineId:{rules:[{required:!0,message:"请选择所属线路!"}]},workshopId:{rules:[{required:!0,message:"请选择所属车间!"}]},remark:{rules:[{max:200,message:"输入长度不能超过200字符!"}]},version:{rules:[{max:16,message:"输入长度不能超过16字符!"}]}}}},created:function(){},methods:{handlerRepairPro:function(e,r){r&&(this.model.repairProName=r.title)},handlerLine:function(e,r){r&&(this.trainTypeId=r.trainTypeId)},handleRemove:function(e){var r=this.fileList.indexOf(e),a=this.fileList.slice();a.splice(r,1),this.fileList=a},beforeUpload:function(e){this.model.id&&this.$message.warn("该操作会覆盖原有的规程项,请谨慎使用!");var r=e.size/1024/1024<10;if(r){var a="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type||"application/vnd.ms-excel"===e.type;if(a)return this.$set(this.fileList,0,e),!1;this.$message.error("只支持Excel文件导入!")}else this.$message.error("文件不得大于10MB!")},customRequest:function(e){var r=this,a=this.fileList;a.forEach((function(a){var t=new FormData;t.append("file",a),t.append("name",e.name),t.append("code",e.code),t.append("repairProId",e.repairProId),t.append("lineId",e.lineId),t.append("workshopId",e.workshopId),t.append("trainTypeId",r.trainTypeId),t.append("version",e.version),t.append("remark",e.remark),r.model.id?t.append("id",r.model.id):t.append("id",""),Object(n["oc"])(t).then((function(e){e.success?(r.$message.success(e.message),r.$emit("ok"),r.close()):r.$message.error(e.message)})).finally((function(){r.confirmLoading=!1}))}))},validateCode:function(e,r,a){var t={tableName:"bu_repair_regu_info",fieldName:"code",fieldVal:r,dataId:this.model.id};Object(c["e"])(r)?a():Object(s["m"])(t).then((function(e){e.success?a():a(e.message)}))},add:function(){this.edit({})},edit:function(e){var r=this;e.id?this.visiblekey=!0:this.visiblekey=!1,this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){r.form.setFieldsValue(l()(r.model,"code","name","lineId","workshopId","repairProId","version","remark"))}))},handleOk:function(){var e=this;e.form.validateFields((function(r,a){if(!r){e.confirmLoading=!0;var t=Object.assign(e.model,a);e.fileList.length>0?e.customRequest(t):Object(n["Uc"])(t).then((function(r){r.success?(e.$message.success(r.message),e.$emit("ok",!0),e.confirmLoading=!1,e.close()):e.$message.warning(r.message)}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,this.fileList=[]}}},p=u,m=a("2877"),f=Object(m["a"])(p,t,i,!1,null,null,null);r["default"]=f.exports}}]);