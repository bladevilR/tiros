(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76e8c6a9"],{"0fda":function(e,t,a){"use strict";a("4125")},4125:function(e,t,a){},fc4d:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.name+"表单管理",width:"100%",visible:e.visible,confirmLoading:e.confirmLoading,dialogClass:"fullDialog no-footer",destroyOnClose:!0},on:{cancel:e.handleCancel}},[t("a-row",{attrs:{id:"sheetContent",gutter:8}},[t("a-col",{attrs:{md:18,sm:24}},[t("a-card",{staticClass:"left"},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchQuery.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:8}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"表单"}},[t("a-input",{attrs:{placeholder:"请输入编码或名称",allowClear:""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"类型"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"bu_work_form_type"},model:{value:e.queryParam.type,callback:function(t){e.$set(e.queryParam,"type",t)},expression:"queryParam.type"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"修程"}},[t("j-dict-select-tag",{attrs:{triggerChange:"",dictCode:"bu_repair_program,name,id"},model:{value:e.queryParam.repairProId,callback:function(t){e.$set(e.queryParam,"repairProId",t)},expression:"queryParam.repairProId"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"线路"}},[t("line-select-list",{model:{value:e.queryParam.lineId,callback:function(t){e.$set(e.queryParam,"lineId",t)},expression:"queryParam.lineId"}})],1)],1)],1),t("a-row",[t("a-col",{attrs:{md:8,sm:8}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.searchQuery}},[e._v("查询")]),t("a-button",{on:{click:e.link}},[e._v("关联")])],1)],1)])],1)],1)],1),t("div",{staticStyle:{height:"calc(100vh - 247px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(100vh - 247px)"},attrs:{border:"","auto-resize":"","max-height":"100%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{trigger:"manual",mode:"row"}}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{field:"formName",title:"表单名称","min-width":"200",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"code",title:"表单编码","min-width":"100",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("div",{style:{backgroundColor:e.statusColor[r.status+""],borderRadius:"4px"}},[e._v(" "+e._s(r.status_dictText)+" ")])]}}])}),t("vxe-table-column",{attrs:{field:"type_dictText",title:"类型",width:"100"}}),t("vxe-table-column",{attrs:{field:"createGroupName",title:"创建班组",width:"150"}}),t("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"180",align:"left","header-align":"center"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)])],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-card",{staticClass:"right"},[t("div",{staticClass:"typeTitle"},[e._v("已关联表单")]),t("vxe-table",{attrs:{"show-header":!1,data:e.sheetList,border:"none","show-overflow":"tooltip"}},[t("vxe-table-column",{attrs:{align:"left",field:"formName"}}),t("vxe-table-column",{attrs:{align:"right",width:"40"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("a-icon",{attrs:{type:"close"},on:{click:function(t){return t.stopPropagation(),e.deleteSheet(r)}}})]}}])})],1)],1)],1)],1)],1)},i=[],s=a("5633"),n=a("8fad"),l={components:{LineSelectList:s["default"]},data:function(){return{visible:!1,allAlign:"center",id:"",name:"",statusColor:{0:"#dedede",1:"#bad795"},queryParam:{searchText:"",workstationId:"",repairProId:"",lineId:"",type:null,pageNo:1,pageSize:10},totalResult:0,sheetList:[],tableData:[],confirmLoading:!1}},methods:{show:function(e){this.visible=!0,this.id=e.id,this.name=e.name,this.queryParam.workstationId=e.id,this.findList(),this.getRelatedFormList()},findList:function(){var e=this;this.loading=!0,"admin"===this.$store.getters.userInfo.username?this.queryParam.createGroupId=null:this.queryParam.createGroupId=this.$store.getters.userInfo.departId,Object(n["Lc"])(this.queryParam).then((function(t){if(t.success){e.totalResult=t.result.total,e.loading=!1;for(var a=t.result.records,r=0;r<a.length;r++)a[r].type_dictText||(a[r].type_dictText="作业记录表");e.tableData=a}}))},getRelatedFormList:function(){var e=this,t={workstationId:this.id,repairProId:this.queryParam.repairProId,lineId:this.queryParam.lineId,type:this.queryParam.type};Object(n["Bc"])(t).then((function(t){t.success&&(e.sheetList=t.result)}))},searchQuery:function(){this.findList(),this.getRelatedFormList()},deleteSheet:function(e){var t=this;this.$confirm({content:"是否删除该关联表单",onOk:function(){Object(n["s"])("id="+e.id).then((function(e){e.success&&(t.$message.success(e.message),t.findList(),t.getRelatedFormList())}))}})},getSelectEvent:function(){var e=this.$refs.listTable.getCheckboxRecords();this.$XModal.alert(e.length)},link:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();t.length>0?this.$confirm({content:"是否关联选中".concat(t.length,"数据？"),onOk:function(){var a=[];Object.assign(a,t);for(var r=0;r<a.length;r++)a[r].workstationId=e.id;Object(n["Oc"])(a).then((function(t){t.success&&(e.$message.success("关联成功!"),e.findList(),e.getRelatedFormList())}))}}):this.$message.error("尚未选中任何数据!")},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},o=l,c=(a("0fda"),a("2877")),u=Object(c["a"])(o,r,i,!1,null,null,null);t["default"]=u.exports}}]);