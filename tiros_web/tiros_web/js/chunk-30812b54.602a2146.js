(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-30812b54","chunk-29136323","chunk-cfac6c42"],{"0743":function(e,t,r){},1158:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:"工位选择",centered:"",bodyStyle:{height:"80vh"},visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{staticStyle:{"border-right":"1px dotted #D3E1F1",height:"calc(80vh - 20px)","margin-right":"8px",padding:"0px"},attrs:{md:4,sm:24}},[e.treeData.length?t("a-tree",{attrs:{defaultExpandAll:"","tree-data":e.treeData,"default-selected-keys":e.defaultKey,dropdownStyle:{maxHeight:"200px",overflow:"auto"},replaceFields:{title:"name",key:"id"}},on:{select:e.onSelect}}):e._e()],1),t("a-col",{attrs:{md:19,sm:24}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getWorkStation.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"工位"}},[t("a-input",{attrs:{placeholder:"请输入工位名称","allow-clear":""},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"班组"}},[t("j-dict-select-tag",{attrs:{dictCode:"sys_depart,depart_name,id,org_category=4",placeholder:"请选择"},model:{value:e.queryParam.groupId,callback:function(t){e.$set(e.queryParam,"groupId",t)},expression:"queryParam.groupId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-space",[t("a-button",{on:{click:e.getWorkStation}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticClass:"limitHeight"},[t("vxe-table",{ref:"listTable",staticStyle:{height:"100%"},attrs:{border:"","row-id":"id",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"},"radio-config":{trigger:"row"},"checkbox-config":{trigger:"row",highlight:!0,range:!0,checkStrictly:!0},"max-height":"100%"}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"stationNo",title:"工位号",width:"100"}}),t("vxe-table-column",{attrs:{field:"name",title:"工位名称",width:"20%",align:"left"}}),t("vxe-table-column",{attrs:{field:"groupName",title:"所属班组",width:"20%",align:"left"}}),t("vxe-table-column",{attrs:{field:"location",title:"位置",width:"100",align:"left"}}),t("vxe-table-column",{attrs:{field:"content",title:"作业内容",width:"25%",align:"left"}}),t("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"10%",align:"left"}})],1)],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.page.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)],1)],1)},o=[],a=r("8fad"),i={name:"WorkStationList",props:{multiple:{type:Boolean,default:!1},groupId:{type:String,default:null}},data:function(){return{visible:!1,confirmLoading:!1,treeData:[],tableData:[],allAlign:"center",defaultKey:[],queryParam:{id:"",name:"",groupId:"",pageNo:1,pageSize:10},page:{currentPage:1,pageSize:10,totalResult:3}}},mounted:function(){this.groupId&&(this.queryParam.groupId=this.groupId)},methods:{showModal:function(){this.visible=!0,this.getTreeList()},getTreeList:function(){var e=this;Object(a["Ub"])().then((function(t){t.success&&(e.treeData=t.result,e.defaultKey[0]=t.result[0].id,e.queryParam.id=t.result[0].id,e.getWorkStation())}))},getWorkStation:function(){var e=this;Object(a["Tb"])(this.queryParam).then((function(t){e.page.totalResult=t.result.total,e.tableData=t.result.records}))},onSelect:function(e,t){var r=t.node.dataRef;e.length>0&&(this.queryParam.id=r.id,this.queryParam.pageNo=1,this.getWorkStation())},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.getTreeList()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},s=i,c=(r("7483"),r("2877")),l=Object(c["a"])(s,n,o,!1,null,"ea42f1f8",null);t["default"]=l.exports},"2d1c":function(e,t,r){"use strict";r("8e5e")},"2e75":function(e,t,r){},"3fdc":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{attrs:{"na-flex-height-full":""}},[e.isSelectDetaile?e._e():t("a-space",{staticStyle:{padding:"10px 0"}},[t("a-button",{on:{click:e.setCheckRecordTime}},[e._v("作业完成")]),t("a-button",{directives:[{name:"has",rawName:"v-has",value:"order:write:check:add",expression:"'order:write:check:add'"}],on:{click:e.openSetCheck}},[e._v("检查登记")]),t("a-button",{directives:[{name:"has",rawName:"v-has",value:"order:write:rectify:add",expression:"'order:write:rectify:add'"}],on:{click:e.openRectifyModal}},[e._v("添加整改")])],1),t("div",{attrs:{"na-flex-height-full":""}},[t("vxe-table",{ref:"listTable",attrs:{border:"","auto-resize":"","max-height":"auto","row-id":"id",align:"center",data:e.tableData,"show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0}}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{field:"sortNo",title:"序号",align:"center",width:"60"}}),t("vxe-table-column",{attrs:{field:"title",title:"项点","header-align":"center",align:"left",width:"160"}}),t("vxe-table-column",{attrs:{field:"content",title:"检查内容","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"checkLevel",title:"等级",align:"center",width:"80"}}),e.isSelectDetaile?e._e():t("vxe-table-column",{attrs:{field:"checkDesc",title:"检查情况",align:"center",width:"80"}}),e.isSelectDetaile?e._e():t("vxe-table-column",{attrs:{field:"checkResult_dictText",title:"结果",align:"center",width:"80"}}),e.isSelectDetaile?e._e():t("vxe-table-column",{attrs:{field:"workTime",title:"作业时间",align:"center",width:"115"}}),e.isSelectDetaile?e._e():t("vxe-table-column",{attrs:{field:"checkMethod_dictText",title:"检查方式",align:"center",width:"80"}}),e.isSelectDetaile?e._e():t("vxe-table-column",{attrs:{field:"checkUserName",title:"检查人",align:"center",width:"80"}}),e.isSelectDetaile?e._e():t("vxe-table-column",{attrs:{field:"checkTime",title:"检查时间",align:"center",width:"115"}})],1)],1),t("a-modal",{attrs:{title:"检查",width:800,visible:e.visible,confirmLoading:e.confirmLoading,centered:"",cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-form",{ref:"initForm",attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"登录名称"}},[t("a-row",{attrs:{gutter:10}},[t("a-col",{attrs:{span:14}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["checkUserName",e.validatorRules.checkUserName],expression:"['checkUserName', validatorRules.checkUserName]",modifiers:{trim:!0}}]})],1),t("a-col",{attrs:{span:10}},[t("a-button",{attrs:{type:"link"},on:{click:e.useCurrentUser}},[e._v("使用当前账号和密码")])],1)],1)],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"登录密码"}},[t("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["checkUserPwd",e.validatorRules.checkUserPwd],expression:"['checkUserPwd', validatorRules.checkUserPwd]",modifiers:{trim:!0}}]})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查方式"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["checkMethod",e.validatorRules.checkMethod],expression:"['checkMethod', validatorRules.checkMethod]"}],attrs:{triggerChange:"",placeholder:"请选择检查方式",dictCode:"bu_regu_method"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查结果"}},[t("a-checkbox",{model:{value:e.checkResult,callback:function(t){e.checkResult=t},expression:"checkResult"}},[e._v(" 合格 ?")])],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查时间"}},[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD HH:mm:ss","show-time":{format:"HH:mm:ss",hideDisabledOptions:!0}},model:{value:e.checkQueryParam.checkTime,callback:function(t){e.$set(e.checkQueryParam,"checkTime",t)},expression:"checkQueryParam.checkTime"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"结果描述"}},[t("a-textarea",{attrs:{"auto-size":{minRows:8,maxRows:8}},model:{value:e.checkQueryParam.checkDesc,callback:function(t){e.$set(e.checkQueryParam,"checkDesc",t)},expression:"checkQueryParam.checkDesc"}})],1)],1)],1),t("rectify-modal",{ref:"modalForm"}),t("WorkTimeModal",{ref:"workTimeModal",on:{ok:function(t){return e.findList()}}})],1)},o=[],a=r("5315"),i=r("7b165"),s=r("b9c3"),c=r("8fad"),l=r("c1df"),u=r.n(l);function d(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var c=n&&n.prototype instanceof s?n:s,l=Object.create(c.prototype);return f(l,"_invoke",function(r,n,o){var a,s,c,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,r){return a=t,s=0,c=e,f.n=r,i}};function h(r,n){for(s=r,c=n,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],h=f.p,m=a[2];r>3?(o=m===n)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=h&&((o=r<2&&h<a[1])?(s=0,f.v=n,f.n=a[1]):h<m&&(o=r<3||a[0]>n||n>m)&&(a[4]=r,a[5]=n,f.n=m,s=0))}if(o||r>1)return i;throw d=!0,n}return function(o,u,m){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,m),s=u,c=m;(t=s<2?e:c)||!d;){a||(s?s<3?(s>1&&(f.n=-1),h(s,c)):f.n=c:f.v=c);try{if(l=2,a){if(s||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=a.return)&&t.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((t=(d=f.n<0)?c:r.call(n,f))!==i)break}catch(t){a=e,s=1,c=t}finally{l=1}}return{value:t,done:d}}}(r,o,a),!0),l}var i={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(f(t={},n,(function(){return this})),t),h=l.prototype=s.prototype=Object.create(u);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,f(e,o,"GeneratorFunction")),e.prototype=Object.create(h),e}return c.prototype=l,f(h,"constructor",l),f(l,"constructor",c),c.displayName="GeneratorFunction",f(l,o,"GeneratorFunction"),f(h),f(h,o,"Generator"),f(h,n,(function(){return this})),f(h,"toString",(function(){return"[object Generator]"})),(d=function(){return{w:a,m:m}})()}function f(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}f=function(e,t,r,n){function a(t,r){f(e,t,(function(e){return this._invoke(t,r,e)}))}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},f(e,t,r,n)}function h(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){h(a,n,o,i,s,"next",e)}function s(e){h(a,n,o,i,s,"throw",e)}i(void 0)}))}}var p={name:"TaskCheckForm",components:{WorkTimeModal:i["default"],RectifyModal:a["default"]},props:{taskFormsList:{type:Array,default:function(){return[]}},tasks:{type:Array,default:function(){return[]}},readOnly:{type:Boolean,default:!1},selectTask:{type:Object,default:null},workOrderInfo:{type:Object,default:function(){}},forms:{type:Array,default:function(){return[]}},modalType:{type:Number,default:0}},computed:{isSelectDetaile:function(){return 1===this.modalType}},mounted:function(){},data:function(){return{visible:!1,confirmLoading:!1,form:this.$form.createForm(this),labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:20}},labelCol2:{xs:{span:24},sm:{span:6}},wrapperCol2:{xs:{span:24},sm:{span:16}},validatorRules:{checkUserName:{rules:[{required:!0,message:"请输入登录名称!"}]},checkUserPwd:{rules:[{required:!0,message:"请输入密码!"}]},checkMethod:{rules:[{required:!0,message:"请选择!"}]}},tableData:[],queryParam:{formInstId:"",task2InstId:""},checkQueryParam:{checkUserName:"",checkUserPwd:"",itemIds:"",checkResult:1,checkDesc:"",checkMethod:null,checkTime:void 0},checkResult:!0}},methods:{findList:function(){var e=m(d().m((function e(t,r){var n=this;return d().w((function(e){while(1)switch(e.n){case 0:return r&&(this.queryParam.formInstId=r),t&&(this.queryParam.task2InstId=t),e.a(2,Object(s["s"])(this.queryParam).then((function(e){return e.success?n.tableData=e.result.sort((function(e,t){return e.sortNo-t.sortNo})):(n.$message.error(e.message),[])})))}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}(),findModelDetaile:function(e){var t=this;Object(c["lc"])({id:e.formObjId}).then((function(e){e.success?t.tableData=e.result.itemList.sort((function(e,t){return e.sortNo-t.sortNo})):t.$message.error(e.message)}))},setCheckRecordTime:function(){var e=this.$refs.listTable.getCheckboxRecords().map((function(e){return e.id}));e.length?this.$refs.workTimeModal.show(e):this.$message.warn("请选择作业项目")},openSetCheck:function(){var e=m(d().m((function e(){var t,r,n=this;return d().w((function(e){while(1)switch(e.n){case 0:return e.n=1,this.checkTaskCanSubmit(1);case 1:if(t=e.v,t.success){e.n=2;break}return this.$message.warn("".concat(t.formsName,"未完成，请检查！")),this.tabFormKey=this.taskFormsList.findIndex((function(e){return e==t.checkFomrs[0]})),this.$emit("taskFormNoWork",this.tabFormKey),e.a(2);case 2:r=this.$refs.listTable.getCheckboxRecords().map((function(e){return e.id})),r.length?(this.visible=!0,this.checkQueryParam.checkUserName="",this.checkQueryParam.checkUserPwd="",this.checkQueryParam.itemIds=r.join(","),this.checkQueryParam.checkResult=1,this.checkQueryParam.checkDesc="",this.checkQueryParam.type=null,this.isIgnore=!1,this.resultCheck=!0,this.$nextTick((function(){n.form.getFieldDecorator("resultDesc"),n.form.setFieldsValue({checkUserName:n.$store.getters.userInfo.username,checkUserPwd:"~**&&##@@$$%%^^~",checkDesc:"",type:null})}))):this.$message.warn("请选择作业项目");case 3:return e.a(2)}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleOk:function(){var e=this;this.form.validateFields((function(t,r){t||(Object.assign(e.checkQueryParam,r),e.checkQueryParam.checkResult=e.checkResult?1:0,e.checkQueryParam.checkTime?e.checkQueryParam.checkTime=u()(e.checkQueryParam.checkTime).format("YYYY-MM-DD HH:mm:ss"):e.checkQueryParam.checkTime=null,Object(s["Z"])(e.checkQueryParam).then((function(t){t.success?(e.$message.success("保存成功"),e.visible=!1,e.findList(),e.$emit("checkEnd")):e.$message.error(t.message)})))}))},handleCancel:function(){this.visible=!1},useCurrentUser:function(){var e=this;this.$nextTick((function(){e.form.setFieldsValue({checkUserName:e.$store.getters.userInfo.username,checkUserPwd:"~**&&##@@$$%%^^~"})}))},openRectifyModal:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords().map((function(e){return e.content}));t.length?Object(c["Nb"])({moduleCode:"JDXZG"}).then((function(r){r.success?(e.$refs.modalForm.addByRow({orderId:e.selectTask.orderId,orderName:e.workOrderInfo.orderName,depotId:e.workOrderInfo.depotId,orderTaskId:e.selectTask.id,remark:t.join(","),rectifyNo:r.result,groupId:e.workOrderInfo.groupId,lineId:e.workOrderInfo.lineId,lineName:e.workOrderInfo.lineName,trainNo:e.workOrderInfo.trainNo,groupName:e.workOrderInfo.groupName,status:"0"}),e.$refs.modalForm.title="新增"):e.$message.error(r.message)})):this.$message.warn("请选择作业项目")},onIgnoreChange:function(){var e=this;this.$nextTick((function(){e.form.resetFields("resultDesc")}))},checkTaskCanSubmit:function(){var e=m(d().m((function e(){var t,r,n,o=this,a=arguments;return d().w((function(e){while(1)switch(e.n){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:1,!0,r={success:!0,forms:[],records:[],checkFomrs:[]},n=[],0===this.selectTask.outTask&&(1===this.selectTask.taskType||3===this.selectTask.taskType||4===this.selectTask.taskType||5===this.selectTask.taskType)){e.n=1;break}return e.a(2,r);case 1:return this.taskFormsList.forEach((function(e){3===e.instType&&1===t&&n.push(Object(s["R"])({task2InstId:e.id,formInstId:e.formInstId,needCategory:!1,needChecks:!0,orderTaskId:o.selectTask.id}).then((function(e){return e.success&&e.result?(r.forms.push(e.result),e.result.detailList):(o.$message.error("获取表单作业明细失败"),[])}))),4===e.instType&&2===t&&n.push(Object(s["s"])({task2InstId:e.id,formInstId:e.formInstId}).then((function(e){return r.forms.push(e.element),e.success&&e.result?e.result:(o.$message.error("获取表单作业明细失败"),[])})))})),e.a(2,Promise.all(n).then((function(e){return e.forEach((function(e){if(1===t){for(var n=0;n<e.length;n++){var a=e[n];a.isIgnore&&1===a.isIgnore||a.selfCheck&&a.monitorCheck&&a.guarderCheck||(r.success=!1,!1,r.records.push(a))}if(r.forms.length>0){var i=[];r.records.forEach((function(e){i.find((function(t){return t.formInstId===e.workRecordId}))||i.push(o.taskFormsList.find((function(t){return t.formInstId===e.workRecordId})))})),r.checkFomrs=i,r.formsName=i.map((function(e){return"《".concat(e.formName,"》")})).toString()}}if(2===t){for(var s=0;s<e.length;s++){var c=e[s];c.checkUserId&&c.workTime||(r.success=!1,!1,r.records.push(c))}if(r.records.length>0){var l=[];r.records.forEach((function(e){l.find((function(t){return t.formInstId===e.checkId}))||l.push(o.taskFormsList.find((function(t){return t.formInstId===e.checkId})))})),r.checkFomrs=l,r.formsName=l.map((function(e){return"《".concat(e.formName,"》")})).toString()}}})),r})))}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getIDRecords:function(){return this.$refs.listTable.getCheckboxRecords().map((function(e){return e.id})).toString()}}},k=p,g=r("2877"),b=Object(g["a"])(k,n,o,!1,null,null,null);t["default"]=b.exports},4681:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:"90%",visible:e.visible,confirmLoading:e.confirmLoading,centered:"",cancelText:"关闭",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[4===e.formObj.instType?t("div",{staticStyle:{height:"100%"},attrs:{"layout-flex":""}},[t("TaskCheckForm",{ref:"checkForm",attrs:{taskFormsList:e.taskFormItemList,modalType:1,"flex-full":""},on:{taskFormNoWork:e.onTaskFormNoWork}})],1):e._e(),3===e.formObj.instType?t("div",{staticStyle:{height:"100%"},attrs:{"layout-flex":""}},[t("div",{attrs:{"flex-full":""}},[t("vxe-table",{ref:"recordListTable",attrs:{stripe:!0,border:"","auto-resize":"","max-height":"100%","row-id":"id",align:"center",data:e.taskFormItemList,"show-overflow":"tooltip","span-method":e.mergeRowMethod,"checkbox-config":{trigger:"row",highlight:!0,range:!0}}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{type:"index",title:"序号",align:"center",width:"60"}}),t("vxe-table-column",{attrs:{field:"reguTitle",title:"作业项目",align:"left","header-align":"center",width:"240"}}),t("vxe-table-column",{attrs:{field:"workContent",title:"检修内容",align:"left"}})],1)],1)]):e._e(),t("check-modal",{ref:"checkModalForm",attrs:{title:e.checkModalTitle},on:{ok:e.onCheckRecord}}),t("BreakdownModal",{ref:"breakdownModal",attrs:{showWorkStation:!0}})],1)},o=[],a=r("8fad"),i=r("3fdc"),s=r("d0f9"),c=(r("b9c3"),r("b47d")),l=r("ab7d");function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var c=n&&n.prototype instanceof s?n:s,l=Object.create(c.prototype);return f(l,"_invoke",function(r,n,o){var a,s,c,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,r){return a=t,s=0,c=e,f.n=r,i}};function h(r,n){for(s=r,c=n,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],h=f.p,m=a[2];r>3?(o=m===n)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=h&&((o=r<2&&h<a[1])?(s=0,f.v=n,f.n=a[1]):h<m&&(o=r<3||a[0]>n||n>m)&&(a[4]=r,a[5]=n,f.n=m,s=0))}if(o||r>1)return i;throw d=!0,n}return function(o,u,m){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,m),s=u,c=m;(t=s<2?e:c)||!d;){a||(s?s<3?(s>1&&(f.n=-1),h(s,c)):f.n=c:f.v=c);try{if(l=2,a){if(s||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=a.return)&&t.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);a=e}else if((t=(d=f.n<0)?c:r.call(n,f))!==i)break}catch(t){a=e,s=1,c=t}finally{l=1}}return{value:t,done:d}}}(r,o,a),!0),l}var i={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(f(t={},n,(function(){return this})),t),h=l.prototype=s.prototype=Object.create(u);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,f(e,o,"GeneratorFunction")),e.prototype=Object.create(h),e}return c.prototype=l,f(h,"constructor",l),f(l,"constructor",c),c.displayName="GeneratorFunction",f(l,o,"GeneratorFunction"),f(h),f(h,o,"Generator"),f(h,n,(function(){return this})),f(h,"toString",(function(){return"[object Generator]"})),(d=function(){return{w:a,m:m}})()}function f(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}f=function(e,t,r,n){function a(t,r){f(e,t,(function(e){return this._invoke(t,r,e)}))}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},f(e,t,r,n)}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return(t=k(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e){var t=g(e,"string");return"symbol"==u(t)?t:t+""}function g(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function b(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function v(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){b(a,n,o,i,s,"next",e)}function s(e){b(a,n,o,i,s,"throw",e)}i(void 0)}))}}function y(e){return T(e)||x(e)||I(e)||w()}function w(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function I(e,t){if(e){if("string"==typeof e)return O(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,t):void 0}}function x(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function T(e){if(Array.isArray(e))return O(e)}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var C={name:"TaskFormDetaileModal",components:{TaskCheckForm:i["default"],checkModal:s["default"],BreakdownModal:l["default"]},props:{taskForms:{type:Array,default:function(){return[]}},workOrderInfo:{type:Object,default:function(){return{}}}},data:function(){return{title:"填写明细",createFaultLoading:!1,switchCheck:!0,visible:!1,confirmLoading:!1,model:{},taskFormItemList:[],formObj:{},checkModalTitle:"自检"}},methods:{add:function(){this.edit({})},showModal:function(e){var t=this;this.formObj=e,this.taskFormItemList=[],this.visible=!0,this.$nextTick((function(){3===e.instType?t.loadRecordFormDetail():4===e.instType&&t.$refs.checkForm.findModelDetaile(e)}))},handleOk:function(){var e="";3===this.formObj.instType?e=this.$refs.recordListTable.getCheckboxRecords().map((function(e){return e.id})).toString():4===this.formObj.instType&&(e=this.$refs.checkForm.getIDRecords()),this.$emit("ok",e),this.close()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},onTaskFormNoWork:function(e){},loadRecordFormDetail:function(){var e=this;this.formObj.formInstId,this.formObj.id;Object(a["Ab"])({id:this.formObj.formObjId}).then((function(t){var r=[];t.result.categoryList.forEach((function(e){r=[].concat(y(r),y(e.detailList.map((function(t){return t.reguTitle=e.reguTitle,t.recIndex=e.recIndex,t.workRecId=e.workRecId,t}))))})),e.taskFormItemList=r,e.$nextTick((function(){if(e.formObj.recordIds&&e.formObj.recordIds.length){var t=e.formObj.recordIds.split(",");e.$refs.recordListTable.setCheckboxRow(e.taskFormItemList.filter((function(e){return t.find((function(t){return t===e.id}))})),!0)}}))}))},mergeRowMethod:function(e){var t=e.row,r=e._rowIndex,n=e.column,o=e.visibleData,a=["reguTitle"],i=t[n.property];if(i&&a.includes(n.property)){var s=o[r-1],c=o[r+1];if(s&&s[n.property]===i)return{rowspan:0,colspan:0};var l=1;while(c&&c[n.property]===i)c=o[++l+r];if(l>1)return{rowspan:l,colspan:1}}},handleCheck:function(e,t){var r=this.$refs.recordListTable.getCheckboxRecords();if(r.length>0){var n=r.map((function(e,t){return e.id})).join(",");this.checkModalTitle=t,this.$refs.checkModalForm.showModal(n,e)}else this.$message.error("请选择要检查的作业记录明细!")},onCheckRecord:function(e){e.saveSuccess&&this.loadRecordFormDetail()},handleMenuClick:function(e){var t=this,r=e.key,n=this.$refs.recordListTable.getCheckboxRecords();if(n.length>0){var o=n.map((function(e,t){return e.id})).join(",");Object(c["C"])("ids=".concat(o,"&checkType=").concat(r)).then((function(e){e.success?(t.$message.success("清除成功"),t.loadRecordFormDetail()):t.$message.warning(e.message)}))}else this.$message.error("请选择要检查的作业记录明细!")},createFault:function(){var e=this;v(d().m((function t(){var r;return d().w((function(t){while(1)switch(t.n){case 0:e.$refs.breakdownModal.setWorkStations(e.workOrderInfo.staffArranges),r={},e.workOrderInfo.planId&&(r={planName:e.workOrderInfo.planName,planId:e.workOrderInfo.planId,lineId:e.workOrderInfo.lineId,trainNo:e.workOrderInfo.trainNo}),e.$refs.breakdownModal.edit(m({workOrderId:e.workOrderInfo.orderId,formType:2,createType:2,happenTime:e.$moment().format("YYYY-MM-DD"),faultDesc:"",phase:1,status:1},r));case 1:return t.a(2)}}),t)})))()}}},j=C,S=(r("2d1c"),r("2877")),P=Object(S["a"])(j,n,o,!1,null,"adebf282",null);t["default"]=P.exports},"51cf":function(e,t,r){},7068:function(e,t,r){"use strict";r("51cf")},7483:function(e,t,r){"use strict";r("2e75")},"7b165":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:500,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"作业时间"}},[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD HH:mm:ss","show-time":{format:"HH:mm:ss",hideDisabledOptions:!0}},model:{value:e.workTime,callback:function(t){e.workTime=t},expression:"workTime"}})],1)],1)],1)],1)],1)],1)},o=[],a=r("c1df"),i=r.n(a),s=r("b9c3"),c={name:"WorkTimeModal",data:function(){return{value:1,title:"作业完成",labelText:"作业时间",visible:!1,labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:15}},confirmLoading:!1,form:this.$form.createForm(this),ids:"",workTime:void 0}},created:function(){},methods:{show:function(e){this.form.resetFields(),this.ids=e,this.visible=!0},handleOk:function(){var e=this,t=this;t.form.validateFields((function(r,n){if(!r){t.confirmLoading=!0;var o=new FormData;o.append("itemIds",t.ids),t.workTime&&(t.workTime=i()(t.workTime).format("YYYY-MM-DD HH:mm:ss"),o.append("workTime",t.workTime)),Object(s["ab"])(o).then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok")):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1,t.close()})),e.visible=!1}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},l=c,u=r("2877"),d=Object(u["a"])(l,n,o,!1,null,"3f50fa8e",null);t["default"]=d.exports},"8e5e":function(e,t,r){},a6da:function(e,t,r){e.exports=r.p+"img/code.77bdebfa.png"},ab7d:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"故障编辑",width:"100%",centered:"",visible:e.visible,dialogClass:"fullDialog",confirmLoading:e.confirmLoading,cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticStyle:{height:"calc(100vh - 5px)","overflow-y":"auto"}},[e.visible?t("BreakdownFormItem",{ref:"breakdownForm",attrs:{fromWriteReport:e.fromWriteReport,workStationsList:e.workStationsList},on:{ok:e.onSaveOk,fail:e.onSaveFail,cancel:e.onSaveCancel}}):e._e()],1)])},o=[],a=r("d0ca"),i={name:"BreakdownModal",components:{BreakdownFormItem:a["default"]},props:{showWorkStation:{type:Boolean,default:!1},fromWriteReport:{type:Boolean,default:!1}},data:function(){return{visible:!1,confirmLoading:!1,workStationsList:[]}},created:function(){},methods:{setWorkStations:function(e){var t=this;this.workStationsList.length=0,e.forEach((function(e){t.workStationsList.find((function(t){return t.workstationId===e.workstationId}))||t.workStationsList.push(e)}))},add:function(e,t,r){this.edit({workOrderId:e,orderTaskId:t,formType:r,createType:r})},edit:function(e){var t=this;this.visible=!0,this.$nextTick((function(){t.$refs.breakdownForm.edit(e)}))},handleOk:function(){this.confirmLoading=!0,this.$refs.breakdownForm.save()},onSaveOk:function(){this.confirmLoading=!1,this.visible=!1,this.$message.success("保存成功"),this.$emit("ok")},onSaveFail:function(){this.$message.error("保存失败"),this.confirmLoading=!1},onSaveCancel:function(){this.confirmLoading=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.confirmLoading=!1,this.visible=!1}}},s=i,c=(r("7068"),r("2877")),l=Object(c["a"])(s,n,o,!1,null,"12e1d6e2",null);t["default"]=l.exports},b7b4:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"i",(function(){return a})),r.d(t,"l",(function(){return i})),r.d(t,"c",(function(){return c})),r.d(t,"t",(function(){return l})),r.d(t,"v",(function(){return s})),r.d(t,"n",(function(){return d})),r.d(t,"C",(function(){return f})),r.d(t,"D",(function(){return h})),r.d(t,"p",(function(){return m})),r.d(t,"m",(function(){return k})),r.d(t,"j",(function(){return g})),r.d(t,"w",(function(){return b})),r.d(t,"a",(function(){return v})),r.d(t,"h",(function(){return y})),r.d(t,"k",(function(){return I})),r.d(t,"q",(function(){return x})),r.d(t,"z",(function(){return T})),r.d(t,"r",(function(){return O})),r.d(t,"e",(function(){return C})),r.d(t,"s",(function(){return j})),r.d(t,"B",(function(){return R})),r.d(t,"x",(function(){return S})),r.d(t,"y",(function(){return P})),r.d(t,"d",(function(){return w})),r.d(t,"f",(function(){return $})),r.d(t,"o",(function(){return p})),r.d(t,"A",(function(){return N})),r.d(t,"E",(function(){return F})),r.d(t,"g",(function(){return L})),r.d(t,"u",(function(){return u}));var n=r("0fea"),o=function(e){return Object(n["j"])("/quality/rectify/add",e)},a=function(e){return Object(n["j"])("/quality/rectify/delete",e)},i=function(e){return Object(n["j"])("/quality/rectify/edit",e)},s=function(e){return Object(n["d"])("/quality/rectify/page",e)},c=function(e){return Object(n["j"])("/quality/rectify/close",e)},l=function(e){return Object(n["d"])("/quality/rectify/get",e)},u=function(e){return Object(n["d"])("/quality/rectify/getCode",e)},d=function(e){return Object(n["d"])("/quality/measurealert/page",e)},f=function(e){return Object(n["d"])("/quality/measurethreshold/form/page-data-form",e)},h=function(e){return Object(n["j"])("/quality/measurethreshold/threshold/save",e)},m=function(e){return Object(n["d"])("/quality/measurethreshold/threshold/list/".concat(e))},p=function(e){return Object(n["d"])("/serialPlan/plan/forms/online-form/alert-records",{dataRecordId:e})},k=function(e){return Object(n["j"])("/quality/measurethreshold/threshold/edit",e)},g=function(e){return Object(n["j"])("/quality/measurethreshold/threshold/delete",e)},b=function(e){return Object(n["d"])("/quality/measurethreshold/threshold/get",e)},v=function(e){return Object(n["j"])("/quality/leaverecord/add",e)},y=function(e){return Object(n["j"])("/quality/leaverecord/delete",e)},w=function(e){return Object(n["j"])("/quality/leaverecord/close",e)},I=function(e){return Object(n["j"])("/quality/leaverecord/edit",e)},x=function(e){return Object(n["d"])("/quality/leaverecord/page",e)},T=function(e,t){return Object(n["c"])("/quality/leaverecord/workLeaveRecordExport",e,t)},O=function(e){return Object(n["d"])("/quality/record-confirm/list",e)},C=function(e){return Object(n["j"])("/quality/record-confirm/confirm",e)},j=function(e){return Object(n["d"])("/quality/record-confirm/work-record/get",e)},S=function(e){return Object(n["d"])("/serialPlan/plan/forms/check-record/get",e)},P=function(e){return Object(n["d"])("/workcheck/get",e)},$=function(e){return Object(n["j"])("/quality/record-confirm/confirm",e)},R=function(e){return Object(n["d"])("/quality/record-confirm/page",e)},N=function(e){return Object(n["d"])("/quality/record-confirm/page/check-record",e)},F=function(e){return Object(n["j"])("/serialPlan/plan/forms/judge/save",e)},L=function(e){return Object(n["j"])("/serialPlan/plan/forms/judge/delete",e)}},d0f9:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:800,visible:e.visible,confirmLoading:e.confirmLoading,centered:"",cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{attrs:{md:18}},[t("div",[t("a-form",{ref:"initForm",attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"登录名称"}},[t("a-row",{attrs:{gutter:10}},[t("a-col",{attrs:{span:14}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["checkUserName",e.validatorRules.checkUserName],expression:"['checkUserName', validatorRules.checkUserName]",modifiers:{trim:!0}}]})],1),t("a-col",{attrs:{span:10}},[t("a-button",{attrs:{type:"link"},on:{click:e.useCurrentUser}},[e._v("使用当前账号和密码")])],1)],1)],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"登录密码"}},[t("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["checkUserPwd",e.validatorRules.checkUserPwd],expression:"['checkUserPwd', validatorRules.checkUserPwd]",modifiers:{trim:!0}}]})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查结果"}},[t("a-checkbox",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["exp",{initialValue:!1}],expression:"['exp', { initialValue: false }]",modifiers:{trim:!0}}]},[e._v(" 异常")]),t("a-checkbox",{on:{change:e.onIgnoreChange},model:{value:e.isIgnore,callback:function(t){e.isIgnore=t},expression:"isIgnore"}},[e._v(" 忽略")])],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"同检人员"}},[t("a-select",{ref:"userSelect",attrs:{placeholder:"请选择人员",open:!1,showArrow:!0,allowClear:""},on:{change:e.clearTogetherCheckUserNames,dropdownVisibleChange:function(t){return e.openSelectUser()}},model:{value:e.togetherCheckUserNames,callback:function(t){e.togetherCheckUserNames=t},expression:"togetherCheckUserNames"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"结果描述"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["resultDesc",{initialValue:"",rules:[{required:e.isIgnore,message:"请输入忽略原因!"}]}],expression:"[\n                'resultDesc',\n                { initialValue: '', rules: [{ required: isIgnore, message: '请输入忽略原因!' }] },\n              ]",modifiers:{trim:!0}}],attrs:{"auto-size":{minRows:8,maxRows:8}}})],1)],1)],1)]),t("a-col",{attrs:{md:6}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("div",{staticStyle:{margin:"30px 10px 20px","text-align":"center"}},[t("a-spin",{attrs:{spinning:e.qrLoading}},[e.imageBase64Url?t("img",{staticClass:"QRcode",attrs:{src:e.imageBase64Url,alt:""}}):t("img",{staticClass:"QRcode",attrs:{src:r("a6da"),alt:""}})])],1),t("div",{staticStyle:{"text-align":"center"}},[e._v("通过APP扫码确认")])])],1)],1),t("UserList",{ref:"userSelectModal",attrs:{multiple:!0},on:{ok:e.onSelectUser}})],1)},o=[],a=r("b9c3"),i=r("b245"),s=r("986e"),c={name:"SheetItemModal",components:{UserList:i["default"]},props:["title","formInstId","workRecordType"],data:function(){return{detailIds:"",checkType:-1,colIndex:0,value:1,status:1,switchCheck:!0,visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{checkUserName:{rules:[{required:!0,message:"请输入登录名称!"}]},checkUserPwd:{rules:[{required:!0,message:"请输入密码!"}]},checkResult:{rules:[{required:!0,message:"选择检查结果!"}]}},isIgnore:!1,qrLoading:!1,imageBase64Url:"",togetherCheckUserIds:"",togetherCheckUserNames:""}},mounted:function(){var e=this;s["a"].$on("topic",(function(t){e.$message.success(t.msgTxt);var r=Object.assign(e.model);r.detailIds=1===e.workRecordType?e.detailIds:e.detailIds.join(","),r.result=r.exp?0:1,r.isIgnore=e.isIgnore?1:0,r.type=e.checkType,r.workRecordId=e.formInstId,r.colIndex=e.colIndex,r.workRecordType=e.workRecordType,r.detailIds=e.detailIds,e.$emit("scan",{saveSuccess:!0,data:r}),e.close()}))},methods:{add:function(){this.edit({})},getTaskQRCode:function(e){var t=this;this.qrLoading=!0,Object(a["J"])({formDetails:"string"===typeof this.detailIds?this.detailIds:this.detailIds.join(","),checkType:this.checkType,colIndex:this.colIndex,formInstId:e.formInstId,formType:e.instType,fromBy:"PC",orderId:e.workOrderId,targetType:"TASK",taskId:e.workOrderTaskId,workRecordType:e.workRecordType}).then((function(e){t.qrLoading=!1,e.success&&(t.imageBase64Url=e.result.base64)}))},showModal:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0;this.imageBase64Url="",this.detailIds=e,this.checkType=t,this.colIndex=n,this.getTaskQRCode(o),this.form.resetFields(),this.isIgnore=!1,this.visible=!0,1===this.checkType&&this.$nextTick((function(){r.form.setFieldsValue({checkUserName:r.$store.getters.userInfo.username,checkUserPwd:"~**&&##@@$$%%^^~"})})),this.$nextTick((function(){r.form.setFieldsValue({exp:"",resultDesc:""})}))},useCurrentUser:function(){var e=this;this.$nextTick((function(){e.form.setFieldsValue({checkUserName:e.$store.getters.userInfo.username,checkUserPwd:"~**&&##@@$$%%^^~"})}))},clearTogetherCheckUserNames:function(e){e||(this.togetherCheckUserIds="",this.togetherCheckUserNames="")},openSelectUser:function(){this.$refs.userSelectModal.showModal(),this.$refs.userSelect.blur()},onSelectUser:function(e){if(e.length){var t="",r="";e.forEach((function(e,n,o){t+=e.realname,r+=e.id,n<o.length-1&&(t+=",",r+=",")})),this.togetherCheckUserIds=r,this.togetherCheckUserNames=t}},handleOk:function(){var e=this,t=this;t.form.validateFields((function(r,n){if(!r){var o=Object.assign(t.model,n);o.detailIds=1===e.workRecordType?e.detailIds:e.detailIds.join(","),o.result=o.exp?0:1,o.isIgnore=e.isIgnore?1:0,o.type=e.checkType,o.workRecordId=e.formInstId,o.colIndex=e.colIndex,o.workRecordType=e.workRecordType,o.togetherCheckUserIds=e.togetherCheckUserIds,o.togetherCheckUserNames=e.togetherCheckUserNames,Object(a["Y"])(o).then((function(r){r.success?(t.$message.success(r.message),o.detailIds=e.detailIds,r.result&&(o.checkUserInfo=r.result),t.$emit("ok",{saveSuccess:!0,data:o}),t.close()):t.$message.error(r.message)})).finally((function(){}))}}))},handleCancel:function(){this.close()},onIgnoreChange:function(){var e=this;this.$nextTick((function(){e.form.resetFields("resultDesc")}))},close:function(){this.$emit("close"),this.visible=!1}}},l=c,u=(r("fb4f"),r("2877")),d=Object(u["a"])(l,n,o,!1,null,"0804228c",null);t["default"]=d.exports},fb4f:function(e,t,r){"use strict";r("0743")}}]);