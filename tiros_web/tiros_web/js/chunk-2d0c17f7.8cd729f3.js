(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c17f7"],{"45ff":function(e,l,t){"use strict";t.r(l);var o=function(){var e=this,l=e._self._c;return l("div",{ref:"calcHeight"})},c=[],n=t("e8ae"),a=t("21a6"),i=t("8fad"),r="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",h={name:"TableExport",data:function(){return{}},mounted:function(){},methods:{printById:function(e){var l=this;Object(i["Kb"])({id:e}).then((function(e){e.success?l.initWorkBook(e.result):l.$message.error("获取记录表详情失败")})).catch((function(e){l.$message.error("获取记录表详情异常")}))},printByData:function(e){this.initWorkBook(e)},initWorkBook:function(e){var l=new n["Workbook"];l.creator="GY",l.lastModifiedBy="2021-10-28",l.created=new Date,l.modified=new Date,l.lastPrinted=new Date;var t=l.addWorksheet("Sheet1",{properties:{defaultColWidth:22,alignment:{vertical:"middle",horizontal:"left",wrapText:!0}},pageSetup:{paperSize:9}}),o=[];t.mergeCells("A1:C1"),t.getCell("A1").value="车号："+(e.trainNo||""),o.push({cell:"A1",horizontal:"left",fill:!0,size:14,bold:!0}),0===e.updown?(t.mergeCells("A2:C2"),t.getCell("A2").value="部件号："+(e.manufNo||""),o.push({cell:"A2",horizontal:"left",fill:!0,size:14,bold:!0})):1===e.updown?(t.mergeCells("A2:C2"),t.getCell("A2").value="原部件序列号："+(e.manufNo||""),o.push({cell:"A2",horizontal:"left",fill:!0,size:14,bold:!0}),t.mergeCells("A3:C3"),t.getCell("A3").value="新部件序列号："+(e.manufNoUp||""),o.push({cell:"A3",horizontal:"left",fill:!0,size:14,bold:!0})):t.mergeCells("A1:C2"),1===e.updown?t.mergeCells("D1:F3"):t.mergeCells("D1:F2"),t.getCell("D1").value=e.title||e.workRecName||"",o.push({cell:"D1",fill:!0,size:14,bold:!0}),t.mergeCells("G1:H1"),t.getCell("G1").value="作业日期："+(e.workDate||""),o.push({cell:"G1",fill:!0,horizontal:"left",size:14,bold:!0}),t.mergeCells("I1:J1"),t.getCell("I1").value="完工日期："+(e.finishDate||""),o.push({cell:"I1",fill:!0,horizontal:"left",size:14,bold:!0}),1===e.updown?t.mergeCells("G2:J3"):t.mergeCells("G2:J2"),t.getCell("G2").value="作业班组："+(e.workGroupName||""),o.push({cell:"G2",fill:!0,horizontal:"left",size:14,bold:!0}),t.getColumn("A").width=15,t.getColumn("B").width=30,t.getColumn("C").width=60,t.getColumn("D").width=15,t.getColumn("E").width=60,t.getColumn("F").width=60,t.getRow(1).height=30,t.getRow(2).height=30,t.getRow(3).height=30,1===e.updown&&(t.getRow(4).height=30);var c={A:"序号",B:"项目",C:"作业内容",D:"控制点",E:"技术要求",F:"作业情况",G:"结果",H:"自检",I:"互检",J:"专检"};for(var i in c)t.getCell(i+(1===e.updown?4:3)).value=c[i],o.push({cell:i+(1===e.updown?4:3),fill:!0,size:14,bold:!0});var h=1===e.updown?5:4,s=0;e.categoryList.forEach((function(e,l){t.getCell("A".concat(h+l)).value=e.recIndex,o.push({cell:"A".concat(h+l)}),t.mergeCells("A".concat(h+l,":A").concat(h+l+e.detailList.length-1)),t.getCell("B".concat(h+l)).value=e.reguTitle,o.push({cell:"B".concat(h+l),horizontal:"left"}),t.mergeCells("B".concat(h+l,":B").concat(h+l+e.detailList.length-1)),e.detailList.forEach((function(e,c){t.getCell("C".concat(h+l+c)).value="\n".concat(e.workContent||"","\n"),o.push({cell:"C".concat(h+l+c),horizontal:"left"}),t.getCell("D".concat(h+l+c)).value=e.checkLevel_dictText||"",o.push({cell:"D".concat(h+l+c)}),t.getCell("E".concat(h+l+c)).value="\n".concat(e.techRequire||"","\n"),o.push({cell:"E".concat(h+l+c),horizontal:"left"}),t.getCell("F".concat(h+l+c)).value=0==e.isIgnore?e.workInfo:e.ignoreDesc,o.push({cell:"F".concat(h+l+c),horizontal:"left"}),t.getCell("G".concat(h+l+c)).value=e.result?"√":"□",o.push({cell:"G".concat(h+l+c)}),t.getCell("H".concat(h+l+c)).value=e.selfCheck||"",o.push({cell:"H".concat(h+l+c)}),t.getCell("I".concat(h+l+c)).value=e.guarderCheck||"",o.push({cell:"I".concat(h+l+c)}),t.getCell("J".concat(h+l+c)).value=e.monitorCheck||"",o.push({cell:"J".concat(h+l+c)})})),h+=e.detailList.length-1,s+=e.detailList.length})),s+=1===e.updown?5:4,t.mergeCells("A".concat(s,":J").concat(s)),t.getRow(s).height=30,o.push({cell:"A".concat(s),bold:!0}),s+=1;var u=e.measureToolList||[];u.length&&(t.mergeCells("A".concat(s,":B").concat(s+u.length-1)),t.getCell("A".concat(s)).value="计量器具使用",o.push({cell:"A".concat(s)}),u.forEach((function(e,l,c){t.mergeCells("C".concat(s+l,":D").concat(s+l)),t.getCell("C".concat(s+l)).value=" \n名称："+(e.name||"")+"\n",o.push({cell:"C".concat(s+l),horizontal:"left"}),t.getCell("E".concat(s+l)).value=" \n规格型号："+(e.model||"")+"\n",o.push({cell:"E".concat(s+l),horizontal:"left"}),t.getCell("F".concat(s+l)).value=" \n出厂编号："+(e.serialNo||"")+"\n",o.push({cell:"F".concat(s+l),horizontal:"left"}),t.mergeCells("G".concat(s+l,":H").concat(s+l)),t.getCell("G".concat(s+l)).value=" \n上次检验时间："+(e.lastCheckTime||"")+"\n",o.push({cell:"G".concat(s+l),horizontal:"left"}),t.mergeCells("I".concat(s+l,":J").concat(s+l)),t.getCell("I".concat(s+l)).value=" \n下次检验时间："+(e.nextCheckTime||"")+"\n",o.push({cell:"I".concat(s+l),horizontal:"left"})})),s+=u.length,t.mergeCells("A".concat(s,":J").concat(s)),t.getRow(s).height=30,o.push({cell:"A".concat(s),bold:!0}),s+=1);var g=["控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。","“自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。","“作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。","“结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。","作业内容中有数据要求的一并填入“作业情况”栏。"];t.mergeCells("A".concat(s,":J").concat(s));var f="";g.forEach((function(e,l,t){f+="".concat(l+1,"、").concat(e).concat(l<t.length-1?"\n":"")})),f="说明：\n"+f+"\n",f="\n检查结果：".concat(0===e.checkResult?"未通过":"通过","                                        检查日期：").concat(e.checkDate||"            ","                                        质量负责人：").concat(e.checkUserName||"            ","\n\n")+f,t.getCell("A".concat(s)).value=f,o.push({cell:"A".concat(s),horizontal:"left",border:top});var C=12*(g.length+4)+18;t.getRow(s).height=C,o.forEach((function(e,l,o){var c=t.getCell(e.cell);c.alignment={vertical:"middle",horizontal:e.horizontal||"center",wrapText:!0},e.fill&&(c.fill={type:"pattern",pattern:"darkGray",fgColor:{argb:"FFe9e9e9"}}),c.font={name:"黑体",family:4,size:e.size||12,underline:!1,bold:e.bold||!1},c.padding={top:10,left:10,bottom:10,right:10},c.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})),l.xlsx.writeBuffer().then((function(l){var t=new Blob([l],{type:r});a["saveAs"](t,"".concat(e.title||e.workRecName,".xlsx"))}))}}},s=h,u=t("2877"),g=Object(u["a"])(s,o,c,!1,null,"dac1198a",null);l["default"]=g.exports}}]);