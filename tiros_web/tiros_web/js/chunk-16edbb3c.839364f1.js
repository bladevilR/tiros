(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-16edbb3c"],{"0e4f":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:700,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"仓库编码"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["code",e.validatorRules.code],expression:"[ 'code', validatorRules.code]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入仓库编码"}})],1)],1),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"仓库名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["name",e.validatorRules.name],expression:"[ 'name', validatorRules.name]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入仓库名称"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"上级仓库"}},[t("j-tree-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["parentId",e.validatorRules.parentId],expression:"[ 'parentId',validatorRules.parentId]",modifiers:{trim:!0}}],attrs:{placeholder:"请选择",dict:"bu_mtr_warehouse,name,id",pidField:"parent_id","has-child-field":"isLeaf"},on:{change:e.selectLevel}})],1)],1),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"仓库级别"}},[t("a-input",{attrs:{placeholder:"请输入仓库名称",disabled:""},model:{value:e.whLevel,callback:function(t){e.whLevel=t},expression:"whLevel"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"仓库类别"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["type",e.validatorRules.type],expression:"[ 'type', validatorRules.type]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,placeholder:"请选择仓库类别",dictCode:"bu_warehouse_type"}})],1)],1),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"车辆段"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["depotId",e.validatorRules.depotId],expression:"[ 'depotId', validatorRules.depotId]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,placeholder:"请选择车辆段",dictCode:"bu_mtr_depot,name,id"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"线路"}},[t("line-select-list",{directives:[{name:"decorator",rawName:"v-decorator",value:["lineId",e.validatorRules.lineId],expression:"['lineId', validatorRules.lineId]"}]})],1)],1),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"是否关账"}},[t("a-switch",{on:{change:e.changeClose},model:{value:e.isClose,callback:function(t){e.isClose=t},expression:"isClose"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"车间"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["workshopId",e.validatorRules.workshopId],expression:"[ 'workshopId', validatorRules.workshopId]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,placeholder:"请选择车间",dictCode:"bu_mtr_workshop,name,id"}})],1)],1)],1),t("a-form-item",{attrs:{label:"位置描述"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["location",e.validatorRules.location],expression:"[ 'location', validatorRules.location]",modifiers:{trim:!0}}]})],1)],1)],1)],1)},l=[],i=a("c54ca"),o=a("b098"),s=a("4ec3"),n=a("5633"),d={name:"WarehouseItemModal",props:["parentId"],components:{JTreeSelect:o["default"],LineSelectList:n["default"]},data:function(){return{queryParam:{title:"",parentId:null},selectTreeNode:[],defaultKey:[],whLevel:"",value:1,title:"操作",visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:15}},isClose:!1,confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{name:{rules:[{required:!0,message:"请输入仓库名称!"},{max:32,message:"输入长度不能超过32字符!"}]},code:{rules:[{required:!0,message:"请输入仓库编码!"},{validator:this.validateCode},{max:32,message:"输入长度不能超过32字符!"}]},whLevel:{rules:[{required:!0,message:"请输选择仓库级别!"}]},parentId:{rules:[{required:!0,message:"请输选择上级级别!"}]},type:{rules:[{required:!0,message:"请选择仓库类别!"}]},depotId:{rules:[{required:!0,message:"请选择车辆段!"}]},lineId:{rules:[{required:!0,message:"请选择车辆段!"}]},workshopId:{rules:[{required:!0,message:"请选择车间!"}]},location:{rules:[{max:64,message:"输入长度不能超过64字符!"}]}}}},created:function(){},methods:{validateCode:function(e,t,a){var r={tableName:"bu_mtr_warehouse",fieldName:"code",fieldVal:t,dataId:this.model.id,filterFields:[{name:"parent_id",val:this.model.parentId}]};Object(s["m"])(r).then((function(e){e.success?a():a(e.message)}))},selectLevel:function(e){var t=this,a={id:e};Object(i["Fb"])(a).then((function(e){e.success&&(t.whLevel=e.result.whLevel+1)}))},changeClose:function(e){this.isClose=e},add:function(){this.edit({})},edit:function(e){var t=this;e.id?(this.isClose=!(!e["close"]||1!=e["close"]),this.whLevel=e["whLevel"]):(this.isClose=!1,this.whLevel=""),this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.model.parentId||(this.model.parentId=this.parentId,this.selectLevel(this.parentId)),this.$nextTick((function(){t.form.setFieldsValue({code:t.model.code,name:t.model.name,parentId:t.model.parentId,type:t.model.type,depotId:t.model.depotId,lineId:t.model.lineId,location:t.model.location,workshopId:t.model.workshopId})}))},handleOk:function(){var e=this;e.form.validateFields((function(t,a){if(!t){e.confirmLoading=!0;var r,l=Object.assign(e.model,a,{whLevel:e.whLevel,close:e.isClose?1:0});r=e.model.id?Object(i["N"])(l):Object(i["h"])(l),r.then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok"),e.close()):e.$message.warning(t.message)})).finally((function(){e.confirmLoading=!1}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},c=d,u=a("2877"),m=Object(u["a"])(c,r,l,!1,null,null,null);t["default"]=m.exports},"54f6":function(e,t,a){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function o(e,t,a){return t&&i(e.prototype,t),a&&i(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){var t=n(e,"string");return"symbol"==r(t)?t:t+""}function n(e,t){if("object"!=r(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var l=a.call(e,t||"default");if("object"!=r(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}a.d(t,"a",(function(){return d}));var d=function(){function e(t,a){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};l(this,e),this.options={attrs:[]},Object.assign(this.options,i),this.options.attrs.find((function(e){return"edit"===e.key}))||this.options.attrs.push({key:"edit"}),this.options.attrs.forEach((function(e){Object.hasOwnProperty.call(e,"key")&&(r[e.key]=!1),Object.hasOwnProperty.call(e,"judge")||(e["judge"]=function(e){return!0})})),this.del=!1,this.nextTick=t.$nextTick,this.refs=t.$refs,this.refName=a,t.$nextTick((function(){r.vxeTable=t.$refs[a]}))}return o(e,[{key:"editRow",get:function(){if(this.edit){var e=this.vxeTable.getCheckboxRecords();return e.length?e[0]:{}}return{}}},{key:"update",value:function(){var e=this;this.nextTick((function(){e.vxeTable||(e.vxeTable=e.refs[e.refName]);var t=e.vxeTable.getCheckboxRecords();e.del=t.length>0,e.options.attrs.forEach((function(a){for(var r in a)Object.hasOwnProperty.call(a,r)&&(a["isDel"]?t.length?e[a.key]=t.length>0&&a.judge(t[0]):e[a.key]=!1:t.length?e[a.key]=1===t.length&&a.judge(t[0]):e[a.key]=!1)}))}))}}])}()},b6a7:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{"body-style":e.cardStyle}},[t("div",[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{label:"仓库"}},[t("a-input",{attrs:{placeholder:"请输入仓库编码或者名称",allowClear:""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{label:"仓库类别"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_warehouse_type"},model:{value:e.queryParam.type,callback:function(t){e.$set(e.queryParam,"type",t)},expression:"queryParam.type"}})],1)],1),t("a-col",{attrs:{md:6,sm:8}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)])],1),t("a-row",[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary",loading:e.loading},on:{click:e.handleAdd}},[e._v("新增")]),t("a-button",{staticStyle:{"margin-left":"8px"},attrs:{disabled:!e.btnStatus.edit},on:{click:function(t){return e.handleEdit(e.btnStatus.editRow)}}},[e._v("编辑")]),t("a-button",{staticStyle:{"margin-left":"8px"},attrs:{disabled:!e.btnStatus.del},on:{click:e.deleteRecord}},[e._v("删除")])],1)],1)])],1)],1),t("div",{staticStyle:{height:"calc(100vh - 288px)"}},[t("vxe-table",{ref:"listTable",attrs:{border:"",resizable:"",height:"100%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{trigger:"manual",mode:"row"}},on:{"checkbox-change":function(t){return e.btnStatus.update()},"checkbox-all":function(t){return e.btnStatus.update()}}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{field:"code",title:"编码",width:"120",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"name",title:"名称",width:"180",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"whLevel",title:"级别",width:"80"}}),t("vxe-table-column",{attrs:{field:"type_dictText",title:"类别",width:"80"}}),t("vxe-table-column",{attrs:{field:"close_dictText",title:"是否关账",width:"80"}}),t("vxe-table-column",{attrs:{field:"lineName",title:"线路",width:"120"}}),t("vxe-table-column",{attrs:{field:"depotName",title:"车辆段",width:"120"}}),t("vxe-table-column",{attrs:{field:"location",title:"位置描述","min-width":"180",align:"left","header-align":"center"}})],1)],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}}),t("warehouse-item-modal",{ref:"modalForm",attrs:{parentId:e.value},on:{ok:function(t){return e.loadData()}}})],1)])},l=[],i=a("c54ca"),o=a("0e4f"),s=a("54f6"),n={name:"RightWarehouse",props:["value"],components:{WarehouseItemModal:o["default"]},data:function(){return{loading:!1,queryParam:{searchText:"",type:null,pageNo:1,pageSize:10,parentId:""},totalResult:0,allAlign:"center",tableData:[],showEdit:!1,cardStyle:{padding:"10px",height:"calc(100vh - 120px)"},btnStatus:new s["a"](this,"listTable")}},created:function(){this.findList()},watch:{value:{immediate:!0,handler:function(e){this.queryParam.parentId=e,this.tableData=[],this.findList()}}},methods:{findList:function(){var e=this;this.queryParam.searchText&&(this.queryParam.parentId=""),Object(i["Gb"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records,e.btnStatus.update()}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},loadData:function(){this.findList(),this.$emit("load")},handleAdd:function(){this.$refs.modalForm.add(),this.$refs.modalForm.title="新增"},handleEdit:function(e){this.$refs.modalForm.edit(e),this.$refs.modalForm.title="编辑"},handleCloseAccount:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();t.length>0?this.$confirm({content:"是否关账选中".concat(t.length,"数据？"),onOk:function(){var a=t.map((function(e,t){return e.id})).join(",");Object(i["n"])("id="+a).then((function(t){e.findList(),e.$message.success(t.message)}))}}):this.$message.error("尚未选中任何数据!")},customRequest:function(e){this.loading=!0;var t=new FormData;t.append("excelFile",e.file),this.saveFile(t)},saveFile:function(e){var t=this;if(this.queryParam.parentId){if("2"!==this.queryParam.parentId)return this.loading=!1,void this.$message.warn("请选择架大修二级仓库");e.append("parentId",this.queryParam.parentId),Object(i["Mb"])(e).then((function(e){t.loading=!1,e.success?(t.$message.success(e.message),t.findList(),t.$emit("load")):t.$message.error(e.message)}))}else this.loading=!1,this.$message.warn("请选择要导入的上级仓库")},getSelectEvent:function(){var e=this.$refs.listTable.getCheckboxRecords();this.$XModal.alert(e.length)},deleteRecord:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();t.length>0?this.$confirm({content:"是否删除选中".concat(t.length,"数据？"),onOk:function(){var a=t.map((function(e,t){return e.id})).join(",");Object(i["x"])("ids="+a).then((function(t){e.findList(),e.$emit("load"),e.$message.success(t.message)}))}}):this.$message.error("尚未选中任何数据!")}}},d=n,c=a("2877"),u=Object(c["a"])(d,r,l,!1,null,"74717eca",null);t["default"]=u.exports}}]);