(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ad0db6b8"],{"10f9":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t._self._c;return e("div",[e("TablePrint",{ref:"tablePrint"}),e("LuckySheetPrint",{ref:"luckySheetPrint",attrs:{luckySheetId:t.luckySheetId},on:{sheetPrintOk:function(e){return t.$emit("sheetPrintOk")}}}),e("JobCheckTableExport",{ref:"jobCheckPrint"})],1)},o=[],c=n("90f1"),i=n("e89a"),u=n("3cf2"),a=n("b7b4"),s=n("b9c3"),d=n("8fad"),l={name:"WorkRecordPrint",components:{TablePrint:c["default"],JobCheckTableExport:u["default"],LuckySheetPrint:i["default"]},props:{luckySheetId:{type:String,default:"lsPrint"}},data:function(){return{}},created:function(){},methods:{print:function(t){switch(t.instType){case 1:this.loadOnlineFormDetail(t.id,t.formInstId);break;case 3:1===t.workRecordType?this.loadRecordTableDetail(t.id,t.formInstId):2===t.workRecordType&&this.loadWorkRecordForm(t,!0);break;case 4:this.loadWorkFormDetail(t.task2InstId,t.formInstId)}},loadWorkRecordForm:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(d["rb"])(t.formObjId).then((function(r){if(r.success){var o=JSON.parse(r.result);if(!n)return void e.$refs.luckySheetPrint.printBySheet(o);Object(s["U"])(t.formInstId).then((function(t){if(t.success&&t.result){var n=JSON.parse(t.result);o.data=[],o.celldata=luckysheet.transToCellData(n)}e.$refs.luckySheetPrint.printBySheet(o)}))}else e.$message.error("获取作业记录表模板数据失败")}))},loadRecordTableDetail:function(t,e){var n=this;Object(s["R"])({task2InstId:t,formInstId:e,needChecks:!0,needCategory:!0,allItems:!0}).then((function(t){t.success&&t.result?(n.$nextTick((function(){t.result.categoryList&&t.result.categoryList.sort((function(t,e){return t.recIndex-e.recIndex})),n.$refs.tablePrint.printByData(t.result)})),n.visible=!0):n.$message.error("加载记录数据异常")}))},loadWorkFormDetail:function(t,e){var n=this;Object(a["x"])({task2InstId:t,formInstId:e}).then((function(t){t.success&&t.result?n.$refs.jobCheckPrint.printByRow(t.result):n.$message.error("加载记录数据异常")}))},loadOnlineFormDetail:function(t,e){var n=this;Object(s["Q"])({task2InstId:t,formInstId:e,needValues:!1}).then((function(t){try{if(t.success&&t.result){var e=t.result,r=JSON.parse(e.result);n.$nextTick((function(){Object(d["rb"])(e.formObjId).then((function(t){if(t.success){var e=JSON.parse(t.result);r&&(e.celldata=luckysheet.transToCellData(r)),n.$refs.luckySheetPrint.printBySheet(e)}}))}))}else n.$message.error("加载记录数据异常")}catch(o){n.$message.error("加载记录数据异常")}}))},printNoData:function(t){try{switch(t.instType){case 1:this.loadOnlineDetailNoData(t.formInstId);break;case 3:1===t.workRecordType?this.loadRecordDetailNoData(t.formInstId):2===t.workRecordType&&this.loadWorkRecordForm(t,!1);break;case 4:this.loadCheckDetailNoData(t.formInstId)}}catch(e){}},loadRecordDetailNoData:function(t){var e=this;Object(d["xb"])({id:t}).then((function(t){t.success&&t.result?(e.$nextTick((function(){t.result.categoryList&&t.result.categoryList.sort((function(t,e){return t.recIndex-e.recIndex})),e.$refs.tablePrint.printByData(t.result)})),e.visible=!0):e.$message.error("加载记录数据异常")}))},loadCheckDetailNoData:function(t){var e=this;Object(a["y"])({id:t}).then((function(t){try{t.success&&t.result?(e.$refs.jobCheckPrint.printByRow(t.result),e.visible=!0):e.$message.error("加载记录数据异常")}catch(n){e.$message.error("加载记录数据异常")}}))},loadOnlineDetailNoData:function(t){var e=this;this.visible=!0,Object(d["rb"])(t).then((function(t){if(t.success){var n=JSON.parse(t.result);e.$refs.luckySheetPrint.printBySheet(n)}}))}}},f=l,p=n("2877"),h=Object(p["a"])(f,r,o,!1,null,null,null);e["default"]=h.exports},"90f1":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{ref:"tablePrint",attrs:{id:"tablePrintMain"}},[e("table",{staticClass:"table",staticStyle:{"font-size":"5px"}},[e("thead"),e("tr",[e("td",{staticStyle:{padding:"0"},attrs:{colspan:"4",rowspan:"2"},on:{click:t.print}},[t.recordSheet.assetTypeId?t._e():e("span",{staticStyle:{"padding-left":"5px"}},[t._v("车号："+t._s(t.recordSheet.trainNo))]),t.recordSheet.assetTypeId&&0===t.recordSheet.updown?e("table",{staticClass:"innerTable"},[e("tr",[e("td",{staticClass:"bottom"},[t._v("车号："+t._s(t.recordSheet.trainNo))])]),e("tr",[e("td",[t._v("部件号："+t._s(t.recordSheet.manufNo))])])]):t._e(),t.recordSheet.assetTypeId&&1===t.recordSheet.updown?e("table",{staticClass:"innerTable"},[e("tr",[e("td",{staticClass:"bottom"},[t._v("车号："+t._s(t.recordSheet.trainNo))])]),e("tr",[e("td",{staticClass:"bottom"},[t._v("原部件序列号："+t._s(t.recordSheet.manufNo))])]),e("tr",[e("td",[t._v("新部件序列号："+t._s(t.recordSheet.manufNoUp))])])]):t._e()]),e("td",{staticStyle:{"text-align":"center","font-weight":"bold"},attrs:{colspan:"3",rowspan:"2"}},[t._v(" "+t._s(t.recordSheet.title||t.recordSheet.workRecName)+" ")]),e("td",{attrs:{colspan:"3"}},[t._v("作业日期："+t._s(t.recordSheet.workDate)+" 完工日期: "+t._s(t.recordSheet.finishDate))])]),e("tr",[e("td",{attrs:{colspan:"3"}},[t._v("作业班组："+t._s(t.recordSheet.workGroupName))])]),t._m(0),t._l(t.recordSheet.categoryList,(function(n){return e("tbody",{key:n.id},t._l(n.detailList,(function(r,o){return e("tr",{key:r.id},[0===o?e("td",{attrs:{rowspan:n.detailList.length}},[t._v(" "+t._s(n.recIndex)+" ")]):t._e(),0===o?e("td",{attrs:{rowspan:n.detailList.length}},[t._v(" "+t._s(n.reguTitle)+" ")]):t._e(),e("td",[t._v(" "+t._s(r.workContent)+" ")]),e("td",{staticStyle:{"text-align":"center"}},[t._v(" "+t._s(r.checkLevel_dictText)+" ")]),e("td",[t._v(" "+t._s(r.techRequire)+" ")]),e("td",[t._v(" "+t._s(0==r.isIgnore?r.workInfo:r.ignoreDesc)+" ")]),e("td",{staticStyle:{"text-align":"center"}},[1===r.result?e("a-checkbox",{attrs:{checked:"",disabled:""}}):t._e(),0===r.result?e("a-checkbox",{attrs:{disabled:""}}):t._e()],1),e("td",[t._v(" "+t._s(r.selfCheck)+" ")]),e("td",[t._v(" "+t._s(r.guarderCheck)+" ")]),e("td",[t._v(" "+t._s(r.monitorCheck)+" ")])])})),0)})),t._l(t.recordSheet.measureToolList,(function(n,r){return e("tr",{key:r},[0===r?e("td",{attrs:{colspan:"2",rowspan:t.recordSheet.measureToolList.length}},[t._v("计量器具使用")]):t._e(),e("td",{attrs:{colspan:"2"}},[t._v("名称: "+t._s(n.name))]),e("td",[t._v("规格型号："+t._s(n.model))]),e("td",[t._v("出厂编号："+t._s(n.serialNo))]),e("td",{attrs:{colspan:"2"}},[t._v("上次检验时间："+t._s(n.lastCheckTime))]),e("td",{attrs:{colspan:"2"}},[t._v("下次检验时间："+t._s(n.nextCheckTime))])])})),e("tr",[e("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[t._v("情况说明："+t._s(t.recordSheet.remark))])]),e("tr",[e("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[e("span",{staticStyle:{"margin-left":"5%"}},[t._v("检查结果："+t._s(0===t.recordSheet.checkResult?"未通过":"通过")+" ")]),e("span",{staticStyle:{"margin-left":"30%"}},[t._v("检查日期："+t._s(t.recordSheet.checkDate)+" ")]),e("span",{staticStyle:{"margin-left":"30%"}},[t._v("质量负责人："+t._s(t.recordSheet.checkUserName)+" ")]),t._m(1)])])],2)])},o=[function(){var t=this,e=t._self._c;return e("tr",[e("th",{staticStyle:{width:"60px"}},[t._v("序号")]),e("th",{staticStyle:{width:"100px"}},[t._v("项目")]),e("th",{staticStyle:{width:"200px"}},[t._v("作业内容")]),e("th",{staticStyle:{width:"60px"}},[t._v("控制点")]),e("th",{staticStyle:{width:"200px"}},[t._v("技术要求")]),e("th",{staticStyle:{width:"200px"}},[t._v("作业情况")]),e("th",{staticStyle:{width:"80px"}},[t._v("结果")]),e("th",{staticStyle:{width:"60px"}},[t._v("自检")]),e("th",{staticStyle:{width:"60px"}},[t._v("互检")]),e("th",{staticStyle:{width:"60px"}},[t._v("专检")])])},function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"padding-top":"15px"}},[t._v(" 说明："),e("br"),t._v(" 1. 控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。"),e("br"),t._v(" 2. “自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。"),e("br"),t._v(" 3. “作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。"),e("br"),t._v(" 4. “结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。"),e("br"),t._v(" 5. 作业内容中有数据要求的一并填入“作业情况”栏 。 ")])}],c=n("8fad"),i={name:"TablePrint",data:function(){return{recordSheet:{}}},mounted:function(){},methods:{printById:function(t){var e=this;Object(c["xb"])({id:t}).then((function(t){t.success?(e.recordSheet=t.result,e.$nextTick((function(){e.print()}))):e.$message.error("获取记录表详情失败")})).catch((function(t){e.$message.error("获取记录表详情异常")}))},printByData:function(t){var e=this;this.recordSheet=t,this.$nextTick((function(){e.print()}))},print:function(){var t=this.$refs.tablePrint.innerHTML,e=document.getElementById("printDom")||document.createElement("iframe");e.id="printDom",document.body.appendChild(e),this.$nextTick((function(){var e=document.getElementById("printDom");e.contentDocument.write(t);var n=e.contentDocument.getElementsByTagName("head").item(0),r=document.createElement("style");r.innerHTML=u,n.appendChild(r),e.contentWindow.print()}))}}},u=".table {\n        border-collapse: collapse;\n        border-spacing: 0;\n    }\n\n    .table td {\n        border-color: black;\n        border-style: solid;\n        border-width: 1px;\n        font-family: Arial, sans-serif;\n        font-size: 14px;\n        overflow: hidden;\n        padding: 10px 5px;\n        word-break: normal;\n    }\n\n    .table th {\n        border-color: black;\n        border-style: solid;\n        border-width: 1px;\n        font-family: Arial, sans-serif;\n        font-size: 14px;\n        font-weight: normal;\n        overflow: hidden;\n        padding: 10px 5px;\n        word-break: normal;\n    }\n\n    .table .tg-ld8d {\n        background-color: #f1f1f1;\n        border-color: inherit;\n        font-weight: bold;\n        text-align: left;\n        vertical-align: middle;\n    }\n\n    .table .tg-9wq8 {\n        border-color: inherit !important;\n        text-align: center !important;\n        vertical-align: middle !important;\n    }\n\n    .table .tg-87ij {\n        background-color: #f1f1f1;\n        border-color: inherit;\n        font-weight: bold;\n        text-align: center;\n        vertical-align: middle;\n    }\n\n    .table .tg-d1f0 {\n        background-color: #f1f1f1;\n        border-color: inherit;\n        font-size: 18px;\n        text-align: center;\n        vertical-align: top;\n    }\n\n    .table .tg-0pky {\n        border-color: inherit;\n        text-align: left;\n        vertical-align: top;\n    }\n\n    .qualityBox {\n        display: -ms-flexbox;\n        display: flex;\n        -ms-flex-align: end;\n        align-items: flex-end;\n    }\n\n    .qualityBox .flex1 {\n        -ms-flex: 1;\n        flex: 1;\n    }\n\n    .qualityBox .flex1 span {\n        margin-right: 15px;\n    }\n\n    .qualityBox [type='button'] {\n        margin-right: 15px;\n    }\n\n\n    .innerTable {\n        height: 100%;\n        width: 100%;\n        border-collapse: collapse;\n        border: 0;\n\n\n\n    }\n\n    .innerTable td {\n        border: 0;\n    }\n\n    .innerTable .bottom {\n        border-bottom: 1px solid #2d2a2a;\n    }\n\n    #tablePrintMain {\n        position: fixed;\n        background-color: #fff;\n        top: 120%;\n        opacity: 0;\n    }",a=i,s=(n("dc91"),n("2877")),d=Object(s["a"])(a,r,o,!1,null,"2cc9a1e0",null);e["default"]=d.exports},9866:function(t,e,n){},b9c3:function(t,e,n){"use strict";n.d(e,"lb",(function(){return i})),n.d(e,"f",(function(){return u})),n.d(e,"i",(function(){return a})),n.d(e,"v",(function(){return s})),n.d(e,"b",(function(){return f})),n.d(e,"l",(function(){return p})),n.d(e,"p",(function(){return h})),n.d(e,"G",(function(){return b})),n.d(e,"c",(function(){return l})),n.d(e,"B",(function(){return k})),n.d(e,"k",(function(){return y})),n.d(e,"A",(function(){return g})),n.d(e,"x",(function(){return j})),n.d(e,"g",(function(){return w})),n.d(e,"E",(function(){return v})),n.d(e,"C",(function(){return O})),n.d(e,"M",(function(){return S})),n.d(e,"kb",(function(){return x})),n.d(e,"O",(function(){return D})),n.d(e,"N",(function(){return R})),n.d(e,"jb",(function(){return T})),n.d(e,"t",(function(){return P})),n.d(e,"d",(function(){return G})),n.d(e,"W",(function(){return $})),n.d(e,"X",(function(){return B})),n.d(e,"e",(function(){return N})),n.d(e,"o",(function(){return L})),n.d(e,"V",(function(){return J})),n.d(e,"R",(function(){return H})),n.d(e,"Q",(function(){return q})),n.d(e,"K",(function(){return z})),n.d(e,"L",(function(){return A})),n.d(e,"fb",(function(){return kt})),n.d(e,"bb",(function(){return V})),n.d(e,"Y",(function(){return K})),n.d(e,"J",(function(){return X})),n.d(e,"hb",(function(){return ct})),n.d(e,"U",(function(){return it})),n.d(e,"eb",(function(){return Y})),n.d(e,"cb",(function(){return Z})),n.d(e,"a",(function(){return tt})),n.d(e,"j",(function(){return dt})),n.d(e,"nb",(function(){return lt})),n.d(e,"gb",(function(){return ft})),n.d(e,"m",(function(){return pt})),n.d(e,"H",(function(){return gt})),n.d(e,"T",(function(){return M})),n.d(e,"S",(function(){return E})),n.d(e,"mb",(function(){return W})),n.d(e,"z",(function(){return ht})),n.d(e,"db",(function(){return bt})),n.d(e,"y",(function(){return mt})),n.d(e,"u",(function(){return d})),n.d(e,"F",(function(){return m})),n.d(e,"ob",(function(){return C})),n.d(e,"q",(function(){return I})),n.d(e,"D",(function(){return _})),n.d(e,"ib",(function(){return et})),n.d(e,"n",(function(){return nt})),n.d(e,"I",(function(){return Q})),n.d(e,"P",(function(){return F})),n.d(e,"s",(function(){return ut})),n.d(e,"Z",(function(){return at})),n.d(e,"ab",(function(){return st})),n.d(e,"h",(function(){return rt})),n.d(e,"w",(function(){return ot})),n.d(e,"r",(function(){return U}));var r=n("0fea"),o=n("4328"),c=n.n(o),i=function(t){return Object(r["j"])("/group/fault/info/submit",t)},u=function(t){return Object(r["j"])("/group/fault/info/cancel",t)},a=function(t){return Object(r["j"])("/group/fault/info/delete",t)},s=function(t){return Object(r["d"])("/group/fault/info/page",t)},d=function(t){return Object(r["d"])("/group/fault/info/get",t)},l=function(t){return Object(r["j"])("/group/safeassume/read/add",t)},f=function(t){return Object(r["j"])("/group/safeassume/add",t)},p=function(t){return Object(r["j"])("/group/safeassume/delete",t)},h=function(t){return Object(r["j"])("/group/safeassume/edit",t)},b=function(t){return Object(r["d"])("/group/safeassume/page",t)},m=function(t){return Object(r["d"])("/group/safeassume/get",t)},k=function(t){return Object(r["d"])("/group/turnoverchange/page",t)},g=function(t){return Object(r["d"])("/material/spare-part/get",t)},y=function(t){return Object(r["j"])("/group/turnoverchange/delete",t)},j=function(t){return Object(r["d"])("/group/measurealert/page",t)},w=function(t){return Object(r["j"])("/group/measurealert/close",t)},v=function(t){return Object(r["d"])("/group/spare-part/page",t)},O=function(t){return Object(r["d"])("/group/spare-part/get",t)},_=function(t){return Object(r["d"])("/produce/train/history/asset/use/page",t)},S=function(t){return Object(r["d"])("/group/toolequipment/page",t)},x=function(t){return Object(r["j"])("/group/toolequipment/setStatus",t)},I=function(t){return Object(r["d"])("/group/toolequipment/usage",t)},D=function(t){return Object(r["d"])("/group/tool/page",t)},R=function(t){return Object(r["d"])("/group/tool/get",t)},T=function(t){return Object(r["j"])("/group/tool/setDutyUser",t)},C=function(t){return Object(r["d"])("/group/tool/usage",t)},P=function(t){return Object(r["d"])("/group/information/basic",t)},G=function(t){return Object(r["j"])("/group/information/tools/add",t)},$=function(t){return Object(r["d"])("/group/information/workstation/page-related",t)},B=function(t){return Object(r["d"])("/group/information/workstation/page-unrelated",t)},N=function(t){return Object(r["j"])("/group/information/workstation/add",t)},L=function(t){return Object(r["j"])("/group/information/workstation/delete",t)},E=function(t){return Object(r["d"])("/workGroup/workOrder/relevanceInfo/".concat(t))},W=function(t){return Object(r["j"])("/workGroup/workOrder/submit-to-dispatcher",c.a.stringify(t))},J=function(t){return Object(r["d"])("/workGroup/workRecord/list",t)},q=function(t){return Object(r["d"])("/serialPlan/plan/forms/online-form/get",t)},H=function(t){return Object(r["d"])("/serialPlan/plan/forms/work-record/get",t)},F=function(t){return Object(r["d"])("/serialPlan/plan/forms/check-record/get",t)},M=function(t){return Object(r["d"])("/workGroup/workOrder/page",t)},U=function(t){return Object(r["d"])("/workGroup/workOrder/apply/page",t)},z=function(t){return Object(r["d"])("/workGroup/workRecord/recordForm",t)},A=function(t){return Object(r["d"])("/workGroup/workRecord/relevanceInfo/".concat(t))},Q=function(t){return Object(r["d"])("/workGroup/workRecord/relevanceInfo/bookSteps/".concat(t))},V=function(t){return Object(r["j"])("/workGroup/workRecord/save/form-result",t)},K=function(t){return Object(r["j"])("/workGroup/workRecord/check",t)},X=function(t){return Object(r["j"])("/workGroup/workRecord/getTaskQRCode",t)},Y=function(t){return Object(r["j"])("/workGroup/workRecord/work-record/save-manufNo",c.a.stringify(t))},Z=function(t){return Object(r["j"])("/workGroup/workRecord/save/material",t)},tt=function(t){return Object(r["j"])("/workGroup/workRecord/save/actMaterial",t)},et=function(t){return Object(r["j"])("/workGroup/workRecord/save/work-time",t)},nt=function(t){return Object(r["j"])("/workGroup/workRecord/arrange/delete",t)},rt=function(t){return Object(r["j"])("/workGroup/workOrder/material/commit-temp-apply",t)},ot=function(t){return Object(r["d"])("/workGroup/workOrder/material/apply/list",t)},ct=function(t){return Object(r["j"])("/workGroup/workRecord/check/saveExcelData",t)},it=function(t){return Object(r["d"])("/workGroup/workRecord/get/excelData/".concat(t))},ut=function(t){return Object(r["d"])("/serialPlan/plan/forms/check-record/item/list",t)},at=function(t){return Object(r["j"])("/workGroup/workRecord/check-record/set-check",t)},st=function(t){return Object(r["j"])("/workGroup/workRecord/check-record/set-time",t)},dt=function(t){return Object(r["j"])("/workGroup/workRecord/delete/material",c.a.stringify(t))},lt=function(t){return Object(r["j"])("/workGroup/workRecord/submit-task",t)},ft=function(t){return Object(r["j"])("/workGroup/workRecord/save/tool",t)},pt=function(t){return Object(r["j"])("/workGroup/workRecord/delete/tool",c.a.stringify(t))},ht=function(t){return Object(r["d"])("/workGroup/workRecord/outsourceOutin",t)},bt=function(t){return Object(r["j"])("/workGroup/workRecord/save/outsourceOutin",t)},mt=function(t){return Object(r["d"])("/workGroup/workRecord/outin/not-returns",t)},kt=function(t){return Object(r["j"])("/group/safeassume/read/add",c.a.stringify(t))},gt=function(t){return Object(r["d"])("/serialPlan/plan/page",t)}},d1e3:function(t,e,n){"use strict";n("9866")},dc91:function(t,e,n){"use strict";n("ed25")},e89a:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"luckySheetPringContent"}},[e("div",{staticClass:"table-page-body",staticStyle:{position:"relative"}},[e("div",{ref:"printDom",staticClass:"ls-print",style:{height:t.lHeight},attrs:{id:t.luckySheetId}})])])},o=[],c=n("8fad"),i=(n("2410"),n("7268")),u={name:"LuckySheetPrint",props:{luckySheetId:{type:String,default:"luckySheetPring"}},data:function(){return{recordSheet:{},lHeight:"calc(100% - 0)"}},mounted:function(){},methods:{printById:function(t){var e=this;c["rb"].call(this,t).then((function(t){t.success&&e.printBySheet(JSON.parse(t.result))})).catch((function(t){e.$message.error("加载表单内容异常")}))},printByData:function(t){var e=this;this.recordSheet=t,this.$nextTick((function(){e.print()}))},printBySheet:function(t){var e=this,n=Object.assign({},i["a"].getDefaultOptions());n.container=this.luckySheetId;var r=0,o=0,c=0;t.celldata.forEach((function(t){t.c>r&&(r=t.c),t.r>o&&(o=t.r)})),r++,o++,c=t.visibledatarow[t.visibledatarow.length-1],n.column=r,n.row=o,delete t.luckysheet_select_save,n.data=[t],this.lHeight="".concat(c+40,"px"),luckysheet.destroy(),luckysheet.create(n),setTimeout((function(){var t=document.getElementById("luckysheet-sheettable_0"),n=document.getElementById("luckysheetTableContent"),r=n.getContext("2d").getImageData(42,17,t.offsetWidth,t.offsetHeight+10),o=document.createElement("canvas");o.width=t.offsetWidth,o.height=t.offsetHeight;var c=o.getContext("2d");c.putImageData(r,0,0);var i=o.toDataURL("image/png");e.print('<img id="printImage" src="'.concat(i,'">'))}),500)},print:function(t){var e=this,n=document.getElementById("printDom")||document.createElement("iframe");n.id="printDom",document.body.appendChild(n),this.$nextTick((function(){var r=document.getElementById("printDom");r.contentDocument.write(t),r.contentDocument.getElementById("printImage").onload=function(){r.contentWindow.print(),luckysheet.destroy(),e.$emit("sheetPrintOk"),document.body.removeChild(n)}}))}}},a=u,s=(n("d1e3"),n("2877")),d=Object(s["a"])(a,r,o,!1,null,"4cc670b2",null);e["default"]=d.exports},ed25:function(t,e,n){}}]);