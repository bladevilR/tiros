(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f4d4d6de","chunk-24cb054c"],{6505:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"布局编辑",centered:"",width:800,bodyStyle:{height:"400px"},visible:e.visible,destroyOnClose:!0},on:{ok:e.handleOk,cancel:function(t){e.visible=!1}}},[t("a-form-model",{ref:"form",attrs:{model:e.model,"label-col":{span:5},"wrapper-col":{span:17},rules:e.rules}},[t("a-row",[t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"布局编码",prop:"layoutCode"}},[t("a-input",{attrs:{disabled:"default-dashboard"===e.model.layoutCode},model:{value:e.model.layoutCode,callback:function(t){e.$set(e.model,"layoutCode",t)},expression:"model.layoutCode"}})],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"布局名称",prop:"layoutName"}},[t("a-input",{model:{value:e.model.layoutName,callback:function(t){e.$set(e.model,"layoutName",t)},expression:"model.layoutName"}})],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"有效状态",prop:"status"}},[t("j-dict-select-tag",{attrs:{dictCode:"bu_valid_status"},model:{value:e.model.status,callback:function(t){e.$set(e.model,"status",t)},expression:"model.status"}})],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"是否主面板",prop:"isMain"}},[t("a-switch",{on:{change:e.changeIsMain},model:{value:e.isMain,callback:function(t){e.isMain=t},expression:"isMain"}})],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"应用范围",prop:"layoutScope"}},[t("j-dict-select-tag",{attrs:{"trigger-change":!0,dictCode:"bu_layout_scope"},on:{change:e.changeScope},model:{value:e.model.layoutScope,callback:function(t){e.$set(e.model,"layoutScope",t)},expression:"model.layoutScope"}})],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"所属人员",prop:"byUserId"}},[t("div",{on:{click:function(t){return e.showUserModal()}}},[t("a-select",{ref:"userSelect",attrs:{placeholder:"请选择人员",open:!1},model:{value:e.model.byUserName,callback:function(t){e.$set(e.model,"byUserName",t)},expression:"model.byUserName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},on:{click:function(t){return e.showUserModal()}},slot:"suffixIcon"})],1)],1)])],1),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"备注"}},[t("a-textarea",{attrs:{"auto-size":{minRows:3,maxRows:5}},model:{value:e.model.layoutDesc,callback:function(t){e.$set(e.model,"layoutDesc",t)},expression:"model.layoutDesc "}})],1)],1)],1)],1),t("user-list",{ref:"userSelectModal",attrs:{multiple:!1},on:{ok:e.onUserSelect}})],1)},r=[],o=a("b245"),s=a("bebf"),i=a("4ec3"),n={name:"edit",components:{UserList:o["default"]},data:function(){return{visible:!1,isMain:!1,model:{},rules:{layoutCode:[{required:!0,message:"请输入布局编码",trigger:"blur"},{validator:this.validateCode,trigger:"change"},{min:3,max:25,message:"编码长度为3-25个字符",trigger:"blur"}],layoutName:[{required:!0,message:"请输入布局名称",trigger:"blur"},{min:2,max:16,message:"名称长度为2-16个字符",trigger:"blur"}],layoutScope:[{required:!0,message:"请选择应用范围",trigger:"blur"}],byUserId:[{required:!1,message:"请选择所属用户",trigger:"blur"}]}}},methods:{showModal:function(e){this.model=e?Object.assign({},e):{byUserId:"",byUserName:"",id:"",isMain:0,layoutCode:"",layoutDesc:"",layoutName:"",layoutScope:0,status:1,layoutWidgetsList:[]},this.visible=!0},handleOk:function(){var e=this;this.$refs.form.validate((function(t){t&&Object(s["f"])(e.model).then((function(t){t.success?(e.$message.success("保存成功"),e.$emit("ok"),e.visible=!1):e.$message.error("保存失败")}))}))},changeIsMain:function(){this.isMain?this.model.isMain=1:this.model.isMain=0},showUserModal:function(){this.$refs.userSelectModal.showModal()},onUserSelect:function(e){e.length?(this.model.byUserId=e[0].id,this.model.byUserName=e[0].realname):(this.model.byUserId=null,this.model.byUserName=null)},changeScope:function(e){this.rules.byUserId[0].required=0!==e},validateCode:function(e,t,a){var l={tableName:"sys_layouts",fieldName:"layout_code",fieldVal:t,dataId:this.model.id,filterFields:[{name:"layout_scope",val:this.model.layoutScope}]};Object(i["m"])(l).then((function(e){e.success?a():a(new Error("布局编码重复"))}))}}},u=n,c=a("2877"),d=Object(c["a"])(u,l,r,!1,null,"43e76603",null);t["default"]=d.exports},9527:function(e,t,a){},b245:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"85%",title:"人员选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",bodyStyle:{height:"70vh"},destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{attrs:{md:4,sm:24}},[t("div",{staticStyle:{height:"calc(70vh - 20px)","border-right":"1px solid #e3e1e1","margin-right":"15px"}},[e.treeData&&e.treeData.length>0?t("a-tree",{staticClass:"limitHeight",attrs:{defaultSelectedKeys:[e.queryParam.depId],defaultExpandAll:!0,"tree-data":e.treeData},on:{select:e.onSelect}}):e._e()],1)]),t("a-col",{attrs:{md:20,sm:24}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"账号"}},[t("a-input",{attrs:{placeholder:"请输入用户账号"},model:{value:e.queryParam.username,callback:function(t){e.$set(e.queryParam,"username",t)},expression:"queryParam.username"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"真实名字"}},[t("a-input",{attrs:{placeholder:"请输入真实名字"},model:{value:e.queryParam.realname,callback:function(t){e.$set(e.queryParam,"realname",t)},expression:"queryParam.realname"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"手机号码"}},[t("a-input",{attrs:{placeholder:"请输入手机号码"},model:{value:e.queryParam.phone,callback:function(t){e.$set(e.queryParam,"phone",t)},expression:"queryParam.phone"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"角色"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"sys_role,role_name,id",placeholder:"选择角色"},model:{value:e.queryParam.roleId,callback:function(t){e.$set(e.queryParam,"roleId",t)},expression:"queryParam.roleId"}})],1)],1),t("a-col",{attrs:{md:2,sm:8}},[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(70vh - 130px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(70vh - 130px)"},attrs:{border:"",align:e.allAlign,data:e.tableData,"max-height":"100%","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"manual",mode:"row"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"5%"}}):t("vxe-table-column",{attrs:{type:"radio",width:"5%"}}),t("vxe-table-column",{attrs:{field:"workNo",title:"工号",width:"100",align:"center"}}),t("vxe-table-column",{attrs:{field:"username",title:"用户账号",width:"150",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"realname",title:"用户名字",width:"100",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"roleNames",title:"角色","min-width":"180",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"sex_dictText",title:"性别",width:"80"}}),t("vxe-table-column",{attrs:{field:"phone",title:"手机号码",width:"120"}}),t("vxe-table-column",{attrs:{field:"orgCode",title:"部门",width:"120",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"80"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)])],1)],1)},r=[],o=a("8fad"),s={name:"UserList",props:{multiple:{type:Boolean,default:!0},depId:{type:String,default:""}},data:function(){return{queryParam:{username:"",realname:"",phone:"",orgCode:"",roleId:void 0,pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,treeData:[]}},watch:{depId:function(e){this.$set(this.queryParam,"depId",e||"")}},mounted:function(){this.$set(this.queryParam,"depId",this.depId||"")},methods:{showModal:function(){this.visible=!0,this.findList(),this.getTreeList()},getTreeList:function(){var e=this;Object(o["yb"])().then((function(t){t.success&&(e.treeData=t.result)}))},onSelect:function(e,t){if(e.length){var a=t.node.dataRef;this.queryParam.depId=a.id,this.findList()}else this.queryParam.orgCode="",this.findList()},findList:function(){var e=this;this.loading=!0,Object(o["uc"])(this.queryParam).then((function(t){e.loading=!1,t.success?(e.totalResult=t.result.total,e.tableData=t.result.records):e.$message.error("加载用户数据失败")})).catch((function(t){e.$message.error("加载用户数据异常")})).finally((function(){}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,Object.assign(this.$data,this.$options.data())}}},i=s,n=(a("f76d"),a("2877")),u=Object(n["a"])(i,l,r,!1,null,"4aa7956f",null);t["default"]=u.exports},bebf:function(e,t,a){"use strict";a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return c})),a.d(t,"d",(function(){return d}));var l=a("0fea"),r=a("4328"),o=a.n(r),s=function(e){return Object(l["d"])("/layout/widgets/page",e)},i=function(e){return Object(l["j"])("/layout/layouts/save",e)},n=function(e){return Object(l["d"])("/layout/layouts/page",e)},u=function(e){return Object(l["j"])("/layout/layouts/delete",o.a.stringify(e))},c=function(e){return Object(l["d"])("/layout/layouts/get",e)},d=function(){return Object(l["d"])("/layout/layouts/get/current-user-main")}},f76d:function(e,t,a){"use strict";a("9527")}}]);