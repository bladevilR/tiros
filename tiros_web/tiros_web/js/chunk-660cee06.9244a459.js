(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-660cee06","chunk-e557ef9e","chunk-362cc4ab","chunk-ad0db6b8","chunk-01a27526","chunk-acc24a18","chunk-0f12fa96","chunk-36a4e4be","chunk-2093b0ec","chunk-5730732a","chunk-e557ef9e","chunk-0950fc2f","chunk-29136323","chunk-c7b1b1f0","chunk-62495c08","chunk-42391c95","chunk-72e72170","chunk-535429be","chunk-c47b85c2","chunk-2cc43f66","chunk-cfac6c42","chunk-cf5f982e","chunk-65151992"],{"009c":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:"90%",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0,centered:"",bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"表单:"}},[t("a-input",{attrs:{placeholder:"表单名称或编码",allowClear:""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"表单类型:"}},[t("a-select",{attrs:{allowClear:""},model:{value:e.queryParam.formTypeList,callback:function(t){e.$set(e.queryParam,"formTypeList",t)},expression:"queryParam.formTypeList"}},[t("a-select-option",{attrs:{value:3}},[e._v(" 作业记录表")]),t("a-select-option",{attrs:{value:1}},[e._v(" 数据记录表")]),t("a-select-option",{attrs:{value:4}},[e._v(" 检查记录表")])],1)],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"选择工位"}},[t("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",placeholder:"请选择工位",open:!1},on:{dropdownVisibleChange:function(t){return e.openStationSelectModal()},change:e.onStationChange},model:{value:e.stationName,callback:function(t){e.stationName=t},expression:"stationName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1),t("a-col",{attrs:{md:9,sm:8}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")]),t("a-button",{on:{click:e.openFormModal}},[e._v("从模板添加")]),t("a-button",{attrs:{disabled:!e.btnStatus.edit},on:{click:function(t){return e.openFormEditModal(e.btnStatus.editRow)}}},[e._v("修改")]),t("a-button",{attrs:{loading:e.deleteLoading,disabled:e.records.length<=0},on:{click:e.deleteForm}},[e._v("删除")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 90px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 90px)"},attrs:{border:"","max-height":"100%",align:"center",data:e.tableData,"radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"show-overflow":"tooltip"},on:{"checkbox-change":e.rowSelectChange,"checkbox-all":e.rowSelectChange}},[t("vxe-table-column",{attrs:{type:"seq",fixed:"left",width:"60"}}),e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"planName",title:"列计划",align:"left","header-align":"center",width:"180"}}),t("vxe-table-column",{attrs:{field:"title",title:"表单名称","min-width":"220",align:"left","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[1!==e.operator?t("span",[e._v(e._s(a.title))]):t("a",{on:{click:function(t){return t.stopPropagation(),e.jumpInfo(a)}}},[e._v(e._s(a.title))])]}}])}),t("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"code",title:"表单编码",width:"120"}}),t("vxe-table-column",{attrs:{field:"formType_dictText",title:"表单类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(3!==r.formType?r.formType_dictText:1===r.workRecordType?"作业记录表(老)":"作业记录表(新)")+" ")]}}])}),t("vxe-table-column",{attrs:{field:"reguName",title:"所属规程",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(r.reguName)+" ")]}},{key:"edit",fn:function(r){var a=r.row;return[t("a-input",{attrs:{placeholder:"请选择表单",disabled:""},model:{value:a.reguName,callback:function(t){e.$set(a,"reguName",t)},expression:"row.reguName"}})]}}])}),t("vxe-table-column",{attrs:{field:"reguVersion",title:"规程版本",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(r.reguVersion)+" ")]}},{key:"edit",fn:function(r){var a=r.row;return[t("a-input",{attrs:{placeholder:"请选择表单",disabled:""},model:{value:a.reguVersion,callback:function(t){e.$set(a,"reguVersion",t)},expression:"row.reguVersion"}})]}}])}),t("vxe-table-column",{attrs:{field:"trainStructName",title:"关联设备","min-width":"150",align:"left","header-align":"center"}})],1)],1),t("JobCheckTableView",{ref:"jobCheckTableView"}),t("RecordTableView",{ref:"recordTableView"}),t("FormViewModal",{ref:"formViewModal"}),t("ViewWorkForm",{ref:"viewWorkForm",attrs:{operator:e.operator}}),t("TaskFormModel",{ref:"taskFormModel",attrs:{repairId:e.repairId,operator:e.operator,checkList:e.tableData,trainNo:e.trainNo,"plan-id":e.planId,"line-id":e.lineId},on:{ok:e.onAddForm}}),t("work-station-list",{ref:"stationSelectModal",on:{ok:e.onSelectStation}}),t("task-form-edit-model",{ref:"taskFormEditModel",attrs:{"line-id":e.lineId,"train-no":e.trainNo},on:{ok:e.findList}})],1)},o=[],i=r("37582"),n=r("e42a"),l=r("8fad"),s=r("3dbe"),c=r("aaa8"),u=r("7e9e"),d=r("88da"),f=r("60c8"),h=r("1158"),m=r("54f6"),p=r("0c04");function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return(t=k(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e){var t=w(e,"string");return"symbol"==g(t)?t:t+""}function w(e,t){if("object"!=g(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=g(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var x={name:"TaskFormSelectModel",components:{FormsList:i["default"],CarDeviceSelect:n["default"],TaskFormModel:f["default"],WorkStationList:h["default"],TaskFormEditModel:p["default"],ViewWorkForm:d["default"],JobCheckTableView:c["default"],RecordTableView:u["default"],FormViewModal:s["default"]},props:{trainNo:{type:String,default:""},lineId:{type:String,default:""},workOrderTaskId:{type:String,default:""},workOrderId:{type:String,default:""},repairId:{type:[Number,String],default:null},operator:{type:[String,Number],default:""},checkList:{type:Array,default:function(){return[]}},multiple:{type:Boolean,default:!0}},data:function(){return{records:[],deleteLoading:!1,title:"列计划已有表单实例",confirmLoading:!1,visible:!1,tableData:[],stationName:"",queryParam:{formTypeList:"",planId:"",searchText:"",workstationId:null},totalResult:0,planId:"",btnStatus:new m["a"](this,"listTable")}},methods:{jumpInfo:function(e){var t=y(y({},e),{},{planFormId:e.planFormId,instType:e.formType,formObjId:e.formObjId,formInstId:e.id,workRecordType:e.workRecordType,formName:e.title,workOrderId:this.workOrderId,workOrderTaskId:this.workOrderTaskId});delete t.id,this.$refs.viewWorkForm.showModal(t,this.trainNo)},deleteForm:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords(),r=t.map((function(e){return{formType:e.formType,formInstId:e.id,planId:e.planId}}));this.deleteLoading=!0,Object(l["R"])(r).then((function(t){t.success?(e.$message.success("删除成功"),e.findList()):e.$message.warning(t.message),e.deleteLoading=!1})).catch((function(t){e.deleteLoading=!1}))},rowSelectChange:function(e){var t=e.records;this.records=t,this.btnStatus.update()},findList:function(){var e=this;Object(l["vb"])(this.queryParam).then((function(t){t.success?(e.tableData=t.result||[],e.records=[]):e.$message.warn(t.message)}))},showModal:function(e){this.queryParam.planId=e,this.tableData=[],this.findList(),this.visible=!0},openFormEditModal:function(e){this.$refs.taskFormEditModel.edit(e)},handleOk:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();if(t.length){var r=t.filter((function(t){var r=e.checkList.find((function(e){return e.formInstId===t.id}));return r&&e.$message.warn("".concat(t.title,"已经添加了")),r}));if(r.length>0)return;t.length>0&&(this.$emit("ok",t),this.visible=!1)}else this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},openFormModal:function(){this.$refs.taskFormModel.showModal(this.queryParam.planId)},onAddForm:function(e){this.findList()},openStationSelectModal:function(){this.$refs.stationSelectModal.showModal()},onSelectStation:function(e){e.length&&(this.queryParam.workstationId=e[0].id,this.stationName=e[0].name)},onStationChange:function(e){e||(this.queryParam.workstationId=null)}}},C=x,I=(r("8cf3"),r("2877")),S=Object(I["a"])(C,a,o,!1,null,"787457a7",null);t["default"]=S.exports},"05d5":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"表单查看-"+e.trainNo+"车 "+e.formName,centered:"",visible:e.visible,width:"100%",footer:null,dialogClass:"fullDialog no-title no-footer",destroyOnClose:!0},on:{cancel:function(t){e.visible=!1}}},[t("div",{staticClass:"table-page-body",staticStyle:{height:"calc(100% - 50px)"}},[t("div",{attrs:{id:"luckysheet"}})])])},o=[],i=r("8fad"),n=r("b9c3"),l=r("7268"),s={name:"FormTemplate",data:function(){return{formName:"",trainNo:"",groupName:"",visible:!1,fileUrl:"",tableData:[],defaultOptions:{container:"luckysheet",title:"sheet",column:26,row:50,lang:"zh",allowEdit:!1,showinfobar:!1,sheetFormulaBar:!1,showsheetbar:!1,showstatisticBar:!0,enableAddRow:!1,enableAddCol:!1,showtoolbar:!1}}},beforeDestroy:function(){luckysheet.destroy()},methods:{initSheet:function(e){var t=JSON.parse(JSON.stringify(this.defaultOptions));t.data=[e],luckysheet.destroy(),luckysheet.create(t)},showModal:function(e){this.formName=e.formObjName,this.groupName=e.groupName,this.loadOnlineFormDetail(e.id,e.formInstId),this.visible=!0},showModal2:function(e,t,r,a){this.formName=e,this.groupName=t,this.loadOnlineFormDetail("task2InstId",r),this.visible=!0},loadOnlineFormDetail:function(e,t){var r=this,a={task2InstId:e,formInstId:t,needValues:!1};Object(n["Q"])(a).then((function(e){if(e.success){var t=e.result;if(r.trainNo=t.trainNo,t&&t.result)try{var a=JSON.parse(t.result);Object(i["ub"])(t.formObjId).then((function(e){if(e.success){var o=JSON.parse(e.result);a&&(o.data=[],o.celldata=luckysheet.transToCellData(a)),r.initSheet(o),setTimeout((function(){l["a"].setRangeConditionalOncell(t.formObjId,t.id)}),200)}else r.$message.error("获取表单模板数据失败")}))}catch(o){return void r.$message.error("转换表单填写结果异常")}else r.$message.error("获取作业表单数据失败")}else r.$message.error("获取记录表内容错误")})).catch((function(e){r.$message.error("获取记录表内容异常")}))}}},c=s,u=(r("5577"),r("2877")),d=Object(u["a"])(c,a,o,!1,null,"7efb72d8",null);t["default"]=d.exports},"0743":function(e,t,r){},"0c04":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0,centered:""},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"标题"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["title",e.validatorRules.title],expression:"[ 'title', validatorRules.title]",modifiers:{trim:!0}}]})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"车辆设备"}},[t("div",{on:{click:e.openAssetSelectModal}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["trainStructName",e.validatorRules.trainStructName],expression:"['trainStructName', validatorRules.trainStructName]",modifiers:{trim:!0}}],ref:"trainAssetSelect",staticStyle:{width:"100%"},attrs:{placeholder:"请选择作业目标设备",open:!1}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)])],1)],1)],1),t("CarDeviceSelectNew",{ref:"trainAssetSelectModal",attrs:{trainNo:e.trainNo,lineId:e.lineId,multiple:!1,canSelectType:[2,3,4]},on:{ok:e.onTrainAssetSelect,cancel:e.onCancelTrainAssetSelect}})],1)],1)},o=[],i=r("310d"),n=r("b47d"),l={name:"TaskFormEditModel",components:{CarDeviceSelectNew:i["default"]},props:["lineId","trainNo"],data:function(){return{title:"编辑",visible:!1,trainStructId:"",model:{},confirmLoading:!1,form:this.$form.createForm(this),labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}},validatorRules:{title:{rules:[{required:!0,message:"请输入标题!"},{max:64,message:"输入长度不能超过64字符!"}]},trainStructName:{rules:[{required:!0,message:"请选择车辆设备!"}]}}}},methods:{edit:function(e){var t=this;this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue({title:t.model.title,trainStructName:t.model.structDetailName}),t.trainStructId=t.model.trainStructId}))},handleOk:function(){var e=this;e.form.validateFields((function(t,r){if(!t){e.confirmLoading=!0;var a=Object.assign(e.model,r,{trainStructId:e.trainStructId,formType:e.model.formType});Object(n["Qb"])(a).then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok"),e.close()):e.$message.warning(t.message)})).finally((function(){e.confirmLoading=!1}))}}))},openAssetSelectModal:function(){this.$refs.trainAssetSelectModal.showModal()},onTrainAssetSelect:function(e){var t=this;if(e.length){var r=e[0];this.trainStructId=r.id,this.$nextTick((function(){t.form.setFieldsValue({trainStructName:r.assetName})}))}},onCancelTrainAssetSelect:function(){},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},s=l,c=r("2877"),u=Object(c["a"])(s,a,o,!1,null,"5f227585",null);t["default"]=u.exports},"0e7b":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"70%",title:"故障代码选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",centered:"",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:""}},[t("a-input",{attrs:{placeholder:"请输入编码和描述"},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:3,sm:8}},[t("a-form-item",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 82px)"}},[t("vxe-table",{ref:"listTable",attrs:{border:"",height:"auto",align:e.allAlign,data:e.tableData,"highlight-current-row":"","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row",checkMethod:e.checkMethod},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0,checkMethod:e.checkMethod}:{},"tree-config":{lazy:!1,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"fltCode",align:"left","header-align":"center",title:"故障代码",width:"260","tree-node":""}}),t("vxe-table-column",{attrs:{field:"fltLevel_dictText",title:"类型",width:"150"}}),t("vxe-table-column",{attrs:{field:"fltName",title:"代码描述",align:"left","header-align":"center"}})],1)],1)])},o=[],i=r("b47d"),n=r("ca00"),l=r("a396");function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=c(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,n=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return n=e.done,e},e:function(e){l=!0,i=e},f:function(){try{n||null==r.return||r.return()}finally{if(l)throw i}}}}function c(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}var d={name:"FaultCodeList",components:{FaultCategoryList:l["default"]},props:{multiple:{type:Boolean,default:!0},type:{type:String,default:""}},data:function(){return{categoryCode:"",queryParam:{searchText:""},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,formItemLayout:{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}}}},methods:{showModal:function(e){this.visible=!0,this.queryParam.categoryId=e,this.findList()},findList:function(){var e=this;this.loading=!0,Object(i["bb"])(this.queryParam).then((function(t){t.success?(e.tableData=e.listToTreeList(t.result),e.$nextTick((function(){e.tableData.length&&e.$refs.listTable.setTreeExpand(e.tableData.find((function(e){return e.children})),!0)}))):e.$message.error(t.message)}))},loadChildrenMethod:function(e){var t=e.row;return Object(i["cb"])({code:t.fltCode}).then((function(e){return e.success?((e.result||[]).forEach((function(e){e.children=[]})),e.result||[]):[]}))},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.close()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,this.categoryCode="",this.queryParam.searchText="",this.queryParam.categoryId=""},openSelectTypeModal:function(){this.$refs.categorySelect.showModal(),this.$refs.categoryIdSelect.blur()},addCategoryTarget:function(e){Object(n["e"])(e)?this.queryParam.categoryId="":(this.queryParam.categoryId=e[0].id,this.categoryCode=e[0].categoryCode)},checkMethod:function(e){var t=e.row;return"unit"!=this.type||3==t.fltLevel},listToTreeList:function(e){if(!e||!e.length)return[];var t,r={},a=s(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;r[o.fltCode]=o}}catch(n){a.e(n)}finally{a.f()}for(var i=0;i<e.length;i++)e[i].parentCode&&r[e[i].parentCode]&&(r[e[i].parentCode].children||(r[e[i].parentCode].children=[]),r[e[i].parentCode].children.push(e[i]),e.splice(i,1),i--);return e.sort((function(e,t){return e.fltCode-t.fltCode})),e}}},f=d,h=(r("191b"),r("2877")),m=Object(h["a"])(f,a,o,!1,null,"e6e31b9e",null);t["default"]=m.exports},"10f9":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("TablePrint",{ref:"tablePrint"}),t("LuckySheetPrint",{ref:"luckySheetPrint",attrs:{luckySheetId:e.luckySheetId},on:{sheetPrintOk:function(t){return e.$emit("sheetPrintOk")}}}),t("JobCheckTableExport",{ref:"jobCheckPrint"})],1)},o=[],i=r("90f1"),n=r("e89a"),l=r("3cf2"),s=r("b7b4"),c=r("b9c3"),u=r("8fad"),d={name:"WorkRecordPrint",components:{TablePrint:i["default"],JobCheckTableExport:l["default"],LuckySheetPrint:n["default"]},props:{luckySheetId:{type:String,default:"lsPrint"}},data:function(){return{}},created:function(){},methods:{print:function(e){switch(e.instType){case 1:this.loadOnlineFormDetail(e.id,e.formInstId);break;case 3:1===e.workRecordType?this.loadRecordTableDetail(e.id,e.formInstId):2===e.workRecordType&&this.loadWorkRecordForm(e,!0);break;case 4:this.loadWorkFormDetail(e.task2InstId,e.formInstId)}},loadWorkRecordForm:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(u["ub"])(e.formObjId).then((function(a){if(a.success){var o=JSON.parse(a.result);if(!r)return void t.$refs.luckySheetPrint.printBySheet(o);Object(c["U"])(e.formInstId).then((function(e){if(e.success&&e.result){var r=JSON.parse(e.result);o.data=[],o.celldata=luckysheet.transToCellData(r)}t.$refs.luckySheetPrint.printBySheet(o)}))}else t.$message.error("获取作业记录表模板数据失败")}))},loadRecordTableDetail:function(e,t){var r=this;Object(c["R"])({task2InstId:e,formInstId:t,needChecks:!0,needCategory:!0,allItems:!0}).then((function(e){e.success&&e.result?(r.$nextTick((function(){e.result.categoryList&&e.result.categoryList.sort((function(e,t){return e.recIndex-t.recIndex})),r.$refs.tablePrint.printByData(e.result)})),r.visible=!0):r.$message.error("加载记录数据异常")}))},loadWorkFormDetail:function(e,t){var r=this;Object(s["x"])({task2InstId:e,formInstId:t}).then((function(e){e.success&&e.result?r.$refs.jobCheckPrint.printByRow(e.result):r.$message.error("加载记录数据异常")}))},loadOnlineFormDetail:function(e,t){var r=this;Object(c["Q"])({task2InstId:e,formInstId:t,needValues:!1}).then((function(e){try{if(e.success&&e.result){var t=e.result,a=JSON.parse(t.result);r.$nextTick((function(){Object(u["ub"])(t.formObjId).then((function(e){if(e.success){var t=JSON.parse(e.result);a&&(t.celldata=luckysheet.transToCellData(a)),r.$refs.luckySheetPrint.printBySheet(t)}}))}))}else r.$message.error("加载记录数据异常")}catch(o){r.$message.error("加载记录数据异常")}}))},printNoData:function(e){try{switch(e.instType){case 1:this.loadOnlineDetailNoData(e.formInstId);break;case 3:1===e.workRecordType?this.loadRecordDetailNoData(e.formInstId):2===e.workRecordType&&this.loadWorkRecordForm(e,!1);break;case 4:this.loadCheckDetailNoData(e.formInstId)}}catch(t){}},loadRecordDetailNoData:function(e){var t=this;Object(u["Ab"])({id:e}).then((function(e){e.success&&e.result?(t.$nextTick((function(){e.result.categoryList&&e.result.categoryList.sort((function(e,t){return e.recIndex-t.recIndex})),t.$refs.tablePrint.printByData(e.result)})),t.visible=!0):t.$message.error("加载记录数据异常")}))},loadCheckDetailNoData:function(e){var t=this;Object(s["y"])({id:e}).then((function(e){try{e.success&&e.result?(t.$refs.jobCheckPrint.printByRow(e.result),t.visible=!0):t.$message.error("加载记录数据异常")}catch(r){t.$message.error("加载记录数据异常")}}))},loadOnlineDetailNoData:function(e){var t=this;this.visible=!0,Object(u["ub"])(e).then((function(e){if(e.success){var r=JSON.parse(e.result);t.$refs.luckySheetPrint.printBySheet(r)}}))}}},f=d,h=r("2877"),m=Object(h["a"])(f,a,o,!1,null,null,null);t["default"]=m.exports},1158:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:"工位选择",centered:"",bodyStyle:{height:"80vh"},visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{staticStyle:{"border-right":"1px dotted #D3E1F1",height:"calc(80vh - 20px)","margin-right":"8px",padding:"0px"},attrs:{md:4,sm:24}},[e.treeData.length?t("a-tree",{attrs:{defaultExpandAll:"","tree-data":e.treeData,"default-selected-keys":e.defaultKey,dropdownStyle:{maxHeight:"200px",overflow:"auto"},replaceFields:{title:"name",key:"id"}},on:{select:e.onSelect}}):e._e()],1),t("a-col",{attrs:{md:19,sm:24}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getWorkStation.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"工位"}},[t("a-input",{attrs:{placeholder:"请输入工位名称","allow-clear":""},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"班组"}},[t("j-dict-select-tag",{attrs:{dictCode:"sys_depart,depart_name,id,org_category=4",placeholder:"请选择"},model:{value:e.queryParam.groupId,callback:function(t){e.$set(e.queryParam,"groupId",t)},expression:"queryParam.groupId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-space",[t("a-button",{on:{click:e.getWorkStation}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticClass:"limitHeight"},[t("vxe-table",{ref:"listTable",staticStyle:{height:"100%"},attrs:{border:"","row-id":"id",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"},"radio-config":{trigger:"row"},"checkbox-config":{trigger:"row",highlight:!0,range:!0,checkStrictly:!0},"max-height":"100%"}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"stationNo",title:"工位号",width:"100"}}),t("vxe-table-column",{attrs:{field:"name",title:"工位名称",width:"20%",align:"left"}}),t("vxe-table-column",{attrs:{field:"groupName",title:"所属班组",width:"20%",align:"left"}}),t("vxe-table-column",{attrs:{field:"location",title:"位置",width:"100",align:"left"}}),t("vxe-table-column",{attrs:{field:"content",title:"作业内容",width:"25%",align:"left"}}),t("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"10%",align:"left"}})],1)],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.page.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)],1)],1)},o=[],i=r("8fad"),n={name:"WorkStationList",props:{multiple:{type:Boolean,default:!1},groupId:{type:String,default:null}},data:function(){return{visible:!1,confirmLoading:!1,treeData:[],tableData:[],allAlign:"center",defaultKey:[],queryParam:{id:"",name:"",groupId:"",pageNo:1,pageSize:10},page:{currentPage:1,pageSize:10,totalResult:3}}},mounted:function(){this.groupId&&(this.queryParam.groupId=this.groupId)},methods:{showModal:function(){this.visible=!0,this.getTreeList()},getTreeList:function(){var e=this;Object(i["Ub"])().then((function(t){t.success&&(e.treeData=t.result,e.defaultKey[0]=t.result[0].id,e.queryParam.id=t.result[0].id,e.getWorkStation())}))},getWorkStation:function(){var e=this;Object(i["Tb"])(this.queryParam).then((function(t){e.page.totalResult=t.result.total,e.tableData=t.result.records}))},onSelect:function(e,t){var r=t.node.dataRef;e.length>0&&(this.queryParam.id=r.id,this.queryParam.pageNo=1,this.getWorkStation())},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.getTreeList()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},l=n,s=(r("7483"),r("2877")),c=Object(s["a"])(l,a,o,!1,null,"ea42f1f8",null);t["default"]=c.exports},"14d0":function(e,t,r){"use strict";r("de37")},"191b":function(e,t,r){"use strict";r("d4ad")},"25e0":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,centered:"",width:500,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查日期"}},[t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["checkDate",e.validatorRules.checkDate],expression:"['checkDate', validatorRules.checkDate]"}],staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD",placeholder:"选择检查日期"},on:{change:e.changeCheckDate}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查结果"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["checkResult",e.validatorRules.checkResult],expression:"['checkResult', validatorRules.checkResult]"}],attrs:{triggerChange:!0,placeholder:"请选择检查结果",dictCode:"bu_work_order_record_result"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"质量负责人"}},[t("a-input",{ref:"userSelect",staticStyle:{width:"100%"},attrs:{placeholder:"请选择质量负责人",open:!1},on:{click:function(t){return e.openSelectUser()}},model:{value:e.checkUserName,callback:function(t){e.checkUserName=t},expression:"checkUserName"}},[t("a-icon",{attrs:{slot:"suffix",type:"ellipsis"},slot:"suffix"})],1)],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"备注"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["remark"],expression:"['remark']",modifiers:{trim:!0}}],attrs:{placeholder:"请输入备注"}})],1)],1)],1),t("user-list",{ref:"userSelectModal",attrs:{multiple:!1},on:{ok:e.onSelectUser}})],1)},o=[],i=r("b245"),n=r("b7b4"),l=r("c1df"),s=r.n(l),c={name:"ConfirmForm",components:{UserList:i["default"]},data:function(){return{title:"检查确认",visible:!1,recordId:"",checkUserName:"",checkUserId:"",model:{},confirmLoading:!1,labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},form:this.$form.createForm(this),validatorRules:{checkDate:{rules:[{required:!0,message:"请选择检查日期!"}]},checkResult:{rules:[{required:!0,message:"请选择检查结果!"}]}}}},mounted:function(){},methods:{confirm:function(e){var t=this;this.form.resetFields(),this.visible=!0,this.confirmLoading=!1,this.recordId=e,this.model=Object.assign({},{checkDate:s()(new Date).format("YYYY-MM-DD")}),this.$nextTick((function(){t.form.setFieldsValue({checkDate:t.model.checkDate})})),this.checkUserName=this.$store.getters.userInfo.realname,this.checkUserId=this.$store.getters.userInfo.id},changeCheckDate:function(e){e&&(this.model.checkDate=e)},handleOk:function(){var e=this;e.form.validateFields((function(t,r){if(!t){e.confirmLoading=!0;var a=Object.assign(e.model,r,{checkDate:s()(e.model.checkDate).format("YYYY-MM-DD"),id:e.recordId,checkUserName:e.checkUserName,checkUserId:e.checkUserId});Object(n["f"])(a).then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok",a),e.close()):e.$message.warning(t.message)})).finally((function(){e.confirmLoading=!1}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},openSelectUser:function(){this.$refs.userSelectModal.showModal(),this.$refs.userSelect.blur()},onSelectUser:function(e){e.length&&(this.checkUserName=e[0].realname,this.checkUserId=e[0].id,this.$forceUpdate())}}},u=c,d=r("2877"),f=Object(d["a"])(u,a,o,!1,null,null,null);t["default"]=f.exports},"260f":function(e,t,r){},"2a71":function(e,t,r){"use strict";r("30f7")},"2d1c":function(e,t,r){"use strict";r("8e5e")},"2e75":function(e,t,r){},"2f2f":function(e,t,r){},"30f7":function(e,t,r){},"310d":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("a-modal",{attrs:{title:"车辆设备选择",width:"80%",bodyStyle:{height:"83vh"},visible:e.visible,confirmLoading:e.confirmLoading,closable:!0,centered:"",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.close}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchQuery.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"名称"}},[t("a-input",{attrs:{placeholder:"名称或编码"},model:{value:e.queryParam.title,callback:function(t){e.$set(e.queryParam,"title",t)},expression:"queryParam.title"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"线路"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"bu_mtr_line,line_name,line_id"},on:{change:e.changeLine},model:{value:e.lineId_A,callback:function(t){e.lineId_A=t},expression:"lineId_A"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"车辆"}},[t("j-dict-select-seach-tag",{attrs:{triggerChange:!0,dictCode:e.dictTrainStr},model:{value:e.trainNo_A,callback:function(t){e.trainNo_A=t},expression:"trainNo_A"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"状态"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,placeholder:"请选择状态",dictCode:"bu_valid_status"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.searchQuery}},[e._v("查询")])],1)],1)])],1)],1)],1),t("div",{staticClass:"tableHeight"},[t("vxe-table",{ref:"listTable",attrs:{border:"",resizable:"","row-id":"id",align:e.allAlign,height:"auto",data:e.tableData,"show-overflow":"tooltip","max-height":"100%","radio-config":{trigger:e.multiple?"default":"row",highlight:!0,checkMethod:e.checkRadioMethod},"checkbox-config":{trigger:e.multiple?"row":"default",highlight:!0,checkStrictly:!0,checkMethod:e.checkRadioMethod},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40",fixed:"left"}}),t("vxe-table-column",{attrs:{field:"name",title:"名称","tree-node":"",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"code",title:"编码",width:"180"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",align:"center","header-align":"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("div",{style:{backgroundColor:e.statusColor[a.status+""],borderRadius:"4px"}},[e._v(" "+e._s(a.status_dictText)+" ")])]}}])}),t("vxe-table-column",{attrs:{field:"maximoAssetType",title:"maximo设备类型",width:"150",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"locationName",title:"位置",width:"400",align:"left","header-align":"center"}})],1)],1)])],1)},o=[],i=r("8fad"),n={props:{multiple:{type:Boolean,default:!0},trainNo:{type:[Number,String]},lineId:{type:[Number,String]}},data:function(){return{statusColor:{0:"#dedede",1:"#bad795"},dictTrainStr:"",trainNo_A:void 0,lineId_A:void 0,allAlign:"center",tableData:[],visible:!1,confirmLoading:!1,queryParam:{trainNo:"",searchText:"",status:1}}},created:function(){},methods:{changeLine:function(e,t){this.dictTrainStr="",e&&(this.dictTrainStr="bu_train_info,train_no,train_no,line_id="+e+"|train_struct_id")},checkRadioMethod:function(e){e.row;return!0},searchQuery:function(){this.findList()},loadChildrenMethod:function(e){var t=this,r=e.row,a={trainNo:this.trainNo_A,parentId:r.id,searchText:this.queryParam.searchText,status:this.queryParam.status};return new Promise((function(e){Object(i["Zb"])(a).then((function(r){r.success?e(r.result):t.$message.error("".concat(r.msg))}))}))},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),Array.from(e,(function(e,t){e.assetName=e.name})),this.$emit("ok",e),this.visible=!1},showModal:function(){this.visible=!0,this.lineId_A=this.lineId,this.trainNo_A=this.trainNo,this.findList()},close:function(){this.visible=!1},findList:function(){var e=this;this.queryParam.trainNo=this.trainNo_A,this.loading=!0,Object(i["Zb"])(this.queryParam).then((function(t){t.success&&(e.loading=!1,e.tableData=t.result)}))}}},l=n,s=(r("4677"),r("2877")),c=Object(s["a"])(l,a,o,!1,null,"3967f3d4",null);t["default"]=c.exports},"353a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"80%",visible:e.visible,title:e.title,centered:"",bodyStyle:{height:"80vh"},confirmLoading:e.confirmLoading,destroyOnClose:!0,footer:null},on:{cancel:e.handleCancel}},[t("div",[t("iframe",{staticClass:"filename",staticStyle:{height:"calc(80vh - 25px)"},attrs:{src:e.filePath,width:"100%",frameborder:"0"}})])])},o=[],i=r("e2aa"),n={name:"DocPreviewModal",props:{title:{type:String,default:"文件预览"}},data:function(){return{visible:!1,confirmLoading:!1,filePath:""}},methods:{handleFilePath:function(e){var t=this;Object(i["c"])(e).then((function(e){if(e.success){var r=e.result;t.visible=!0,t.filePath=window._CONFIG["onlinePreviewDomainURL"]+"?url="+encodeURIComponent(r)}else t.$message.warning("查看文件失败")}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},l=n,s=(r("9216"),r("2877")),c=Object(s["a"])(l,a,o,!1,null,"484795fd",null);t["default"]=c.exports},3737:function(e,t,r){"use strict";r("2f2f")},37582:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:e.title,centered:"",bodyStyle:{height:"80vh"},visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("na-splitter",{staticStyle:{height:"calc(80vh - 15px)"},attrs:{defaultSize:200}},[t("div",{staticStyle:{"overflow-y":"auto","overflow-x":"hidden","padding-right":"2px"},attrs:{slot:"left-panel"},slot:"left-panel"},[t("a-menu",{attrs:{mode:"inline","default-selected-keys":e.defaultSelect},on:{click:e.handleMenuClick}},[t("a-menu-item",{key:1},[t("a-icon",{attrs:{type:"pie-chart"}}),t("span",[e._v("数据记录表")])],1),t("a-menu-item",{key:3},[t("a-icon",{attrs:{type:"pie-chart"}}),t("span",[e._v("作业记录表【新】")])],1),t("a-menu-item",{key:4},[t("a-icon",{attrs:{type:"pie-chart"}}),t("span",[e._v("检查记录表")])],1)],1)],1),t("div",{staticStyle:{"padding-left":"5px","padding-right":"3px"},attrs:{slot:"right-panel"},slot:"right-panel"},[t("div",[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"表单名称"}},[t("a-input",{attrs:{placeholder:"请输入表单名称"},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol,label:"线路"}},[t("line-select-list",{model:{value:e.queryParam.lineId,callback:function(t){e.$set(e.queryParam,"lineId",t)},expression:"queryParam.lineId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol,label:"所属修程"}},[t("j-dict-select-tag",{attrs:{triggerChange:"",dictCode:"bu_repair_program,name,id"},model:{value:e.queryParam.repairProId,callback:function(t){e.$set(e.queryParam,"repairProId",t)},expression:"queryParam.repairProId"}})],1)],1),t("a-col",{attrs:{md:3,sm:8}},[t("a-form-item",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 135px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 135px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"},"radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{title:"-",width:"80"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("span",[t("a",{on:{click:function(t){return t.stopPropagation(),e.handleSeeing(a)}}},[e._v("预览")])])]}}])}),t("vxe-table-column",{attrs:{field:"title",title:3===e.formType?"作业记录表名称":1===e.formType?"数据记录表":4===e.formType?"检查记录表":"",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{width:"100",align:"left","header-align":"center",field:"code",title:"编码"}}),t("vxe-table-column",{attrs:{field:"lineName",title:"线路",width:"100"}}),4===e.formType?t("vxe-table-column",{attrs:{field:"repairProName",title:"修程",width:"100"}}):e._e(),1===e.formType||3===e.formType?t("vxe-table-column",{attrs:{field:"repairProgramName",title:"修程",width:"100"}}):e._e(),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[t("div",{style:{backgroundColor:e.statusColor[a.status+""],borderRadius:"4px"}},[e._v(" "+e._s(a.status_dictText)+" ")])]}}])}),t("vxe-table-column",{attrs:{field:"reguName",title:"所属规程",width:"120"}}),t("vxe-table-column",{attrs:{field:"reguVersion",title:"规程版本",width:"100"}}),t("vxe-table-column",{attrs:{field:"remark",title:"备注",align:"left","header-align":"center"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)]),t("RecordTableView",{ref:"recordTableView"}),t("JobCheckTableView",{ref:"jobCheckTableView"}),t("FormViewModal",{ref:"formViewModal"})],1)])],1)},o=[],i=r("b7b4"),n=r("8fad"),l=r("4ec3"),s=r("e18e"),c=r("7e9e"),u=r("aaa8"),d=r("3dbe"),f=r("5633"),h={name:"FormsList",components:{NaSplitter:s["default"],RecordTableView:c["default"],FormViewModal:d["default"],LineSelectList:f["default"],JobCheckTableView:u["default"]},props:{title:{type:String,default:"表单选择"},multiple:{type:Boolean,default:!0}},data:function(){return{fileName:"",formItemLayout:{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},statusColor:{0:"#dedede",1:"#bad795"},queryParam:{name:"",workstationId:"",lineId:"",repairProId:"",status:1,pageNo:1,pageSize:10},formType:3,workRecordType:2,defaultSelect:[3],dictCode:"bu_mtr_workstation,name,id",allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,stationData:[],isShowPlan:!1}},methods:{handleSeeing:function(e){var t=this;3===this.formType&&1===this.workRecordType&&this.$refs.recordTableView.show(e.id),(1===this.formType||3===this.formType&&2===this.workRecordType)&&this.$refs.formViewModal.showModal(e.id),4===this.formType&&Object(i["y"])({id:e.id}).then((function(e){if(e.success&&e.result){var r=e.result;t.$refs.jobCheckTableView.show(r)}else t.$message.error("加载记录数据异常")}))},showModal:function(e){e&&e.lineId&&(this.queryParam.lineId=e.lineId),e&&e.repairProgramId&&(this.queryParam.repairProId=e.repairProgramId),this.visible=!0,this.isShowPlan=!1,this.formType=3,this.workRecordType=2,this.defaultSelect=[3],this.findList()},showModalByPlan:function(e){this.visible=!0,this.isShowPlan=!0,this.formType=3,this.workRecordType=2,this.defaultSelect=[3],this.queryParam.planId=e,this.findList()},initDictData:function(){var e=this;Object(l["u"])(this.dictCode)?this.stationData=Object(l["u"])(this.dictCode):Object(l["f"])(this.dictCode).then((function(t){t.success&&(e.stationData=t.result)}))},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},initParamByFormType:function(){3===this.formType&&(this.queryParam.category="1328995639249358850",this.queryParam.type=1,this.workRecordType=2),1===this.formType&&(this.queryParam.category="1328995580210335746",this.queryParam.type=1,this.workRecordType=0)},findList:function(){var e=this;this.loading=!0,this.initParamByFormType(),(1===this.formType||3===this.formType&&2===this.workRecordType)&&Object(n["Dc"])(this.queryParam).then((function(t){t.success&&(e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records)})),4===this.formType&&Object(n["mc"])(this.queryParam).then((function(t){t.success&&(e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records)}))},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord());var t="";1===this.formType&&(t="数据记录表"),3===this.formType&&(1===this.workRecordType&&(t="作业记录表(老)"),2===this.workRecordType&&(t="作业记录表(新)")),4===this.formType&&(t="检查记录表"),this.$emit("ok",{formType:this.formType,workRecordType:this.workRecordType,formTypeName:t,forms:e}),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},handleMenuClick:function(e){this.formType!==e.key&&(this.formType=e.key,this.queryParam.name="",this.initParamByFormType(),this.findList())}}},m=h,p=(r("3737"),r("2877")),g=Object(p["a"])(m,a,o,!1,null,"1ecb454d",null);t["default"]=g.exports},"3c2d":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%","overflow-x":"hidden"}},[t("a-button",{attrs:{"na-btn-type":"print",type:"primary"},on:{click:e.exportPrint}},[e._v("导出打印")]),t("div",{staticStyle:{margin:"0px",padding:"0px",width:"100%",height:"calc(100vh - 85px)"},attrs:{id:"luckysheet"}}),e.showLoading?t("div",{staticStyle:{width:"100%","text-align":"center",position:"absolute",top:"0px",height:"100%","font-size":"16px","z-index":"1000000000",background:"#fff"}},[e._m(0)]):e._e()],1)},o=[function(){var e=this,t=e._self._c;return t("div",{staticStyle:{position:"relative",top:"45%",width:"100%"}},[t("div",{staticClass:"luckysheetLoaderGif"}),t("span",[e._v("加载中...")])])}],i=r("8fad"),n=r("2410"),l=r.n(n),s=r("e24e"),c={name:"view",props:["customId","formName"],data:function(){return{showLoading:!1,defaultOptions:{container:"luckysheet",title:"sheet",column:26,row:50,lang:"zh",allowEdit:!0,showinfobar:!1,sheetFormulaBar:!1,showsheetbar:!1,showstatisticBar:!0,enableAddRow:!1,enableAddCol:!1,showtoolbar:!1}}},beforeDestroy:function(){luckysheet.destroy()},mounted:function(){var e=this,t=l()(this.defaultOptions);t.data=[{name:"Sheet1",color:"",status:"1",order:"0",index:0,ch_width:2044,rh_height:1080}],this.customId?Object(i["ub"])(this.customId).then((function(e){if(e.success){var r=JSON.parse(e.result);r.scrollLeft=0,r.scrollTop=0,t.showtoolbarConfig={},r.config.authority={sheet:1,hintText:"禁止编辑",allowRangeList:[]},t.data=[r],luckysheet.destroy(),luckysheet.create(t)}})).catch((function(r){e.$message.error("加载表单内容异常"),luckysheet.destroy(),luckysheet.create(t)})):(luckysheet.destroy(),luckysheet.create(t))},methods:{exportPrint:function(){try{var e=this.formName;e||(e="export"),Object(s["a"])(luckysheet.getAllSheets(),e)}catch(t){}}}},u=c,d=r("2877"),f=Object(d["a"])(u,a,o,!1,null,"22edf2fe",null);t["default"]=f.exports},"3cb5":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"70%",title:"故障处理措施选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",centered:"",bodyStyle:{height:"80vh"},destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:""}},[t("a-input",{attrs:{placeholder:"故障措施编码或者描述"},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"分类"}},[t("a-select",{ref:"categoryIdSelect",attrs:{placeholder:"请选择所属分类",open:!1,showArrow:!0},on:{focus:function(t){return e.openSelectTypeModal(1)}},model:{value:e.categoryCode,callback:function(t){e.categoryCode=t},expression:"categoryCode"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"故障代码"}},[t("a-select",{ref:"faultCodeIdSelect",attrs:{placeholder:"请选择所属故障代码",open:!1,showArrow:!0},on:{focus:function(t){return e.openSelectTypeModal(2)}},model:{value:e.faultCode,callback:function(t){e.faultCode=t},expression:"faultCode"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"故障原因"}},[t("a-select",{ref:"faultReasonIdSelect",attrs:{placeholder:"请选择所属故障原因代码",open:!1,showArrow:!0},on:{focus:function(t){return e.openSelectTypeModal(3)}},model:{value:e.faultReasonCode,callback:function(t){e.faultReasonCode=t},expression:"faultReasonCode"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1),t("a-col",{attrs:{md:2,sm:8}},[t("a-form-item",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 130px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 130px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"highlight-current-row":"","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"click",mode:"cell",showIcon:"true"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{type:"seq",width:"60",title:"序号"}}),t("vxe-table-column",{attrs:{field:"solutionCode",title:"故障措施代码",width:"150"}}),t("vxe-table-column",{attrs:{field:"solutionDesc",title:"故障措施描述",align:"left","header-align":"center"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1),t("fault-category-list",{ref:"categorySelect",attrs:{multiple:!1},on:{ok:e.addCategoryTarget}}),t("fault-code-list",{ref:"codeSelect",attrs:{multiple:!1},on:{ok:e.addCodeTarget}}),t("fault-reason-list",{ref:"reasonSelect",attrs:{multiple:!1},on:{ok:e.addReasonTarget}})],1)},o=[],i=r("b47d"),n=r("a396"),l=r("0e7b"),s=r("6034"),c=r("ca00"),u={name:"FaultSolutionList",components:{FaultCategoryList:n["default"],FaultCodeList:l["default"],FaultReasonList:s["default"]},props:{multiple:{type:Boolean,default:!0}},data:function(){return{categoryCode:"",faultCode:"",faultReasonCode:"",queryParam:{searchText:"",categoryId:"",faultCodeId:"",faultReasonId:"",pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,formItemLayout:{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}}}},methods:{showModal:function(e){this.visible=!0,this.queryParam.faultReasonId=e,this.findList()},findList:function(){var e=this;this.loading=!0,Object(i["S"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.close()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,this.categoryCode="",this.faultCode="",this.faultReasonCode="",this.queryParam.searchText="",this.queryParam.categoryId="",this.queryParam.faultCodeId="",this.queryParam.faultReasonId=""},openSelectTypeModal:function(e){switch(e){case 1:this.$refs.categorySelect.showModal(),this.$refs.categoryIdSelect.blur();break;case 2:this.$refs.codeSelect.showModal(),this.$refs.faultCodeIdSelect.blur();break;case 3:this.$refs.reasonSelect.showModal(),this.$refs.faultReasonIdSelect.blur();break;default:break}},addCategoryTarget:function(e){Object(c["e"])(e)?this.queryParam.categoryId="":(this.queryParam.categoryId=e[0].id,this.categoryCode=e[0].categoryCode)},addCodeTarget:function(e){Object(c["e"])(e)?this.queryParam.faultCodeId="":(this.queryParam.faultCodeId=e[0].id,this.faultCode=e[0].fltCode)},addReasonTarget:function(e){Object(c["e"])(e)?this.queryParam.faultReasonId="":(this.queryParam.faultReasonId=e[0].id,this.faultReasonCode=e[0].reasonCode)}}},d=u,f=(r("f02c"),r("2877")),h=Object(f["a"])(d,a,o,!1,null,"4d7ca708",null);t["default"]=h.exports},"3dbe":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"表单查看",width:"100%",dialogClass:"fullDialog no-footer",visible:e.visible,footer:null,destroyOnClose:!0},on:{cancel:function(t){e.visible=!1}}},[t("FormView",{attrs:{"custom-id":e.customId,"form-name":e.formName}})],1)},o=[],i=r("3c2d"),n={name:"FormViewModal",components:{FormView:i["default"]},props:["formName"],data:function(){return{visible:!1,customId:null}},methods:{showModal:function(e){e&&(this.customId=e,this.visible=!0)}}},l=n,s=r("2877"),c=Object(s["a"])(l,a,o,!1,null,"65a9461c",null);t["default"]=c.exports},"3fdc":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{attrs:{"na-flex-height-full":""}},[e.isSelectDetaile?e._e():t("a-space",{staticStyle:{padding:"10px 0"}},[t("a-button",{on:{click:e.setCheckRecordTime}},[e._v("作业完成")]),t("a-button",{directives:[{name:"has",rawName:"v-has",value:"order:write:check:add",expression:"'order:write:check:add'"}],on:{click:e.openSetCheck}},[e._v("检查登记")]),t("a-button",{directives:[{name:"has",rawName:"v-has",value:"order:write:rectify:add",expression:"'order:write:rectify:add'"}],on:{click:e.openRectifyModal}},[e._v("添加整改")])],1),t("div",{attrs:{"na-flex-height-full":""}},[t("vxe-table",{ref:"listTable",attrs:{border:"","auto-resize":"","max-height":"auto","row-id":"id",align:"center",data:e.tableData,"show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0}}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{field:"sortNo",title:"序号",align:"center",width:"60"}}),t("vxe-table-column",{attrs:{field:"title",title:"项点","header-align":"center",align:"left",width:"160"}}),t("vxe-table-column",{attrs:{field:"content",title:"检查内容","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"checkLevel",title:"等级",align:"center",width:"80"}}),e.isSelectDetaile?e._e():t("vxe-table-column",{attrs:{field:"checkDesc",title:"检查情况",align:"center",width:"80"}}),e.isSelectDetaile?e._e():t("vxe-table-column",{attrs:{field:"checkResult_dictText",title:"结果",align:"center",width:"80"}}),e.isSelectDetaile?e._e():t("vxe-table-column",{attrs:{field:"workTime",title:"作业时间",align:"center",width:"115"}}),e.isSelectDetaile?e._e():t("vxe-table-column",{attrs:{field:"checkMethod_dictText",title:"检查方式",align:"center",width:"80"}}),e.isSelectDetaile?e._e():t("vxe-table-column",{attrs:{field:"checkUserName",title:"检查人",align:"center",width:"80"}}),e.isSelectDetaile?e._e():t("vxe-table-column",{attrs:{field:"checkTime",title:"检查时间",align:"center",width:"115"}})],1)],1),t("a-modal",{attrs:{title:"检查",width:800,visible:e.visible,confirmLoading:e.confirmLoading,centered:"",cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-form",{ref:"initForm",attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"登录名称"}},[t("a-row",{attrs:{gutter:10}},[t("a-col",{attrs:{span:14}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["checkUserName",e.validatorRules.checkUserName],expression:"['checkUserName', validatorRules.checkUserName]",modifiers:{trim:!0}}]})],1),t("a-col",{attrs:{span:10}},[t("a-button",{attrs:{type:"link"},on:{click:e.useCurrentUser}},[e._v("使用当前账号和密码")])],1)],1)],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"登录密码"}},[t("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["checkUserPwd",e.validatorRules.checkUserPwd],expression:"['checkUserPwd', validatorRules.checkUserPwd]",modifiers:{trim:!0}}]})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查方式"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["checkMethod",e.validatorRules.checkMethod],expression:"['checkMethod', validatorRules.checkMethod]"}],attrs:{triggerChange:"",placeholder:"请选择检查方式",dictCode:"bu_regu_method"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查结果"}},[t("a-checkbox",{model:{value:e.checkResult,callback:function(t){e.checkResult=t},expression:"checkResult"}},[e._v(" 合格 ?")])],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查时间"}},[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD HH:mm:ss","show-time":{format:"HH:mm:ss",hideDisabledOptions:!0}},model:{value:e.checkQueryParam.checkTime,callback:function(t){e.$set(e.checkQueryParam,"checkTime",t)},expression:"checkQueryParam.checkTime"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"结果描述"}},[t("a-textarea",{attrs:{"auto-size":{minRows:8,maxRows:8}},model:{value:e.checkQueryParam.checkDesc,callback:function(t){e.$set(e.checkQueryParam,"checkDesc",t)},expression:"checkQueryParam.checkDesc"}})],1)],1)],1),t("rectify-modal",{ref:"modalForm"}),t("WorkTimeModal",{ref:"workTimeModal",on:{ok:function(t){return e.findList()}}})],1)},o=[],i=r("5315"),n=r("7b165"),l=r("b9c3"),s=r("8fad"),c=r("c1df"),u=r.n(c);function d(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,a,o,i){var s=a&&a.prototype instanceof l?a:l,c=Object.create(s.prototype);return f(c,"_invoke",function(r,a,o){var i,l,s,c=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,r){return i=t,l=0,s=e,f.n=r,n}};function h(r,a){for(l=r,s=a,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=f.p,m=i[2];r>3?(o=m===a)&&(s=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=r<2&&h<i[1])?(l=0,f.v=a,f.n=i[1]):h<m&&(o=r<3||i[0]>a||a>m)&&(i[4]=r,i[5]=a,f.n=m,l=0))}if(o||r>1)return n;throw d=!0,a}return function(o,u,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,m),l=u,s=m;(t=l<2?e:s)||!d;){i||(l?l<3?(l>1&&(f.n=-1),h(l,s)):f.n=s:f.v=s);try{if(c=2,i){if(l||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,l<2&&(l=0)}else 1===l&&(t=i.return)&&t.call(i),l<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),l=1);i=e}else if((t=(d=f.n<0)?s:r.call(a,f))!==n)break}catch(t){i=e,l=1,s=t}finally{c=1}}return{value:t,done:d}}}(r,o,i),!0),c}var n={};function l(){}function s(){}function c(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(f(t={},a,(function(){return this})),t),h=c.prototype=l.prototype=Object.create(u);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,f(e,o,"GeneratorFunction")),e.prototype=Object.create(h),e}return s.prototype=c,f(h,"constructor",c),f(c,"constructor",s),s.displayName="GeneratorFunction",f(c,o,"GeneratorFunction"),f(h),f(h,o,"Generator"),f(h,a,(function(){return this})),f(h,"toString",(function(){return"[object Generator]"})),(d=function(){return{w:i,m:m}})()}function f(e,t,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}f=function(e,t,r,a){function i(t,r){f(e,t,(function(e){return this._invoke(t,r,e)}))}t?o?o(e,t,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[t]=r:(i("next",0),i("throw",1),i("return",2))},f(e,t,r,a)}function h(e,t,r,a,o,i,n){try{var l=e[i](n),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(a,o)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var i=e.apply(t,r);function n(e){h(i,a,o,n,l,"next",e)}function l(e){h(i,a,o,n,l,"throw",e)}n(void 0)}))}}var p={name:"TaskCheckForm",components:{WorkTimeModal:n["default"],RectifyModal:i["default"]},props:{taskFormsList:{type:Array,default:function(){return[]}},tasks:{type:Array,default:function(){return[]}},readOnly:{type:Boolean,default:!1},selectTask:{type:Object,default:null},workOrderInfo:{type:Object,default:function(){}},forms:{type:Array,default:function(){return[]}},modalType:{type:Number,default:0}},computed:{isSelectDetaile:function(){return 1===this.modalType}},mounted:function(){},data:function(){return{visible:!1,confirmLoading:!1,form:this.$form.createForm(this),labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:20}},labelCol2:{xs:{span:24},sm:{span:6}},wrapperCol2:{xs:{span:24},sm:{span:16}},validatorRules:{checkUserName:{rules:[{required:!0,message:"请输入登录名称!"}]},checkUserPwd:{rules:[{required:!0,message:"请输入密码!"}]},checkMethod:{rules:[{required:!0,message:"请选择!"}]}},tableData:[],queryParam:{formInstId:"",task2InstId:""},checkQueryParam:{checkUserName:"",checkUserPwd:"",itemIds:"",checkResult:1,checkDesc:"",checkMethod:null,checkTime:void 0},checkResult:!0}},methods:{findList:function(){var e=m(d().m((function e(t,r){var a=this;return d().w((function(e){while(1)switch(e.n){case 0:return r&&(this.queryParam.formInstId=r),t&&(this.queryParam.task2InstId=t),e.a(2,Object(l["s"])(this.queryParam).then((function(e){return e.success?a.tableData=e.result.sort((function(e,t){return e.sortNo-t.sortNo})):(a.$message.error(e.message),[])})))}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}(),findModelDetaile:function(e){var t=this;Object(s["lc"])({id:e.formObjId}).then((function(e){e.success?t.tableData=e.result.itemList.sort((function(e,t){return e.sortNo-t.sortNo})):t.$message.error(e.message)}))},setCheckRecordTime:function(){var e=this.$refs.listTable.getCheckboxRecords().map((function(e){return e.id}));e.length?this.$refs.workTimeModal.show(e):this.$message.warn("请选择作业项目")},openSetCheck:function(){var e=m(d().m((function e(){var t,r,a=this;return d().w((function(e){while(1)switch(e.n){case 0:return e.n=1,this.checkTaskCanSubmit(1);case 1:if(t=e.v,t.success){e.n=2;break}return this.$message.warn("".concat(t.formsName,"未完成，请检查！")),this.tabFormKey=this.taskFormsList.findIndex((function(e){return e==t.checkFomrs[0]})),this.$emit("taskFormNoWork",this.tabFormKey),e.a(2);case 2:r=this.$refs.listTable.getCheckboxRecords().map((function(e){return e.id})),r.length?(this.visible=!0,this.checkQueryParam.checkUserName="",this.checkQueryParam.checkUserPwd="",this.checkQueryParam.itemIds=r.join(","),this.checkQueryParam.checkResult=1,this.checkQueryParam.checkDesc="",this.checkQueryParam.type=null,this.isIgnore=!1,this.resultCheck=!0,this.$nextTick((function(){a.form.getFieldDecorator("resultDesc"),a.form.setFieldsValue({checkUserName:a.$store.getters.userInfo.username,checkUserPwd:"~**&&##@@$$%%^^~",checkDesc:"",type:null})}))):this.$message.warn("请选择作业项目");case 3:return e.a(2)}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleOk:function(){var e=this;this.form.validateFields((function(t,r){t||(Object.assign(e.checkQueryParam,r),e.checkQueryParam.checkResult=e.checkResult?1:0,e.checkQueryParam.checkTime?e.checkQueryParam.checkTime=u()(e.checkQueryParam.checkTime).format("YYYY-MM-DD HH:mm:ss"):e.checkQueryParam.checkTime=null,Object(l["Z"])(e.checkQueryParam).then((function(t){t.success?(e.$message.success("保存成功"),e.visible=!1,e.findList(),e.$emit("checkEnd")):e.$message.error(t.message)})))}))},handleCancel:function(){this.visible=!1},useCurrentUser:function(){var e=this;this.$nextTick((function(){e.form.setFieldsValue({checkUserName:e.$store.getters.userInfo.username,checkUserPwd:"~**&&##@@$$%%^^~"})}))},openRectifyModal:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords().map((function(e){return e.content}));t.length?Object(s["Nb"])({moduleCode:"JDXZG"}).then((function(r){r.success?(e.$refs.modalForm.addByRow({orderId:e.selectTask.orderId,orderName:e.workOrderInfo.orderName,depotId:e.workOrderInfo.depotId,orderTaskId:e.selectTask.id,remark:t.join(","),rectifyNo:r.result,groupId:e.workOrderInfo.groupId,lineId:e.workOrderInfo.lineId,lineName:e.workOrderInfo.lineName,trainNo:e.workOrderInfo.trainNo,groupName:e.workOrderInfo.groupName,status:"0"}),e.$refs.modalForm.title="新增"):e.$message.error(r.message)})):this.$message.warn("请选择作业项目")},onIgnoreChange:function(){var e=this;this.$nextTick((function(){e.form.resetFields("resultDesc")}))},checkTaskCanSubmit:function(){var e=m(d().m((function e(){var t,r,a,o=this,i=arguments;return d().w((function(e){while(1)switch(e.n){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:1,!0,r={success:!0,forms:[],records:[],checkFomrs:[]},a=[],0===this.selectTask.outTask&&(1===this.selectTask.taskType||3===this.selectTask.taskType||4===this.selectTask.taskType||5===this.selectTask.taskType)){e.n=1;break}return e.a(2,r);case 1:return this.taskFormsList.forEach((function(e){3===e.instType&&1===t&&a.push(Object(l["R"])({task2InstId:e.id,formInstId:e.formInstId,needCategory:!1,needChecks:!0,orderTaskId:o.selectTask.id}).then((function(e){return e.success&&e.result?(r.forms.push(e.result),e.result.detailList):(o.$message.error("获取表单作业明细失败"),[])}))),4===e.instType&&2===t&&a.push(Object(l["s"])({task2InstId:e.id,formInstId:e.formInstId}).then((function(e){return r.forms.push(e.element),e.success&&e.result?e.result:(o.$message.error("获取表单作业明细失败"),[])})))})),e.a(2,Promise.all(a).then((function(e){return e.forEach((function(e){if(1===t){for(var a=0;a<e.length;a++){var i=e[a];i.isIgnore&&1===i.isIgnore||i.selfCheck&&i.monitorCheck&&i.guarderCheck||(r.success=!1,!1,r.records.push(i))}if(r.forms.length>0){var n=[];r.records.forEach((function(e){n.find((function(t){return t.formInstId===e.workRecordId}))||n.push(o.taskFormsList.find((function(t){return t.formInstId===e.workRecordId})))})),r.checkFomrs=n,r.formsName=n.map((function(e){return"《".concat(e.formName,"》")})).toString()}}if(2===t){for(var l=0;l<e.length;l++){var s=e[l];s.checkUserId&&s.workTime||(r.success=!1,!1,r.records.push(s))}if(r.records.length>0){var c=[];r.records.forEach((function(e){c.find((function(t){return t.formInstId===e.checkId}))||c.push(o.taskFormsList.find((function(t){return t.formInstId===e.checkId})))})),r.checkFomrs=c,r.formsName=c.map((function(e){return"《".concat(e.formName,"》")})).toString()}}})),r})))}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getIDRecords:function(){return this.$refs.listTable.getCheckboxRecords().map((function(e){return e.id})).toString()}}},g=p,b=r("2877"),y=Object(b["a"])(g,a,o,!1,null,null,null);t["default"]=y.exports},"3ff1":function(e,t,r){},"412f":function(e,t,r){},"45ff":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{ref:"calcHeight"})},o=[],i=r("e8ae"),n=r("21a6"),l=r("8fad"),s="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",c={name:"TableExport",data:function(){return{}},mounted:function(){},methods:{printById:function(e){var t=this;Object(l["Ab"])({id:e}).then((function(e){e.success?t.initWorkBook(e.result):t.$message.error("获取记录表详情失败")})).catch((function(e){t.$message.error("获取记录表详情异常")}))},printByData:function(e){this.initWorkBook(e)},initWorkBook:function(e){var t=new i["Workbook"];t.creator="GY",t.lastModifiedBy="2021-10-28",t.created=new Date,t.modified=new Date,t.lastPrinted=new Date;var r=t.addWorksheet("Sheet1",{properties:{defaultColWidth:22,alignment:{vertical:"middle",horizontal:"left",wrapText:!0}},pageSetup:{paperSize:9}}),a=[];r.mergeCells("A1:C1"),r.getCell("A1").value="车号："+(e.trainNo||""),a.push({cell:"A1",horizontal:"left",fill:!0,size:14,bold:!0}),0===e.updown?(r.mergeCells("A2:C2"),r.getCell("A2").value="部件号："+(e.manufNo||""),a.push({cell:"A2",horizontal:"left",fill:!0,size:14,bold:!0})):1===e.updown?(r.mergeCells("A2:C2"),r.getCell("A2").value="原部件序列号："+(e.manufNo||""),a.push({cell:"A2",horizontal:"left",fill:!0,size:14,bold:!0}),r.mergeCells("A3:C3"),r.getCell("A3").value="新部件序列号："+(e.manufNoUp||""),a.push({cell:"A3",horizontal:"left",fill:!0,size:14,bold:!0})):r.mergeCells("A1:C2"),1===e.updown?r.mergeCells("D1:F3"):r.mergeCells("D1:F2"),r.getCell("D1").value=e.title||e.workRecName||"",a.push({cell:"D1",fill:!0,size:14,bold:!0}),r.mergeCells("G1:H1"),r.getCell("G1").value="作业日期："+(e.workDate||""),a.push({cell:"G1",fill:!0,horizontal:"left",size:14,bold:!0}),r.mergeCells("I1:J1"),r.getCell("I1").value="完工日期："+(e.finishDate||""),a.push({cell:"I1",fill:!0,horizontal:"left",size:14,bold:!0}),1===e.updown?r.mergeCells("G2:J3"):r.mergeCells("G2:J2"),r.getCell("G2").value="作业班组："+(e.workGroupName||""),a.push({cell:"G2",fill:!0,horizontal:"left",size:14,bold:!0}),r.getColumn("A").width=15,r.getColumn("B").width=30,r.getColumn("C").width=60,r.getColumn("D").width=15,r.getColumn("E").width=60,r.getColumn("F").width=60,r.getRow(1).height=30,r.getRow(2).height=30,r.getRow(3).height=30,1===e.updown&&(r.getRow(4).height=30);var o={A:"序号",B:"项目",C:"作业内容",D:"控制点",E:"技术要求",F:"作业情况",G:"结果",H:"自检",I:"互检",J:"专检"};for(var l in o)r.getCell(l+(1===e.updown?4:3)).value=o[l],a.push({cell:l+(1===e.updown?4:3),fill:!0,size:14,bold:!0});var c=1===e.updown?5:4,u=0;e.categoryList.forEach((function(e,t){r.getCell("A".concat(c+t)).value=e.recIndex,a.push({cell:"A".concat(c+t)}),r.mergeCells("A".concat(c+t,":A").concat(c+t+e.detailList.length-1)),r.getCell("B".concat(c+t)).value=e.reguTitle,a.push({cell:"B".concat(c+t),horizontal:"left"}),r.mergeCells("B".concat(c+t,":B").concat(c+t+e.detailList.length-1)),e.detailList.forEach((function(e,o){r.getCell("C".concat(c+t+o)).value="\n".concat(e.workContent||"","\n"),a.push({cell:"C".concat(c+t+o),horizontal:"left"}),r.getCell("D".concat(c+t+o)).value=e.checkLevel_dictText||"",a.push({cell:"D".concat(c+t+o)}),r.getCell("E".concat(c+t+o)).value="\n".concat(e.techRequire||"","\n"),a.push({cell:"E".concat(c+t+o),horizontal:"left"}),r.getCell("F".concat(c+t+o)).value=0==e.isIgnore?e.workInfo:e.ignoreDesc,a.push({cell:"F".concat(c+t+o),horizontal:"left"}),r.getCell("G".concat(c+t+o)).value=e.result?"√":"□",a.push({cell:"G".concat(c+t+o)}),r.getCell("H".concat(c+t+o)).value=e.selfCheck||"",a.push({cell:"H".concat(c+t+o)}),r.getCell("I".concat(c+t+o)).value=e.guarderCheck||"",a.push({cell:"I".concat(c+t+o)}),r.getCell("J".concat(c+t+o)).value=e.monitorCheck||"",a.push({cell:"J".concat(c+t+o)})})),c+=e.detailList.length-1,u+=e.detailList.length})),u+=1===e.updown?5:4,r.mergeCells("A".concat(u,":J").concat(u)),r.getRow(u).height=30,a.push({cell:"A".concat(u),bold:!0}),u+=1;var d=e.measureToolList||[];d.length&&(r.mergeCells("A".concat(u,":B").concat(u+d.length-1)),r.getCell("A".concat(u)).value="计量器具使用",a.push({cell:"A".concat(u)}),d.forEach((function(e,t,o){r.mergeCells("C".concat(u+t,":D").concat(u+t)),r.getCell("C".concat(u+t)).value=" \n名称："+(e.name||"")+"\n",a.push({cell:"C".concat(u+t),horizontal:"left"}),r.getCell("E".concat(u+t)).value=" \n规格型号："+(e.model||"")+"\n",a.push({cell:"E".concat(u+t),horizontal:"left"}),r.getCell("F".concat(u+t)).value=" \n出厂编号："+(e.serialNo||"")+"\n",a.push({cell:"F".concat(u+t),horizontal:"left"}),r.mergeCells("G".concat(u+t,":H").concat(u+t)),r.getCell("G".concat(u+t)).value=" \n上次检验时间："+(e.lastCheckTime||"")+"\n",a.push({cell:"G".concat(u+t),horizontal:"left"}),r.mergeCells("I".concat(u+t,":J").concat(u+t)),r.getCell("I".concat(u+t)).value=" \n下次检验时间："+(e.nextCheckTime||"")+"\n",a.push({cell:"I".concat(u+t),horizontal:"left"})})),u+=d.length,r.mergeCells("A".concat(u,":J").concat(u)),r.getRow(u).height=30,a.push({cell:"A".concat(u),bold:!0}),u+=1);var f=["控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。","“自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。","“作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。","“结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。","作业内容中有数据要求的一并填入“作业情况”栏。"];r.mergeCells("A".concat(u,":J").concat(u));var h="";f.forEach((function(e,t,r){h+="".concat(t+1,"、").concat(e).concat(t<r.length-1?"\n":"")})),h="说明：\n"+h+"\n",h="\n检查结果：".concat(0===e.checkResult?"未通过":"通过","                                        检查日期：").concat(e.checkDate||"            ","                                        质量负责人：").concat(e.checkUserName||"            ","\n\n")+h,r.getCell("A".concat(u)).value=h,a.push({cell:"A".concat(u),horizontal:"left",border:top});var m=12*(f.length+4)+18;r.getRow(u).height=m,a.forEach((function(e,t,a){var o=r.getCell(e.cell);o.alignment={vertical:"middle",horizontal:e.horizontal||"center",wrapText:!0},e.fill&&(o.fill={type:"pattern",pattern:"darkGray",fgColor:{argb:"FFe9e9e9"}}),o.font={name:"黑体",family:4,size:e.size||12,underline:!1,bold:e.bold||!1},o.padding={top:10,left:10,bottom:10,right:10},o.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})),t.xlsx.writeBuffer().then((function(t){var r=new Blob([t],{type:s});n["saveAs"](r,"".concat(e.title||e.workRecName,".xlsx"))}))}}},u=c,d=r("2877"),f=Object(d["a"])(u,a,o,!1,null,"dac1198a",null);t["default"]=f.exports},4677:function(e,t,r){"use strict";r("412f")},4681:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:"90%",visible:e.visible,confirmLoading:e.confirmLoading,centered:"",cancelText:"关闭",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[4===e.formObj.instType?t("div",{staticStyle:{height:"100%"},attrs:{"layout-flex":""}},[t("TaskCheckForm",{ref:"checkForm",attrs:{taskFormsList:e.taskFormItemList,modalType:1,"flex-full":""},on:{taskFormNoWork:e.onTaskFormNoWork}})],1):e._e(),3===e.formObj.instType?t("div",{staticStyle:{height:"100%"},attrs:{"layout-flex":""}},[t("div",{attrs:{"flex-full":""}},[t("vxe-table",{ref:"recordListTable",attrs:{stripe:!0,border:"","auto-resize":"","max-height":"100%","row-id":"id",align:"center",data:e.taskFormItemList,"show-overflow":"tooltip","span-method":e.mergeRowMethod,"checkbox-config":{trigger:"row",highlight:!0,range:!0}}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{type:"index",title:"序号",align:"center",width:"60"}}),t("vxe-table-column",{attrs:{field:"reguTitle",title:"作业项目",align:"left","header-align":"center",width:"240"}}),t("vxe-table-column",{attrs:{field:"workContent",title:"检修内容",align:"left"}})],1)],1)]):e._e(),t("check-modal",{ref:"checkModalForm",attrs:{title:e.checkModalTitle},on:{ok:e.onCheckRecord}}),t("BreakdownModal",{ref:"breakdownModal",attrs:{showWorkStation:!0}})],1)},o=[],i=r("8fad"),n=r("3fdc"),l=r("d0f9"),s=(r("b9c3"),r("b47d")),c=r("ab7d");function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,a,o,i){var s=a&&a.prototype instanceof l?a:l,c=Object.create(s.prototype);return f(c,"_invoke",function(r,a,o){var i,l,s,c=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,r){return i=t,l=0,s=e,f.n=r,n}};function h(r,a){for(l=r,s=a,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=f.p,m=i[2];r>3?(o=m===a)&&(s=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=r<2&&h<i[1])?(l=0,f.v=a,f.n=i[1]):h<m&&(o=r<3||i[0]>a||a>m)&&(i[4]=r,i[5]=a,f.n=m,l=0))}if(o||r>1)return n;throw d=!0,a}return function(o,u,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,m),l=u,s=m;(t=l<2?e:s)||!d;){i||(l?l<3?(l>1&&(f.n=-1),h(l,s)):f.n=s:f.v=s);try{if(c=2,i){if(l||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,l<2&&(l=0)}else 1===l&&(t=i.return)&&t.call(i),l<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),l=1);i=e}else if((t=(d=f.n<0)?s:r.call(a,f))!==n)break}catch(t){i=e,l=1,s=t}finally{c=1}}return{value:t,done:d}}}(r,o,i),!0),c}var n={};function l(){}function s(){}function c(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(f(t={},a,(function(){return this})),t),h=c.prototype=l.prototype=Object.create(u);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,f(e,o,"GeneratorFunction")),e.prototype=Object.create(h),e}return s.prototype=c,f(h,"constructor",c),f(c,"constructor",s),s.displayName="GeneratorFunction",f(c,o,"GeneratorFunction"),f(h),f(h,o,"Generator"),f(h,a,(function(){return this})),f(h,"toString",(function(){return"[object Generator]"})),(d=function(){return{w:i,m:m}})()}function f(e,t,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}f=function(e,t,r,a){function i(t,r){f(e,t,(function(e){return this._invoke(t,r,e)}))}t?o?o(e,t,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[t]=r:(i("next",0),i("throw",1),i("return",2))},f(e,t,r,a)}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return(t=g(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e){var t=b(e,"string");return"symbol"==u(t)?t:t+""}function b(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=u(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function y(e,t,r,a,o,i,n){try{var l=e[i](n),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(a,o)}function v(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var i=e.apply(t,r);function n(e){y(i,a,o,n,l,"next",e)}function l(e){y(i,a,o,n,l,"throw",e)}n(void 0)}))}}function k(e){return I(e)||C(e)||x(e)||w()}function w(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(e,t){if(e){if("string"==typeof e)return S(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}}function C(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function I(e){if(Array.isArray(e))return S(e)}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}var T={name:"TaskFormDetaileModal",components:{TaskCheckForm:n["default"],checkModal:l["default"],BreakdownModal:c["default"]},props:{taskForms:{type:Array,default:function(){return[]}},workOrderInfo:{type:Object,default:function(){return{}}}},data:function(){return{title:"填写明细",createFaultLoading:!1,switchCheck:!0,visible:!1,confirmLoading:!1,model:{},taskFormItemList:[],formObj:{},checkModalTitle:"自检"}},methods:{add:function(){this.edit({})},showModal:function(e){var t=this;this.formObj=e,this.taskFormItemList=[],this.visible=!0,this.$nextTick((function(){3===e.instType?t.loadRecordFormDetail():4===e.instType&&t.$refs.checkForm.findModelDetaile(e)}))},handleOk:function(){var e="";3===this.formObj.instType?e=this.$refs.recordListTable.getCheckboxRecords().map((function(e){return e.id})).toString():4===this.formObj.instType&&(e=this.$refs.checkForm.getIDRecords()),this.$emit("ok",e),this.close()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},onTaskFormNoWork:function(e){},loadRecordFormDetail:function(){var e=this;this.formObj.formInstId,this.formObj.id;Object(i["Ab"])({id:this.formObj.formObjId}).then((function(t){var r=[];t.result.categoryList.forEach((function(e){r=[].concat(k(r),k(e.detailList.map((function(t){return t.reguTitle=e.reguTitle,t.recIndex=e.recIndex,t.workRecId=e.workRecId,t}))))})),e.taskFormItemList=r,e.$nextTick((function(){if(e.formObj.recordIds&&e.formObj.recordIds.length){var t=e.formObj.recordIds.split(",");e.$refs.recordListTable.setCheckboxRow(e.taskFormItemList.filter((function(e){return t.find((function(t){return t===e.id}))})),!0)}}))}))},mergeRowMethod:function(e){var t=e.row,r=e._rowIndex,a=e.column,o=e.visibleData,i=["reguTitle"],n=t[a.property];if(n&&i.includes(a.property)){var l=o[r-1],s=o[r+1];if(l&&l[a.property]===n)return{rowspan:0,colspan:0};var c=1;while(s&&s[a.property]===n)s=o[++c+r];if(c>1)return{rowspan:c,colspan:1}}},handleCheck:function(e,t){var r=this.$refs.recordListTable.getCheckboxRecords();if(r.length>0){var a=r.map((function(e,t){return e.id})).join(",");this.checkModalTitle=t,this.$refs.checkModalForm.showModal(a,e)}else this.$message.error("请选择要检查的作业记录明细!")},onCheckRecord:function(e){e.saveSuccess&&this.loadRecordFormDetail()},handleMenuClick:function(e){var t=this,r=e.key,a=this.$refs.recordListTable.getCheckboxRecords();if(a.length>0){var o=a.map((function(e,t){return e.id})).join(",");Object(s["C"])("ids=".concat(o,"&checkType=").concat(r)).then((function(e){e.success?(t.$message.success("清除成功"),t.loadRecordFormDetail()):t.$message.warning(e.message)}))}else this.$message.error("请选择要检查的作业记录明细!")},createFault:function(){var e=this;v(d().m((function t(){var r;return d().w((function(t){while(1)switch(t.n){case 0:e.$refs.breakdownModal.setWorkStations(e.workOrderInfo.staffArranges),r={},e.workOrderInfo.planId&&(r={planName:e.workOrderInfo.planName,planId:e.workOrderInfo.planId,lineId:e.workOrderInfo.lineId,trainNo:e.workOrderInfo.trainNo}),e.$refs.breakdownModal.edit(m({workOrderId:e.workOrderInfo.orderId,formType:2,createType:2,happenTime:e.$moment().format("YYYY-MM-DD"),faultDesc:"",phase:1,status:1},r));case 1:return t.a(2)}}),t)})))()}}},O=T,_=(r("2d1c"),r("2877")),N=Object(_["a"])(O,a,o,!1,null,"adebf282",null);t["default"]=N.exports},"4a51":function(e,t,r){"use strict";r("612d")},"4b54":function(e,t,r){},"4e0a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:"车辆设备选择",centered:"",visible:e.visible,bodyStyle:{height:"80vh"},cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:8}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{attrs:{placeholder:"名称或编码","allow-clear":""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:9,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)])],1)],1)],1),t("div",{staticClass:"tableHeight",staticStyle:{height:"calc(80vh - 85px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 85px)"},attrs:{border:"","row-id":"id",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","max-height":"100%","radio-config":{trigger:e.multiple?"default":"row",highlight:!0,checkMethod:e.checkRadioMethod},"checkbox-config":{trigger:e.multiple?"row":"default",highlight:!0,checkStrictly:!0,checkMethod:e.checkRadioMethod},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"name",title:"名称","tree-node":"",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"code",title:"编码",width:"150"}}),t("vxe-table-column",{attrs:{field:"structType_dictText",title:"类型",width:"120"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"100"}}),t("vxe-table-column",{attrs:{field:"placeId",title:"位置编码",width:"150"}}),t("vxe-table-column",{attrs:{field:"placeDesc",title:"位置描述",width:"200",align:"left","header-align":"center"}})],1)],1)])},o=[],i=r("8fad"),n={name:"TrainStructureList",props:{multiple:{type:Boolean,default:!1},canSelectType:{type:Array,default:function(){return[1,2,3,4]}},lineId:{type:String,default:""}},data:function(){return{visible:!1,queryParam:{id:"",searchText:"",status:null,trainStructId:""},selectParent:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}},allAlign:"center",tableData:[],trainStructId:""}},methods:{showModal:function(e){this.queryParam.trainStructId=e,this.queryParam.lineId=this.lineId,this.trainStructId=e,this.visible=!0,this.findList()},findList:function(){var e=this;Object(i["ec"])(this.queryParam).then((function(t){t.success&&(e.tableData=t.result)}))},loadChildrenMethod:function(e){var t=this,r=e.row,a={trainStructId:this.trainStructId,id:r.id};return new Promise((function(e){Object(i["ec"])(a).then((function(r){r.success?e(r.result):t.$message.error("".concat(r.msg))}))}))},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.close()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},checkRadioMethod:function(e){var t=e.row;return this.canSelectType.indexOf(t.structType)>-1}}},l=n,s=r("2877"),c=Object(s["a"])(l,a,o,!1,null,"5f613a8e",null);t["default"]=c.exports},5126:function(e,t,r){},"51cf":function(e,t,r){},"52d1":function(e,t,r){},5315:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("j-modal",{attrs:{title:e.title,centered:"",width:1100,visible:e.visible,confirmLoading:e.confirmLoading,fullscreen:"",cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("div",{staticStyle:{width:"100%",overflow:"hidden"}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:23,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol1,wrapperCol:e.wrapperCol1,label:"任务名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["title",e.validatorRules.title],expression:"['title', validatorRules.title]",modifiers:{trim:!0}}],attrs:{allowClear:"",placeholder:"请输入"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"编码"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["rectifyNo",e.validatorRules.rectifyNo],expression:"['rectifyNo', validatorRules.rectifyNo]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入",disabled:""}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"整改类型"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["rectifyType",e.validatorRules.rectifyType],expression:"['rectifyType', validatorRules.rectifyType]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,dictCode:"bu_work_rectify_type"}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"下发日期",width:"40"}},[t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["sendDate",e.validatorRules.sendDate],expression:"['sendDate', validatorRules.sendDate]",modifiers:{trim:!0}}],staticStyle:{width:"100%"}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"责任班组"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["groupId",e.validatorRules.groupId],expression:"['groupId', validatorRules.groupId]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,dictCode:e.dictGroupStr},on:{change:e.changeGroup}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"整改状态"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["status",e.validatorRules.status],expression:"['status', validatorRules.status]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,dictCode:"bu_work_rectify_status"}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"车辆段"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["depotId",e.validatorRules.depotId],expression:"['depotId', validatorRules.depotId]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,dictCode:"bu_mtr_depot,name,id"}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"线路"}},[t("line-select-list",{directives:[{name:"decorator",rawName:"v-decorator",value:["lineId",e.validatorRules.lineId],expression:"['lineId', validatorRules.lineId]"}],on:{change:e.lineIdChange}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属车辆"}},[t("j-dict-select-seach-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["trainNo",e.validatorRules.trainNo],expression:"['trainNo', validatorRules.trainNo]"}],attrs:{triggerChange:"",dictCode:e.dictTrainStr}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"关联工单"}},[t("span",{on:{click:e.openOrderModel}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["orderName",e.validatorRules.orderName],expression:"['orderName', validatorRules.orderName]",modifiers:{trim:!0}}],ref:"myOrderSelect",attrs:{"allow-clear":"",placeholder:"请选择工单",open:!1,showArrow:!0},on:{change:e.orderNameChange}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)])],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"整改工位"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["workstationId",e.validatorRules.workstationId],expression:"['workstationId', validatorRules.workstationId]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,dictCode:e.dictCodeStr}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"整改工序"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["orderTaskId",e.validatorRules.orderTaskId],expression:"['orderTaskId', validatorRules.orderTaskId]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,dictCode:e.dictCodeStrOrder}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:23,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol1,wrapperCol:e.wrapperCol1,label:"备注说明"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["remark",e.validatorRules.remark],expression:"['remark', validatorRules.remark]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:23,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol1,wrapperCol:e.wrapperCol1,label:"附件"}},[t("DocUpload",{ref:"upload",attrs:{"default-file-list":e.defaultFileList,"show-upload":!1,isFileEmpty:!0},on:{setBforeUploadStatus:e.setBforeUploadStatus,uploaded:e.successUploadFile,removed:e.onRemoveFile,uploadFail:e.uploadFail,setUpLoadingEndStatus:e.setUpLoadingEndStatus}})],1)],1)],1),t("a-divider",{staticStyle:{"font-size":"14px"},attrs:{orientation:"left"}},[e._v("已上传列表")]),t("vxe-table",{staticStyle:{"margin-top":"12px"},attrs:{border:"",data:e.annexList,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"}}},[t("div",{}),t("vxe-table-column",{attrs:{type:"seq",title:"序号",width:"50px","header-align":"center",align:"center"}}),t("vxe-table-column",{attrs:{field:"title",title:"文件名","header-align":"left",align:"left"}}),t("vxe-table-column",{attrs:{title:"操作",width:"160px","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row,o=r.rowIndex;return[t("a",{staticStyle:{"margin-right":"12px"},on:{click:function(t){return t.stopPropagation(),e.handleSeeing(a)}}},[e._v("查看")]),t("a",{on:{click:function(t){return t.stopPropagation(),e.handleDelete(a,o)}}},[e._v("删除")])]}}])})],1),t("doc-preview-modal",{ref:"docPreview",attrs:{title:e.fileName}})],1)],1)]),t("user-list",{ref:"UserModalForm",attrs:{multiple:!0},on:{ok:e.addTarget}}),t("work-order-select",{ref:"orderSelect",attrs:{"order-status":[2]},on:{ok:e.onSelectOrder}})],1)},o=[],i=r("b245"),n=r("c1df"),l=r.n(n),s=r("b7b4"),c=r("8fad"),u=r("ca00"),d=r("5371"),f=r("353a"),h=r("5633"),m=r("673e");function p(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,a,o,i){var s=a&&a.prototype instanceof l?a:l,c=Object.create(s.prototype);return g(c,"_invoke",function(r,a,o){var i,l,s,c=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,r){return i=t,l=0,s=e,f.n=r,n}};function h(r,a){for(l=r,s=a,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=f.p,m=i[2];r>3?(o=m===a)&&(s=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=r<2&&h<i[1])?(l=0,f.v=a,f.n=i[1]):h<m&&(o=r<3||i[0]>a||a>m)&&(i[4]=r,i[5]=a,f.n=m,l=0))}if(o||r>1)return n;throw d=!0,a}return function(o,u,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,m),l=u,s=m;(t=l<2?e:s)||!d;){i||(l?l<3?(l>1&&(f.n=-1),h(l,s)):f.n=s:f.v=s);try{if(c=2,i){if(l||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,l<2&&(l=0)}else 1===l&&(t=i.return)&&t.call(i),l<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),l=1);i=e}else if((t=(d=f.n<0)?s:r.call(a,f))!==n)break}catch(t){i=e,l=1,s=t}finally{c=1}}return{value:t,done:d}}}(r,o,i),!0),c}var n={};function l(){}function s(){}function c(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(g(t={},a,(function(){return this})),t),d=c.prototype=l.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,g(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=c,g(d,"constructor",c),g(c,"constructor",s),s.displayName="GeneratorFunction",g(c,o,"GeneratorFunction"),g(d),g(d,o,"Generator"),g(d,a,(function(){return this})),g(d,"toString",(function(){return"[object Generator]"})),(p=function(){return{w:i,m:f}})()}function g(e,t,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}g=function(e,t,r,a){function i(t,r){g(e,t,(function(e){return this._invoke(t,r,e)}))}t?o?o(e,t,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[t]=r:(i("next",0),i("throw",1),i("return",2))},g(e,t,r,a)}function b(e,t,r,a,o,i,n){try{var l=e[i](n),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(a,o)}function y(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var i=e.apply(t,r);function n(e){b(i,a,o,n,l,"next",e)}function l(e){b(i,a,o,n,l,"throw",e)}n(void 0)}))}}var v={name:"RectifyModal",props:{defaultFileList:{type:Array,default:function(){return[]}}},components:{UserList:i["default"],DocUpload:d["default"],DocPreviewModal:f["default"],LineSelectList:h["default"],WorkOrderSelect:m["default"]},data:function(){return{dictTrainStr:"",dictGroupStr:"bu_mtr_workshop_group,group_name,id,workshop_id='"+this.$store.getters.userInfo.workshopId+"'|workshop_id",fileList:[],annexList:[],rectifyId:"",filePath:"",fileName:"",status:!1,uploading:!1,dictCodeStr:"bu_mtr_workstation,name,id",dictCodeStrOrder:"",title:"整改项信息",visible:!1,model:{},saveFlag:!0,labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:13}},labelCol1:{xs:{span:24},sm:{span:2}},wrapperCol1:{xs:{span:24},sm:{span:22}},labelCol2:{xs:{span:24},sm:{span:2}},wrapperCol2:{xs:{span:24},sm:{span:19}},dutyUsername:"",dutyUserId:"",isClose:!1,confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{rectifyNo:{rules:[{required:!0,message:"请输入编号!"},{max:32,message:"输入长度不能超过32字符!"}]},rectifyType:{rules:[{required:!0,message:"请选择整改类型!"}]},orderName:{rules:[]},groupId:{rules:[{required:!0,message:"请选择责任班组!"}]},workstationId:{rules:[]},sendDate:{rules:[{required:!0,message:"请选择下发日期!"}]},status:{rules:[{required:!0,message:"请选择整改状态!"}]},lineId:{rules:[{required:!0,message:"请选择线路!"}]},trainNo:{rules:[{required:!0,message:"请选择车辆!"}]},depotId:{rules:[]},title:{rules:[{required:!0,message:"请输入整改标题!"},{max:32,message:"输入长度不能超过32字符!"}]},remark:{rules:[{max:255,message:"输入长度不能超过255字符!"}]},orderTaskId:{rules:[]}},workOrderId:"",rectifyNo:""}},created:function(){},methods:{orderNameChange:function(e){e||(this.workOrderId="",this.form.setFieldsValue({orderTaskId:""}),this.changeOrder())},lineIdChange:function(e){this.form.setFieldsValue({trainNo:""}),this.dictTrainStr=e?"bu_train_info,train_no,train_no,line_id="+e:""},openOrderModel:function(){this.$refs.orderSelect.showModal()},onSelectOrder:function(e){Object(u["e"])(e)||(this.form.setFieldsValue({orderName:e[0].orderName}),this.workOrderId=e[0].id,this.changeOrder(e[0].id))},changeGroup:function(e){this.dictCodeStr=e?"bu_mtr_workstation,name,id,id in (select workstation_id from bu_group_workstation where group_id = '"+e+"')":"bu_mtr_workstation,name,id"},changeOrder:function(e){this.dictCodeStrOrder=e?"bu_work_order_task,task_name,id,order_id='"+e+"'":""},changeClose:function(e){this.isClose=e},add:function(){var e=y(p().m((function e(t,r,a,o){return p().w((function(e){while(1)switch(e.n){case 0:return e.n=1,this.getRectifyNo();case 1:t&&this.changeOrder(t),this.lineIdChange(),this.edit({orderId:t,orderTaskId:r,remark:a,rectifyNo:this.rectifyNo});case 2:return e.a(2)}}),e,this)})));function t(t,r,a,o){return e.apply(this,arguments)}return t}(),getRectifyNo:function(){var e=y(p().m((function e(){var t=this;return p().w((function(e){while(1)switch(e.n){case 0:return e.n=1,Object(s["u"])().then((function(e){t.rectifyNo=e.result}));case 1:return e.a(2)}}),e)})));function t(){return e.apply(this,arguments)}return t}(),addByRow:function(e){e.orderId&&(this.workOrderId=e.orderId,this.changeOrder(e.orderId)),this.edit(e)},edit:function(e){var t=this;this.confirmLoading=!1,e.id?(this.isClose=!(!e["close"]||1!=e["close"]),this.workOrderId=e.orderId,this.changeOrder(this.workOrderId),null!=e.annexList&&e.annexList.length>0&&(this.annexList=e.annexList)):this.isClose=!1,this.dutyUserId=e.dutyUserId||"",this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue({rectifyNo:t.model.rectifyNo,rectifyType:t.model.rectifyType,groupId:t.model.groupId,workstationId:t.model.workstationId,lineId:t.model.lineId,status:t.model.status,sendDate:l()(t.model.sendDate||new Date,"YYYY-MM-DD"),depotId:t.model.depotId,title:t.model.title,remark:t.model.remark,orderTaskId:t.model.orderTaskId,orderName:t.model.orderName}),t.lineIdChange(t.model.lineId),t.form.setFieldsValue({trainNo:t.model.trainNo})}))},openuserModal:function(){this.$refs.UserModalForm.showModal(),this.$refs.myuserSelect.blur()},addTarget:function(e){e.length&&(this.dutyUsername=e[0].realname,this.dutyUserId=e[0].id),this.form.setFieldsValue({dutyUserName:this.dutyUsername})},successUploadFile:function(e){var t=this;!e||e.length<1||(e.map((function(e){Object.assign(e,{id:Object(u["p"])()})})),Object(c["d"])(e).then((function(r){r.success&&e.map((function(e){t.annexList.push({address:e.savepath,id:e.id,title:e.name,rectifyId:t.rectifyId})}))})))},uploadFail:function(e){this.confirmLoading=!1},onRemoveFile:function(e){},beginUpload:function(){this.confirmLoading=!0,this.$refs.upload.beginUpload()},setBforeUploadStatus:function(e){this.saveFlag=e},setUpLoadingEndStatus:function(e){this.saveFlag=e},handlePrivilege:function(){var e=y(p().m((function e(t,r){var a,o=this;return p().w((function(e){while(1)switch(e.n){case 0:return a={id:t,operation:r},e.n=1,Object(c["xc"])(a).then((function(e){o.status=e.result}));case 1:return e.a(2)}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}(),handleSeeing:function(){var e=y(p().m((function e(t){return p().w((function(e){while(1)switch(e.n){case 0:return e.n=1,this.handlePrivilege(t.id,2);case 1:this.status?(this.fileName=t.title,this.$refs.docPreview.handleFilePath(t.address)):this.$message.error("您没有权限!");case 2:return e.a(2)}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleDelete:function(){var e=y(p().m((function e(t,r){var a;return p().w((function(e){while(1)switch(e.n){case 0:a=this,a.$confirm({title:"提示",content:"确定删除该条附件吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){a.annexList.splice(r,1)},onCancel:function(){}});case 1:return e.a(2)}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}(),handleOk:function(){var e=this,t=this;t.form.validateFields((function(r,a){if(!r){t.confirmLoading=!0;var o=Object.assign(t.model,a,{sendDate:l()(a.sendDate).format("YYYY-MM-DD HH:mm:ss"),orderId:e.workOrderId});t.model.id?t.rectifyId=t.model.id:t.rectifyId=null,e.beginUpload();var i=null;clearInterval(i),i=setInterval((function(){var e;t.saveFlag&&(o["annexList"]=t.annexList,o["id"]=t.rectifyId,o["dutyUserId"]=t.dutyUserId,e=t.model.id?Object(s["l"])(o):Object(s["b"])(o),e.then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok")):t.$message.warning(e.message)})).finally((function(){clearInterval(i),t.confirmLoading=!1,t.close()})))}),1e3)}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.fileList=[],this.annexList=[],this.visible=!1}}},k=v,w=r("2877"),x=Object(w["a"])(k,a,o,!1,null,"2bfc6fa6",null);t["default"]=x.exports},5371:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("a-row",{staticStyle:{"padding-bottom":"10px"},attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-upload",{attrs:{multiple:!0,"file-list":e.fileList,remove:e.handleRemove,"before-upload":e.beforeUpload,"default-file-list":e.defaultFileList}},[t("a-button",{staticClass:"border-primary-4"},[e._v("添加文件")])],1)],1)],1),t("a-row",[e.showUpload?t("a-col",{attrs:{span:5}},[t("a-button",{attrs:{type:"primary",loading:e.isLoading},on:{click:e.beginUpload}},[e._v("上传至服务器")])],1):e._e(),t("a-col",{staticStyle:{color:"#cccccc"},attrs:{span:19}},[e._v("一次最多上传"+e._s(e.fileSize)+"个文件，且单个文件不能超过10MB")])],1)],1)},o=[],i=r("e2aa");function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,a,o,i){var n=a&&a.prototype instanceof c?a:c,u=Object.create(n.prototype);return l(u,"_invoke",function(r,a,o){var i,n,l,c=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,r){return i=t,n=0,l=e,f.n=r,s}};function h(r,a){for(n=r,l=a,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=f.p,m=i[2];r>3?(o=m===a)&&(l=i[(n=i[4])?5:(n=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=r<2&&h<i[1])?(n=0,f.v=a,f.n=i[1]):h<m&&(o=r<3||i[0]>a||a>m)&&(i[4]=r,i[5]=a,f.n=m,n=0))}if(o||r>1)return s;throw d=!0,a}return function(o,u,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,m),n=u,l=m;(t=n<2?e:l)||!d;){i||(n?n<3?(n>1&&(f.n=-1),h(n,l)):f.n=l:f.v=l);try{if(c=2,i){if(n||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,n<2&&(n=0)}else 1===n&&(t=i.return)&&t.call(i),n<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),n=1);i=e}else if((t=(d=f.n<0)?l:r.call(a,f))!==s)break}catch(t){i=e,n=1,l=t}finally{c=1}}return{value:t,done:d}}}(r,o,i),!0),u}var s={};function c(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][a]?t(t([][a]())):(l(t={},a,(function(){return this})),t),h=d.prototype=c.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,o,"GeneratorFunction")),e.prototype=Object.create(h),e}return u.prototype=d,l(h,"constructor",d),l(d,"constructor",u),u.displayName="GeneratorFunction",l(d,o,"GeneratorFunction"),l(h),l(h,o,"Generator"),l(h,a,(function(){return this})),l(h,"toString",(function(){return"[object Generator]"})),(n=function(){return{w:i,m:m}})()}function l(e,t,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}l=function(e,t,r,a){function i(t,r){l(e,t,(function(e){return this._invoke(t,r,e)}))}t?o?o(e,t,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[t]=r:(i("next",0),i("throw",1),i("return",2))},l(e,t,r,a)}function s(e,t,r,a,o,i,n){try{var l=e[i](n),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(a,o)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var i=e.apply(t,r);function n(e){s(i,a,o,n,l,"next",e)}function l(e){s(i,a,o,n,l,"throw",e)}n(void 0)}))}}var u={name:"DocUpload",props:{path:{type:String,default:""},fileSize:{type:Number,default:5},defaultFileList:{type:Array,default:[]},showUpload:{type:Boolean,default:!0},isFileEmpty:{type:Boolean,default:!1}},watch:{uploadFiles:{immediate:!1,handler:function(){var e=c(n().m((function e(t){return n().w((function(e){while(1)switch(e.n){case 0:if(t.length!==this.fileList.length){e.n=1;break}return e.n=1,this.$emit("uploaded",this.uploadFiles);case 1:return e.a(2)}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},data:function(){return{fileList:[],uploadFiles:[],isLoading:!1}},methods:{beforeUpload:function(e){var t=e.size/1024/1024<10;return t?(this.fileList.push(e),this.$emit("fileNum",this.fileList.length),this.$emit("setBforeUploadStatus",!1),!1):(this.$message.error("文件不得大于10MB!"),!1)},handleRemove:function(e){var t=this.fileList.indexOf(e),r=this.fileList.slice();r.splice(t,1),this.fileList=r,this.$emit("fileNum",this.fileList.length),this.$emit("removed",e)},beginUpload:function(){var e=this;return new Promise((function(t,r){var a=e.fileList,o=e.fileSize;if(!e.isFileEmpty&&0===a.length)return e.$emit("upLoadingEnd"),e.$message.warning("请选择要上传的文件"),void r();a.length>o?(e.$message.error("一次最多上传"+o+"个文件!"),r()):e.customRequest().then((function(){t()})).catch((function(e){r()}))}))},customRequest:function(){var e=this,t=this.fileList;if(t.length<1)return this.$emit("uploaded",[]),this.$emit("upLoadingEnd"),Promise.resolve();this.isLoading=!0;var r=[];return t.forEach((function(t){var a=new FormData;a.append("file",t),r.push(e.saveFile(a,t))})),Promise.all(r).finally((function(){e.isLoading=!1,e.$emit("upLoadingEnd")}))},saveFile:function(){var e=c(n().m((function e(t,r){var a=this;return n().w((function(e){while(1)switch(e.n){case 0:return e.a(2,Object(i["d"])(t,this.path).then((function(e){e.success?(a.getUploadData(r,e),a.$emit("setUpLoadingEndStatus",!0)):(a.$message.error(e.message),a.$emit("uploadFail",r))})))}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}(),getUploadData:function(e,t){var r=this.uploadFiles,a={name:e.name,type:this.handleFileName(e),fileSize:Math.round(e.size/1024),savepath:t.result};r.push(a)},handleFileName:function(e){var t=e.name.lastIndexOf("."),r=e.name.length,a=e.name.substring(t+1,r);return a}}},d=u,f=(r("9615"),r("2877")),h=Object(f["a"])(d,a,o,!1,null,"69990be1",null);t["default"]=h.exports},"54f6":function(e,t,r){"use strict";function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,l(a.key),a)}}function n(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e){var t=s(e,"string");return"symbol"==a(t)?t:t+""}function s(e,t){if("object"!=a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=a(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}r.d(t,"a",(function(){return c}));var c=function(){function e(t,r){var a=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o(this,e),this.options={attrs:[]},Object.assign(this.options,i),this.options.attrs.find((function(e){return"edit"===e.key}))||this.options.attrs.push({key:"edit"}),this.options.attrs.forEach((function(e){Object.hasOwnProperty.call(e,"key")&&(a[e.key]=!1),Object.hasOwnProperty.call(e,"judge")||(e["judge"]=function(e){return!0})})),this.del=!1,this.nextTick=t.$nextTick,this.refs=t.$refs,this.refName=r,t.$nextTick((function(){a.vxeTable=t.$refs[r]}))}return n(e,[{key:"editRow",get:function(){if(this.edit){var e=this.vxeTable.getCheckboxRecords();return e.length?e[0]:{}}return{}}},{key:"update",value:function(){var e=this;this.nextTick((function(){e.vxeTable||(e.vxeTable=e.refs[e.refName]);var t=e.vxeTable.getCheckboxRecords();e.del=t.length>0,e.options.attrs.forEach((function(r){for(var a in r)Object.hasOwnProperty.call(r,a)&&(r["isDel"]?t.length?e[r.key]=t.length>0&&r.judge(t[0]):e[r.key]=!1:t.length?e[r.key]=1===t.length&&r.judge(t[0]):e[r.key]=!1)}))}))}}])}()},5577:function(e,t,r){"use strict";r("52d1")},6034:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"70%",title:"故障原因选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",centered:"",bodyStyle:{height:"80vh"},destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:""}},[t("a-input",{attrs:{placeholder:"请输入故障原因编码或者描述"},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"所属分类"}},[t("a-input",{ref:"categoryIdSelect",attrs:{readonly:"",allowClear:"",placeholder:"请选择所属分类"},on:{click:function(t){return e.openSelectTypeModal(1)}},model:{value:e.categoryCode,callback:function(t){e.categoryCode=t},expression:"categoryCode"}},[t("a-icon",{attrs:{slot:"suffix",type:"ellipsis"},slot:"suffix"})],1)],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"所属故障代码"}},[t("a-input",{ref:"faultCodeIdSelect",attrs:{readonly:"",allowClear:"",placeholder:"请选择所属故障代码"},on:{focus:function(t){return e.openSelectTypeModal(2)}},model:{value:e.faultCode,callback:function(t){e.faultCode=t},expression:"faultCode"}},[t("a-icon",{attrs:{slot:"suffix",type:"ellipsis"},slot:"suffix"})],1)],1)],1),t("a-col",{attrs:{md:3,sm:8}},[t("a-form-item",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 130px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 130px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"highlight-current-row":"","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"click",mode:"cell",showIcon:"true"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{type:"seq",width:"60",title:"序号"}}),t("vxe-table-column",{attrs:{field:"reasonCode",title:"故障原因代码",width:"150"}}),t("vxe-table-column",{attrs:{field:"reasonDesc",title:"故障原因描述",align:"left","header-align":"center"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1),t("fault-category-list",{ref:"categorySelect",attrs:{multiple:!1},on:{ok:e.addCategoryTarget}}),t("fault-code-list",{ref:"codeSelect",attrs:{multiple:!1},on:{ok:e.addCodeTarget}})],1)},o=[],i=r("b47d"),n=r("a396"),l=r("0e7b"),s=r("ca00"),c={name:"FaultReasonList",components:{FaultCategoryList:n["default"],FaultCodeList:l["default"]},props:{multiple:{type:Boolean,default:!0}},data:function(){return{categoryCode:"",faultCode:"",queryParam:{searchText:"",categoryId:"",faultCodeId:"",pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,formItemLayout:{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}}}},watch:{categoryCode:function(e,t){e||(this.queryParam.categoryId=null)},faultCode:function(e,t){e||(this.queryParam.faultCodeId=null)}},methods:{showModal:function(e){this.visible=!0,this.queryParam.faultCodeId=e,this.findList()},findList:function(){var e=this;this.loading=!0,Object(i["R"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.close()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,this.categoryCode="",this.faultCode="",this.queryParam.searchText="",this.queryParam.categoryId="",this.queryParam.faultCodeId=""},openSelectTypeModal:function(e){switch(e){case 1:this.$refs.categorySelect.showModal(),this.$refs.categoryIdSelect.blur();break;case 2:this.$refs.codeSelect.showModal(),this.$refs.faultCodeIdSelect.blur();break;default:break}},addCategoryTarget:function(e){Object(s["e"])(e)?this.queryParam.categoryId="":(this.queryParam.categoryId=e[0].id,this.categoryCode=e[0].categoryCode)},addCodeTarget:function(e){Object(s["e"])(e)?this.queryParam.faultCodeId="":(this.queryParam.faultCodeId=e[0].id,this.faultCode=e[0].fltCode)}}},u=c,d=(r("ef2b0"),r("2877")),f=Object(d["a"])(u,a,o,!1,null,"ba47c754",null);t["default"]=f.exports},"607e":function(e,t,r){"use strict";r("c95b")},"60c8":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:800,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-form",{ref:"flex",staticStyle:{padding:"15px 24px"},attrs:{form:e.form,labelAlign:"left"}},[t("a-form-item",{attrs:{labelCol:{span:3},wrapperCol:{span:21},label:"模板选择",required:!0}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择表单",maxTagTextLength:10,open:!1,optionFilterProp:"formName"},on:{change:e.onFormSelectChange,dropdownVisibleChange:function(t){return e.openFormSelect()}},model:{value:e.queryParam.formName,callback:function(t){e.$set(e.queryParam,"formName",t)},expression:"queryParam.formName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},on:{click:function(t){return e.openFormSelect()}},slot:"suffixIcon"})],1)],1),t("a-form-item",{attrs:{label:"设备选择",labelCol:{span:3},wrapperCol:{span:21},required:!0}},[t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择设备",open:!1,allowClear:""},on:{dropdownVisibleChange:function(t){return e.openAssetSelectModal()},change:e.onDeviceSelect},model:{value:e.queryParam.assetTypeName,callback:function(t){e.$set(e.queryParam,"assetTypeName",t)},expression:"queryParam.assetTypeName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1),t("a-form-item",{attrs:{label:"表单名称",labelCol:{span:3},wrapperCol:{span:21}}},[t("a-input",{attrs:{placeholder:"请输入表单名称",allowClear:""},model:{value:e.queryParam.title,callback:function(t){e.$set(e.queryParam,"title",t)},expression:"queryParam.title"}})],1)],1),t("FormsList",{ref:"multipleSelect",attrs:{multiple:!1},on:{ok:e.onFormSelect}}),t("CarDeviceSelectNew",{ref:"trainAssetSelectModal",attrs:{trainNo:e.trainNo,lineId:e.lineId,multiple:!1,canSelectType:[2,3,4]},on:{ok:e.onTrainAssetSelect,cancel:e.onCancelTrainAssetSelect}})],1)},o=[],i=r("37582"),n=r("e42a"),l=r("8fad"),s=r("310d"),c={props:{trainNo:{type:String,default:""},lineId:{type:String,default:""},repairId:{type:[Number,String],default:null},checkList:{type:Array,default:function(){return[]}},operator:{type:[String,Number],default:""}},name:"TaskFormModel",components:{FormsList:i["default"],CarDeviceSelect:n["default"],CarDeviceSelectNew:s["default"]},data:function(){return{title:"添加",detailIds:"",checkType:-1,value:1,status:1,confirmLoading:!1,switchCheck:!0,visible:!1,model:{},form:this.$form.createForm(this),queryParam:{assetTypeId:"",assetTypeName:"",code:"",copies:"",formName:"",title:"",formType:"",fromBy:"",id:"",objId:"",planId:"",remark:"",type:"",workRecordType:null}}},methods:{showModal:function(e){this.queryParam.planId=e,this.queryParam.assetTypeId="",this.queryParam.assetTypeName="",this.queryParam.code="",this.queryParam.copies="",this.queryParam.formName="",this.queryParam.title="",this.queryParam.formType="",this.queryParam.fromBy="",this.queryParam.id="",this.queryParam.objId="",this.queryParam.remark="",this.queryParam.type="",this.visible=!0},handleOk:function(){var e=this;this.queryParam.formName?this.queryParam.assetTypeId?this.checkList.find((function(t){return t.objId===e.queryParam.objId}))?this.$message.warn("".concat(this.checkList.find((function(t){return t.objId===e.queryParam.objId})).formName,"已经添加了")):Object(l["e"])(this.queryParam).then((function(t){t.success?(e.$message.success("执行成功"),e.$emit("ok"),e.visible=!1):e.$message.error(t.message)})):this.$message.warn("请选择设备"):this.$message.warn("请选择表单")},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},openFormSelect:function(){this.$refs.multipleSelect.showModal(1===this.operator&&{lineId:this.lineId,repairProgramId:this.repairId})},onFormSelect:function(e){if(e.forms.length){var t=e.forms[0];this.queryParam.code=t.code,this.queryParam.formName=t.title,this.queryParam.title=t.title,this.queryParam.formType=t.formType,this.queryParam.workRecordType=t.workRecordType,this.queryParam.objId=t.id,this.queryParam.fromBy=2}},onFormSelectChange:function(){this.queryParam.code="",this.queryParam.formName="",this.queryParam.formType="",this.queryParam.workRecordType=null,this.queryParam.type="",this.queryParam.objId=""},onDeviceSelect:function(e){e||(this.queryParam.assetTypeId="",this.queryParam.assetTypeName="",this.queryParam.trainStructId="",this.queryParam.trainStructName="",this.queryParam.assetId="",this.queryParam.assetName="")},openAssetSelectModal:function(){this.$refs.trainAssetSelectModal.showModal()},onTrainAssetSelect:function(e){if(e.length){var t=e[0];this.queryParam.assetTypeId=t.id,this.queryParam.assetTypeName=t.assetName,this.queryParam.trainStructId=t.id,this.queryParam.trainStructName=t.assetName,this.queryParam.assetId=t.id,this.queryParam.assetName=t.assetName}},onCancelTrainAssetSelect:function(){}}},u=c,d=(r("4a51"),r("2877")),f=Object(d["a"])(u,a,o,!1,null,"6a9b84db",null);t["default"]=f.exports},"60e2":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"80%",title:"列计划选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",centered:"",destroyOnClose:!0,bodyStyle:{height:"70vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"计划名称"}},[t("a-input",{attrs:{placeholder:"请输入计划名称或列车序号"},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{label:"线路"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["lineId"],expression:"['lineId']"}],staticStyle:{width:"100%"},attrs:{triggerChange:!0,dictCode:"bu_mtr_line,line_name,line_id"},model:{value:e.queryParam.lineId,callback:function(t){e.$set(e.queryParam,"lineId",t)},expression:"queryParam.lineId"}})],1)],1),t("a-col",{attrs:{md:4}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(100% - 55px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(100% - 55px)"},attrs:{border:"",align:e.allAlign,data:e.tableData,"max-height":"100%","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"manual",mode:"row"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"planName",title:"计划名称",align:"left"}}),t("vxe-table-column",{attrs:{field:"lineName",title:"所属线路",align:"left"}}),t("vxe-table-column",{attrs:{field:"trainNo",title:"车号",align:"left"}}),t("vxe-table-column",{attrs:{field:"startDate",title:"开始日期",align:"left"}}),t("vxe-table-column",{attrs:{field:"finishDate",title:"完成日期",align:"left"}}),t("vxe-table-column",{attrs:{field:"progressStatus_dictText",title:"进度状态",align:"left"}}),t("vxe-table-column",{attrs:{field:"wfStatus",title:"审批状态",align:"left"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)])},o=[],i=r("b9c3"),n={name:"TrainPlanList",props:{multiple:{type:Boolean,default:!1},trainNo:{type:String,default:""},progressStatusList:{type:Array,default:function(){return[]}}},data:function(){return{queryParam:{searchText:"",lineId:"",trainNo:"",status:"2",pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,stationData:[]}},methods:{showModal:function(){this.visible=!0,this.findList()},findList:function(){var e=this;this.loading=!0,this.progressStatusList.length&&(this.queryParam.progressStatusList=this.progressStatusList),this.trainNo&&(this.queryParam.trainNo=this.trainNo),Object(i["H"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},l=n,s=r("2877"),c=Object(s["a"])(l,a,o,!1,null,null,null);t["default"]=c.exports},"612d":function(e,t,r){},"673e":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"80%",title:"工单选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",centered:"",bodyStyle:{height:"70vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"工单搜索"}},[t("a-input",{attrs:{placeholder:"请输入工单名称或编码"},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"工单类型"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择工单类型",dictCode:"bu_order_type"},model:{value:e.queryParam.orderType,callback:function(t){e.$set(e.queryParam,"orderType",t)},expression:"queryParam.orderType"}})],1)],1),t("a-col",{attrs:{md:9,sm:24}},[t("a-form-item",{attrs:{label:"工单状态"}},[t("div",{staticClass:"autoWidth"},[t("j-multi-select-tag",{attrs:{placeholder:"请选择工单状态",dictCode:"bu_order_status"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)])],1),t("a-col",{attrs:{md:3,sm:24}},[t("a-form-item",[t("a-button",{attrs:{type:"primary"},on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(70vh - 172px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(70vh - 172px)"},attrs:{border:"",align:e.allAlign,data:e.tableData,"max-height":"100%","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row",checkMethod:e.checkRadioMethod},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0,checkMethod:e.checkRadioMethod}:{},"edit-config":{trigger:"manual",mode:"row"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"trainNo",title:"作业车号",width:"100"}}),t("vxe-table-column",{attrs:{field:"groupName",title:"所属班组",width:"100"}}),t("vxe-table-column",{attrs:{field:"orderCode",title:"工单编号",width:"150"}}),t("vxe-table-column",{attrs:{field:"orderName",title:"工单名称",align:"left","min-width":"150"}}),t("vxe-table-column",{attrs:{field:"startTime",title:"计划开始",width:"150"}}),t("vxe-table-column",{attrs:{field:"finishTime",title:"计划结束",width:"150"}}),t("vxe-table-column",{attrs:{field:"orderStatus_dictText",title:"工单状态",width:"150"}}),t("vxe-table-column",{attrs:{field:"orderType_dictText",title:"工单类型",width:"150"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)])},o=[],i=r("f680"),n=r("b9c3"),l=r("c1df"),s=r.n(l),c={name:"WorkOrderSelect",components:{JMultiSelectTag:i["default"]},props:{multiple:{type:Boolean,default:!1},workGroupId:{type:String,default:""},planId:{type:String,default:""},orderType:{type:Number,default:null},orderStatus:{type:Array,default:function(){return[3,4,8]}},selectStatus:{type:Array,default:function(){return[]}}},data:function(){return{dateRange:[s()(new Date,"YYYY-MM-DD"),s()(new Date,"YYYY-MM-DD")],queryParam:{searchText:"",startDate:"",endDate:"",orderType:"",status:this.orderStatus.join(","),pageNo:1,pageSize:10,workGroupId:this.workGroupId,planId:this.planId},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,stationData:[]}},methods:{checkRadioMethod:function(e){var t=e.row;return!(this.selectStatus&&this.selectStatus.length>0)||this.selectStatus.indexOf(t.orderStatus)>-1},onDateChange:function(){this.dateRange[0]?this.queryParam.startDate=this.dateRange[0].format("YYYY-MM-DD"):this.queryParam.startDate=null,this.dateRange[1]?this.queryParam.endDate=this.dateRange[1].format("YYYY-MM-DD"):this.queryParam.endDate=null},showModal:function(){this.visible=!0,this.queryParam.planId=this.planId,this.queryParam.workGroupId=this.workGroupId,this.queryParam.orderType=this.orderType,this.findList()},findList:function(){var e=this;this.loading=!0,Object(n["T"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},u=c,d=(r("607e"),r("2877")),f=Object(d["a"])(u,a,o,!1,null,null,null);t["default"]=f.exports},7068:function(e,t,r){"use strict";r("51cf")},7483:function(e,t,r){"use strict";r("2e75")},7616:function(e,t,r){},"769e":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"80%",title:"厂商选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",centered:"",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"名称"}},[t("a-input",{attrs:{placeholder:"请输入名称"},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"修程类型"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_repair_program,name,id"},model:{value:e.queryParam.repairProgramId,callback:function(t){e.$set(e.queryParam,"repairProgramId",t)},expression:"queryParam.repairProgramId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"所属线路"}},[t("line-select-list",{model:{value:e.queryParam.lineId,callback:function(t){e.$set(e.queryParam,"lineId",t)},expression:"queryParam.lineId"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"状态"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_effective"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",{attrs:{md:4,sm:8}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)])],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 130px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 130px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"highlight-current-row":"","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"click",mode:"cell",showIcon:"true"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"name",title:"厂商名称","min-width":"140","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"shortName",title:"厂商简称","min-width":"120"}}),t("vxe-table-column",{attrs:{field:"category_dictText",title:"厂商类别",width:"80"}}),t("vxe-table-column",{attrs:{field:"repairProgramName",title:"所属修程",width:"8%"}}),t("vxe-table-column",{attrs:{field:"lineName",title:"所属线路",width:"8%"}}),t("vxe-table-column",{attrs:{field:"contactName",title:"联系人员",width:"80"}}),t("vxe-table-column",{attrs:{field:"contactPhone",title:"联系电话",width:"100","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"email",title:"邮箱",width:"100","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"address",title:"地址","min-width":"120","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"appraise",title:"评分",width:"80","header-align":"center",align:"right"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"80"}}),t("vxe-table-column",{attrs:{field:"remarks",title:"备注","min-width":"120","header-align":"center",align:"left"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)])},o=[],i=r("d214"),n=r("5633"),l={name:"SupplierList",components:{LineSelectList:n["default"]},props:{multiple:{type:Boolean,default:!0}},data:function(){return{queryParam:{category:null,name:"",objTypeId:"",status:null,lineId:"",repairProgramId:"",pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,formItemLayout:{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}}}},methods:{showModal:function(){this.visible=!0,this.findList()},findList:function(){var e=this;this.loading=!0,Object(i["eb"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.close()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,this.queryParam.searchText=""}}},s=l,c=(r("cc0c"),r("2877")),u=Object(c["a"])(s,a,o,!1,null,"2c33e9dc",null);t["default"]=u.exports},"7b165":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:500,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"作业时间"}},[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD HH:mm:ss","show-time":{format:"HH:mm:ss",hideDisabledOptions:!0}},model:{value:e.workTime,callback:function(t){e.workTime=t},expression:"workTime"}})],1)],1)],1)],1)],1)],1)},o=[],i=r("c1df"),n=r.n(i),l=r("b9c3"),s={name:"WorkTimeModal",data:function(){return{value:1,title:"作业完成",labelText:"作业时间",visible:!1,labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:15}},confirmLoading:!1,form:this.$form.createForm(this),ids:"",workTime:void 0}},created:function(){},methods:{show:function(e){this.form.resetFields(),this.ids=e,this.visible=!0},handleOk:function(){var e=this,t=this;t.form.validateFields((function(r,a){if(!r){t.confirmLoading=!0;var o=new FormData;o.append("itemIds",t.ids),t.workTime&&(t.workTime=n()(t.workTime).format("YYYY-MM-DD HH:mm:ss"),o.append("workTime",t.workTime)),Object(l["ab"])(o).then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok")):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1,t.close()})),e.visible=!1}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},c=s,u=r("2877"),d=Object(u["a"])(c,a,o,!1,null,"3f50fa8e",null);t["default"]=d.exports},"7e9e":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,centered:"",width:"100%",dialogClass:"fullDialog no-footer",visible:e.visible,confirmLoading:e.loading,footer:null,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.close,cancel:e.close}},[t("a-button",{attrs:{"na-btn-type":"print",type:"primary"},on:{click:e.print}},[e._v("导出")]),t("RecordSheetTable",{directives:[{name:"show",rawName:"v-show",value:e.recordSheet,expression:"recordSheet"}],ref:"recordTable"}),t("div",{staticStyle:{height:"20px"}}),t("TableExport",{ref:"tablePrintRef"})],1)},o=[],i=r("8fad"),n=r("958d"),l=r("45ff"),s={name:"RecordTableView",components:{RecordSheetTable:n["default"],TableExport:l["default"]},props:{},data:function(){return{title:"记录表查看",visible:!1,loading:!1,recordId:"",recordSheet:{}}},mounted:function(){},methods:{show:function(e){this.recordId=e,this.loadData(),this.visible=!0},close:function(){this.$emit("close"),this.visible=!1},loadData:function(){var e=this;Object(i["Ab"])({id:this.recordId}).then((function(t){t.success?(e.recordSheet=t.result,e.$refs.recordTable.loadData(e.recordSheet)):e.$message.error("获取记录表详情失败")})).catch((function(t){e.$message.error("获取记录表详情异常")}))},print:function(){this.$refs.tablePrintRef.printById(this.recordId)}}},c=s,u=r("2877"),d=Object(u["a"])(c,a,o,!1,null,"a8b3abda",null);t["default"]=d.exports},"842a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{style:"height: calc(100vh - ".concat(e.getButtonShow()?"47px":"4px",");")},[e.getButtonShow()?t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24}},[t("a-form-item",{attrs:{label:"表单名称:"}},[t("a-input",{attrs:{placeholder:"表单名称",allowClear:""},on:{change:e.sortTable},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),t("a-form-item",{attrs:{label:"表单类型:"}},[t("a-select",{staticStyle:{width:"120px"},attrs:{allowClear:""},on:{change:e.sortTable},model:{value:e.searchCategory,callback:function(t){e.searchCategory=t},expression:"searchCategory"}},[t("a-select-option",{attrs:{value:3}},[e._v(" 作业记录表")]),t("a-select-option",{attrs:{value:1}},[e._v(" 数据记录表")]),t("a-select-option",{attrs:{value:4}},[e._v(" 检查记录表")])],1)],1),t("a-form-item",{},[t("a-space",[t("a-button",{staticClass:"primary-color",attrs:{type:"dashed",disabled:"1"===e.displayModel},on:{click:e.handleAdd}},[e._v("关联表单 ")]),t("a-button",{attrs:{type:"dashed",disabled:"1"===e.displayModel},on:{click:e.handleDel}},[e._v("删除关联")])],1)],1)],1)],1)],1):e._e(),t("div",{attrs:{"na-flex-height-full":""}},["1"===e.displayModel?t("vxe-table",{ref:"listTable",attrs:{border:"",align:"center","max-height":"auto",data:e.sumTableDate,"edit-rules":e.validRules,"keep-source":!0,"filter-config":{showIcon:!1},"checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{key:"id",trigger:"manual",mode:"row",autoClear:!1,showStatus:!0}},on:{"checkbox-change":function(t){return e.btnStatus.update()},"checkbox-all":function(t){return e.btnStatus.update()}}},[t("vxe-table-column",{attrs:{type:"seq",width:"40"}}),t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),e.tasks&&e.tasks.length>1?t("vxe-table-column",{attrs:{field:"taskName",title:"工单任务",align:"left","edit-render":{name:"input"}},scopedSlots:e._u([{key:"edit",fn:function(r){var a=r.row;return[t("a-select",{staticStyle:{width:"100%"},on:{change:e.taskSelectChange},model:{value:a.workOrderTaskId,callback:function(t){e.$set(a,"workOrderTaskId",t)},expression:"row.workOrderTaskId"}},e._l(e.tasks,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.id}},[e._v(" "+e._s(r.taskName)+" ")])})),1)]}}],null,!1,3163574811)}):e._e(),t("vxe-table-column",{attrs:{field:"title",title:"表单名称",width:"25%","edit-render":{name:"input"},align:"left",filters:[{data:""}],"filter-method":e.customStringFilterMethod,"header-align":"center"},scopedSlots:e._u([{key:"edit",fn:function(r){var a=r.row;return[t("a-select",{ref:"formSelect",staticStyle:{width:"100%"},attrs:{placeholder:"请选择表单",open:!1},on:{focus:function(t){return e.openFormSelectModal(a)}},model:{value:a.formName,callback:function(t){e.$set(a,"formName",t)},expression:"row.formName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},on:{click:function(t){return e.openFormSelectModal(a)}},slot:"suffixIcon"})],1)]}},{key:"default",fn:function(r){var a=r.row;return[t("a",{on:{click:function(t){return t.stopPropagation(),e.jumpInfo(a)}}},[e._v(e._s(a.formName))])]}}],null,!1,4164762839)}),t("vxe-table-column",{attrs:{field:"instType_dictText",title:"表单类型",width:"100","edit-render":{name:"input"}},scopedSlots:e._u([{key:"edit",fn:function(r){var a=r.row;return[t("a-input",{attrs:{placeholder:"请选择表单",disabled:""},model:{value:a.instType_dictText,callback:function(t){e.$set(a,"instType_dictText",t)},expression:"row.instType_dictText"}})]}}],null,!1,1183295985)}),t("vxe-table-column",{attrs:{field:"reguName",title:"所属规程",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(r.reguName)+" ")]}},{key:"edit",fn:function(r){var a=r.row;return[t("a-input",{attrs:{placeholder:"请选择表单",disabled:""},model:{value:a.reguName,callback:function(t){e.$set(a,"reguName",t)},expression:"row.reguName"}})]}}],null,!1,3702729415)}),t("vxe-table-column",{attrs:{field:"reguVersion",title:"规程版本",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(r.reguVersion)+" ")]}},{key:"edit",fn:function(r){var a=r.row;return[t("a-input",{attrs:{placeholder:"请选择表单",disabled:""},model:{value:a.reguVersion,callback:function(t){e.$set(a,"reguVersion",t)},expression:"row.reguVersion"}})]}}],null,!1,4216350919)}),t("vxe-table-column",{attrs:{field:"trainAssetName",title:"关联设备","edit-render":{name:"input"},align:"left","header-align":"center",formatter:e.formatterAssetName},scopedSlots:e._u([{key:"edit",fn:function(r){var a=r.row;return[t("a-select",{ref:"trainAssetSelect",staticStyle:{width:"100%"},attrs:{placeholder:"请选择关联设备",open:!1},on:{focus:function(t){return e.openAssetSelectModal(a)}},model:{value:a.trainAssetName,callback:function(t){e.$set(a,"trainAssetName",t)},expression:"row.trainAssetName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},on:{click:function(t){return e.openAssetSelectModal(a)}},slot:"suffixIcon"})],1)]}}],null,!1,1688760708)}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"已填写？",width:"100"}}),t("vxe-table-column",{attrs:{field:"checkUserName",title:"检查",width:"100"}}),t("vxe-table-column",{attrs:{field:"remark",title:"备注","edit-render":{name:"$input",props:{placeholder:"请输入备注"}},align:"left","header-align":"center"}}),6===e.operator?t("vxe-table-column",{attrs:{title:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[[t("a-button",{attrs:{size:"small",disabled:6!==e.operator},on:{click:function(t){return t.stopPropagation(),e.jumpInfo(a)}}},[e._v("检查填写")])]]}}],null,!1,3991836714)}):e._e()],1):e._e(),"0"===e.displayModel?t("vxe-table",{ref:"listTable",attrs:{border:"",align:"center","max-height":"auto",data:e.taskForms,"edit-rules":e.validRules,"keep-source":!0,"filter-config":{showIcon:!1},"checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{key:"id",trigger:"manual",mode:"row",autoClear:!1,showStatus:!0}},on:{"update:data":function(t){e.taskForms=t},"checkbox-change":function(t){return e.btnStatus.update()},"checkbox-all":function(t){return e.btnStatus.update()}}},[t("vxe-table-column",{attrs:{type:"seq",width:"40"}}),t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),e.tasks&&e.tasks.length>1?t("vxe-table-column",{attrs:{field:"taskName",title:"工单任务",align:"left","edit-render":{name:"input"}},scopedSlots:e._u([{key:"edit",fn:function(r){var a=r.row;return[t("a-select",{staticStyle:{width:"100%"},on:{change:e.taskSelectChange},model:{value:a.workOrderTaskId,callback:function(t){e.$set(a,"workOrderTaskId",t)},expression:"row.workOrderTaskId"}},e._l(e.tasks,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.id}},[e._v(" "+e._s(r.taskName)+" ")])})),1)]}}],null,!1,3163574811)}):e._e(),t("vxe-table-column",{attrs:{field:"formName",title:"表单名称",width:"25%","edit-render":{name:"input"},align:"left","header-align":"center",filters:[{data:""}],"filter-method":e.customStringFilterMethod},scopedSlots:e._u([{key:"edit",fn:function(r){var a=r.row;return[t("a-select",{ref:"formSelect",staticStyle:{width:"100%"},attrs:{placeholder:"请选择表单",open:!1},on:{focus:function(t){return e.openFormSelectModal(a)}},model:{value:a.formName,callback:function(t){e.$set(a,"formName",t)},expression:"row.formName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},on:{click:function(t){return e.openFormSelectModal(a)}},slot:"suffixIcon"})],1)]}},{key:"default",fn:function(r){var a=r.row;return[t("a",{on:{click:function(t){return t.stopPropagation(),e.jumpInfo(a)}}},[e._v(e._s(a.formName))])]}}],null,!1,4164762839)}),t("vxe-table-column",{attrs:{field:"instType_dictText",title:"表单类型",width:"100","edit-render":{name:"input"}},scopedSlots:e._u([{key:"edit",fn:function(r){var a=r.row;return[t("a-input",{attrs:{placeholder:"请选择表单",disabled:""},model:{value:a.instType_dictText,callback:function(t){e.$set(a,"instType_dictText",t)},expression:"row.instType_dictText"}})]}}],null,!1,1183295985)}),t("vxe-table-column",{attrs:{field:"reguName",title:"所属规程",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(r.reguName)+" ")]}},{key:"edit",fn:function(r){var a=r.row;return[t("a-input",{attrs:{placeholder:"请选择表单",disabled:""},model:{value:a.reguName,callback:function(t){e.$set(a,"reguName",t)},expression:"row.reguName"}})]}}],null,!1,3702729415)}),t("vxe-table-column",{attrs:{field:"reguVersion",title:"规程版本",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(r.reguVersion)+" ")]}},{key:"edit",fn:function(r){var a=r.row;return[t("a-input",{attrs:{placeholder:"请选择表单",disabled:""},model:{value:a.reguVersion,callback:function(t){e.$set(a,"reguVersion",t)},expression:"row.reguVersion"}})]}}],null,!1,4216350919)}),t("vxe-table-column",{attrs:{field:"trainAssetName",title:"关联设备","edit-render":{name:"input"},align:"left","header-align":"center",formatter:e.formatterAssetName},scopedSlots:e._u([{key:"edit",fn:function(r){var a=r.row;return[t("a-select",{ref:"trainAssetSelect",staticStyle:{width:"100%"},attrs:{placeholder:"请选择关联设备",open:!1},on:{focus:function(t){return e.openAssetSelectModal(a)}},model:{value:a.trainAssetName,callback:function(t){e.$set(a,"trainAssetName",t)},expression:"row.trainAssetName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},on:{click:function(t){return e.openAssetSelectModal(a)}},slot:"suffixIcon"})],1)]}}],null,!1,1688760708)}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"已填写？",width:"100"}}),t("vxe-table-column",{attrs:{field:"checkUserName",title:"专验",width:"100"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row;return[3!==a.instType&&4!==a.instType||a.checkUserName?t("span",[e._v(e._s(a.checkUserName))]):t("span",[e._v("未检查")])]}}],null,!1,3387105567)}),t("vxe-table-column",{attrs:{field:"remark",title:"备注","edit-render":{name:"$input",props:{placeholder:"请输入备注"}},align:"left","header-align":"center"}})],1):e._e()],1),t("form-template",{ref:"formTemplate"}),t("FormsList",{ref:"modalForm",attrs:{multiple:!1},on:{ok:e.onSelectForm}}),t("FormsList",{ref:"multipleSelect",attrs:{multiple:!0},on:{ok:e.multipleSelectChange}}),t("CarDeviceSelect",{ref:"trainAssetSelectModal",attrs:{"train-no":e.trainNo,multiple:!1,canSelectType:[3,4]},on:{ok:e.onTrainAssetSelect,cancel:e.onCancelTrainAssetSelect}}),t("ViewWorkForm",{ref:"viewWorkForm",attrs:{operator:e.operator},on:{checkSuccess:e.onCheckSuccess}}),t("FormViewModal",{ref:"formViewModal"}),t("RecordTableView",{ref:"recordTableView"}),t("JobCheckTableView",{ref:"jobCheckTableView"}),t("TaskFormSelectModel",{ref:"formSelectModel",attrs:{"check-list":e.taskForms,"train-no":e.trainNo,lineId:e.workOrderInfo.lineId,repairId:e.repairId,operator:e.operator,workOrderId:e.workOrderInfo.id||e.workOrderInfo.orderId,workOrderTaskId:e.defaultTaskId},on:{ok:e.onAddForm}}),t("TaskFormDetaileModal",{ref:"taskFormDetaileModal",attrs:{workOrderInfo:e.workOrderInfo,tableForm:e.taskForms},on:{ok:e.onSelectFormDetaile}})],1)},o=[],i=r("ca00"),n=r("37582"),l=r("e42a"),s=r("4e0a"),c=r("05d5"),u=r("88da"),d=r("3dbe"),f=r("7e9e"),h=r("aaa8"),m=r("b7b4"),p=r("009c"),g=r("4681"),b=r("54f6"),y={name:"TaskForms",components:{FormsList:n["default"],TrainStructureList:s["default"],FormTemplate:c["default"],ViewWorkForm:u["default"],CarDeviceSelect:l["default"],FormViewModal:d["default"],RecordTableView:f["default"],JobCheckTableView:h["default"],TaskFormSelectModel:p["default"],TaskFormDetaileModal:g["default"]},props:{taskForms:{type:Array,default:function(){return[]}},workOrderInfo:{type:Object,default:function(){return{}}},tasks:{type:Array,default:function(){return[]}},repairId:{type:[Number,String],default:null},trainNo:{type:String,default:""},planId:{type:String,default:""},readOnly:{type:Boolean,default:!1},operator:{type:Number,default:0}},data:function(){return{defaultTaskId:"",displayModel:"0",curEditMode:0,curRow:null,searchText:"",searchCategory:null,validRules:{formName:[{required:!0,message:"表单必须选择",trigger:"manual"}],copies:[{required:!0,message:"数量必须填写",trigger:"manual"}],remark:[{max:200,type:"string",message:"备注不能超过200个字符"}]},sumTableDate:[],btnStatus:new b["a"](this,"listTable",{attrs:[{key:"edit",judge:function(e){return 3===e.instType||4===e.instType}}]})}},watch:{taskForms:function(e,t){(4===this.operator||6===this.operator||this.readOnly)&&(this.sumTableDate=this.taskForms,this.btnStatus.update())}},mounted:function(){(4===this.operator||6===this.operator||this.readOnly)&&(this.sumTableDate=this.taskForms,this.displayModel="1"),this.tasks&&this.tasks.length>0&&(this.defaultTaskId=this.tasks[0].id)},methods:{onCheckSuccess:function(e,t){this.taskForms.forEach((function(r){r.id===e.id&&(r.checkUserName=t.checkUserName)})),this.$forceUpdate()},remarkChange:function(e){var t=e.remark;return!(t.length>200)||(this.$message.error("备注不能超过200个字符"),!1)},handleChange:function(e){"1"===this.displayModel&&(this.sumTableDate=this.groupArr(this.taskForms))},groupArr:function(e){for(var t={},r=0;r<e.length;r++){var a=e[r],o="A"+a.formInstId,i=t[o];i||(i={},i.taskName="",i.instType=a.instType,i.formName=a.formName,i.formInstId=a.formInstId,i.instType_dictText=a.instType_dictText,i.trainAssetName=a.trainAssetName||a.assetTypeName,i.remark=a.remark,i.status_dictText=a.status_dictText,i.checkUserName=a.checkUserName,t[o]=i),i.taskName+=a.taskName}var n=[];for(var l in t)n.push(t[l]);return n},getButtonShow:function(){return!this.readOnly&&(0===this.operator||1===this.operator)},handleAdd:function(){this.tasks.length?this.$refs.listTable.getActiveRecord()||this.$refs.formSelectModel.showModal(this.planId):this.$message.warning("请先添加任务")},handleDel:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();t.length>0?this.$confirm({content:"是否删除选中".concat(t.length,"条数据？"),okText:"确定",cancelText:"取消",onOk:function(){t.map((function(t){e.taskForms.map((function(r,a){t.id===r.id&&e.taskForms.splice(a,1)}))})),e.btnStatus.update()}}):this.$message.error("尚未选中任何数据!")},editRowEvent:function(e){this.curEditMode=2,this.$refs.listTable.setActiveRow(e)},delRowEvent:function(e){var t=this;this.taskForms.map((function(r,a){e.id===r.id&&t.taskForms.splice(a,1)}))},saveRowEvent:function(e){var t=this;this.$refs.listTable.validate(e,(function(r){if(r)for(var a in r){var o=r[a];o.forEach((function(e){e.rule&&t.$message.error(e.rule.message)}))}else 1===t.curEditMode&&t.taskForms.push(e),t.$refs.listTable.clearActived(),t.curEditMode=0}))},cancelRowEvent:function(e){this.$refs.listTable.clearActived(),1===this.curEditMode?this.$refs.listTable.remove(e):2===this.curEditMode&&this.$refs.listTable.revertData(e),this.curEditMode=0},openFormSelectModal:function(e){this.curRow=e,this.$refs.modalForm.showModal(),this.$refs.formSelect.blur()},onSelectForm:function(e){if(e&&e.forms.length>0){for(var t=e.forms[0],r=0,a=0,o=this.taskForms.length;a<o;a++){var i=this.taskForms[a];if(i.formObjId==t.id){r=1;break}}if(1===r)return void this.$message.error("你选择的表单已经在列表中存在，请选择其他表单");this.curRow.formName=t.title,this.curRow.formObjId=t.id,this.curRow.formCode=t.code,this.curRow.fromBy=2,this.curRow.formInstId="",this.curRow.instType=e.formType,this.curRow.planFormId="",this.curRow.instType_dictText=e.formTypeName,this.curRow.copies=1,this.curRow.status_dictText="未填写",this.curRow.fromBy=2,t.assetTypeId&&(this.curRow.assetTypeName=t.assetTypeName,this.curRow.assetTypeId=t.assetTypeId),this.curRow.isNew=!0}else this.curRow.formName="",this.curRow.objId="",this.curRow.formType="",this.curRow.formType_dictText="",this.curRow.copies=0,this.curRow.fromBy=2,this.curRow.isNew=!0},openAssetSelectModal:function(e){this.curRow=e,this.$refs.trainAssetSelectModal.showModal(),this.$refs.trainAssetSelect.blur()},onTrainAssetSelect:function(e){if(e.length){var t=e[0];t?(this.curRow.trainStructName=t.assetName,this.curRow.trainStructId=t.structDetailId,this.curRow.trainAssetId=t.id,this.curRow.trainAssetName=t.assetName,this.curRow.assetTypeId=t.assetTypeId):(this.curRow.trainStructName="",this.curRow.trainStructId="",this.curRow.trainAssetId="",this.curRow.trainAssetName="")}else this.curRow.trainStructName="",this.curRow.trainStructId="",this.curRow.trainAssetId="",this.curRow.trainAssetName=""},multipleSelectChange:function(e){for(var t=e.forms.length,r=0;r<t;r++){var a=e.forms[r],o=0;if(1!==o){var n={id:Object(i["p"])(),planId:this.planId,workOrderTaskId:"",formName:a.title,formObjId:a.id,formCode:a.code,fromBy:2,formInstId:"",instType:e.formType,planFormId:"",instType_dictText:e.formTypeName,copies:1,status_dictText:"未填写",trainStructName:"",trainStructId:"",trainAssetId:"",trainAssetName:"",assetTypeId:"",assetTypeName:""};this.tasks.length&&Object.assign(n,{workOrderTaskId:this.tasks[0].id,taskName:this.tasks[0].taskName}),a.assetTypeId&&(n.assetTypeName=a.assetTypeName,n.assetTypeId=a.assetTypeId),n.isNew=!0,this.taskForms.push(n),this.$refs.listTable.insertAt(n,-1)}}},onCancelTrainAssetSelect:function(){},taskSelectChange:function(e,t){this.$refs.listTable.getActiveRecord().row.taskName=this.tasks[t.key].taskName},jumpInfo:function(e){var t=this;e.isNew?(1===e.instType&&this.$refs.formViewModal.showModal(e.formObjId),3===e.instType&&(1===e.workRecordType?this.$refs.recordTableView.show(e.formObjId):2===e.workRecordType&&this.$refs.formViewModal.showModal(e.formObjId)),4===e.instType&&Object(m["y"])({id:e.formObjId}).then((function(e){if(e.success&&e.result){var r=e.result;t.$refs.jobCheckTableView.show(r)}else t.$message.error("加载检查记录表明细记录数据异常")}))):this.$refs.viewWorkForm.showModal(e,this.trainNo)},clearValidate:function(){this.$refs.listTable.clearValidate()},sortTable:function(){if(this.$refs.listTable){var e=this.$refs.listTable.getColumnByField("formName"),t=e.filters[0];t.checked=!0,this.$refs.listTable.updateData()}},customStringFilterMethod:function(e){var t=e.row,r=new RegExp(this.searchText);new RegExp(this.searchText);return r.test(t.formName)&&(!this.searchCategory||t.instType===this.searchCategory)},onAddForm:function(e){var t=this;e.length&&(e.forEach((function(e){t.taskForms.push({isNew:!0,id:Object(i["p"])(),planId:t.planId,formName:e.title,title:e.title,workOrderId:t.workOrderInfo.id,workOrderTaskId:t.tasks[0].id,formInstId:e.id,formObjId:e.formObjId,formCode:e.code,fromBy:2,instType:e.type||e.formType,instType_dictText:e.formType_dictText,workRecordType:e.workRecordType,status_dictText:"未填写",recordIds:"",remark:"",assetTypeName:e.assetTypeName,trainStructName:e.trainStructName,trainAssetName:e.assetName,trainStructWbs:e.trainStructWbs})})),this.btnStatus.update())},openFormDetaile:function(){var e=this.$refs.listTable.getCheckboxRecords();e.length?this.$refs.taskFormDetaileModal.showModal(e[0]):this.$message.warn("请勾选填写的数据")},formatterAssetName:function(e){e.cellValue;var t=e.row,r=t.trainAssetName||t.trainStructName||t.assetTypeName;if(t.trainStructWbs){var a=t.trainStructWbs.split(".");r=a[0]+"_"+r}return r},onSelectFormDetaile:function(e){var t=this.$refs.listTable.getCheckboxRecords()[0];t.recordIds=e||null}}},v=y,k=r("2877"),w=Object(k["a"])(v,a,o,!1,null,"410d5550",null);t["default"]=w.exports},8522:function(e,t,r){"use strict";r("f000")},"88da":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,centered:"",visible:e.visible,width:"100%",dialogClass:6===e.operator?"fullDialog":"fullDialog no-footer",destroyOnClose:!0},on:{cancel:function(t){e.visible=!1}}},[t("a-button",{attrs:{"na-btn-type":"print",type:"primary"},on:{click:e.exportPrint}},[e._v("导出打印")]),3===e.formType&&1===e.workRecordType?t("div",{staticClass:"table-page-body",staticStyle:{height:"100%","overflow-y":"auto"}},[t("RecordSheetTable",{directives:[{name:"show",rawName:"v-show",value:e.curRecordData,expression:"curRecordData"}],ref:"recordTable"})],1):e._e(),4===e.formType?t("div",{staticClass:"table-page-body",staticStyle:{height:"100%","overflow-y":"auto"}},[t("JobCheckSheetTable",{ref:"jobCheckTable",attrs:{data:e.sheetData}})],1):e._e(),1===e.formType||3===e.formType&&2===e.workRecordType?t("div",{staticClass:"table-page-body",staticStyle:{height:"100%"}},[t("div",{attrs:{id:"luckysheet"}})]):e._e(),6===e.operator?t("template",{slot:"footer"},[t("a-button",{attrs:{type:"primary"},on:{click:e.confirmForm}},[e._v(" 检查确认")]),t("a-button",{on:{click:function(t){e.visible=!1}}},[e._v(" 关闭")])],1):e._e(),t("ConfirmForm",{ref:"confirmForm",on:{ok:e.handleOk}}),t("WorkRecordPrint",{ref:"workRecordPrint",attrs:{luckySheetId:"luckysheet"},on:{sheetPrintOk:e.onSheetPrintOk}}),t("JobCheckTableExport",{ref:"tablePrintRef"}),t("TableExport",{ref:"tablePrintRef2"})],2)},o=[],i=r("b7b4"),n=r("b9c3"),l=r("958d"),s=r("e0ce"),c=r("3cf2"),u=r("45ff"),d=r("8fad"),f=r("7268"),h=r("25e0"),m=r("10f9"),p=r("e24e"),g={name:"ViewWorkForm",components:{RecordSheetTable:l["default"],ConfirmForm:h["default"],JobCheckSheetTable:s["default"],WorkRecordPrint:m["default"],JobCheckTableExport:c["default"],TableExport:u["default"]},props:{operator:{type:Number,default:0}},data:function(){return{sheetData:{},formType:1,workRecordType:0,formName:"",trainNo:"",groupName:"",visible:!1,fileUrl:"",tableData:[],curRecordData:[],curOnlineForm:null,formSheetId:"",formInfo:{},formInstId:"",onLineInstId:"",defaultOptions:{container:"luckysheet",title:"sheet",column:26,row:50,lang:"zh",allowEdit:!1,showinfobar:!1,sheetFormulaBar:!1,showsheetbar:!1,showstatisticBar:!0,enableAddRow:!1,enableAddCol:!1,showtoolbar:!1},printType:0,allItems:!0}},computed:{title:function(){return"表单查看-"+this.trainNo+"车 "+this.formName}},beforeDestroy:function(){luckysheet.destroy()},methods:{exportPrint:function(){try{var e="";switch(this.trainNo&&(e="-"+this.trainNo+"车"),this.formType){case 1:Object(p["a"])(luckysheet.getAllSheets(),this.formName+e);break;case 3:1===this.workRecordType?this.$refs.tablePrintRef2.printByData(this.curRecordData):2===this.workRecordType&&Object(p["a"])(luckysheet.getAllSheets(),this.formName+e);break;case 4:this.$refs.tablePrintRef.printByRow(this.sheetData)}}catch(t){}},initSheet:function(e){e.scrollLeft=0,e.scrollTop=0;var t=JSON.parse(JSON.stringify(this.defaultOptions));t.data=[e],luckysheet.destroy(),luckysheet.create(t)},showModal:function(e,t){try{this.formInfo=e,this.formType=e.instType,this.workRecordType=e.workRecordType,this.trainNo=t,this.formName=e.formName,this.formInstId=e.formInstId,this.allItems=!1,this.loadFormDetail(!1)}catch(r){}},showModalAllItem:function(e,t){try{this.formInfo=e,this.formType=e.instType,this.trainNo=t,this.formName=e.formName,this.formInstId=e.formInstId,this.allItems=!0,this.loadFormDetail(!0)}catch(r){}},loadFormDetail:function(e){this.printType=0;try{switch(this.formType){case 1:this.formInfo.formObjId=this.formInfo.id,this.loadOnlineFormDetail(this.formInfo.task2InstId,this.formInfo.formInstId);break;case 3:1===this.workRecordType?this.loadRecordTableDetail(this.formInfo.task2InstId,this.formInfo.formInstId,e):2===this.workRecordType&&this.loadWorkRecordDetail(this.formInfo.formObjId,this.formInfo.formInstId);break;case 4:this.loadWorkCheckFormDetail(this.formInfo.task2InstId,this.formInfo.formInstId,e)}}catch(t){}},loadWorkRecordDetail:function(e,t){var r=this,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.visible=!0,Object(d["ub"])(e).then((function(e){if(e.success){var o=JSON.parse(e.result);if(!a)return void r.initSheet(o);Object(n["U"])(t).then((function(e){if(e.success){if(e.result){var t=JSON.parse(e.result);o.data=[],o.celldata=luckysheet.transToCellData(t)}r.initSheet(o)}else r.initSheet(o)}))}else r.$message.error("获取作业记录表模板数据失败")}))},loadWorkCheckFormDetail:function(e,t){var r=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(n["P"])({task2InstId:e,formInstId:t,allItems:a}).then((function(e){if(e.success&&e.result){var t=e.result;r.sheetData=t,r.visible=!0}else r.$message.error("加载记录数据异常")}))},loadOnlineFormDetail:function(e,t){var r=this;this.visible=!0,Object(n["Q"])({task2InstId:e,formInstId:t,needValues:!1}).then((function(e){if(e.success){r.curOnlineForm=e.result;var t=null;if(r.curOnlineForm){if(r.curOnlineForm.result)try{t=JSON.parse(r.curOnlineForm.result)}catch(a){return void r.$message.error("转换表单填写结果异常")}Object(d["ub"])(r.curOnlineForm.formObjId).then((function(e){if(e.success){var a=JSON.parse(e.result);t&&(a.data=[],a.celldata=luckysheet.transToCellData(t)),r.initSheet(a)}else r.$message.error("获取表单模板数据失败")}))}else r.$message.error("获取作业表单数据失败")}else r.$message.error("获取记录表内容错误")}))},loadRecordTableDetail:function(e,t){var r=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(n["R"])({task2InstId:e,formInstId:t,needChecks:!0,needCategory:!0,allItems:a}).then((function(e){e.success&&e.result?(r.curRecordData=e.result,r.curRecordData.categoryList&&r.curRecordData.categoryList.sort((function(e,t){return e.recIndex-t.recIndex})),r.$nextTick((function(){r.$refs.recordTable.loadData(r.curRecordData)})),r.visible=!0):r.$message.error("加载记录数据异常")}))},confirmForm:function(){this.$refs.confirmForm.confirm(this.formInstId)},handleOk:function(e){if(3===this.formType&&2===this.workRecordType){var t=f["a"].searchCellByText("检查结果",luckysheet.getAllSheets()[0].data),r=t.c;if(t){var a=f["a"].getCellText(t.cell),o="1"===e.checkResult?"通过":"不通过";a=a.replace("检查结果：","检查结果："+o),f["a"].setCellValue(t.r,t.c,a)}t=f["a"].searchCellByText("检查日期",luckysheet.getAllSheets()[0].data);var i=t.c;if(t){var n=f["a"].getCellText(t.cell);n=n.replace("检查日期：","检查日期："+e.checkDate),f["a"].setCellValue(t.r,t.c,n)}t=f["a"].searchCellByText("质量负责人",luckysheet.getAllSheets()[0].data);var l=t.c;if(t){var s=f["a"].getCellText(t.cell);s=s.replace("质量负责人：","质量负责人："+e.checkUserName),f["a"].setCellValue(t.r,t.c,s)}if(r===i&&i===l){var c="1"===e.checkResult?"通过":"不通过",u="检查结果："+c;u+="          检查日期："+e.checkDate,u+="          质量负责人："+e.checkUserName,f["a"].setCellValue(t.r,t.c,u)}this.saveWorkRecord(!1)}this.$emit("checkSuccess",this.formInfo,e),this.visible=!1},saveWorkRecord:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=JSON.stringify(luckysheet.getAllSheets()[0].data),a={formInstId:this.formInfo.formInstId,xlsJson:r};Object(n["hb"])(a).then((function(r){r.success?t&&e.$message.success("保存作业记录表信息成功"):t&&e.$message.error("保存作业记录表信息失败")}))},print:function(){var e={id:this.formInfo.id,instType:this.formType,formInstId:this.formInfo.formInstId,formObjId:this.formInfo.formObjId,formName:this.formName,workRecordType:this.workRecordType};0===this.printType?this.$refs.workRecordPrint.print(e):1===this.printType&&this.$refs.workRecordPrint.printNoData(e)},onSheetPrintOk:function(){0===this.printType?this.loadFormDetail(this.allItems):1===this.printType&&this.loadFormDetailNoData()},showModalNoData:function(e,t){this.formInfo=e,this.formType=e.instType,this.trainNo=t,this.formName=e.formName,this.formInstId=e.formInstId,this.loadFormDetailNoData()},loadFormDetailNoData:function(){this.printType=1;try{switch(this.formType){case 1:this.formInfo.formObjId=this.formInfo.id,this.loadOnlineDetailNoData(this.formInfo.formInstId);break;case 3:1===this.workRecordType?this.loadRecordDetailNoData(this.formInfo.formInstId):2===this.workRecordType&&this.loadWorkRecordDetail(this.formInfo.formObjId||this.formInfo.id,this.formInfo.formInstId,!1);break;case 4:this.loadCheckDetailNoData(this.formInfo.formInstId)}}catch(e){}},loadRecordDetailNoData:function(e){var t=this;Object(d["Ab"])({id:e}).then((function(e){e.success&&e.result?(t.curRecordData=e.result,t.curRecordData.categoryList&&t.curRecordData.categoryList.sort((function(e,t){return e.recIndex-t.recIndex})),t.$nextTick((function(){t.$refs.recordTable.loadData(t.curRecordData)})),t.visible=!0):t.$message.error("加载记录数据异常")}))},loadCheckDetailNoData:function(e){var t=this;Object(i["y"])({id:e}).then((function(e){try{if(e.success&&e.result){var r=e.result;t.sheetData=r,t.visible=!0}else t.$message.error("加载记录数据异常")}catch(a){t.$message.error("加载记录数据异常")}}))},loadOnlineDetailNoData:function(e){var t=this;this.visible=!0,Object(d["ub"])(e).then((function(e){if(e.success){var r=JSON.parse(e.result);t.$nextTick((function(){t.initSheet(r)}))}}))}}},b=g,y=(r("f0c5"),r("8522"),r("2877")),v=Object(y["a"])(b,a,o,!1,null,"a7b5b52c",null);t["default"]=v.exports},"8cf3":function(e,t,r){"use strict";r("5126")},"8e5e":function(e,t,r){},"90f1":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{ref:"tablePrint",attrs:{id:"tablePrintMain"}},[t("table",{staticClass:"table",staticStyle:{"font-size":"5px"}},[t("thead"),t("tr",[t("td",{staticStyle:{padding:"0"},attrs:{colspan:"4",rowspan:"2"},on:{click:e.print}},[e.recordSheet.assetTypeId?e._e():t("span",{staticStyle:{"padding-left":"5px"}},[e._v("车号："+e._s(e.recordSheet.trainNo))]),e.recordSheet.assetTypeId&&0===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",[e._v("部件号："+e._s(e.recordSheet.manufNo))])])]):e._e(),e.recordSheet.assetTypeId&&1===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",{staticClass:"bottom"},[e._v("原部件序列号："+e._s(e.recordSheet.manufNo))])]),t("tr",[t("td",[e._v("新部件序列号："+e._s(e.recordSheet.manufNoUp))])])]):e._e()]),t("td",{staticStyle:{"text-align":"center","font-weight":"bold"},attrs:{colspan:"3",rowspan:"2"}},[e._v(" "+e._s(e.recordSheet.title||e.recordSheet.workRecName)+" ")]),t("td",{attrs:{colspan:"3"}},[e._v("作业日期："+e._s(e.recordSheet.workDate)+" 完工日期: "+e._s(e.recordSheet.finishDate))])]),t("tr",[t("td",{attrs:{colspan:"3"}},[e._v("作业班组："+e._s(e.recordSheet.workGroupName))])]),e._m(0),e._l(e.recordSheet.categoryList,(function(r){return t("tbody",{key:r.id},e._l(r.detailList,(function(a,o){return t("tr",{key:a.id},[0===o?t("td",{attrs:{rowspan:r.detailList.length}},[e._v(" "+e._s(r.recIndex)+" ")]):e._e(),0===o?t("td",{attrs:{rowspan:r.detailList.length}},[e._v(" "+e._s(r.reguTitle)+" ")]):e._e(),t("td",[e._v(" "+e._s(a.workContent)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[e._v(" "+e._s(a.checkLevel_dictText)+" ")]),t("td",[e._v(" "+e._s(a.techRequire)+" ")]),t("td",[e._v(" "+e._s(0==a.isIgnore?a.workInfo:a.ignoreDesc)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[1===a.result?t("a-checkbox",{attrs:{checked:"",disabled:""}}):e._e(),0===a.result?t("a-checkbox",{attrs:{disabled:""}}):e._e()],1),t("td",[e._v(" "+e._s(a.selfCheck)+" ")]),t("td",[e._v(" "+e._s(a.guarderCheck)+" ")]),t("td",[e._v(" "+e._s(a.monitorCheck)+" ")])])})),0)})),e._l(e.recordSheet.measureToolList,(function(r,a){return t("tr",{key:a},[0===a?t("td",{attrs:{colspan:"2",rowspan:e.recordSheet.measureToolList.length}},[e._v("计量器具使用")]):e._e(),t("td",{attrs:{colspan:"2"}},[e._v("名称: "+e._s(r.name))]),t("td",[e._v("规格型号："+e._s(r.model))]),t("td",[e._v("出厂编号："+e._s(r.serialNo))]),t("td",{attrs:{colspan:"2"}},[e._v("上次检验时间："+e._s(r.lastCheckTime))]),t("td",{attrs:{colspan:"2"}},[e._v("下次检验时间："+e._s(r.nextCheckTime))])])})),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[e._v("情况说明："+e._s(e.recordSheet.remark))])]),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[t("span",{staticStyle:{"margin-left":"5%"}},[e._v("检查结果："+e._s(0===e.recordSheet.checkResult?"未通过":"通过")+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("检查日期："+e._s(e.recordSheet.checkDate)+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("质量负责人："+e._s(e.recordSheet.checkUserName)+" ")]),e._m(1)])])],2)])},o=[function(){var e=this,t=e._self._c;return t("tr",[t("th",{staticStyle:{width:"60px"}},[e._v("序号")]),t("th",{staticStyle:{width:"100px"}},[e._v("项目")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业内容")]),t("th",{staticStyle:{width:"60px"}},[e._v("控制点")]),t("th",{staticStyle:{width:"200px"}},[e._v("技术要求")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业情况")]),t("th",{staticStyle:{width:"80px"}},[e._v("结果")]),t("th",{staticStyle:{width:"60px"}},[e._v("自检")]),t("th",{staticStyle:{width:"60px"}},[e._v("互检")]),t("th",{staticStyle:{width:"60px"}},[e._v("专检")])])},function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"padding-top":"15px"}},[e._v(" 说明："),t("br"),e._v(" 1. 控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。"),t("br"),e._v(" 2. “自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。"),t("br"),e._v(" 3. “作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。"),t("br"),e._v(" 4. “结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。"),t("br"),e._v(" 5. 作业内容中有数据要求的一并填入“作业情况”栏 。 ")])}],i=r("8fad"),n={name:"TablePrint",data:function(){return{recordSheet:{}}},mounted:function(){},methods:{printById:function(e){var t=this;Object(i["Ab"])({id:e}).then((function(e){e.success?(t.recordSheet=e.result,t.$nextTick((function(){t.print()}))):t.$message.error("获取记录表详情失败")})).catch((function(e){t.$message.error("获取记录表详情异常")}))},printByData:function(e){var t=this;this.recordSheet=e,this.$nextTick((function(){t.print()}))},print:function(){var e=this.$refs.tablePrint.innerHTML,t=document.getElementById("printDom")||document.createElement("iframe");t.id="printDom",document.body.appendChild(t),this.$nextTick((function(){var t=document.getElementById("printDom");t.contentDocument.write(e);var r=t.contentDocument.getElementsByTagName("head").item(0),a=document.createElement("style");a.innerHTML=l,r.appendChild(a),t.contentWindow.print()}))}}},l=".table {\n        border-collapse: collapse;\n        border-spacing: 0;\n    }\n\n    .table td {\n        border-color: black;\n        border-style: solid;\n        border-width: 1px;\n        font-family: Arial, sans-serif;\n        font-size: 14px;\n        overflow: hidden;\n        padding: 10px 5px;\n        word-break: normal;\n    }\n\n    .table th {\n        border-color: black;\n        border-style: solid;\n        border-width: 1px;\n        font-family: Arial, sans-serif;\n        font-size: 14px;\n        font-weight: normal;\n        overflow: hidden;\n        padding: 10px 5px;\n        word-break: normal;\n    }\n\n    .table .tg-ld8d {\n        background-color: #f1f1f1;\n        border-color: inherit;\n        font-weight: bold;\n        text-align: left;\n        vertical-align: middle;\n    }\n\n    .table .tg-9wq8 {\n        border-color: inherit !important;\n        text-align: center !important;\n        vertical-align: middle !important;\n    }\n\n    .table .tg-87ij {\n        background-color: #f1f1f1;\n        border-color: inherit;\n        font-weight: bold;\n        text-align: center;\n        vertical-align: middle;\n    }\n\n    .table .tg-d1f0 {\n        background-color: #f1f1f1;\n        border-color: inherit;\n        font-size: 18px;\n        text-align: center;\n        vertical-align: top;\n    }\n\n    .table .tg-0pky {\n        border-color: inherit;\n        text-align: left;\n        vertical-align: top;\n    }\n\n    .qualityBox {\n        display: -ms-flexbox;\n        display: flex;\n        -ms-flex-align: end;\n        align-items: flex-end;\n    }\n\n    .qualityBox .flex1 {\n        -ms-flex: 1;\n        flex: 1;\n    }\n\n    .qualityBox .flex1 span {\n        margin-right: 15px;\n    }\n\n    .qualityBox [type='button'] {\n        margin-right: 15px;\n    }\n\n\n    .innerTable {\n        height: 100%;\n        width: 100%;\n        border-collapse: collapse;\n        border: 0;\n\n\n\n    }\n\n    .innerTable td {\n        border: 0;\n    }\n\n    .innerTable .bottom {\n        border-bottom: 1px solid #2d2a2a;\n    }\n\n    #tablePrintMain {\n        position: fixed;\n        background-color: #fff;\n        top: 120%;\n        opacity: 0;\n    }",s=n,c=(r("dc91"),r("2877")),u=Object(c["a"])(s,a,o,!1,null,"2cc9a1e0",null);t["default"]=u.exports},9216:function(e,t,r){"use strict";r("260f")},"94c2d":function(e,t,r){},9527:function(e,t,r){},"958d":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("table",{staticClass:"table"},[t("thead",[t("tr",[t("td",{staticStyle:{padding:"0"},attrs:{colspan:"4",rowspan:"2"}},[e.recordSheet.assetTypeId?e._e():t("span",{staticStyle:{"padding-left":"5px"}},[e._v("车号："+e._s(e.recordSheet.trainNo))]),e.recordSheet.assetTypeId&&0===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",[e._v("部件号："+e._s(e.recordSheet.manufNo))])])]):e._e(),e.recordSheet.assetTypeId&&1===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",{staticClass:"bottom"},[e._v("原部件序列号："+e._s(e.recordSheet.manufNo))])]),t("tr",[t("td",[e._v("新部件序列号："+e._s(e.recordSheet.manufNoUp))])])]):e._e()]),t("td",{staticStyle:{"text-align":"center","font-weight":"bold"},attrs:{colspan:"3",rowspan:"2"}},[e._v(" "+e._s(e.recordSheet.title||e.recordSheet.workRecName)+" ")]),t("td",{attrs:{colspan:"3"}},[e._v("作业日期："+e._s(e.recordSheet.workDate)+" 完工日期: "+e._s(e.recordSheet.finishDate))])]),t("tr",[t("td",{attrs:{colspan:"3"}},[e._v("作业班组："+e._s(e.recordSheet.workGroupName))])]),e._m(0)]),e._l(e.recordSheet.categoryList,(function(r){return t("tbody",{key:r.id},e._l(r.detailList,(function(a,o){return t("tr",{key:a.id},[0===o?t("td",{attrs:{rowspan:r.detailList.length}},[e._v(" "+e._s(r.recIndex)+" ")]):e._e(),0===o?t("td",{attrs:{rowspan:r.detailList.length}},[e._v(" "+e._s(r.reguTitle)+" ")]):e._e(),t("td",[e._v(" "+e._s(a.workContent)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[e._v(" "+e._s(a.checkLevel_dictText)+" ")]),t("td",[e._v(" "+e._s(a.techRequire)+" ")]),t("td",[e._v(" "+e._s(0==a.isIgnore?a.workInfo:a.ignoreDesc)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[1===a.result?t("a-checkbox",{attrs:{checked:"",disabled:""}}):e._e(),0===a.result?t("a-checkbox",{attrs:{disabled:""}}):e._e()],1),t("td",[e._v(" "+e._s(a.selfCheck)+" ")]),t("td",[e._v(" "+e._s(a.guarderCheck)+" ")]),t("td",[e._v(" "+e._s(a.monitorCheck)+" ")])])})),0)})),e._l(e.recordSheet.measureToolList,(function(r,a){return t("tr",{key:a},[0===a?t("td",{attrs:{colspan:"2",rowspan:e.recordSheet.measureToolList.length}},[e._v("计量器具使用")]):e._e(),t("td",{attrs:{colspan:"2"}},[e._v("名称: "+e._s(r.name))]),t("td",[e._v("规格型号："+e._s(r.model))]),t("td",[e._v("出厂编号："+e._s(r.serialNo))]),t("td",{attrs:{colspan:"2"}},[e._v("上次检验时间："+e._s(r.lastCheckTime))]),t("td",{attrs:{colspan:"2"}},[e._v("下次检验时间："+e._s(r.nextCheckTime))])])})),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[e._v("情况说明："+e._s(e.recordSheet.remark))])]),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[t("span",{staticStyle:{"margin-left":"5%"}},[e._v("检查结果："+e._s(0===e.recordSheet.checkResult?"未通过":"通过")+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("检查日期："+e._s(e.recordSheet.checkDate)+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("质量负责人："+e._s(e.recordSheet.checkUserName)+" ")]),e._m(1)])])],2)])},o=[function(){var e=this,t=e._self._c;return t("tr",[t("th",{staticStyle:{width:"60px"}},[e._v("序号")]),t("th",{staticStyle:{width:"100px"}},[e._v("项目")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业内容")]),t("th",{staticStyle:{width:"60px"}},[e._v("控制点")]),t("th",{staticStyle:{width:"200px"}},[e._v("技术要求")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业情况")]),t("th",{staticStyle:{width:"80px"}},[e._v("结果")]),t("th",{staticStyle:{width:"60px"}},[e._v("自检")]),t("th",{staticStyle:{width:"60px"}},[e._v("互检")]),t("th",{staticStyle:{width:"60px"}},[e._v("专检")])])},function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"padding-top":"15px"}},[e._v(" 说明："),t("br"),e._v(" 1. 控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。"),t("br"),e._v(" 2. “自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。"),t("br"),e._v(" 3. “作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。"),t("br"),e._v(" 4. “结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。"),t("br"),e._v(" 5. 作业内容中有数据要求的一并填入“作业情况”栏 。 ")])}],i={name:"RecordSheetTable",data:function(){return{recordSheet:{}}},methods:{loadData:function(e){this.recordSheet=e}}},n=i,l=(r("d88b"),r("2877")),s=Object(l["a"])(n,a,o,!1,null,"197d5722",null);t["default"]=s.exports},9615:function(e,t,r){"use strict";r("94c2d")},9866:function(e,t,r){},a396:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"70%",title:"故障分类选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",centered:"",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:""}},[t("a-input",{attrs:{placeholder:"请输入故障分类编码或者描述"},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:3,sm:8}},[t("a-form-item",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 130px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 130px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"highlight-current-row":"","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"click",mode:"cell",showIcon:"true"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{type:"seq",width:"60",title:"序号"}}),t("vxe-table-column",{attrs:{field:"categoryCode",title:"故障分类编码",width:"150"}}),t("vxe-table-column",{attrs:{field:"categoryDesc",title:"故障分类描述",align:"left","header-align":"center"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)])},o=[],i=r("b47d"),n={name:"FaultCategoryList",props:{multiple:{type:Boolean,default:!0}},data:function(){return{queryParam:{searchText:"",pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,formItemLayout:{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}}}},methods:{showModal:function(){this.visible=!0,this.findList()},findList:function(){var e=this;this.loading=!0,Object(i["O"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.close()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,this.queryParam.searchText=""}}},l=n,s=(r("2a71"),r("2877")),c=Object(s["a"])(l,a,o,!1,null,"124b546c",null);t["default"]=c.exports},a6da:function(e,t,r){e.exports=r.p+"img/code.77bdebfa.png"},ab7d:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"故障编辑",width:"100%",centered:"",visible:e.visible,dialogClass:"fullDialog",confirmLoading:e.confirmLoading,cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticStyle:{height:"calc(100vh - 5px)","overflow-y":"auto"}},[e.visible?t("BreakdownFormItem",{ref:"breakdownForm",attrs:{fromWriteReport:e.fromWriteReport,workStationsList:e.workStationsList},on:{ok:e.onSaveOk,fail:e.onSaveFail,cancel:e.onSaveCancel}}):e._e()],1)])},o=[],i=r("d0ca"),n={name:"BreakdownModal",components:{BreakdownFormItem:i["default"]},props:{showWorkStation:{type:Boolean,default:!1},fromWriteReport:{type:Boolean,default:!1}},data:function(){return{visible:!1,confirmLoading:!1,workStationsList:[]}},created:function(){},methods:{setWorkStations:function(e){var t=this;this.workStationsList.length=0,e.forEach((function(e){t.workStationsList.find((function(t){return t.workstationId===e.workstationId}))||t.workStationsList.push(e)}))},add:function(e,t,r){this.edit({workOrderId:e,orderTaskId:t,formType:r,createType:r})},edit:function(e){var t=this;this.visible=!0,this.$nextTick((function(){t.$refs.breakdownForm.edit(e)}))},handleOk:function(){this.confirmLoading=!0,this.$refs.breakdownForm.save()},onSaveOk:function(){this.confirmLoading=!1,this.visible=!1,this.$message.success("保存成功"),this.$emit("ok")},onSaveFail:function(){this.$message.error("保存失败"),this.confirmLoading=!1},onSaveCancel:function(){this.confirmLoading=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.confirmLoading=!1,this.visible=!1}}},l=n,s=(r("7068"),r("2877")),c=Object(s["a"])(l,a,o,!1,null,"12e1d6e2",null);t["default"]=c.exports},b245:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"85%",title:"人员选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",bodyStyle:{height:"70vh"},destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{attrs:{md:4,sm:24}},[t("div",{staticStyle:{height:"calc(70vh - 20px)","border-right":"1px solid #e3e1e1","margin-right":"15px"}},[e.treeData&&e.treeData.length>0?t("a-tree",{staticClass:"limitHeight",attrs:{defaultSelectedKeys:[e.queryParam.depId],defaultExpandAll:!0,"tree-data":e.treeData},on:{select:e.onSelect}}):e._e()],1)]),t("a-col",{attrs:{md:20,sm:24}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"账号"}},[t("a-input",{attrs:{placeholder:"请输入用户账号"},model:{value:e.queryParam.username,callback:function(t){e.$set(e.queryParam,"username",t)},expression:"queryParam.username"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"真实名字"}},[t("a-input",{attrs:{placeholder:"请输入真实名字"},model:{value:e.queryParam.realname,callback:function(t){e.$set(e.queryParam,"realname",t)},expression:"queryParam.realname"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"手机号码"}},[t("a-input",{attrs:{placeholder:"请输入手机号码"},model:{value:e.queryParam.phone,callback:function(t){e.$set(e.queryParam,"phone",t)},expression:"queryParam.phone"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"角色"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"sys_role,role_name,id",placeholder:"选择角色"},model:{value:e.queryParam.roleId,callback:function(t){e.$set(e.queryParam,"roleId",t)},expression:"queryParam.roleId"}})],1)],1),t("a-col",{attrs:{md:2,sm:8}},[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(70vh - 130px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(70vh - 130px)"},attrs:{border:"",align:e.allAlign,data:e.tableData,"max-height":"100%","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"manual",mode:"row"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"5%"}}):t("vxe-table-column",{attrs:{type:"radio",width:"5%"}}),t("vxe-table-column",{attrs:{field:"workNo",title:"工号",width:"100",align:"center"}}),t("vxe-table-column",{attrs:{field:"username",title:"用户账号",width:"150",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"realname",title:"用户名字",width:"100",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"roleNames",title:"角色","min-width":"180",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"sex_dictText",title:"性别",width:"80"}}),t("vxe-table-column",{attrs:{field:"phone",title:"手机号码",width:"120"}}),t("vxe-table-column",{attrs:{field:"orgCode",title:"部门",width:"120",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"80"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)])],1)],1)},o=[],i=r("8fad"),n={name:"UserList",props:{multiple:{type:Boolean,default:!0},depId:{type:String,default:""}},data:function(){return{queryParam:{username:"",realname:"",phone:"",orgCode:"",roleId:void 0,pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,treeData:[]}},watch:{depId:function(e){this.$set(this.queryParam,"depId",e||"")}},mounted:function(){this.$set(this.queryParam,"depId",this.depId||"")},methods:{showModal:function(){this.visible=!0,this.findList(),this.getTreeList()},getTreeList:function(){var e=this;Object(i["pb"])().then((function(t){t.success&&(e.treeData=t.result)}))},onSelect:function(e,t){if(e.length){var r=t.node.dataRef;this.queryParam.depId=r.id,this.findList()}else this.queryParam.orgCode="",this.findList()},findList:function(){var e=this;this.loading=!0,Object(i["jc"])(this.queryParam).then((function(t){e.loading=!1,t.success?(e.totalResult=t.result.total,e.tableData=t.result.records):e.$message.error("加载用户数据失败")})).catch((function(t){e.$message.error("加载用户数据异常")})).finally((function(){}))},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,Object.assign(this.$data,this.$options.data())}}},l=n,s=(r("f76d"),r("2877")),c=Object(s["a"])(l,a,o,!1,null,"4aa7956f",null);t["default"]=c.exports},b9c3:function(e,t,r){"use strict";r.d(t,"lb",(function(){return n})),r.d(t,"f",(function(){return l})),r.d(t,"i",(function(){return s})),r.d(t,"v",(function(){return c})),r.d(t,"b",(function(){return f})),r.d(t,"l",(function(){return h})),r.d(t,"p",(function(){return m})),r.d(t,"G",(function(){return p})),r.d(t,"c",(function(){return d})),r.d(t,"B",(function(){return b})),r.d(t,"k",(function(){return v})),r.d(t,"A",(function(){return y})),r.d(t,"x",(function(){return k})),r.d(t,"g",(function(){return w})),r.d(t,"E",(function(){return x})),r.d(t,"C",(function(){return C})),r.d(t,"M",(function(){return S})),r.d(t,"kb",(function(){return T})),r.d(t,"O",(function(){return _})),r.d(t,"N",(function(){return N})),r.d(t,"jb",(function(){return P})),r.d(t,"t",(function(){return M})),r.d(t,"d",(function(){return $})),r.d(t,"W",(function(){return R})),r.d(t,"X",(function(){return D})),r.d(t,"e",(function(){return L})),r.d(t,"o",(function(){return q})),r.d(t,"V",(function(){return U})),r.d(t,"R",(function(){return E})),r.d(t,"Q",(function(){return z})),r.d(t,"K",(function(){return V})),r.d(t,"L",(function(){return W})),r.d(t,"fb",(function(){return be})),r.d(t,"bb",(function(){return H})),r.d(t,"Y",(function(){return Q})),r.d(t,"J",(function(){return K})),r.d(t,"hb",(function(){return ie})),r.d(t,"U",(function(){return ne})),r.d(t,"eb",(function(){return Z})),r.d(t,"cb",(function(){return X})),r.d(t,"a",(function(){return ee})),r.d(t,"j",(function(){return ue})),r.d(t,"nb",(function(){return de})),r.d(t,"gb",(function(){return fe})),r.d(t,"m",(function(){return he})),r.d(t,"H",(function(){return ye})),r.d(t,"T",(function(){return G})),r.d(t,"S",(function(){return F})),r.d(t,"mb",(function(){return A})),r.d(t,"z",(function(){return me})),r.d(t,"db",(function(){return pe})),r.d(t,"y",(function(){return ge})),r.d(t,"u",(function(){return u})),r.d(t,"F",(function(){return g})),r.d(t,"ob",(function(){return j})),r.d(t,"q",(function(){return O})),r.d(t,"D",(function(){return I})),r.d(t,"ib",(function(){return te})),r.d(t,"n",(function(){return re})),r.d(t,"I",(function(){return J})),r.d(t,"P",(function(){return B})),r.d(t,"s",(function(){return le})),r.d(t,"Z",(function(){return se})),r.d(t,"ab",(function(){return ce})),r.d(t,"h",(function(){return ae})),r.d(t,"w",(function(){return oe})),r.d(t,"r",(function(){return Y}));var a=r("0fea"),o=r("4328"),i=r.n(o),n=function(e){return Object(a["j"])("/group/fault/info/submit",e)},l=function(e){return Object(a["j"])("/group/fault/info/cancel",e)},s=function(e){return Object(a["j"])("/group/fault/info/delete",e)},c=function(e){return Object(a["d"])("/group/fault/info/page",e)},u=function(e){return Object(a["d"])("/group/fault/info/get",e)},d=function(e){return Object(a["j"])("/group/safeassume/read/add",e)},f=function(e){return Object(a["j"])("/group/safeassume/add",e)},h=function(e){return Object(a["j"])("/group/safeassume/delete",e)},m=function(e){return Object(a["j"])("/group/safeassume/edit",e)},p=function(e){return Object(a["d"])("/group/safeassume/page",e)},g=function(e){return Object(a["d"])("/group/safeassume/get",e)},b=function(e){return Object(a["d"])("/group/turnoverchange/page",e)},y=function(e){return Object(a["d"])("/material/spare-part/get",e)},v=function(e){return Object(a["j"])("/group/turnoverchange/delete",e)},k=function(e){return Object(a["d"])("/group/measurealert/page",e)},w=function(e){return Object(a["j"])("/group/measurealert/close",e)},x=function(e){return Object(a["d"])("/group/spare-part/page",e)},C=function(e){return Object(a["d"])("/group/spare-part/get",e)},I=function(e){return Object(a["d"])("/produce/train/history/asset/use/page",e)},S=function(e){return Object(a["d"])("/group/toolequipment/page",e)},T=function(e){return Object(a["j"])("/group/toolequipment/setStatus",e)},O=function(e){return Object(a["d"])("/group/toolequipment/usage",e)},_=function(e){return Object(a["d"])("/group/tool/page",e)},N=function(e){return Object(a["d"])("/group/tool/get",e)},P=function(e){return Object(a["j"])("/group/tool/setDutyUser",e)},j=function(e){return Object(a["d"])("/group/tool/usage",e)},M=function(e){return Object(a["d"])("/group/information/basic",e)},$=function(e){return Object(a["j"])("/group/information/tools/add",e)},R=function(e){return Object(a["d"])("/group/information/workstation/page-related",e)},D=function(e){return Object(a["d"])("/group/information/workstation/page-unrelated",e)},L=function(e){return Object(a["j"])("/group/information/workstation/add",e)},q=function(e){return Object(a["j"])("/group/information/workstation/delete",e)},F=function(e){return Object(a["d"])("/workGroup/workOrder/relevanceInfo/".concat(e))},A=function(e){return Object(a["j"])("/workGroup/workOrder/submit-to-dispatcher",i.a.stringify(e))},U=function(e){return Object(a["d"])("/workGroup/workRecord/list",e)},z=function(e){return Object(a["d"])("/serialPlan/plan/forms/online-form/get",e)},E=function(e){return Object(a["d"])("/serialPlan/plan/forms/work-record/get",e)},B=function(e){return Object(a["d"])("/serialPlan/plan/forms/check-record/get",e)},G=function(e){return Object(a["d"])("/workGroup/workOrder/page",e)},Y=function(e){return Object(a["d"])("/workGroup/workOrder/apply/page",e)},V=function(e){return Object(a["d"])("/workGroup/workRecord/recordForm",e)},W=function(e){return Object(a["d"])("/workGroup/workRecord/relevanceInfo/".concat(e))},J=function(e){return Object(a["d"])("/workGroup/workRecord/relevanceInfo/bookSteps/".concat(e))},H=function(e){return Object(a["j"])("/workGroup/workRecord/save/form-result",e)},Q=function(e){return Object(a["j"])("/workGroup/workRecord/check",e)},K=function(e){return Object(a["j"])("/workGroup/workRecord/getTaskQRCode",e)},Z=function(e){return Object(a["j"])("/workGroup/workRecord/work-record/save-manufNo",i.a.stringify(e))},X=function(e){return Object(a["j"])("/workGroup/workRecord/save/material",e)},ee=function(e){return Object(a["j"])("/workGroup/workRecord/save/actMaterial",e)},te=function(e){return Object(a["j"])("/workGroup/workRecord/save/work-time",e)},re=function(e){return Object(a["j"])("/workGroup/workRecord/arrange/delete",e)},ae=function(e){return Object(a["j"])("/workGroup/workOrder/material/commit-temp-apply",e)},oe=function(e){return Object(a["d"])("/workGroup/workOrder/material/apply/list",e)},ie=function(e){return Object(a["j"])("/workGroup/workRecord/check/saveExcelData",e)},ne=function(e){return Object(a["d"])("/workGroup/workRecord/get/excelData/".concat(e))},le=function(e){return Object(a["d"])("/serialPlan/plan/forms/check-record/item/list",e)},se=function(e){return Object(a["j"])("/workGroup/workRecord/check-record/set-check",e)},ce=function(e){return Object(a["j"])("/workGroup/workRecord/check-record/set-time",e)},ue=function(e){return Object(a["j"])("/workGroup/workRecord/delete/material",i.a.stringify(e))},de=function(e){return Object(a["j"])("/workGroup/workRecord/submit-task",e)},fe=function(e){return Object(a["j"])("/workGroup/workRecord/save/tool",e)},he=function(e){return Object(a["j"])("/workGroup/workRecord/delete/tool",i.a.stringify(e))},me=function(e){return Object(a["d"])("/workGroup/workRecord/outsourceOutin",e)},pe=function(e){return Object(a["j"])("/workGroup/workRecord/save/outsourceOutin",e)},ge=function(e){return Object(a["d"])("/workGroup/workRecord/outin/not-returns",e)},be=function(e){return Object(a["j"])("/group/safeassume/read/add",i.a.stringify(e))},ye=function(e){return Object(a["d"])("/serialPlan/plan/page",e)}},c95b:function(e,t,r){},cc0c:function(e,t,r){"use strict";r("cdfd")},ccb3:function(e,t,r){},cdfd:function(e,t,r){},d0ca:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{height:"calc(100% - 0px)","overflow-y":"auto"}},[t("a-form-model",{ref:"form",staticStyle:{"margin-top":"10px"},attrs:{model:e.faultModel,rules:e.formRules}},[t("div",{staticClass:"info-wrapper info-top-wrapper"},[t("h4",[e._v("故障信息")]),t("a-row",[t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"列计划",prop:"planName"}},[t("div",{on:{click:e.openPlanModel}},[t("a-select",{ref:"myPlanSelect",attrs:{"allow-clear":"",placeholder:"请选择列计划",open:!1,showArrow:!0,triggerChange:!0},on:{change:e.changePlanSelect},model:{value:e.faultModel.planName,callback:function(t){e.$set(e.faultModel,"planName",t)},expression:"faultModel.planName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)])],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"线路",prop:"lineId"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"bu_mtr_line,line_name,line_id"},on:{change:e.changeLine},model:{value:e.faultModel.lineId,callback:function(t){e.$set(e.faultModel,"lineId",t)},expression:"faultModel.lineId"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"车辆",prop:"trainNo"}},[t("j-dict-select-seach-tag",{attrs:{triggerChange:!0,dictCode:e.dictTrainStr},on:{focus:e.handleSysFocus,change:e.handleTrainNo},model:{value:e.faultModel.trainNo,callback:function(t){e.$set(e.faultModel,"trainNo",t)},expression:"faultModel.trainNo"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"发现阶段",prop:"phase"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"bu_fault_phase"},model:{value:e.faultModel.phase,callback:function(t){e.$set(e.faultModel,"phase",t)},expression:"faultModel.phase"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"发现时间",prop:"happenTime"}},[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD HH:mm","show-time":{format:"HH:mm",hideDisabledOptions:!0}},on:{change:function(t){e.faultModel.reportTime=void 0,e.handleModel.solutionTime=void 0,e.faultModel.solutionTime=void 0,e.reportTimeKey++,e.solutionTimeKey++}},model:{value:e.faultModel.happenTime,callback:function(t){e.$set(e.faultModel,"happenTime",t)},expression:"faultModel.happenTime"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"故障工位",prop:"workStationName"}},[t("a-select",{ref:"workStationSelect",attrs:{placeholder:"请选择故障工位",open:!1,showArrow:!0},on:{focus:function(t){return e.openSelectTypeModal(5)}},model:{value:e.faultModel.workStationName,callback:function(t){e.$set(e.faultModel,"workStationName",t)},expression:"faultModel.workStationName"}},[t("div",{attrs:{slot:"suffixIcon"},slot:"suffixIcon"},[e.faultModel.workStationName?t("a-icon",{staticStyle:{"padding-right":"3px"},attrs:{type:"close-circle"},on:{click:function(t){return t.stopPropagation(),e.clearValue(5)}}}):e._e(),t("a-icon",{attrs:{type:"ellipsis"}})],1)])],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"系统",prop:"sysId"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,"dict-code":e.dictTrainSys},on:{change:e.changeLinesubsys,focus:e.handleSysFocus},model:{value:e.faultModel.sysId,callback:function(t){e.$set(e.faultModel,"sysId",t)},expression:"faultModel.sysId"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"故障部件",prop:"faultAssetName"}},[t("a-select",{ref:"faultAssetSelect",attrs:{placeholder:"请选择",open:!1,showArrow:!0},on:{focus:e.showAssetModal},model:{value:e.faultModel.faultAssetName,callback:function(t){e.$set(e.faultModel,"faultAssetName",t)},expression:"faultModel.faultAssetName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol2,wrapperCol:e.wrapperCol2,label:"故障描述",prop:"faultDesc"}},[t("a-textarea",{attrs:{placeholder:"请输入内容"},model:{value:e.faultModel.faultDesc,callback:function(t){e.$set(e.faultModel,"faultDesc",t)},expression:"faultModel.faultDesc"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:{span:6},wrapperCol:{span:18},label:"其他属性"}},[t("a-row",[t("a-col",{attrs:{span:8}},[e._v(" 是否正线: "),t("a-switch",{model:{value:e.faultModel.faultOnline,callback:function(t){e.$set(e.faultModel,"faultOnline",t)},expression:"faultModel.faultOnline"}})],1),t("a-col",{attrs:{span:8}},[e._v(" 是否委外: "),t("a-switch",{model:{value:e.faultModel.outsource,callback:function(t){e.$set(e.faultModel,"outsource",t)},expression:"faultModel.outsource"}})],1)],1)],1)],1),e.faultModel.outsource?t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属厂商",prop:"outSupplierName"}},[t("a-select",{ref:"mySupplierSelect",attrs:{placeholder:"请选择厂商",triggerChange:!0,open:!1,showArrow:!0},on:{focus:e.openSupplierModal},model:{value:e.faultModel.outSupplierName,callback:function(t){e.$set(e.faultModel,"outSupplierName",t)},expression:"faultModel.outSupplierName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1):e._e()],1)],1),t("div",{staticClass:"info-wrapper info-top-wrapper"},[t("h4",[e._v("提报信息")]),t("a-row",[t("a-col",{attrs:{span:8}},[t("a-form-model-item",{ref:"reportGroupTag",attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"提报班组",prop:"reportGroupId"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:e.dictGroupStr},model:{value:e.faultModel.reportGroupId,callback:function(t){e.$set(e.faultModel,"reportGroupId",t)},expression:"faultModel.reportGroupId"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"提报人员",prop:"reportUserId"}},[t("a-select",{ref:"tmyuserSelect1",attrs:{placeholder:"请选择人员",open:!1},on:{focus:function(t){return e.showUserModal(1)}},model:{value:e.faultModel.reportUserName,callback:function(t){e.$set(e.faultModel,"reportUserName",t)},expression:"faultModel.reportUserName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},on:{click:function(t){return e.showUserModal(1)}},slot:"suffixIcon"})],1)],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"责任工程师",prop:"dutyEngineer"}},[t("a-select",{ref:"tmyuserSelect2",attrs:{placeholder:"请选择责任工程师",open:!1,showArrow:!0},on:{focus:function(t){return e.showUserModal(2)}},model:{value:e.faultModel.dutyEngineerName,callback:function(t){e.$set(e.faultModel,"dutyEngineerName",t)},expression:"faultModel.dutyEngineerName"}},[t("div",{attrs:{slot:"suffixIcon"},slot:"suffixIcon"},[e.faultModel.dutyEngineerName?t("a-icon",{staticStyle:{"padding-right":"3px"},attrs:{type:"close-circle"},on:{click:function(t){return t.stopPropagation(),e.clearValue(6)}}}):e._e(),t("a-icon",{attrs:{type:"ellipsis"}})],1)])],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{key:"reportTime"+e.reportTimeKey,attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"提报时间",prop:"reportTime"}},[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{disabledDate:e.dateTimeDisabled1,disabledTime:e.disabledDateTime1,format:"YYYY-MM-DD HH:mm","show-time":!!e.faultModel.happenTime&&{format:"HH:mm",hideDisabledOptions:!0}},on:{change:function(t){e.handleModel.solutionTime=void 0,e.faultModel.solutionTime=void 0,e.solutionTimeKey++}},model:{value:e.faultModel.reportTime,callback:function(t){e.$set(e.faultModel,"reportTime",t)},expression:"faultModel.reportTime"}})],1)],1)],1)],1),t("div",{staticClass:"info-wrapper info-top-wrapper"},[t("h4",[e._v("处理信息")]),t("a-row",[t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"处理状态",prop:"status"}},[t("a-radio-group",{attrs:{name:"radioGroup",disabled:e.fromWriteReport},on:{change:e.changeFaultStatus},model:{value:e.faultModel.status,callback:function(t){e.$set(e.faultModel,"status",t)},expression:"faultModel.status"}},[t("a-radio",{attrs:{value:0}},[e._v(" 未处理")]),t("a-radio",{attrs:{value:1}},[e._v(" 已处理")]),t("a-radio",{attrs:{value:3}},[e._v(" 遗留故障")])],1)],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"故障代码",prop:"faultCodeId"}},[t("a-select",{ref:"faultCodeIdSelect",attrs:{placeholder:"请选择所属故障代码",open:!1,showArrow:!0},on:{focus:function(t){return e.openSelectTypeModal(2)}},model:{value:e.faultModel.faultCodeCodeDes,callback:function(t){e.$set(e.faultModel,"faultCodeCodeDes",t)},expression:"faultModel.faultCodeCodeDes"}},[t("div",{attrs:{slot:"suffixIcon"},slot:"suffixIcon"},[e.faultModel.faultCodeId?t("a-icon",{staticStyle:{"padding-right":"3px"},attrs:{type:"close-circle"},on:{click:function(t){return t.stopPropagation(),e.clearValue(2)}}}):e._e(),t("a-icon",{attrs:{type:"ellipsis"}})],1)])],1)],1),e.faultModel.status>0&&4!==e.faultModel.status?t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"故障等级",prop:"faultLevel"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"bu_fault_level"},model:{value:e.faultModel.faultLevel,callback:function(t){e.$set(e.faultModel,"faultLevel",t)},expression:"faultModel.faultLevel"}})],1)],1):e._e()],1),e.faultModel.status>0&&4!==e.faultModel.status?t("a-row",[t("a-col",{directives:[{name:"show",rawName:"v-show",value:e.faultModel.faultCodeId,expression:"faultModel.faultCodeId"}],attrs:{span:24}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol2,wrapperCol:e.wrapperCol2,label:"代码详情"}},[e.getFaultdetailLoading?t("a-icon",{attrs:{type:"loading"}}):t("a-space",[e._l(e.getFaultdetailList,(function(r,a){return t("span",{key:a,staticStyle:{color:"#c1c1c1"}},[e._v("故障"+e._s(r.fltLevel_dictText)+"："+e._s(r.fltCode)+"-"+e._s(r.fltName)+"；")])})),t("span",{staticStyle:{color:"#c1c1c1"}},[e._v("故障部件："+e._s(e.faultModel.faultCodeCode)+"-"+e._s(e.faultModel.faultCodeCodeDes)+"；")])],2)],1)],1)],1):e._e(),e.faultModel.status>0&&4!==e.faultModel.status?t("a-row",[t("a-col",{attrs:{span:8}},[t("a-form-model-item",{key:"solutionTime"+e.solutionTimeKey+e.reportTimeKey,attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"处理时间",prop:"solutionTime"}},[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{disabledDate:e.dateTimeDisabled2,disabledTime:e.disabledDateTime2,format:"YYYY-MM-DD HH:mm","show-time":!!e.faultModel.reportTime&&{format:"HH:mm",hideDisabledOptions:!0}},on:{change:e.datePickerChange},model:{value:e.handleModel.solutionTime,callback:function(t){e.$set(e.handleModel,"solutionTime",t)},expression:"handleModel.solutionTime"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"原因描述",prop:"reasonDesc"}},[t("a-textarea",{attrs:{placeholder:"请输入内容"},model:{value:e.faultModel.reasonDesc,callback:function(t){e.$set(e.faultModel,"reasonDesc",t)},expression:"faultModel.reasonDesc"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"措施描述",prop:"solutionDesc"}},[t("a-textarea",{attrs:{placeholder:"请输入内容"},model:{value:e.faultModel.solutionDesc,callback:function(t){e.$set(e.faultModel,"solutionDesc",t)},expression:"faultModel.solutionDesc"}})],1)],1)],1):e._e(),e.faultModel.status>0&&4!==e.faultModel.status?t("a-row",[t("a-col",{attrs:{span:8}},[e.faultModel.status>0&&4!==e.faultModel.status?t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"处理结果",prop:"handleStatus"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"bu_handlestatus"},model:{value:e.faultModel.handleStatus,callback:function(t){e.$set(e.faultModel,"handleStatus",t)},expression:"faultModel.handleStatus"}})],1):e._e()],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"处理班组",prop:"solutionGroupId"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:e.dictGroupStr},model:{value:e.faultModel.solutionGroupId,callback:function(t){e.$set(e.faultModel,"solutionGroupId",t)},expression:"faultModel.solutionGroupId"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"处理人员",prop:"solutionUserId"}},[t("a-select",{ref:"tmyuserSelect3",attrs:{placeholder:"请选择处理人员",open:!1},on:{focus:function(t){return e.showUserModal(3)}},model:{value:e.handleModel.solutionUserName,callback:function(t){e.$set(e.handleModel,"solutionUserName",t)},expression:"handleModel.solutionUserName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1)],1):e._e()],1),t("div",{staticClass:"clearfix"},[t("a-row",[t("a-col",{attrs:{span:12}},[t("DocUpload",{ref:"upload",attrs:{"default-file-list":e.defaultFileList,"show-upload":!1,isFileEmpty:!0},on:{uploaded:e.successUploadFile,removed:e.onRemoveFile,uploadFail:e.uploadFail}})],1)],1),t("a-row",[t("a-divider",{staticStyle:{"font-size":"14px"},attrs:{orientation:"left"}},[e._v("已上传列表")]),t("vxe-table",{staticStyle:{"margin-top":"12px"},attrs:{data:e.annexList,"show-overflow":"tooltip","show-header":!1,"edit-config":{trigger:"manual",mode:"row"}}},[t("div",{}),t("vxe-table-column",{attrs:{type:"index",title:"序号",width:"50px","header-align":"center",align:"center"}}),t("vxe-table-column",{attrs:{field:"name",title:"文件名","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"annexType_dictText",title:"附件类型",width:"120px","header-align":"center",align:"center"}}),t("vxe-table-column",{attrs:{title:"操作",width:"160px","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.row,o=r.rowIndex;return[t("a",{staticStyle:{"margin-right":"12px"},on:{click:function(t){return t.stopPropagation(),e.handleSeeing(a)}}},[e._v("查看")]),t("a",{on:{click:function(t){return t.stopPropagation(),e.handleDelete(a,o)}}},[e._v("删除")])]}}])})],1)],1)],1)]),t("train-plan-list",{ref:"planModalForm",on:{ok:e.onSelectPlan}}),t("doc-preview-modal",{ref:"docPreview",attrs:{title:e.fileName}}),t("user-list",{ref:"tUserModalForm",attrs:{"dep-id":1===e.userSelectType?e.faultModel.reportGroupId:3===e.userSelectType?e.faultModel.solutionGroupId:"",multiple:!1},on:{ok:e.onUserSelect}}),t("fault-category-list",{ref:"categorySelect",attrs:{multiple:!1},on:{ok:e.addCategoryTarget}}),t("fault-code-list",{ref:"codeSelect",attrs:{type:"unit",multiple:!1},on:{ok:e.addCategoryTarget}}),t("fault-reason-list",{ref:"reasonSelect",attrs:{multiple:!1},on:{ok:e.addCategoryTarget}}),t("fault-solution-list",{ref:"solutionSelect",attrs:{multiple:!1},on:{ok:e.addCategoryTarget}}),t("work-station-list",{ref:"stationSelectModal",on:{ok:e.onSelectStation}}),t("CarDeviceSelectNew",{ref:"assetSelect",attrs:{canSelectType:[3,4],trainNo:e.faultModel.trainNo,lineId:e.faultModel.lineId,multiple:!1},on:{ok:e.addFaultAsset}}),t("supplier-list",{ref:"supplierModal",attrs:{multiple:!1},on:{ok:e.supplierSelect}})],1)},o=[],i=r("c1df"),n=r.n(i),l=r("8fad"),s=r("b245"),c=r("b47d"),u=r("ca00"),d=r("5371"),f=r("a396"),h=r("0e7b"),m=r("6034"),p=r("3cb5"),g=r("769e"),b=r("1158"),y=r("353a"),v=r("310d"),k=r("60e2"),w=r("2f62");function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function C(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,a,o,i){var s=a&&a.prototype instanceof l?a:l,c=Object.create(s.prototype);return I(c,"_invoke",function(r,a,o){var i,l,s,c=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,r){return i=t,l=0,s=e,f.n=r,n}};function h(r,a){for(l=r,s=a,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=f.p,m=i[2];r>3?(o=m===a)&&(s=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=r<2&&h<i[1])?(l=0,f.v=a,f.n=i[1]):h<m&&(o=r<3||i[0]>a||a>m)&&(i[4]=r,i[5]=a,f.n=m,l=0))}if(o||r>1)return n;throw d=!0,a}return function(o,u,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,m),l=u,s=m;(t=l<2?e:s)||!d;){i||(l?l<3?(l>1&&(f.n=-1),h(l,s)):f.n=s:f.v=s);try{if(c=2,i){if(l||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,l<2&&(l=0)}else 1===l&&(t=i.return)&&t.call(i),l<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),l=1);i=e}else if((t=(d=f.n<0)?s:r.call(a,f))!==n)break}catch(t){i=e,l=1,s=t}finally{c=1}}return{value:t,done:d}}}(r,o,i),!0),c}var n={};function l(){}function s(){}function c(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(I(t={},a,(function(){return this})),t),d=c.prototype=l.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,I(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=c,I(d,"constructor",c),I(c,"constructor",s),s.displayName="GeneratorFunction",I(c,o,"GeneratorFunction"),I(d),I(d,o,"Generator"),I(d,a,(function(){return this})),I(d,"toString",(function(){return"[object Generator]"})),(C=function(){return{w:i,m:f}})()}function I(e,t,r,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}I=function(e,t,r,a){function i(t,r){I(e,t,(function(e){return this._invoke(t,r,e)}))}t?o?o(e,t,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[t]=r:(i("next",0),i("throw",1),i("return",2))},I(e,t,r,a)}function S(e,t,r,a,o,i,n){try{var l=e[i](n),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(a,o)}function T(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var i=e.apply(t,r);function n(e){S(i,a,o,n,l,"next",e)}function l(e){S(i,a,o,n,l,"throw",e)}n(void 0)}))}}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){N(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function N(e,t,r){return(t=P(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e){var t=j(e,"string");return"symbol"==x(t)?t:t+""}function j(e,t){if("object"!=x(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=x(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var M={name:"BreakdownFormItem",components:{UserList:s["default"],DocUpload:d["default"],FaultCategoryList:f["default"],FaultCodeList:h["default"],FaultReasonList:m["default"],FaultSolutionList:p["default"],SupplierList:g["default"],DocPreviewModal:y["default"],WorkStationList:b["default"],CarDeviceSelectNew:v["default"],TrainPlanList:k["default"]},props:{workStationsList:{type:Array,default:function(){return[]}},fromWriteReport:{type:Boolean,default:!1}},data:function(){return{getFaultdetailLoading:!1,getFaultdetailList:[],solutionTimeKey:0,reportTimeKey:0,dictGroupStr:"bu_mtr_workshop_group,group_name,id,workshop_id='"+this.$store.getters.userInfo.workshopId+"'|workshop_id",defaultFileList:[],annexList:[],fileList:[],filePath:"",fileName:"",status:!1,saveFlag:!0,uploading:!1,value:1,faultModel:{planName:void 0,planId:void 0,reportTime:void 0,happenTime:void 0,solutionTime:void 0,reasonDesc:void 0,solutionDesc:void 0,workStationName:void 0},handleModel:{solutionTime:void 0},labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}},labelCol2:{xs:{span:24},sm:{span:2}},wrapperCol2:{xs:{span:24},sm:{span:21}},labelCol3:{xs:{span:24},sm:{span:13}},wrapperCol3:{xs:{span:24},sm:{span:11}},userSelectType:1,dictTrainStr:"",dictCodefaultcode:"bu_fault_code,fault_code,id",dictCodesubsys:"",dictTrainSys:"",confirmLoading:!1,trainStructId:"",faultCodeLevelList:[],formRules:{faultSn:[],categoryId:[{required:!1,message:"请选择故障分类!",trigger:"change"}],faultCodeId:[{required:!0,message:"请选择故障代码!",trigger:"change"}],faultLevel:[{required:!0,message:"请选择故障等级!",trigger:"change"}],workStationName:[{required:!1,message:"请选择故障工位!",trigger:"change"}],happenTime:[{required:!0,message:"请选择故障发现时间!"}],lineId:[{required:!0,message:"请选择所属线路!",trigger:"change"}],trainNo:[{required:!0,message:"请选择车辆!",trigger:"change"}],sysId:[{required:!0,message:"请选择所属系统!",trigger:"change"}],faultAssetName:[{required:!0,message:"请选择部件!",trigger:"change"}],faultDesc:[{required:!0,message:"请填写故障描述!",trigger:"change"},{max:249,message:"输入长度不能超过249字符!"}],phase:[{required:!0,message:"请选择发现阶段!"}],outSupplierName:[{required:!0,message:"请选择厂商!",trigger:"change"}],planName:[{required:!0,message:"请选择列计划!",trigger:"change"}],faultOnline:[],hasDuty:[],outsource:[],reportGroupId:[{required:!0,message:"请选择提报班组!",trigger:"change"}],reportUserId:[{required:!0,message:"请选择提报人员",trigger:"change"}],dutyEngineer:[],status:[],closeTime:[],handleStatus:[{required:!0,message:"请选择处理结果!",trigger:"change"}],faultReasonId:[{required:!0,message:"请选择故障原因!",trigger:"change"}],faultSolutionId:[{required:!0,message:"请选择处理措施!",trigger:"change"}],reasonDesc:[{required:!0,message:"请输入原因描述!",trigger:"change"},{max:249,message:"输入长度不能超过249字符!"}],solutionDesc:[{required:!0,message:"请输入措施描述!",trigger:"change"},{max:249,message:"输入长度不能超过249字符!"}],reportTime:[{required:!0,message:"请选择提报时间!",trigger:"change"}],solutionTime:[{required:!0,message:"请选择故障处理时间!",trigger:"change"}],solutionGroupId:[{required:!0,message:"请选择处理班组!",trigger:"change"}],solutionUserId:[{required:!0,message:"请选择处理人员!",trigger:"change"}],closeUserId:[]},reason:{categoryId:"",faultCodeId:""},solution:{categoryId:"",faultCodeId:"",faultReasonId:""},reasonList:[],solutionList:[],faultId:"",formType:"",faultType:"",assetTypeData:[],isWriteSave:!1}},computed:_({},Object(w["d"])(["user"])),created:function(){this.fromWriteReport&&(this.formRules.categoryId[0].required=!0,this.formRules.faultCodeId[0].required=!0,this.formRules.faultLevel[0].required=!0,this.formRules.workStationName[0].required=!0)},methods:{onSelectPlan:function(e){this.faultModel.planName=e[0].planName,this.faultModel.planId=e[0].id,this.faultModel.lineId=e[0].lineId,this.faultModel.trainNo=e[0].trainNo,this.changeLine(e[0].lineId),this.$refs.form.validateField("planName"),this.$refs.form.validateField("lineId"),this.$refs.form.validateField("trainNo")},changePlanSelect:function(e){e||(this.faultModel.planName="",this.faultModel.planId="",this.$refs.form.validateField("planName"))},openPlanModel:function(){this.$refs.planModalForm.showModal()},getFaultCodeLevel:function(e){var t=this;Object(c["ab"])({id:e}).then((function(e){e.success&&e.result&&t.$set(t.faultModel,"faultLevel",e.result.levelValue)}))},getFaultdetail:function(e){var t=this;this.getFaultdetailLoading=!0,Object(c["db"])({code:e}).then((function(e){e.success&&e.result.length&&(t.getFaultdetailList=e.result.filter((function(e){return 0!==e.fltLevel&&3!==e.fltLevel}))),t.getFaultdetailLoading=!1})).catch((function(e){t.getFaultdetailLoading=!1}))},range:function(e,t){for(var r=[],a=e;a<t;a++)r.push(a);return r},dateTimeDisabled1:function(e){var t=n()(this.faultModel.happenTime).format("YYYY-MM-DD");return!this.faultModel.happenTime||e<=n()(t)},dateTimeDisabled2:function(e){var t=n()(this.faultModel.reportTime).format("YYYY-MM-DD");return!this.faultModel.reportTime||e<=n()(t)},disabledDateTime1:function(){var e,t,r=this,a=n()(this.faultModel.happenTime),o=n()(this.faultModel.reportTime);return a.format("YYYY-MM-DD")!==o.format("YYYY-MM-DD")?(e=0,t=0):(e=this.faultModel.happenTime?n()(a).get("hours"):0,t=this.faultModel.happenTime?n()(a).get("minutes")+1:0),{disabledHours:function(){return r.range(0,e)},disabledMinutes:function(){return r.range(0,t)}}},disabledDateTime2:function(){var e,t,r=this,a=n()(this.faultModel.reportTime),o=n()(this.handleModel.solutionTime);return a.format("YYYY-MM-DD")!==o.format("YYYY-MM-DD")?(e=0,t=0):(e=this.faultModel.reportTime?n()(a).get("hours"):0,t=this.faultModel.reportTime?n()(a).get("minutes")+1:0),{disabledHours:function(){return r.range(0,e)},disabledMinutes:function(){return r.range(0,t)}}},handleSysFocus:function(){this.faultModel.lineId||this.$message.warn("请先选择线路!")},handleAssetFocus:function(){this.faultModel.trainNo||this.$message.warn("请先选择车辆!")},handleTrainNo:function(e,t){t.extFields&&(this.trainStructId=t.extFields[0].train_struct_id)},showAssetModal:function(){this.faultModel.trainNo?(this.$refs.assetSelect.showModal(),this.$refs.faultAssetSelect.blur()):this.$message.warn("请先选择车辆!")},openSelectTypeModal:function(e){switch(this.faultType=e,e){case 1:this.$refs.categorySelect.showModal(),this.$refs.categoryIdSelect.blur();break;case 2:this.$refs.codeSelect.showModal(),this.$refs.faultCodeIdSelect.blur();break;case 3:this.$refs.reasonSelect.showModal(),this.$refs.faultReasonIdSelect.blur();break;case 4:this.$refs.solutionSelect.showModal(),this.$refs.faultSolutionIdSelect.blur();break;case 5:this.$refs.stationSelectModal.showModal(),this.$refs.workStationSelect.blur();break}},addFaultAsset:function(e){Object(u["e"])(e)||(this.faultModel.trainStructureId=e[0].structDetailId,this.faultModel.faultAssetName=e[0].assetName,this.faultModel.faultAssetId=e[0].id,this.$refs.form.validateField("faultAssetName"))},addCategoryTarget:function(e){e.length&&(1===this.faultType&&(this.faultModel.categoryId=e[0].id,this.faultModel.categoryCode=e[0].categoryCode,this.faultModel.categoryCodeDes=e[0].categoryDesc,this.faultModel.faultLevel&&(this.faultModel.faultLevel=""),this.$refs.form.validateField("categoryId")),2===this.faultType&&(this.faultModel.faultCodeId=e[0].id,this.faultModel.faultCodeCode=e[0].fltCode,this.faultModel.faultCodeCodeDes=e[0].fltName,this.faultModel.faultLevel&&(this.faultModel.faultLevel=""),this.$refs.form.validateField("faultCodeId"),this.getFaultCodeLevel(this.faultModel.faultCodeId),this.getFaultdetail(this.faultModel.faultCodeId)),3===this.faultType&&(this.faultModel.faultReasonId=e[0].id,this.faultModel.faultReasonCode=e[0].reasonCode,this.$set(this.faultModel,"reasonDesc",e[0].reasonDesc),this.$refs.form.validateField("faultReasonId"),this.$refs.form.validateField("reasonDesc")),4===this.faultType&&(this.faultModel.faultSolutionId=e[0].id,this.faultModel.faultSolutionCode=e[0].solutionCode,this.$set(this.faultModel,"solutionDesc",e[0].solutionDesc),this.$refs.form.validateField("faultSolutionId"),this.$refs.form.validateField("solutionDesc")))},clearValue:function(e){1===e&&(this.faultModel.categoryId="",this.faultModel.categoryCode="",this.faultModel.categoryCodeDes=""),2===e&&(this.faultModel.faultCodeId="",this.faultModel.faultCodeCode="",this.faultModel.faultCodeCodeDes=""),5===e&&(this.faultModel.workStationId="",this.faultModel.workStationName=""),6===e&&(this.faultModel.dutyEngineerName="",this.faultModel.dutyEngineer="")},successUploadFile:function(e){var t=this;e.map((function(e){Object.assign(e,{id:Object(u["p"])()})})),e&&e.length>0?(e.map((function(e){var r={annexType:1,fileId:e.id,type:e.type,fileSize:e.fileSize,name:e.name,savepath:e.savepath};t.annexList.push(r)})),this.saveFaultInfo()):this.saveFaultInfo()},saveFaultInfo:function(){var e=this,t=Object.assign({},this.faultModel,{happenTime:n()(this.faultModel.happenTime).format("YYYY-MM-DD HH:mm:ss"),reportTime:n()(this.faultModel.reportTime).format("YYYY-MM-DD HH:mm:ss"),closeTime:this.faultModel.closeTime?n()(this.faultModel.closeTime).format("YYYY-MM-DD HH:mm:ss"):null,faultOnline:this.faultModel.faultOnline?1:0,hasDuty:0,outsource:this.faultModel.outsource?1:0});this.handleModel.solutionTime=n()(this.handleModel.solutionTime).format("YYYY-MM-DD HH:mm:ss"),t.status>0&&4!==t.status?t.handleRecordList=[Object.assign({},this.handleModel,{faultReasonId:this.faultModel.faultReasonId,faultSolutionId:this.faultModel.faultSolutionId,reasonDesc:this.faultModel.reasonDesc,solutionDesc:this.faultModel.solutionDesc,solutionGroupId:this.faultModel.solutionGroupId})]:t.handleRecordList=[];var r=null;t["annexList"]=this.annexList,this.faultModel.id?r=Object(c["F"])(t):(t["id"]=this.faultId,r=Object(c["b"])(t)),r.then((function(t){t.success?(e.isWriteSave=!0,e.$emit("ok")):e.$emit("fail")})).catch((function(t){e.$emit("fail")})).finally((function(){}))},setBforeUploadStatus:function(e){this.saveFlag=e},setUpLoadingEndStatus:function(e){this.saveFlag=e},uploadFail:function(e){this.$emit("fail")},onRemoveFile:function(e){},beginUpload:function(){this.confirmLoading=!0,this.$refs.upload.beginUpload()},handlePrivilege:function(){var e=T(C().m((function e(t,r){var a,o=this;return C().w((function(e){while(1)switch(e.n){case 0:return a={id:t,operation:r},e.n=1,Object(l["xc"])(a).then((function(e){o.status=e.result}));case 1:return e.a(2)}}),e)})));function t(t,r){return e.apply(this,arguments)}return t}(),handleSeeing:function(){var e=T(C().m((function e(t){return C().w((function(e){while(1)switch(e.n){case 0:this.fileName=t.name,this.$refs.docPreview.handleFilePath(t.savepath);case 1:return e.a(2)}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleDelete:function(){var e=T(C().m((function e(t,r){var a;return C().w((function(e){while(1)switch(e.n){case 0:a=this,a.$confirm({title:"提示",content:"确定删除该条附件吗？",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){a.annexList.splice(r,1)},onCancel:function(){}});case 1:return e.a(2)}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}(),add:function(e,t,r){this.edit({workOrderId:e,orderTaskId:t,formType:r,createType:r})},edit:function(e){var t={faultOnline:!1,hasDuty:!1,outsource:!1,status:0,reportUserName:"",reportUserId:"",dutyEngineer:"",dutyEngineerName:"",closeUserId:"",closeUserName:"",categoryId:"",categoryCode:"",categoryCodeDes:"",faultCodeId:"",faultCodeCode:"",faultReasonId:"",faultReasonCode:"",faultSolutionId:"",faultSolutionCode:"",solutionUserId:"",solutionUserName:"",faultAssetId:"",reportGroupId:"",outSupplierId:"",outSupplierName:"",sysId:"",subSysId:"",trainNo:"",lineId:"",faultAssetName:"",trainStructureId:"",happenTime:"",workStationId:"",workStationName:"",solutionTime:"",solutionGroupId:"",solutionDesc:"",reasonDesc:"",reportTime:"",planName:"",planId:""};e.workStationName=e.workstationName,this.faultModel=Object.assign(t,e),this.faultModel.categoryCode&&(this.isWriteSave=!0),this.faultModel.reportTime&&(this.faultModel.reportTime=this.$moment(this.faultModel.reportTime)),this.faultModel.faultCodeId&&this.getFaultdetail(this.faultModel.faultCodeId),this.faultModel.happenTime&&(this.faultModel.happenTime=this.$moment(this.faultModel.happenTime)),Object(u["e"])(this.faultModel.handleRecordList)||(this.handleModel=this.faultModel.handleRecordList[0],this.faultModel=Object.assign(this.faultModel,{faultReasonId:this.handleModel.faultReasonId,faultSolutionId:this.handleModel.faultSolutionId,reasonDesc:this.handleModel.reasonDesc,solutionDesc:this.handleModel.solutionDesc,solutionGroupId:this.handleModel.solutionGroupId,faultSolutionCode:this.handleModel.faultSolutionCode,faultReasonCode:this.handleModel.faultReasonCode,solutionUserId:this.handleModel.solutionUserId,solutionUserName:this.handleModel.solutionUserName,solutionTime:this.handleModel.solutionTime})),Object(u["e"])(e)||(this.faultModel=Object.assign(this.faultModel,{faultOnline:1===e.faultOnline,hasDuty:1===e.hasDuty,outsource:1===e.outsource}),e.annexList&&(this.annexList=e.annexList)),2===e.formType&&(""===this.faultModel.reportUserName&&""===this.faultModel.reportUserId&&this.$store.getters.userInfo.departIsGroup&&(this.faultModel.reportUserName=this.$store.getters.userInfo.realname,this.faultModel.reportUserId=this.$store.getters.userInfo.id),Object(u["e"])(this.faultModel.reportGroupId)&&this.$store.getters.userInfo.departIsGroup&&this.$set(this.faultModel,"reportGroupId",this.$store.getters.userInfo.departId)),this.workStationsList.length>0&&(this.faultModel.workStationId=this.workStationsList[0].workstationId,this.faultModel.workStationName=this.workStationsList[0].workstationName),this.formType=e.formType,this.faultModel.submitStatus||(this.faultModel.submitStatus=1===this.formType?1:0),this.changeFaultStatus()},handleChange:function(e){var t=e.file;t.status},changeFaultStatus:function(){(2===this.formType&&0!==this.faultModel.status||this.fromWriteReport)&&(this.faultModel.solutionGroupId&&""!==this.faultModel.solutionGroupId||!this.$store.getters.userInfo.departIsGroup||(this.faultModel.solutionGroupId=this.$store.getters.userInfo.departId),this.handleModel.solutionUserId&&this.faultModel.solutionUserName||!this.$store.getters.userInfo.departIsGroup||(this.faultModel.solutionUserName=this.$store.getters.userInfo.realname,this.faultModel.solutionUserId=this.$store.getters.userInfo.id,this.handleModel.solutionUserName=this.$store.getters.userInfo.realname,this.handleModel.solutionUserId=this.$store.getters.userInfo.id))},changeClose:function(e){this.isClose=e},showUserModal:function(e){switch(this.userSelectType=e,this.$refs.tUserModalForm.showModal(),e){case 1:this.$refs.tmyuserSelect1.blur();break;case 2:this.$refs.tmyuserSelect2.blur();break;case 3:this.$refs.tmyuserSelect3.blur();break;case 4:this.$refs.tmyuserSelect4.blur();break}},onUserSelect:function(e){e.length&&(1===this.userSelectType&&(this.faultModel.reportUserName=e[0].realname,this.faultModel.reportUserId=e[0].id,this.$refs.form.validateField("reportUserId")),2===this.userSelectType&&(this.faultModel.dutyEngineerName=e[0].realname,this.faultModel.dutyEngineer=e[0].id,this.$refs.form.validateField("dutyEngineer")),3===this.userSelectType&&(this.handleModel.solutionUserName=e[0].realname,this.handleModel.solutionUserId=e[0].id,this.faultModel.solutionUserName=e[0].realname,this.faultModel.solutionUserId=e[0].id,this.$refs.form.validateField("solutionUserId")),4===this.userSelectType&&(this.faultModel.closeUserName=e[0].realname,this.faultModel.closeUserId=e[0].id,this.$forceUpdate(),this.$refs.form.validateField("closeUserId")),this.$forceUpdate())},datePickerChange:function(e){this.handleModel.solutionTime=e,this.faultModel.solutionTime=e,this.$refs.form.validateField("solutionTime")},openSupplierModal:function(){this.$refs.supplierModal.showModal(),this.$refs.mySupplierSelect.blur()},supplierSelect:function(e){Object(u["e"])(e)||(this.faultModel.outSupplierName=e[0].name,this.faultModel.outSupplierId=e[0].id,this.$refs.form.validateField("outSupplierName"))},changeLine:function(e,t){this.dictTrainStr="",e&&(this.dictTrainStr="bu_train_info,train_no,train_no,line_id="+e+"|train_struct_id",this.dictTrainSys="bu_train_asset_type,name,id,struct_type=1 and parent_id is null and train_type_id=(select train_type_id from bu_mtr_line where line_id="+e+" )")},changeLinesubsys:function(e,t){this.dictCodesubsys="",!0!==t&&(this.faultModel.subSysId=null,this.faultModel.faultAssetId=null),e&&(this.dictCodesubsys="bu_train_asset_type,name,id,struct_type=2 and parent_id='"+e+"'")},save:function(){var e=this,t=this;this.$refs.form.validate((function(r){r?(t.faultModel.id?t.faultId=t.faultModel.id:t.faultId=Object(u["p"])(),e.beginUpload()):(e.$message.warn("请填写必须填写的信息"),e.$emit("cancel"))}))},check:function(){var e=this;return new Promise((function(t,r){e.$refs.form.validate((function(a){a?e.isWriteSave?t(!0):r("你还有没有保存故障信息, 请先保存故障信息"):r("请填写必须填写的信息")}))}))},onSelectStation:function(e){e&&e.length>0&&(this.faultModel.workStationId=e[0].id,this.faultModel.workStationName=e[0].name,this.$refs.form.validateField("workStationName"))}}},$=M,R=(r("d6d3"),r("2877")),D=Object(R["a"])($,a,o,!1,null,"0aeefc58",null);t["default"]=D.exports},d0f9:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:800,visible:e.visible,confirmLoading:e.confirmLoading,centered:"",cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{attrs:{md:18}},[t("div",[t("a-form",{ref:"initForm",attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"登录名称"}},[t("a-row",{attrs:{gutter:10}},[t("a-col",{attrs:{span:14}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["checkUserName",e.validatorRules.checkUserName],expression:"['checkUserName', validatorRules.checkUserName]",modifiers:{trim:!0}}]})],1),t("a-col",{attrs:{span:10}},[t("a-button",{attrs:{type:"link"},on:{click:e.useCurrentUser}},[e._v("使用当前账号和密码")])],1)],1)],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"登录密码"}},[t("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["checkUserPwd",e.validatorRules.checkUserPwd],expression:"['checkUserPwd', validatorRules.checkUserPwd]",modifiers:{trim:!0}}]})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查结果"}},[t("a-checkbox",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["exp",{initialValue:!1}],expression:"['exp', { initialValue: false }]",modifiers:{trim:!0}}]},[e._v(" 异常")]),t("a-checkbox",{on:{change:e.onIgnoreChange},model:{value:e.isIgnore,callback:function(t){e.isIgnore=t},expression:"isIgnore"}},[e._v(" 忽略")])],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"同检人员"}},[t("a-select",{ref:"userSelect",attrs:{placeholder:"请选择人员",open:!1,showArrow:!0,allowClear:""},on:{change:e.clearTogetherCheckUserNames,dropdownVisibleChange:function(t){return e.openSelectUser()}},model:{value:e.togetherCheckUserNames,callback:function(t){e.togetherCheckUserNames=t},expression:"togetherCheckUserNames"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"结果描述"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["resultDesc",{initialValue:"",rules:[{required:e.isIgnore,message:"请输入忽略原因!"}]}],expression:"[\n                'resultDesc',\n                { initialValue: '', rules: [{ required: isIgnore, message: '请输入忽略原因!' }] },\n              ]",modifiers:{trim:!0}}],attrs:{"auto-size":{minRows:8,maxRows:8}}})],1)],1)],1)]),t("a-col",{attrs:{md:6}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("div",{staticStyle:{margin:"30px 10px 20px","text-align":"center"}},[t("a-spin",{attrs:{spinning:e.qrLoading}},[e.imageBase64Url?t("img",{staticClass:"QRcode",attrs:{src:e.imageBase64Url,alt:""}}):t("img",{staticClass:"QRcode",attrs:{src:r("a6da"),alt:""}})])],1),t("div",{staticStyle:{"text-align":"center"}},[e._v("通过APP扫码确认")])])],1)],1),t("UserList",{ref:"userSelectModal",attrs:{multiple:!0},on:{ok:e.onSelectUser}})],1)},o=[],i=r("b9c3"),n=r("b245"),l=r("986e"),s={name:"SheetItemModal",components:{UserList:n["default"]},props:["title","formInstId","workRecordType"],data:function(){return{detailIds:"",checkType:-1,colIndex:0,value:1,status:1,switchCheck:!0,visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{checkUserName:{rules:[{required:!0,message:"请输入登录名称!"}]},checkUserPwd:{rules:[{required:!0,message:"请输入密码!"}]},checkResult:{rules:[{required:!0,message:"选择检查结果!"}]}},isIgnore:!1,qrLoading:!1,imageBase64Url:"",togetherCheckUserIds:"",togetherCheckUserNames:""}},mounted:function(){var e=this;l["a"].$on("topic",(function(t){e.$message.success(t.msgTxt);var r=Object.assign(e.model);r.detailIds=1===e.workRecordType?e.detailIds:e.detailIds.join(","),r.result=r.exp?0:1,r.isIgnore=e.isIgnore?1:0,r.type=e.checkType,r.workRecordId=e.formInstId,r.colIndex=e.colIndex,r.workRecordType=e.workRecordType,r.detailIds=e.detailIds,e.$emit("scan",{saveSuccess:!0,data:r}),e.close()}))},methods:{add:function(){this.edit({})},getTaskQRCode:function(e){var t=this;this.qrLoading=!0,Object(i["J"])({formDetails:"string"===typeof this.detailIds?this.detailIds:this.detailIds.join(","),checkType:this.checkType,colIndex:this.colIndex,formInstId:e.formInstId,formType:e.instType,fromBy:"PC",orderId:e.workOrderId,targetType:"TASK",taskId:e.workOrderTaskId,workRecordType:e.workRecordType}).then((function(e){t.qrLoading=!1,e.success&&(t.imageBase64Url=e.result.base64)}))},showModal:function(e,t){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0;this.imageBase64Url="",this.detailIds=e,this.checkType=t,this.colIndex=a,this.getTaskQRCode(o),this.form.resetFields(),this.isIgnore=!1,this.visible=!0,1===this.checkType&&this.$nextTick((function(){r.form.setFieldsValue({checkUserName:r.$store.getters.userInfo.username,checkUserPwd:"~**&&##@@$$%%^^~"})})),this.$nextTick((function(){r.form.setFieldsValue({exp:"",resultDesc:""})}))},useCurrentUser:function(){var e=this;this.$nextTick((function(){e.form.setFieldsValue({checkUserName:e.$store.getters.userInfo.username,checkUserPwd:"~**&&##@@$$%%^^~"})}))},clearTogetherCheckUserNames:function(e){e||(this.togetherCheckUserIds="",this.togetherCheckUserNames="")},openSelectUser:function(){this.$refs.userSelectModal.showModal(),this.$refs.userSelect.blur()},onSelectUser:function(e){if(e.length){var t="",r="";e.forEach((function(e,a,o){t+=e.realname,r+=e.id,a<o.length-1&&(t+=",",r+=",")})),this.togetherCheckUserIds=r,this.togetherCheckUserNames=t}},handleOk:function(){var e=this,t=this;t.form.validateFields((function(r,a){if(!r){var o=Object.assign(t.model,a);o.detailIds=1===e.workRecordType?e.detailIds:e.detailIds.join(","),o.result=o.exp?0:1,o.isIgnore=e.isIgnore?1:0,o.type=e.checkType,o.workRecordId=e.formInstId,o.colIndex=e.colIndex,o.workRecordType=e.workRecordType,o.togetherCheckUserIds=e.togetherCheckUserIds,o.togetherCheckUserNames=e.togetherCheckUserNames,Object(i["Y"])(o).then((function(r){r.success?(t.$message.success(r.message),o.detailIds=e.detailIds,r.result&&(o.checkUserInfo=r.result),t.$emit("ok",{saveSuccess:!0,data:o}),t.close()):t.$message.error(r.message)})).finally((function(){}))}}))},handleCancel:function(){this.close()},onIgnoreChange:function(){var e=this;this.$nextTick((function(){e.form.resetFields("resultDesc")}))},close:function(){this.$emit("close"),this.visible=!1}}},c=s,u=(r("fb4f"),r("2877")),d=Object(u["a"])(c,a,o,!1,null,"0804228c",null);t["default"]=d.exports},d1e3:function(e,t,r){"use strict";r("9866")},d214:function(e,t,r){"use strict";r.d(t,"h",(function(){return o})),r.d(t,"D",(function(){return i})),r.d(t,"eb",(function(){return n})),r.d(t,"r",(function(){return l})),r.d(t,"b",(function(){return s})),r.d(t,"w",(function(){return c})),r.d(t,"H",(function(){return u})),r.d(t,"I",(function(){return p})),r.d(t,"k",(function(){return d})),r.d(t,"c",(function(){return g})),r.d(t,"x",(function(){return b})),r.d(t,"l",(function(){return v})),r.d(t,"K",(function(){return y})),r.d(t,"a",(function(){return k})),r.d(t,"v",(function(){return w})),r.d(t,"j",(function(){return C})),r.d(t,"F",(function(){return x})),r.d(t,"J",(function(){return f})),r.d(t,"G",(function(){return h})),r.d(t,"t",(function(){return m})),r.d(t,"Q",(function(){return I})),r.d(t,"u",(function(){return S})),r.d(t,"db",(function(){return N})),r.d(t,"q",(function(){return P})),r.d(t,"bb",(function(){return j})),r.d(t,"cb",(function(){return M})),r.d(t,"C",(function(){return _})),r.d(t,"g",(function(){return O})),r.d(t,"P",(function(){return T})),r.d(t,"X",(function(){return D})),r.d(t,"ab",(function(){return q})),r.d(t,"f",(function(){return F})),r.d(t,"p",(function(){return L})),r.d(t,"jb",(function(){return R})),r.d(t,"kb",(function(){return $})),r.d(t,"Z",(function(){return U})),r.d(t,"e",(function(){return z})),r.d(t,"A",(function(){return E})),r.d(t,"n",(function(){return B})),r.d(t,"m",(function(){return Y})),r.d(t,"O",(function(){return J})),r.d(t,"Y",(function(){return H})),r.d(t,"V",(function(){return K})),r.d(t,"gb",(function(){return Z})),r.d(t,"hb",(function(){return X})),r.d(t,"L",(function(){return ee})),r.d(t,"ib",(function(){return te})),r.d(t,"B",(function(){return A})),r.d(t,"y",(function(){return V})),r.d(t,"d",(function(){return W})),r.d(t,"z",(function(){return Q})),r.d(t,"W",(function(){return re})),r.d(t,"o",(function(){return G})),r.d(t,"fb",(function(){return ae})),r.d(t,"i",(function(){return oe})),r.d(t,"E",(function(){return ie})),r.d(t,"s",(function(){return ne})),r.d(t,"M",(function(){return le})),r.d(t,"N",(function(){return se})),r.d(t,"S",(function(){return ce})),r.d(t,"T",(function(){return ue})),r.d(t,"U",(function(){return de})),r.d(t,"R",(function(){return fe}));var a=r("0fea"),o=function(e){return Object(a["j"])("/outsource/supplier/add",e)},i=function(e){return Object(a["j"])("/outsource/supplier/edit",e)},n=function(e){return Object(a["d"])("/outsource/supplier/page",e)},l=function(e){return Object(a["j"])("/outsource/supplier/delete",e)},s=function(e){return Object(a["j"])("/outsource/contractInfo/add",e)},c=function(e){return Object(a["j"])("/outsource/contractInfo/edit",e)},u=function(e){return Object(a["d"])("/outsource/contractInfo/page",e)},d=function(e){return Object(a["j"])("/outsource/contractInfo/delete",e)},f=function(e){return Object(a["d"])("/outsource/contractInfo/monitor",e)},h=function(e){return Object(a["d"])("/outsource/contract/annex/list",e)},m=function(e){return Object(a["j"])("/outsource/contract/annex/delete",e)},p=function(e){return Object(a["d"])("/outsource/contractInfo/price",e)},g=function(e){return Object(a["j"])("/outsource/contractPay/add",e)},b=function(e){return Object(a["j"])("/outsource/contractPay/edit",e)},y=function(e){return Object(a["d"])("/outsource/contractPay/page",e)},v=function(e){return Object(a["j"])("/outsource/contractPay/delete",e)},k=function(e){return Object(a["j"])("/outsource/contractBakMoney/add",e)},w=function(e){return Object(a["j"])("/outsource/contractBakMoney/edit",e)},x=function(e){return Object(a["d"])("/outsource/contractBakMoney/page",e)},C=function(e){return Object(a["j"])("/outsource/contractBakMoney/delete",e)},I=function(e){return Object(a["d"])("/outsource/outin/page",e)},S=function(e){return Object(a["j"])("/outsource/outin/delete",e)},T=function(e){return Object(a["d"])("/outsource/outin/page/detail",e)},O=function(e){return Object(a["j"])("/outsource/supervise/add",e)},_=function(e){return Object(a["j"])("/outsource/supervise/edit",e)},N=function(e){return Object(a["d"])("/outsource/supervise/page",e)},P=function(e){return Object(a["j"])("/outsource/supervise/delete",e)},j=function(e){return Object(a["d"])("/outsource/supervise/get",{id:e})},M=function(e){return Object(a["d"])("/outsource/supervise/get-by-order",e)},$=function(e){return Object(a["d"])("/outsource/perform/vendor/tree",e)},R=function(e){return Object(a["j"])("/outsource/perform/delayReason",e)},D=function(e){return Object(a["d"])("/outsource/perform/page",e)},L=function(e){return Object(a["j"])("/outsource/perform/delete/resource",e)},q=function(e){return Object(a["d"])("/outsource/perform/resource",e)},F=function(e){return Object(a["j"])("/outsource/perform/resource/add",e)},A=function(e){return Object(a["j"])("/outsource/perform/resource/edit",e)},U=function(e){return Object(a["d"])("/outsource/rateing/page",e)},z=function(e){return Object(a["j"])("/outsource/rateing/add",e)},E=function(e){return Object(a["j"])("/outsource/rateing/edit",e)},B=function(e){return Object(a["j"])("/outsource/rateing/delete",e)},G=function(e){return Object(a["j"])("/outsource/rateing/delete/attachment",e)},Y=function(e){return Object(a["j"])("/outsource/otherSource/delete",e)},V=function(e){return Object(a["j"])("/outsource/otherSource/edit",e)},W=function(e){return Object(a["j"])("/outsource/otherSource/add",e)},J=function(e){return Object(a["d"])("/outsource/otherSource/page",e)},H=function(e){return Object(a["d"])("/outsource/quality/page",e)},Q=function(e){return Object(a["j"])("/outsource/quality/edit",e)},K=function(e){return Object(a["d"])("/outsource/part/page",e)},Z=function(e){return Object(a["d"])("/outsource/fault/countFault",e)},X=function(e){return Object(a["d"])("/outsource/fault/countFaultGroupBySystem",e)},ee=function(e){return Object(a["d"])("/outsource/fault/page",e)},te=function(e){return Object(a["j"])("/outsource/fault/countFaultGroupByPhaseAndSystem",e)},re=function(e){return Object(a["d"])("/outsource/contractPay/page",e)},ae=function(e){return Object(a["d"])("/training/record/page",e)},oe=function(e){return Object(a["j"])("/training/record/add",e)},ie=function(e){return Object(a["j"])("/training/record/edit",e)},ne=function(e){return Object(a["j"])("/training/record/delete",e)},le=function(e){return Object(a["d"])("/base/finance/project/list",e)},se=function(e){return Object(a["d"])("/base/finance/task/list",e)},ce=function(e){return Object(a["d"])("/outsource/cost/listCost",e)},ue=function(e){return Object(a["d"])("/outsource/cost/detail",e)},de=function(e){return Object(a["d"])("/outsource/cost/part",e)},fe=function(e){return Object(a["d"])("/outsource/cost/asset",e)}},d4ad:function(e,t,r){},d6d3:function(e,t,r){"use strict";r("ccb3")},d88b:function(e,t,r){"use strict";r("3ff1")},dc91:function(e,t,r){"use strict";r("ed25")},de37:function(e,t,r){},e24e:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var a=r("e8ae"),o=r.n(a),i=r("21a6"),n=r.n(i),l=(r("7268"),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"),s=function(e,t){var r=new o.a.Workbook;"[object Object]"===Object.prototype.toString.call(e)&&(e=[e]),e.forEach((function(e){if(0===e.data.length)return!0;var t=r.addWorksheet(e.name),a=e.config&&e.config.merge||{},o=e.config&&e.config.borderInfo||{},i=e.config&&e.config.columnlen||{},n=e.images||{};return d(n,r,t),u(i,t),c(e.config,t),m(e.data,t),f(a,t),h(o,t),!0}));var a=r.xlsx.writeBuffer().then((function(e){var r=new Blob([e],{type:l});n.a.saveAs(r,"".concat(t,".xlsx"))}));return a},c=function(e,t){if(e&&e.rowlen)for(var r in e.rowlen){var a=parseInt(r),o=parseInt(e.rowlen[r]),i=t.getRow(a+1);i.height=o}},u=function(e,t){for(var r in e){var a=parseInt(r),o=parseInt(e[r]);t.getColumn(a+1).width=parseInt(o/7)}},d=function(e,t,r){for(var a in e){var o=e[a],i=o.src.split(";base64,"),n=i[0].replaceAll("data:image/",""),l=t.addImage({base64:o.src,extension:n}),s=luckysheet.location(o.default.left,o.default.top);r.addImage(l,{tl:{col:s.col,row:s.row},ext:{width:o.default.width,height:o.default.height}})}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=Object.values(e);r.forEach((function(e){t.mergeCells(e.r+1,e.c+1,e.r+e.rs,e.c+e.cs)}))},h=function(e,t){Array.isArray(e)&&e.forEach((function(e){if("range"===e.rangeType)for(var r=y(e.borderType,e.style,e.color),a=e.range[0],o=a.row,i=a.column,n=o[0]+1;n<o[1]+2;n++)for(var l=i[0]+1;l<i[1]+2;l++)t.getCell(n,l).border=r;if("cell"===e.rangeType){var s=e.value,c=s.col_index,u=s.row_index,d=Object.assign({},e.value);delete d.col_index,delete d.row_index;var f=v(d,u,c);t.getCell(u+1,c+1).border=f}}))},m=function(e,t){Array.isArray(e)&&e.forEach((function(e,r){e.every((function(e,a){if(!e)return!0;var o=p(e.bg),i=g(e.ff,e.fc,e.bl,e.it,e.fs,e.cl,e.ul),n=b(e.vt,e.ht,e.tb,e.tr),l="";e.f?l={formula:e.f,result:e.v}:!e.v&&e.ct&&e.ct.s?e.ct.s.forEach((function(e){l+=e.v})):l=e.v;var s=k(a),c=t.getCell(s+(r+1));for(var u in o){c.fill=o;break}return c.font=i,c.alignment=n,c.value=l,!0}))}))},p=function(e){if(!e)return{};var t={type:"pattern",pattern:"solid",fgColor:{argb:e.replace("#","")}};return t},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000000",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l={0:"微软雅黑",1:"宋体（Song）",2:"黑体（ST Heiti）",3:"楷体（ST Kaiti）",4:"仿宋（ST FangSong）",5:"新宋体（ST Song）",6:"华文新魏",7:"华文行楷",8:"华文隶书",9:"Arial",10:"Times New Roman ",11:"Tahoma ",12:"Verdana",num2bl:function(e){return 0!==e}},s={name:"number"===typeof e?l[e]:e,family:1,size:o,color:{argb:t.replace("#","")},bold:l.num2bl(r),italic:l.num2bl(a),underline:l.num2bl(n),strike:l.num2bl(i)};return s},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"default",o={vertical:{0:"middle",1:"top",2:"bottom",default:"top"},horizontal:{0:"center",1:"left",2:"right",default:"left"},wrapText:{0:!1,1:!1,2:!0,default:!1},textRotation:{0:0,1:45,2:-45,3:"vertical",4:90,5:-90,default:0}},i={vertical:o.vertical[e],horizontal:o.horizontal[t],wrapText:o.wrapText[r],textRotation:o.textRotation[a]};return i},y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000";if(!e)return{};var a={type:{"border-all":"all","border-top":"top","border-right":"right","border-bottom":"bottom","border-left":"left"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}},o={style:a.style[t],color:{argb:r.replace("#","")}},i={};return"all"===a.type[e]?(i["top"]=o,i["right"]=o,i["bottom"]=o,i["left"]=o):i[a.type[e]]=o,i};function v(e,t,r){var a={},o={type:{l:"left",r:"right",b:"bottom",t:"top"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}};for(var i in e)-1===e[i].color.indexOf("rgb")?a[o.type[i]]={style:o.style[e[i].style],color:{argb:e[i].color.replace("#","")}}:a[o.type[i]]={style:o.style[e[i].style],color:{argb:e[i].color}};return a}function k(e){var t="A".charCodeAt(0),r="Z".charCodeAt(0),a=r-t+1,o="";while(e>=0)o=String.fromCharCode(e%a+t)+o,e=Math.floor(e/a)-1;return o}},e42a:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("a-modal",{attrs:{title:"车辆设备选择",width:"80%",bodyStyle:{height:"60vh"},visible:e.visible,confirmLoading:e.confirmLoading,closable:!0,destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.close}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchQuery.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"名称"}},[t("a-input",{attrs:{placeholder:"名称或编码"},model:{value:e.queryParam.title,callback:function(t){e.$set(e.queryParam,"title",t)},expression:"queryParam.title"}})],1)],1),t("a-col",{attrs:{md:10,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.searchQuery}},[e._v("查询")])],1)],1)])],1)],1)],1),t("div",{staticClass:"tableHeight"},[t("vxe-table",{ref:"listTable",attrs:{border:"",resizable:"","row-id":"id",align:e.allAlign,height:"auto",data:e.tableData,"show-overflow":"tooltip","max-height":"100%","radio-config":{trigger:e.multiple?"default":"row",highlight:!0,checkMethod:e.checkRadioMethod},"checkbox-config":{trigger:e.multiple?"row":"default",highlight:!0,checkStrictly:!0,checkMethod:e.checkRadioMethod},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40",fixed:"left"}}),t("vxe-table-column",{attrs:{field:"assetName",title:"名称","tree-node":"",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"assetNo",title:"编码",width:"12%"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"100"}}),t("vxe-table-column",{attrs:{field:"structType_dictText",title:"类型",width:"10%"}}),t("vxe-table-column",{attrs:{field:"assetTypeName",title:"设备类型",width:"13%",align:"left","header-align":"center"}})],1)],1)])],1)},o=[],i=r("8fad"),n={props:{multiple:{type:Boolean,default:!0},trainNo:{required:!0},canSelectType:{type:Array,default:function(){return[1,2,3,4]}}},data:function(){return{allAlign:"center",tableData:[],visible:!1,confirmLoading:!1,queryParam:{code:"",title:""}}},created:function(){},methods:{checkRadioMethod:function(e){var t=e.row;return this.canSelectType.indexOf(t.structType)>-1},searchQuery:function(){this.findList()},loadChildrenMethod:function(e){var t=this,r=e.row,a={code:this.trainNo,id:r.id,searchText:this.queryParam.searchText};return new Promise((function(e){Object(i["Xb"])(a).then((function(r){r.success?e(r.result):t.$message.error("".concat(r.msg))}))}))},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},showModal:function(){this.visible=!0,this.queryParam.code=this.trainNo,this.findList()},close:function(){this.visible=!1},findList:function(){var e=this;this.loading=!0,Object(i["Xb"])(this.queryParam).then((function(t){t.success&&(e.loading=!1,e.tableData=t.result)}))}}},l=n,s=(r("14d0"),r("2877")),c=Object(s["a"])(l,a,o,!1,null,"0f6e3f94",null);t["default"]=c.exports},e89a:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"luckySheetPringContent"}},[t("div",{staticClass:"table-page-body",staticStyle:{position:"relative"}},[t("div",{ref:"printDom",staticClass:"ls-print",style:{height:e.lHeight},attrs:{id:e.luckySheetId}})])])},o=[],i=r("8fad"),n=(r("2410"),r("7268")),l={name:"LuckySheetPrint",props:{luckySheetId:{type:String,default:"luckySheetPring"}},data:function(){return{recordSheet:{},lHeight:"calc(100% - 0)"}},mounted:function(){},methods:{printById:function(e){var t=this;i["ub"].call(this,e).then((function(e){e.success&&t.printBySheet(JSON.parse(e.result))})).catch((function(e){t.$message.error("加载表单内容异常")}))},printByData:function(e){var t=this;this.recordSheet=e,this.$nextTick((function(){t.print()}))},printBySheet:function(e){var t=this,r=Object.assign({},n["a"].getDefaultOptions());r.container=this.luckySheetId;var a=0,o=0,i=0;e.celldata.forEach((function(e){e.c>a&&(a=e.c),e.r>o&&(o=e.r)})),a++,o++,i=e.visibledatarow[e.visibledatarow.length-1],r.column=a,r.row=o,delete e.luckysheet_select_save,r.data=[e],this.lHeight="".concat(i+40,"px"),luckysheet.destroy(),luckysheet.create(r),setTimeout((function(){var e=document.getElementById("luckysheet-sheettable_0"),r=document.getElementById("luckysheetTableContent"),a=r.getContext("2d").getImageData(42,17,e.offsetWidth,e.offsetHeight+10),o=document.createElement("canvas");o.width=e.offsetWidth,o.height=e.offsetHeight;var i=o.getContext("2d");i.putImageData(a,0,0);var n=o.toDataURL("image/png");t.print('<img id="printImage" src="'.concat(n,'">'))}),500)},print:function(e){var t=this,r=document.getElementById("printDom")||document.createElement("iframe");r.id="printDom",document.body.appendChild(r),this.$nextTick((function(){var a=document.getElementById("printDom");a.contentDocument.write(e),a.contentDocument.getElementById("printImage").onload=function(){a.contentWindow.print(),luckysheet.destroy(),t.$emit("sheetPrintOk"),document.body.removeChild(r)}}))}}},s=l,c=(r("d1e3"),r("2877")),u=Object(c["a"])(s,a,o,!1,null,"4cc670b2",null);t["default"]=u.exports},ed25:function(e,t,r){},ee46:function(e,t,r){},ef2b0:function(e,t,r){"use strict";r("7616")},f000:function(e,t,r){},f02c:function(e,t,r){"use strict";r("ee46")},f0c5:function(e,t,r){"use strict";r("4b54")},f680:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return"checkbox"==e.tagType?t("a-checkbox-group",{attrs:{value:e.arrayValue,disabled:e.disabled},on:{change:e.onChange}},e._l(e.dictOptions,(function(r,a){return t("a-checkbox",{key:a,attrs:{value:r.value}},[e._v(e._s(r.text||r.label))])})),1):"select"==e.tagType?t("a-select",{attrs:{value:e.arrayValue,disabled:e.disabled,mode:"multiple",placeholder:e.placeholder,getPopupContainer:function(e){return e.parentNode},allowClear:""},on:{change:e.onChange}},e._l(e.dictOptions,(function(r,a){return t("a-select-option",{key:a,attrs:{value:r.value}},[t("span",{staticStyle:{display:"inline-block",width:"100%"},attrs:{title:r.text||r.label}},[e._v(" "+e._s(r.text||r.label)+" ")])])})),1):e._e()},o=[],i=r("4ec3");function n(e){return u(e)||c(e)||s(e)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){if(e){if("string"==typeof e)return d(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}function c(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function u(e){if(Array.isArray(e))return d(e)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}var f={name:"JMultiSelectTag",props:{dictCode:String,placeholder:String,disabled:Boolean,value:String,type:String,options:Array},data:function(){return{dictOptions:[],tagType:"",arrayValue:this.value?this.value.split(","):[]}},created:function(){this.type&&"list_multi"!==this.type?this.tagType=this.type:this.tagType="select"},watch:{options:function(e){this.setCurrentDictOptions(e)},dictCode:{immediate:!0,handler:function(){this.initDictData()}},value:function(e){this.arrayValue=e?this.value.split(","):[]}},methods:{initDictData:function(){var e=this;if(this.options&&this.options.length>0)this.dictOptions=n(this.options);else{if(Object(i["u"])(this.dictCode))return void(this.dictOptions=Object(i["u"])(this.dictCode));Object(i["f"])(this.dictCode,null).then((function(t){t.success&&(e.dictOptions=t.result)}))}},onChange:function(e){this.$emit("change",e.join(","))},setCurrentDictOptions:function(e){this.dictOptions=e},getCurrentDictOptions:function(){return this.dictOptions}},model:{prop:"value",event:"change"}},h=f,m=r("2877"),p=Object(m["a"])(h,a,o,!1,null,null,null);t["default"]=p.exports},f76d:function(e,t,r){"use strict";r("9527")},fb4f:function(e,t,r){"use strict";r("0743")}}]);