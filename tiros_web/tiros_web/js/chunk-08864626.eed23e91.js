(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08864626"],{3791:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"设置权限",width:"85%",visible:e.visible,dialogClass:"fullDialog no-footer",destroyOnClose:!0},on:{cancel:e.handleCancel}},[t("div",{attrs:{id:"PrivilegeContent"}},[t("div",{staticClass:"info-wrapper info-top-wrapper"},[t("h4",[e._v("可选权限")]),t("a-form",{attrs:{form:e.form}},[t("a-row",[t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"权限维度"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["dimension",{rules:[{required:!0,message:"请选择权限维度"}]}],expression:"['dimension',  { rules: [{ required: true, message: '请选择权限维度' }] },]"}],attrs:{dictCode:"bu_dimension",triggerChange:!0,placeholder:"请选择接收维度"},on:{change:e.changeDimension}})],1)],1),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"权限对象"}},[t("a-select",{ref:"mySelect",attrs:{mode:"multiple",placeholder:"请选择接收对象",open:!1,showArrow:!0},on:{focus:e.openModal,deselect:e.changeSelect},model:{value:e.target,callback:function(t){e.target=t},expression:"target"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:14,sm:24}},[t("a-form-item",{attrs:{labelCol:{xs:{span:24},sm:{span:2}},wrapperCol:e.wrapperCol,label:"权限"}},[t("a-checkbox-group",{attrs:{options:e.plainOptions},model:{value:e.privilegeValue,callback:function(t){e.privilegeValue=t},expression:"privilegeValue"}})],1)],1),t("a-col",{attrs:{md:6,sm:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"设置子项"}},[t("a-switch",{model:{value:e.isSub,callback:function(t){e.isSub=t},expression:"isSub"}})],1)],1)],1),t("a-row",[t("a-col",[t("a-button",{on:{click:e.handleOk}},[e._v("添加权限")])],1)],1)],1)],1),t("div",[e._v(" 如果不设置任何权限项，默认为所有人拥有所有权限 ")]),t("div",{staticClass:"info-wrapper info-top-wrapper"},[t("h4",[e._v("已设置权限")]),t("vxe-table",{attrs:{stripe:"",border:"inner",align:"center",data:e.tableData}},[t("vxe-table-column",{attrs:{type:"seq",width:"60",title:"序号"}}),t("vxe-table-column",{attrs:{field:"objName",title:"权限对象"}}),t("vxe-table-column",{attrs:{title:"上传文件"},scopedSlots:e._u([{key:"default",fn:function(e){var a=e.row;return[t("a-checkbox",{attrs:{checked:"1"===a.docPrivileges.slice(0,1)}})]}}])}),t("vxe-table-column",{attrs:{title:"查看文件"},scopedSlots:e._u([{key:"default",fn:function(e){var a=e.row;return[t("a-checkbox",{attrs:{checked:"1"===a.docPrivileges.slice(1,2)}})]}}])}),t("vxe-table-column",{attrs:{title:"下载文件"},scopedSlots:e._u([{key:"default",fn:function(e){var a=e.row;return[t("a-checkbox",{attrs:{checked:"1"===a.docPrivileges.slice(2,3)}})]}}])}),t("vxe-table-column",{attrs:{title:"删除文件"},scopedSlots:e._u([{key:"default",fn:function(e){var a=e.row;return[t("a-checkbox",{attrs:{checked:"1"===a.docPrivileges.slice(3,4)}})]}}])}),t("vxe-table-column",{attrs:{title:"目录管理"},scopedSlots:e._u([{key:"default",fn:function(e){var a=e.row;return[t("a-checkbox",{attrs:{checked:"1"===a.docPrivileges.slice(4,5)}})]}}])}),t("vxe-table-column",{attrs:{title:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("a",{on:{click:function(t){return t.stopPropagation(),e.handleDel(r)}}},[e._v("删除")])]}}])})],1)],1),t("user-list",{ref:"UserModalForm",attrs:{multiple:!0},on:{ok:e.addTarget}}),t("role-list",{ref:"RoleModalForm",attrs:{multiple:!0},on:{ok:e.addTarget}}),t("org-list",{ref:"OrgModalForm",attrs:{multiple:!0},on:{ok:e.addTarget}})],1)])},i=[],l=a("b245"),s=a("fc35"),n=a("f004"),o=a("8fad"),c={name:"PrivilegeAdd",components:{UserList:l["default"],RoleList:s["default"],OrgList:n["default"]},data:function(){return{plainOptions:[{label:"上传文件",value:"1"},{label:"查看文件",value:"2"},{label:"下载文件",value:"3"},{label:"删除文件",value:"4"},{label:"目录管理",value:"5"}],tableData:[],queryParam:{dimension:"",target:""},privilegeValue:[],target:[],targetItem:[],dimension:"",labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},form:this.$form.createForm(this),showSelect:!0,confirmLoading:!1,visible:!1,directoryId:"",objType:"",isSub:!0}},methods:{show:function(e){this.visible=!0,this.directoryId=e.directoryId,this.objType=e.objType,this.findList()},findList:function(){var e=this;Object(o["Eb"])(this.directoryId).then((function(t){t.success&&(e.tableData=t.result)}))},openModal:function(){if(this.queryParam.dimension)switch(this.queryParam.dimension){case"1":this.$refs.UserModalForm.showModal();break;case"2":this.$refs.RoleModalForm.showModal();break;case"3":this.$refs.OrgModalForm.showModal();break;default:break}else this.$message.error("请先选择接收维度!");this.$refs.mySelect.blur()},addTarget:function(e){var t=this;this.target=[],this.targetItem=[],this.queryParam.target="",e.map((function(e,a){switch(t.queryParam.dimension){case"1":t.target.push(e.username);break;case"2":t.target.push(e.roleName);break;case"3":t.target.push(e.departName);break;default:break}t.targetItem.push(e)}))},changeSelect:function(e,t){var a;switch(this.queryParam.dimension){case"1":a=this.targetItem.findIndex((function(t){return t.username===e}));break;case"2":a=this.targetItem.findIndex((function(t){return t.roleName===e}));break;case"3":a=this.targetItem.findIndex((function(t){return t.departName===e}));break;default:break}this.targetItem.splice(a,1)},getTargetIds:function(e){var t=this;e.map((function(e,a){t.queryParam.target=0===a?t.queryParam.target+e.id:t.queryParam.target+","+e.id}))},changeDimension:function(e){e!==this.queryParam.dimension&&(this.queryParam.dimension=e,this.queryParam.target="",this.target=[])},handleOk:function(){var e=this;if(this.queryParam.dimension&&this.targetItem.length){if(this.getTargetIds(this.targetItem),0==this.privilegeValue.length)return void this.$message.warn("至少选择一个权限!");this.form.validateFields((function(t,a){if(!t){var r=Object.assign({},a,{objId:e.directoryId,docPrivileges:e.privilegeValue.join(","),targetId:e.queryParam.target,targetType:e.queryParam.dimension,objType:e.objType,isSub:e.isSub});Object(o["Wc"])(r).then((function(t){t.success?(e.findList(),e.$message.success(t.message),e.queryParam={dimension:"",target:""},e.form.resetFields(),e.privilegeValue=[],e.target=[],e.targetItem=[],e.dimension=""):e.$message.error(t.message)}))}}))}else this.queryParam.dimension&&!this.targetItem.length?this.$message.error("请选择接收对象！"):this.$message.error("请选择接收维度和接收对象！")},handleDel:function(e){var t=this;Object(o["B"])(e.id).then((function(e){e.success?(t.findList(),t.$message.success(e.message)):t.$message.error(e.message)}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},u=c,d=(a("cc1e"),a("2877")),m=Object(d["a"])(u,r,i,!1,null,"37ab631a",null);t["default"]=m.exports},"82f3":function(e,t,a){"use strict";a("aaee")},9527:function(e,t,a){},a374:function(e,t,a){"use strict";a("cf71")},aaee:function(e,t,a){},b245:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"85%",title:"人员选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",bodyStyle:{height:"70vh"},destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{attrs:{md:4,sm:24}},[t("div",{staticStyle:{height:"calc(70vh - 20px)","border-right":"1px solid #e3e1e1","margin-right":"15px"}},[e.treeData&&e.treeData.length>0?t("a-tree",{staticClass:"limitHeight",attrs:{defaultSelectedKeys:[e.queryParam.depId],defaultExpandAll:!0,"tree-data":e.treeData},on:{select:e.onSelect}}):e._e()],1)]),t("a-col",{attrs:{md:20,sm:24}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"账号"}},[t("a-input",{attrs:{placeholder:"请输入用户账号"},model:{value:e.queryParam.username,callback:function(t){e.$set(e.queryParam,"username",t)},expression:"queryParam.username"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"真实名字"}},[t("a-input",{attrs:{placeholder:"请输入真实名字"},model:{value:e.queryParam.realname,callback:function(t){e.$set(e.queryParam,"realname",t)},expression:"queryParam.realname"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"手机号码"}},[t("a-input",{attrs:{placeholder:"请输入手机号码"},model:{value:e.queryParam.phone,callback:function(t){e.$set(e.queryParam,"phone",t)},expression:"queryParam.phone"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"角色"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"sys_role,role_name,id",placeholder:"选择角色"},model:{value:e.queryParam.roleId,callback:function(t){e.$set(e.queryParam,"roleId",t)},expression:"queryParam.roleId"}})],1)],1),t("a-col",{attrs:{md:2,sm:8}},[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(70vh - 130px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(70vh - 130px)"},attrs:{border:"",align:e.allAlign,data:e.tableData,"max-height":"100%","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"manual",mode:"row"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"5%"}}):t("vxe-table-column",{attrs:{type:"radio",width:"5%"}}),t("vxe-table-column",{attrs:{field:"workNo",title:"工号",width:"100",align:"center"}}),t("vxe-table-column",{attrs:{field:"username",title:"用户账号",width:"150",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"realname",title:"用户名字",width:"100",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"roleNames",title:"角色","min-width":"180",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"sex_dictText",title:"性别",width:"80"}}),t("vxe-table-column",{attrs:{field:"phone",title:"手机号码",width:"120"}}),t("vxe-table-column",{attrs:{field:"orgCode",title:"部门",width:"120",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"80"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)])],1)],1)},i=[],l=a("8fad"),s={name:"UserList",props:{multiple:{type:Boolean,default:!0},depId:{type:String,default:""}},data:function(){return{queryParam:{username:"",realname:"",phone:"",orgCode:"",roleId:void 0,pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,treeData:[]}},watch:{depId:function(e){this.$set(this.queryParam,"depId",e||"")}},mounted:function(){this.$set(this.queryParam,"depId",this.depId||"")},methods:{showModal:function(){this.visible=!0,this.findList(),this.getTreeList()},getTreeList:function(){var e=this;Object(l["mb"])().then((function(t){t.success&&(e.treeData=t.result)}))},onSelect:function(e,t){if(e.length){var a=t.node.dataRef;this.queryParam.depId=a.id,this.findList()}else this.queryParam.orgCode="",this.findList()},findList:function(){var e=this;this.loading=!0,Object(l["gc"])(this.queryParam).then((function(t){e.loading=!1,t.success?(e.totalResult=t.result.total,e.tableData=t.result.records):e.$message.error("加载用户数据失败")})).catch((function(t){e.$message.error("加载用户数据异常")})).finally((function(){}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,Object.assign(this.$data,this.$options.data())}}},n=s,o=(a("f76d"),a("2877")),c=Object(o["a"])(n,r,i,!1,null,"4aa7956f",null);t["default"]=c.exports},cc1e:function(e,t,a){"use strict";a("e105")},cf71:function(e,t,a){},e105:function(e,t,a){},f004:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:"机构选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0,bodyStyle:{height:"60vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{attrs:{md:5,sm:24}},[e.treeData.length?t("a-tree",{staticClass:"limitHeight",attrs:{defaultExpandAll:"","tree-data":e.treeData},on:{select:e.onSelect}}):e._e()],1),t("a-col",{attrs:{md:19,sm:24}},[t("div",{staticClass:"limitHeight"},[t("vxe-table",{ref:"listTable",attrs:{border:"",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"10%"}}):t("vxe-table-column",{attrs:{type:"radio",width:"5%"}}),t("vxe-table-column",{attrs:{field:"departName",title:"机构名称",width:"45%"}}),t("vxe-table-column",{attrs:{field:"orgCode",title:"机构编码",width:"45%"}})],1)],1)])],1)],1)},i=[],l=a("8fad"),s={name:"OrgList",props:{multiple:{type:Boolean,default:!0}},data:function(){return{visible:!1,confirmLoading:!1,treeData:[],defaultSelect:[],tableData:[],allAlign:"center"}},created:function(){},methods:{showModal:function(){this.visible=!0,this.getTreeList()},getTreeList:function(){var e=this;Object(l["mb"])().then((function(t){t.success&&(e.treeData=t.result)}))},onSelect:function(e,t){this.tableData=t.node.dataRef.children},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},n=s,o=(a("a374"),a("2877")),c=Object(o["a"])(n,r,i,!1,null,"d673464c",null);t["default"]=c.exports},f76d:function(e,t,a){"use strict";a("9527")},fc35:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:"角色选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0,bodyStyle:{height:"60vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"角色名称"}},[t("a-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.queryParam.roleName,callback:function(t){e.$set(e.queryParam,"roleName",t)},expression:"queryParam.roleName"}})],1)],1),t("a-col",{attrs:{md:3,sm:8}},[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1),t("div",{staticClass:"limitHeight"},[t("vxe-table",{ref:"listTable",attrs:{border:"",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"10%"}}):t("vxe-table-column",{attrs:{type:"radio",width:"10%"}}),t("vxe-table-column",{attrs:{field:"roleCode",title:"角色编码",width:"30%"}}),t("vxe-table-column",{attrs:{field:"roleName",title:"角色名称",width:"30%"}}),t("vxe-table-column",{attrs:{field:"createTime",title:"创建时间",width:"30%"}})],1)],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)},i=[],l=a("8fad"),s={name:"RoleList",props:{multiple:{type:Boolean,default:!0}},data:function(){return{queryParam:{roleName:"",pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1}},methods:{showModal:function(){this.visible=!0,this.findList()},findList:function(){var e=this;this.loading=!0,Object(l["Jb"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},n=s,o=(a("82f3"),a("2877")),c=Object(o["a"])(n,r,i,!1,null,"364d5b69",null);t["default"]=c.exports}}]);