(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48d6f9e6","chunk-4def5374"],{"310d":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",[e("a-modal",{attrs:{title:"车辆设备选择",width:"80%",bodyStyle:{height:"83vh"},visible:t.visible,confirmLoading:t.confirmLoading,closable:!0,centered:"",destroyOnClose:!0},on:{ok:t.handleOk,cancel:t.close}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchQuery.apply(null,arguments)}}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"名称"}},[e("a-input",{attrs:{placeholder:"名称或编码"},model:{value:t.queryParam.title,callback:function(e){t.$set(t.queryParam,"title",e)},expression:"queryParam.title"}})],1)],1),e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"线路"}},[e("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"bu_mtr_line,line_name,line_id"},on:{change:t.changeLine},model:{value:t.lineId_A,callback:function(e){t.lineId_A=e},expression:"lineId_A"}})],1)],1),e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"车辆"}},[e("j-dict-select-seach-tag",{attrs:{triggerChange:!0,dictCode:t.dictTrainStr},model:{value:t.trainNo_A,callback:function(e){t.trainNo_A=e},expression:"trainNo_A"}})],1)],1),e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"状态"}},[e("j-dict-select-tag",{attrs:{triggerChange:!0,placeholder:"请选择状态",dictCode:"bu_valid_status"},model:{value:t.queryParam.status,callback:function(e){t.$set(t.queryParam,"status",e)},expression:"queryParam.status"}})],1)],1),e("a-col",{attrs:{md:5,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[e("a-space",[e("a-button",{on:{click:t.searchQuery}},[t._v("查询")])],1)],1)])],1)],1)],1),e("div",{staticClass:"tableHeight"},[e("vxe-table",{ref:"listTable",attrs:{border:"",resizable:"","row-id":"id",align:t.allAlign,height:"auto",data:t.tableData,"show-overflow":"tooltip","max-height":"100%","radio-config":{trigger:t.multiple?"default":"row",highlight:!0,checkMethod:t.checkRadioMethod},"checkbox-config":{trigger:t.multiple?"row":"default",highlight:!0,checkStrictly:!0,checkMethod:t.checkRadioMethod},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:t.loadChildrenMethod}}},[t.multiple?e("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}):e("vxe-table-column",{attrs:{type:"radio",width:"40",fixed:"left"}}),e("vxe-table-column",{attrs:{field:"name",title:"名称","tree-node":"",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"code",title:"编码",width:"180"}}),e("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",align:"center","header-align":"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){var i=a.row;return[e("div",{style:{backgroundColor:t.statusColor[i.status+""],borderRadius:"4px"}},[t._v(" "+t._s(i.status_dictText)+" ")])]}}])}),e("vxe-table-column",{attrs:{field:"maximoAssetType",title:"maximo设备类型",width:"150",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{field:"locationName",title:"位置",width:"400",align:"left","header-align":"center"}})],1)],1)])],1)},r=[],n=a("8fad"),l={props:{multiple:{type:Boolean,default:!0},trainNo:{type:[Number,String]},lineId:{type:[Number,String]}},data:function(){return{statusColor:{0:"#dedede",1:"#bad795"},dictTrainStr:"",trainNo_A:void 0,lineId_A:void 0,allAlign:"center",tableData:[],visible:!1,confirmLoading:!1,queryParam:{trainNo:"",searchText:"",status:1}}},created:function(){},methods:{changeLine:function(t,e){this.dictTrainStr="",t&&(this.dictTrainStr="bu_train_info,train_no,train_no,line_id="+t+"|train_struct_id")},checkRadioMethod:function(t){t.row;return!0},searchQuery:function(){this.findList()},loadChildrenMethod:function(t){var e=this,a=t.row,i={trainNo:this.trainNo_A,parentId:a.id,searchText:this.queryParam.searchText,status:this.queryParam.status};return new Promise((function(t){Object(n["kc"])(i).then((function(a){a.success?t(a.result):e.$message.error("".concat(a.msg))}))}))},handleOk:function(){var t=[];this.multiple?t=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&t.push(this.$refs.listTable.getRadioRecord()),Array.from(t,(function(t,e){t.assetName=t.name})),this.$emit("ok",t),this.visible=!1},showModal:function(){this.visible=!0,this.lineId_A=this.lineId,this.trainNo_A=this.trainNo,this.findList()},close:function(){this.visible=!1},findList:function(){var t=this;this.queryParam.trainNo=this.trainNo_A,this.loading=!0,Object(n["kc"])(this.queryParam).then((function(e){e.success&&(t.loading=!1,t.tableData=e.result)}))}}},s=l,o=(a("4677"),a("2877")),c=Object(o["a"])(s,i,r,!1,null,"3967f3d4",null);e["default"]=c.exports},"412f":function(t,e,a){},4677:function(t,e,a){"use strict";a("412f")},ab812:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",[t.readOnly?t._e():e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:6,sm:8}},[e("a-form-item",[e("a-space",[e("a-button",{staticClass:"primary-color",attrs:{type:"dashed"},on:{click:function(e){return t.$refs.trainAssetSelectModal.showModal()}}},[t._v("添加")]),e("a-button",{attrs:{type:"dashed"},on:{click:t.handleDel}},[t._v("删除")])],1)],1)],1)],1)],1),e("div",{staticStyle:{height:"208px"}},[e("vxe-table",{ref:"listTable",attrs:{border:"",align:t.allAlign,height:"auto","show-overflow":"tooltip",data:t.targetDeviceList,"checkbox-config":{trigger:"row",highlight:!0}}},[e("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),e("vxe-table-column",{attrs:{type:"seq",width:"50"}}),e("vxe-table-column",{attrs:{field:"trainAssetName",title:"名称","tree-node":"",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"trainAssetNo",title:"编码",width:"12%"}}),e("vxe-table-column",{attrs:{field:"trainAssetStructType_dictText",title:"类型",width:"10%"}})],1)],1),e("CarDeviceSelectNew",{ref:"trainAssetSelectModal",attrs:{trainNo:t.trainNo,lineId:t.lineId,multiple:!0},on:{ok:t.addAsset}})],1)},r=[],n=a("310d");function l(t){return d(t)||c(t)||o(t)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,e){if(t){if("string"==typeof t)return u(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?u(t,e):void 0}}function c(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function d(t){if(Array.isArray(t))return u(t)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=Array(e);a<e;a++)i[a]=t[a];return i}var h={name:"TargetDeviceList",components:{CarDeviceSelectNew:n["default"]},props:{orderTaskId:{default:""},equipments:{type:Array,default:function(){return[]}},readOnly:{type:Boolean,default:!1},lineId:{type:[String,Number],default:""},trainNo:{type:[String,Number],default:""}},data:function(){return{allAlign:"center",targetDeviceList:[]}},watch:{equipments:{handler:function(t){this.targetDeviceList=t},deep:!0,immediate:!0}},methods:{handleDel:function(){var t=this,e=this.$refs.listTable.getCheckboxRecords();e.length<1?this.$message.warn("请选择要删除的数据"):this.$confirm({content:"确认删除选中的数据？",onOk:function(){e.map((function(e){t.targetDeviceList.map((function(a,i){e.id==a.id&&t.targetDeviceList.splice(i,1)}))})),t.$emit("update:equipments",t.targetDeviceList)}})},addAsset:function(t){var e=this,a=[];t.forEach((function(t){e.targetDeviceList.filter((function(e){return e.trainAssetId==t.id})).length?e.$message.warning("".concat(t.name,"-").concat(t.code,"已存在列表中")):a.push({orderTaskId:e.orderTaskId,trainAssetName:t.name,trainAssetId:t.id,trainAssetNo:t.code,trainAssetStructType_dictText:t.maximoAssetType})})),this.targetDeviceList=[].concat(l(this.targetDeviceList),a),this.$emit("update:equipments",this.targetDeviceList)}}},f=h,m=a("2877"),g=Object(m["a"])(f,i,r,!1,null,null,null);e["default"]=g.exports}}]);