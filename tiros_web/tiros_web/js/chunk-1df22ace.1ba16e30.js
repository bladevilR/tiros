(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1df22ace"],{"51fa":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bodyWrapper"},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"转序单"}},[t("a-input",{attrs:{placeholder:"编号/描述",allowClear:""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"状态"}},[t("a-select",{attrs:{allowClear:"",placeholder:"请选择"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}},[t("a-select-option",{attrs:{value:0}},[e._v("待处理")]),t("a-select-option",{attrs:{value:1}},[e._v("已放行")]),t("a-select-option",{attrs:{value:2}},[e._v("已驳回")])],1)],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"车号"}},[t("a-input",{attrs:{placeholder:"请输入车号",allowClear:""},model:{value:e.queryParam.trainNo,callback:function(t){e.$set(e.queryParam,"trainNo",t)},expression:"queryParam.trainNo"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"列计划ID"}},[t("a-input",{attrs:{placeholder:"请输入列计划ID",allowClear:""},model:{value:e.queryParam.planId,callback:function(t){e.$set(e.queryParam,"planId",t)},expression:"queryParam.planId"}})],1)],1)],1),t("a-row",[t("a-col",[t("span",{staticClass:"table-page-search-submitButtons"},[t("a-space",[t("a-button",{attrs:{type:"primary"},on:{click:e.handleCreateByFault}},[e._v("由故障创建")]),t("a-button",{attrs:{disabled:1!==e.records.length||0!==e.records[0].status},on:{click:function(t){return e.handleEdit(e.records[0])}}},[e._v("编辑")]),t("a-button",{attrs:{disabled:1!==e.records.length||0!==e.records[0].status},on:{click:function(t){return e.handleAllow(e.records[0])}}},[e._v("一键放行")]),t("a-button",{attrs:{disabled:1!==e.records.length||0!==e.records[0].status},on:{click:function(t){return e.handleReject(e.records[0])}}},[e._v("驳回")]),t("a-button",{attrs:{disabled:e.records.length<1},on:{click:e.handleDelete}},[e._v("删除")]),t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)])],1)],1)],1),t("div",{staticStyle:{height:"calc(100vh - 267px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(100vh - 267px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0}},on:{"checkbox-change":e.checkboxChange,"checkbox-all":e.checkboxChange}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{field:"transferCode",title:"转序编号",width:"160"}}),t("vxe-table-column",{attrs:{field:"trainNo",title:"车号",width:"90"}}),t("vxe-table-column",{attrs:{field:"orderCode",title:"工单号",width:"130"}}),t("vxe-table-column",{attrs:{field:"taskName",title:"异常工步",width:"180",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"nextProcess",title:"受影响后续工序",width:"200",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"transferDesc",title:"转序说明","min-width":"220",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"status",title:"状态",width:"90"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.row;return[t("a-tag",{attrs:{color:1===n.status?"green":2===n.status?"red":"orange"}},[e._v(" "+e._s(1===n.status?"已放行":2===n.status?"已驳回":"待处理")+" ")])]}}])}),t("vxe-table-column",{attrs:{field:"decisionType",title:"完成方式",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(1===r.decisionType?"审批流":2===r.decisionType?"一键放行":"-")+" ")]}}])}),t("vxe-table-column",{attrs:{field:"submitUserName",title:"提报人",width:"100"}}),t("vxe-table-column",{attrs:{field:"submitTime",title:"提报时间",width:"160"}}),t("vxe-table-column",{attrs:{field:"decisionUserName",title:"决策人",width:"100"}}),t("vxe-table-column",{attrs:{field:"decisionTime",title:"决策时间",width:"160"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1),t("a-modal",{attrs:{visible:e.editVisible,title:"例外转序",confirmLoading:e.saveLoading,maskClosable:!1},on:{ok:e.handleSave,cancel:function(t){e.editVisible=!1}}},[t("a-form-model",{attrs:{model:e.editModel,"label-col":{span:6},"wrapper-col":{span:16}}},[t("a-form-model-item",{attrs:{label:"故障ID"}},[t("a-input",{attrs:{disabled:!!e.editModel.id},model:{value:e.editModel.faultId,callback:function(t){e.$set(e.editModel,"faultId",t)},expression:"editModel.faultId"}})],1),t("a-form-model-item",{attrs:{label:"工单ID"}},[t("a-input",{attrs:{disabled:!!e.editModel.id},model:{value:e.editModel.orderId,callback:function(t){e.$set(e.editModel,"orderId",t)},expression:"editModel.orderId"}})],1),t("a-form-model-item",{attrs:{label:"工单任务ID"}},[t("a-input",{model:{value:e.editModel.orderTaskId,callback:function(t){e.$set(e.editModel,"orderTaskId",t)},expression:"editModel.orderTaskId"}})],1),t("a-form-model-item",{attrs:{label:"工序名称"}},[t("a-input",{model:{value:e.editModel.processName,callback:function(t){e.$set(e.editModel,"processName",t)},expression:"editModel.processName"}})],1),t("a-form-model-item",{attrs:{label:"工步名称"}},[t("a-input",{model:{value:e.editModel.stepName,callback:function(t){e.$set(e.editModel,"stepName",t)},expression:"editModel.stepName"}})],1),t("a-form-model-item",{attrs:{label:"后续工序"}},[t("a-input",{model:{value:e.editModel.nextProcess,callback:function(t){e.$set(e.editModel,"nextProcess",t)},expression:"editModel.nextProcess"}})],1),t("a-form-model-item",{attrs:{label:"转序说明"}},[t("a-textarea",{attrs:{rows:3},model:{value:e.editModel.transferDesc,callback:function(t){e.$set(e.editModel,"transferDesc",t)},expression:"editModel.transferDesc"}})],1)],1)],1)],1)},a=[],i=r("b7b4");function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return(t=u(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e){var t=d(e,"string");return"symbol"==o(t)?t:t+""}function d(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var f={name:"ExceptionTransferPage",data:function(){return{queryParam:{searchText:"",status:void 0,trainNo:"",planId:"",pageNo:1,pageSize:10},allAlign:"center",records:[],totalResult:0,tableData:[],editVisible:!1,saveLoading:!1,editModel:{}}},created:function(){this.handleRouteCreate(),this.findList()},methods:{handleRouteCreate:function(){var e=this,t=this.$route&&this.$route.query?this.$route.query:{};"1"===t.create&&t.faultId&&t.orderId&&(this.editModel={faultId:t.faultId,orderId:t.orderId,orderTaskId:t.orderTaskId||"",processName:t.processName||"",stepName:"",nextProcess:"",transferDesc:t.transferDesc||""},this.editVisible=!0,this.$nextTick((function(){e.$router.replace({path:e.$route.path,query:{}})})))},checkboxChange:function(e){this.records=e.records},findList:function(){var e=this;Object(i["C"])(this.queryParam).then((function(t){t.success&&t.result&&(e.tableData=t.result.records||[],e.totalResult=t.result.total||0,e.records=[])}))},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=r,this.findList()},handleCreateByFault:function(){this.editModel={faultId:"",orderId:"",orderTaskId:"",processName:"",stepName:"",nextProcess:"",transferDesc:""},this.editVisible=!0},handleEdit:function(e){this.editModel=s({},e),this.editVisible=!0},handleSave:function(){var e=this;if(this.editModel.faultId&&this.editModel.orderId){this.saveLoading=!0;var t=this.editModel.id?Object(i["J"])(this.editModel):Object(i["G"])(this.editModel);t.then((function(t){t.success?(e.$message.success("保存成功"),e.editVisible=!1,e.findList()):e.$message.error(t.message||"保存失败")})).finally((function(){e.saveLoading=!1}))}else this.$message.warning("故障ID和工单ID不能为空")},handleAllow:function(e){var t=this;this.$confirm({title:"确认放行",content:"确认将【".concat(e.transferCode,"】标记为可放行？"),onOk:function(){Object(i["g"])({id:e.id,status:1,decisionType:2,decisionRemark:"一键放行"}).then((function(e){e.success?(t.$message.success("放行成功"),t.findList()):t.$message.error(e.message||"放行失败")}))}})},handleReject:function(e){var t=this;this.$confirm({title:"确认驳回",content:"确认驳回【".concat(e.transferCode,"】？"),onOk:function(){Object(i["g"])({id:e.id,status:2,decisionType:2,decisionRemark:"驳回"}).then((function(e){e.success?(t.$message.success("驳回成功"),t.findList()):t.$message.error(e.message||"驳回失败")}))}})},handleDelete:function(){var e=this;this.records.length?this.$confirm({title:"确认删除",content:"确认删除选中".concat(this.records.length,"条记录？"),onOk:function(){var t=e.records.map((function(e){return e.id})).join(",");Object(i["k"])({ids:t}).then((function(t){t.success?(e.$message.success("删除成功"),e.findList()):e.$message.error(t.message||"删除失败")}))}}):this.$message.warning("请先选择记录")}}},m=f,b=r("2877"),h=Object(b["a"])(m,n,a,!1,null,"7a7cef09",null);t["default"]=h.exports},b7b4:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"j",(function(){return i})),r.d(t,"n",(function(){return o})),r.d(t,"c",(function(){return s})),r.d(t,"v",(function(){return l})),r.d(t,"x",(function(){return c})),r.d(t,"p",(function(){return d})),r.d(t,"F",(function(){return f})),r.d(t,"H",(function(){return m})),r.d(t,"r",(function(){return b})),r.d(t,"o",(function(){return p})),r.d(t,"l",(function(){return g})),r.d(t,"y",(function(){return y})),r.d(t,"a",(function(){return v})),r.d(t,"i",(function(){return j})),r.d(t,"m",(function(){return x})),r.d(t,"s",(function(){return q})),r.d(t,"B",(function(){return k})),r.d(t,"C",(function(){return P})),r.d(t,"G",(function(){return w})),r.d(t,"J",(function(){return I})),r.d(t,"g",(function(){return $})),r.d(t,"k",(function(){return M})),r.d(t,"t",(function(){return N})),r.d(t,"e",(function(){return C})),r.d(t,"u",(function(){return D})),r.d(t,"E",(function(){return L})),r.d(t,"z",(function(){return S})),r.d(t,"A",(function(){return T})),r.d(t,"d",(function(){return O})),r.d(t,"f",(function(){return _})),r.d(t,"q",(function(){return h})),r.d(t,"D",(function(){return z})),r.d(t,"I",(function(){return R})),r.d(t,"h",(function(){return E})),r.d(t,"w",(function(){return u}));var n=r("0fea"),a=function(e){return Object(n["j"])("/quality/rectify/add",e)},i=function(e){return Object(n["j"])("/quality/rectify/delete",e)},o=function(e){return Object(n["j"])("/quality/rectify/edit",e)},c=function(e){return Object(n["d"])("/quality/rectify/page",e)},s=function(e){return Object(n["j"])("/quality/rectify/close",e)},l=function(e){return Object(n["d"])("/quality/rectify/get",e)},u=function(e){return Object(n["d"])("/quality/rectify/getCode",e)},d=function(e){return Object(n["d"])("/quality/measurealert/page",e)},f=function(e){return Object(n["d"])("/quality/measurethreshold/form/page-data-form",e)},m=function(e){return Object(n["j"])("/quality/measurethreshold/threshold/save",e)},b=function(e){return Object(n["d"])("/quality/measurethreshold/threshold/list/".concat(e))},h=function(e){return Object(n["d"])("/serialPlan/plan/forms/online-form/alert-records",{dataRecordId:e})},p=function(e){return Object(n["j"])("/quality/measurethreshold/threshold/edit",e)},g=function(e){return Object(n["j"])("/quality/measurethreshold/threshold/delete",e)},y=function(e){return Object(n["d"])("/quality/measurethreshold/threshold/get",e)},v=function(e){return Object(n["j"])("/quality/leaverecord/add",e)},j=function(e){return Object(n["j"])("/quality/leaverecord/delete",e)},O=function(e){return Object(n["j"])("/quality/leaverecord/close",e)},x=function(e){return Object(n["j"])("/quality/leaverecord/edit",e)},q=function(e){return Object(n["d"])("/quality/leaverecord/page",e)},k=function(e,t){return Object(n["c"])("/quality/leaverecord/workLeaveRecordExport",e,t)},P=function(e){return Object(n["d"])("/quality/exception-transfer/page",e)},w=function(e){return Object(n["j"])("/quality/exception-transfer/add",e)},I=function(e){return Object(n["j"])("/quality/exception-transfer/edit",e)},$=function(e){return Object(n["j"])("/quality/exception-transfer/decide",e)},M=function(e){return Object(n["j"])("/quality/exception-transfer/delete",e)},N=function(e){return Object(n["d"])("/quality/record-confirm/list",e)},C=function(e){return Object(n["j"])("/quality/record-confirm/confirm",e)},D=function(e){return Object(n["d"])("/quality/record-confirm/work-record/get",e)},S=function(e){return Object(n["d"])("/serialPlan/plan/forms/check-record/get",e)},T=function(e){return Object(n["d"])("/workcheck/get",e)},_=function(e){return Object(n["j"])("/quality/record-confirm/confirm",e)},L=function(e){return Object(n["d"])("/quality/record-confirm/page",e)},z=function(e){return Object(n["d"])("/quality/record-confirm/page/check-record",e)},R=function(e){return Object(n["j"])("/serialPlan/plan/forms/judge/save",e)},E=function(e){return Object(n["j"])("/serialPlan/plan/forms/judge/delete",e)}}}]);