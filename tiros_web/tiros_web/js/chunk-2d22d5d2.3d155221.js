(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22d5d2"],{f6d0:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",[t.fromFlow?t._e():e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:12,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden","margin-bottom":"8px"}},[e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.save}},[t._v("确认领用")]),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.close}},[t._v("关闭")])],1)])],1),e("div",{staticStyle:{height:"calc(70vh - 45px)"}},[e("vxe-table",{ref:"listTable",attrs:{border:"","max-height":"100%",align:t.allAlign,data:t.tableData,"show-overflow":"tooltip","edit-config":{trigger:"click",mode:"row"},"checkbox-config":{highlight:!0,range:!0}}},[e("vxe-table-column",{attrs:{type:"seq",width:"40",fixed:"left"}}),e("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeCode",title:"物资编码",width:"150"}}),e("vxe-table-column",{attrs:{field:"materialTypeName",title:"物资名称","min-width":"180","header-align":"center",align:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeSpec",title:"规格型号","min-width":"180","header-align":"center",align:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeUnit",title:"单位",width:"100"}}),e("vxe-table-column",{attrs:{field:"useCategory_dictText",title:"类别",width:"100"}}),e("vxe-table-column",{attrs:{field:"amount",title:"申请数量",width:"100"}}),e("vxe-table-column",{attrs:{field:"receive",title:"发料数量",width:"100"}}),e("vxe-table-column",{attrs:{field:"sourceLocationAndPalletName",title:"发放信息",width:"380","sort-type":"string",sortable:""}}),e("vxe-table-column",{attrs:{field:"status_dictText",title:"确认状态",width:"100"}}),e("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"150","header-align":"center",align:"left"}})],1)],1),e("ApplyDistributionModal",{ref:"distributionModal",attrs:{dataList:t.distributionTableList},on:{ok:t.onSuccess}})],1)},n=[],l=i("c54ca"),r=i("2eb4"),o=i("8973");function s(t){return f(t)||d(t)||u(t)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(t,e){if(t){if("string"==typeof t)return m(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?m(t,e):void 0}}function d(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function f(t){if(Array.isArray(t))return m(t)}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=Array(e);i<e;i++)a[i]=t[i];return a}var b={name:"ApplyConfirmComponent",components:{ApplyDistributionModal:r["default"]},props:{businessKey:{type:String,default:null},isReadonly:{type:Boolean,default:!0},fromFlow:{type:Boolean,default:!1},orderType:{type:Number,default:null}},data:function(){return{tableData:[],palletList:[],distributionTableList:[],model:{},allAlign:"center",dictCode:"bu_material_pallet,name,id,status=1",queryParam:{orderId:"",status:[1]}}},mounted:function(){this.businessKey&&this.edit(this.businessKey)},methods:{edit:function(t){this.queryParam.orderId=t,this.findList()},findList:function(){var t=this;this.tableData=[],Object(l["bb"])(this.queryParam).then((function(e){e.success?(t.tableData=[].concat(s(t.tableData),s(e.result)),o["a"].joinDistributionInfo(t.tableData)):t.$message.error("加载数据失败"),t.$emit("loaded")}))},save:function(t){var e=this;if(this.tableData&&this.tableData.length>0){var i=this.tableData.map((function(t,e){return t.id}));if(0===i.length)return this.$message.warn("没有要确认领料的物资，无法继续！"),void this.$emit("fail",{message:"没有要确认领料的物资，无法继续！"});var a={fromType:2,ids:i.join(",")};Object(l["j"])(a).then((function(t){t.success?e.$emit("ok"):e.$emit("fail",t)})).catch((function(t){e.$message.error("保存异常"),e.$emit("fail",{message:"保存异常！"})}))}else this.$emit("ok")},close:function(){this.$emit("close")},openDistribution:function(t){this.$refs.distributionModal.showModal(t)},onSuccess:function(){var t=this;this.tableData.forEach((function(e){e.receive=0,t.distributionTableList.forEach((function(t){t.applyDetailId===e.id&&(e.receive+=Number(t.amount))}))}))}}},h=b,p=i("2877"),y=Object(p["a"])(h,a,n,!1,null,"1c988508",null);e["default"]=y.exports}}]);