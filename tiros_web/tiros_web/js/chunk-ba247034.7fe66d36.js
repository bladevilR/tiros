(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ba247034"],{"1f43":function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bgm"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.departVisible,expression:"!departVisible"}],attrs:{id:"loader-wrapper"}},[e("div",{attrs:{id:"loader"}}),e("div",{staticClass:"loader-section section-left"}),e("div",{staticClass:"loader-section section-right"}),e("div",{staticClass:"load_title"},[t._v("正在加载,请耐心等待")])]),e("a-modal",{attrs:{title:"登录部门选择",width:450,visible:t.departVisible,closable:!1,maskClosable:!1}},[e("template",{slot:"footer"},[e("a-button",{attrs:{type:"primary"},on:{click:t.departOk}},[t._v("确认")])],1),e("a-form",[e("a-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{labelCol:{span:4},wrapperCol:{span:20},"validate-status":t.validate_status}},[e("a-tooltip",{attrs:{placement:"topLeft"}},[e("template",{slot:"title"},[e("span",[t._v("您隶属于多部门，请选择登录部门")])]),e("a-avatar",{staticStyle:{backgroundColor:"#87d068"},attrs:{icon:"gold"}})],2),e("a-select",{class:{"valid-error":"error"==t.validate_status},staticStyle:{"margin-left":"10px",width:"80%"},attrs:{placeholder:"请选择登录部门"},on:{change:t.departChange}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"gold"},slot:"suffixIcon"}),t._l(t.departList,(function(r){return e("a-select-option",{key:r.id,attrs:{value:r.orgCode}},[t._v(" "+t._s(r.departName)+" ")])}))],2)],1)],1)],2)],1)},a=[],i=r("9fb0"),n=r("2ca2"),o=r("2f62"),c=r("ca00"),l=r("2b0e"),u=r("0fea"),d=r("9da4"),p=r("4360"),f=r("ed3b"),h=r("4328"),m=r.n(h);function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function v(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function g(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?v(Object(r),!0).forEach((function(e){y(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function y(t,e,r){return(e=w(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w(t){var e=O(t,"string");return"symbol"==b(e)?e:e+""}function O(t,e){if("object"!=b(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var s=r.call(t,e||"default");if("object"!=b(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var S={components:{TwoStepCaptcha:n["default"]},data:function(){return{departList:[],departVisible:!1,departSelected:"",validate_status:""}},created:function(){this.currdatetime=(new Date).getTime(),l["default"].ls.remove(i["a"]),this.getRouterData(),f["a"].destroyAll()},mounted:function(){var t=this,e=m.a.parse(location.search.substring(1)),r=e.token;if(r)try{l["default"].ls.set(i["n"],new Date),this.ThirdLogin(r).then((function(e){e.success?t.departConfirm(e):t.requestFailed(e)}))}catch(s){}else this.$router.push("/sso/check")},methods:g(g({},Object(o["b"])(["ThirdLogin"])),{},{requestFailed:function(t){this.$notification["error"]({message:"登录失败",description:((t.response||{}).data||{}).message||t.message||"请求出现错误，请稍后再试",duration:4})},departConfirm:function(t){if(t.success){this.departList=t.result.departs;var e=t.result.multi_depart;0===e?(this.loginSuccess(),this.$notification.warn({message:"提示",description:"您尚未归属部门,请确认账号信息",duration:3})):2===e?(this.departVisible=!0,this.departList=t.result.departs):this.loginSuccess()}else this.requestFailed(t),this.Logout()},departOk:function(){var t=this;if(!this.departSelected)return this.validate_status="error",!1;var e={orgCode:this.departSelected,username:this.form.getFieldValue("username")};Object(u["k"])("/sys/selectDepart",e).then((function(e){if(e.success){var r=e.result.userInfo;l["default"].ls.set(i["s"],r,6048e5),p["a"].commit("SET_INFO",r),t.loginSuccess(),t.departClear()}else t.requestFailed(e),t.Logout().then((function(){t.departClear()}))}))},departClear:function(){this.departList=[],this.departSelected="",this.currentUsername="",this.departVisible=!1,this.validate_status=""},departChange:function(t){this.validate_status="success",this.departSelected=t},getRouterData:function(){var t=this;this.$nextTick((function(){t.$route.params.username&&t.form.setFieldsValue({username:t.$route.params.username})}))},loginSuccess:function(){var t=this.$store.getters.userInfo.departId;if(this.departList&&this.departList.length>0){var e=this.departList.filter((function(e){return e.id===t}));e&&e.length>0&&p["a"].commit("SET_DEPARTNAME",e[0].departName)}this.$router.push({path:i["m"]}),this.$notification.success({message:"欢迎",description:"".concat(Object(c["s"])(),"，欢迎回来")})},getEncrypte:function(){var t=this,e=l["default"].ls.get(i["k"]);null==e?Object(d["a"])().then((function(e){t.encryptedString=e})):this.encryptedString=e}})},j=S,C=(r("67ee"),r("2877")),_=Object(C["a"])(j,s,a,!1,null,"394bb65c",null);e["default"]=_.exports},"2ffd":function(t,e,r){},"67ee":function(t,e,r){"use strict";r("2ffd")}}]);