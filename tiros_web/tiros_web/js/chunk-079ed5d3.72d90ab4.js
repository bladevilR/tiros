(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-079ed5d3","chunk-2d0df437","chunk-2d0df437"],{"500a":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:"选择规程",centered:"",visible:e.visible,bodyStyle:{height:"70vh"},confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{staticStyle:{"border-right":"1px dotted #D3E1F1",height:"calc(70vh - 20px)","margin-right":"8px",padding:"0px"},attrs:{md:4,sm:24}},[t("a-menu",{attrs:{mode:"inline","default-selected-keys":e.defaultKey},on:{click:e.handleMenuClick}},e._l(e.treeData,(function(a){return t("a-menu-item",{key:a.id},[t("a-icon",{attrs:{type:"container"}}),t("span",[e._v(e._s(a.name))])],1)})),1)],1),t("a-col",{attrs:{md:19,sm:24}},[this.planId?t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"是否已关联"}},[t("j-dict-select-tag",{attrs:{dictCode:"bu_state","allow-clear":""},model:{value:e.tpPlanRelated,callback:function(t){e.tpPlanRelated=t},expression:"tpPlanRelated"}})],1)],1),t("a-col",{attrs:{md:3,sm:8}},[t("a-form-item",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1)],1):e._e(),t("div",{staticStyle:{height:"calc(70vh - 20px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(70vh - 20px)"},attrs:{border:"","row-id":"id","max-height":"100%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"},"radio-config":e.multiple?{}:{trigger:"row",checkMethod:e.checkRadioMethod},"checkbox-config":e.multiple?{checkStrictly:e.checkStrictly,trigger:"row",highlight:!0}:{},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"title",title:"名称","tree-node":"",align:"left"}}),t("vxe-table-column",{attrs:{field:"no",title:"序号",width:"80"}}),t("vxe-table-column",{attrs:{field:"type_dictText",title:"类型",width:"100"}}),t("vxe-table-column",{attrs:{field:"method_dictText",title:"维保手段",width:"120"}}),t("vxe-table-column",{attrs:{field:"qualityLevel",title:"质保等级",width:"80"}}),t("vxe-table-column",{attrs:{field:"safeNotice",title:"安全提示",width:"160"}}),t("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"120"}}),this.planId?t("vxe-table-column",{attrs:{field:"tpPlanRelatedInfo",title:"模板已关联",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){var l=a.row;return[t("div",{style:{backgroundColor:e.statusColor[l.tpPlanRelated+""],borderRadius:"4px"}},[e._v(" "+e._s(l.tpPlanRelatedInfo)+" ")])]}}],null,!1,2972306538)}):e._e()],1)],1)])],1)],1)},i=[],n=a("8fad"),r={name:"RegulationList",props:{multiple:{type:Boolean,default:!1},checkStrictly:{type:Boolean,default:!0},reguId:{type:String,default:""},planId:{type:String,default:""},trainTypeId:{type:String,default:""},onlyProject:{type:Boolean,default:!1}},data:function(){return{visible:!1,confirmLoading:!1,statusColor:{0:"#dedede",1:"#bad795"},treeData:[],curReguId:"",tableData:[],allAlign:"center",defaultKey:[],tpPlanRelated:"",formItemLayout:{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}}}},methods:{showModal:function(){this.visible=!0,this.getTreeList()},checkRadioMethod:function(e){var t=e.row;return!this.onlyProject||1===t.type},getTreeList:function(){var e=this;this.reguId?Object(n["Ib"])(this.reguId).then((function(t){t.success?(e.curReguId=e.reguId,e.treeData=[t.result],e.getReguDetailList(e.curReguId)):e.$message.error("获取规程信息失败")})).catch((function(t){e.$message.error("获取规程信息异常")})):Object(n["Lb"])({trainTypeId:this.trainTypeId}).then((function(t){t.success?(e.defaultKey[0]=t.result[0].id,e.curReguId=t.result[0].id,e.treeData=t.result,e.getReguDetailList(e.curReguId)):e.$message.error("获取规程信息失败")})).catch((function(t){e.$message.error("获取规程信息异常")}))},findList:function(){var e=this,t={reguId:this.reguId,tpPlanId:this.planId,tpPlanRelated:this.tpPlanRelated};Object(n["Kb"])(t).then((function(t){e.tableData=t.result}))},getReguDetailList:function(e){var t=this,a={reguId:e,tpPlanId:this.planId,tpPlanRelated:this.tpPlanRelated};Object(n["Kb"])(a).then((function(e){t.tableData=e.result}))},loadChildrenMethod:function(e){var t=this,a={reguId:this.reguId,parentId:e.row.id,tpPlanId:this.planId,tpPlanRelated:this.tpPlanRelated};return new Promise((function(e){Object(n["Kb"])(a).then((function(a){a.success?e(a.result):t.$message.error("".concat(a.msg))}))}))},onSelect:function(e,t){var a=t.node.dataRef;e.length>0&&(this.curReguId=a.id,this.getReguDetailList(a.id))},handleMenuClick:function(e){this.getReguDetailList(e.key)},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.close()},handleCancel:function(){this.close()},close:function(){this.visible=!1}}},o=r,s=(a("5125"),a("2877")),c=Object(s["a"])(o,l,i,!1,null,"210f6b5e",null);t["default"]=c.exports},5125:function(e,t,a){"use strict";a("d059")},"52ae":function(e,t,a){"use strict";a("e2cd")},"88bc":function(e,t,a){(function(t){var a=1/0,l=9007199254740991,i="[object Arguments]",n="[object Function]",r="[object GeneratorFunction]",o="[object Symbol]",s="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,u=s||c||Function("return this")();function d(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function h(e,t){var a=-1,l=e?e.length:0,i=Array(l);while(++a<l)i[a]=t(e[a],a,e);return i}function f(e,t){var a=-1,l=t.length,i=e.length;while(++a<l)e[i+a]=t[a];return e}var m=Object.prototype,g=m.hasOwnProperty,p=m.toString,b=u.Symbol,v=m.propertyIsEnumerable,y=b?b.isConcatSpreadable:void 0,w=Math.max;function R(e,t,a,l,i){var n=-1,r=e.length;a||(a=k),i||(i=[]);while(++n<r){var o=e[n];t>0&&a(o)?t>1?R(o,t-1,a,l,i):f(i,o):l||(i[i.length]=o)}return i}function I(e,t){return e=Object(e),x(e,t,(function(t,a){return a in e}))}function x(e,t,a){var l=-1,i=t.length,n={};while(++l<i){var r=t[l],o=e[r];a(o,r)&&(n[r]=o)}return n}function C(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var a=arguments,l=-1,i=w(a.length-t,0),n=Array(i);while(++l<i)n[l]=a[t+l];l=-1;var r=Array(t+1);while(++l<t)r[l]=a[l];return r[t]=n,d(e,this,r)}}function k(e){return L(e)||P(e)||!!(y&&e&&e[y])}function j(e){if("string"==typeof e||M(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function P(e){return S(e)&&g.call(e,"callee")&&(!v.call(e,"callee")||p.call(e)==i)}var L=Array.isArray;function O(e){return null!=e&&_(e.length)&&!T(e)}function S(e){return $(e)&&O(e)}function T(e){var t=D(e)?p.call(e):"";return t==n||t==r}function _(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=l}function D(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function $(e){return!!e&&"object"==typeof e}function M(e){return"symbol"==typeof e||$(e)&&p.call(e)==o}var N=C((function(e,t){return null==e?{}:I(e,h(R(t,1),j))}));e.exports=N}).call(this,a("c8ba"))},d059:function(e,t,a){},e2cd:function(e,t,a){},f020:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e._self._c;return t("a-drawer",{attrs:{title:e.title,maskClosable:!0,closable:!0,width:600,visible:e.visible},on:{close:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"关联规程项"}},[t("a-select",{ref:"mySelect",attrs:{placeholder:"请选择规程项",open:!1,showArrow:!0},on:{focus:e.openModal},model:{value:e.ReguName,callback:function(t){e.ReguName=t},expression:"ReguName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"项目序号"}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["recIndex",e.validatorRules.recIndex],expression:"['recIndex', validatorRules.recIndex ]",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{max:2147483647,id:"inputNumber"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"项目名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["reguTitle",e.validatorRules.reguTitle],expression:"['reguTitle', validatorRules.reguTitle]",modifiers:{trim:!0}}],on:{change:e.onChange}})],1)],1)],1),t("div",{staticClass:"drawer-bootom-button"},[t("a-button",{staticStyle:{"margin-right":"0.8rem"},on:{click:e.handleCancel}},[e._v("取消")]),t("a-button",{attrs:{type:"primary",loading:e.confirmLoading},on:{click:e.handleSubmit}},[e._v("提交")])],1),t("regulation-list",{ref:"modalForm",attrs:{multiple:!1,onlyProject:!1},on:{ok:e.selectRegulation}})],1)},i=[],n=a("88bc"),r=a.n(n),o=a("8fad"),s=a("500a"),c={name:"CatItemModal",components:{RegulationList:s["default"]},props:["recordId"],data:function(){return{value:1,title:"操作",status:1,switchCheck:!0,ReguName:"",queryParam:{workRecId:"",reguDetailId:""},visible:!1,regu:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{recIndex:{rules:[{required:!0,message:"请输入项目序号!"}]},reguTitle:{rules:[{required:!0,message:"请输入项目名称!"},{max:64,message:"输入长度不能超过64字符!"}]}}}},methods:{openModal:function(){this.$refs.modalForm.showModal(),this.$refs.mySelect.blur()},add:function(){this.edit({})},edit:function(e){var t=this;this.queryParam.workRecId=this.recordId,this.queryParam.reguDetailId="",this.ReguName="",e.id&&(this.ReguName=e.reguName),this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue(r()(t.model,"recIndex","reguTitle"))}))},onChange:function(e){this.regu=!0,null==e.data&&(this.regu=!1)},switchChange:function(e){e?(this.status=1,this.switchCheck=!0):(this.status=0,this.switchCheck=!1)},selectRegulation:function(e){this.ReguName=e[0].title,this.queryParam.reguDetailId=e[0].id,this.regu||this.form.setFieldsValue({reguTitle:e[0].title})},handleSubmit:function(){var e=this,t=this;t.form.validateFields((function(a,l){if(!a){t.confirmLoading=!0;var i=Object.assign(t.model,l,e.queryParam);Object(o["Rc"])(i).then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok")):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1,t.close()}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},u=c,d=(a("52ae"),a("2877")),h=Object(d["a"])(u,l,i,!1,null,"adc13086",null);t["default"]=h.exports}}]);