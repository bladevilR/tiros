(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a427ed3","chunk-8f95e8e6","chunk-2d0c89b7"],{"1a6f":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",[e("div",{style:t.containerHeightStyle},[e("div",{staticClass:"info-wrapper info-top-wrapper",staticStyle:{"margin-top":"10px"}},[e("h4",[t._v("故障信息")]),e("a-descriptions",{attrs:{size:"default",bordered:"",column:6}},[e("a-descriptions-item",{attrs:{label:"故障编号",span:2}},[t._v(" "+t._s(t.detail.faultSn)+" ")]),e("a-descriptions-item",{attrs:{label:"发现时间",span:2}},[t._v(" "+t._s(t.detail.happenTime)+" ")]),e("a-descriptions-item",{attrs:{label:"线路",span:2}},[t._v(" "+t._s(t.detail.lineName)+" ")]),e("a-descriptions-item",{attrs:{label:"车辆",span:2}},[t._v(" "+t._s(t.detail.trainNo)+" ")]),e("a-descriptions-item",{attrs:{label:"系统",span:2}},[t._v(" "+t._s(t.detail.sysName)+" ")]),e("a-descriptions-item",{attrs:{label:"子系统",span:2}},[t._v(" "+t._s(t.detail.subSysName)+" ")]),e("a-descriptions-item",{attrs:{label:"部件",span:2}},[t._v(" "+t._s(t.detail.faultAssetName)+" ")]),e("a-descriptions-item",{attrs:{label:"发现阶段",span:2}},[t._v(" "+t._s(t.detail.phase_dictText)+" ")]),e("a-descriptions-item",{attrs:{label:"故障等级",span:2}},[t._v(" "+t._s(t.detail.faultLevel_dictText)+" ")]),e("a-descriptions-item",{attrs:{label:"是否正线",span:2}},[t._v(" "+t._s(t.detail.faultOnline_dictText)+" ")]),e("a-descriptions-item",{attrs:{label:"是否委外",span:2}},[t._v(" "+t._s(t.detail.outsource_dictText)+" ")]),1==t.detail.outsource?e("a-descriptions-item",{attrs:{label:"所属厂商",span:6}},[t._v(" "+t._s(t.detail.outSupplierName)+" ")]):t._e(),e("a-descriptions-item",{attrs:{label:"列计划",span:6}},[t._v(" "+t._s(t.detail.planName)+" ")]),e("a-descriptions-item",{attrs:{label:"故障描述",span:6}},[t._v(" "+t._s(t.detail.faultDesc)+" ")]),e("a-descriptions-item",{attrs:{label:"故障代码",span:6}},[t._v(" "+t._s(t.detail.faultCodeCode)+" "),e("span",{staticStyle:{color:"#c1c1c1","margin-left":"20px"}},[t._v(" （ "),e("a-space",[t._l(t.getFaultdetailList,(function(a,i){return e("span",{key:i},[t._v("故障"+t._s(a.fltLevel_dictText)+"："+t._s(a.fltCode)+"-"+t._s(a.fltName)+"；")])})),e("span",[t._v("故障部件："+t._s(t.detail.faultCodeCode)+"-"+t._s(t.detail.faultCodeCodeDes))])],2),t._v(" ） ")],1)]),e("a-descriptions-item",{attrs:{label:"故障状态",span:6}},[t._v(" "+t._s(t.detail.status_dictText)+" ")])],1)],1),e("div",{staticClass:"info-wrapper info-top-wrapper"},[e("h4",[t._v("提报信息")]),e("a-descriptions",{attrs:{bordered:"",column:6}},[e("a-descriptions-item",{attrs:{label:"提报班组",span:2}},[t._v(" "+t._s(t.detail.reportGroupName)+" ")]),e("a-descriptions-item",{attrs:{label:"提报人员",span:2}},[t._v(" "+t._s(t.detail.reportUserName)+" ")]),e("a-descriptions-item",{attrs:{label:"提报时间",span:2}},[t._v(" "+t._s(t.detail.reportTime)+" ")]),e("a-descriptions-item",{attrs:{label:"责任工程师",span:2}},[t._v(" "+t._s(t.detail.dutyEngineerName)+" ")])],1)],1),e("div",{staticClass:"info-wrapper info-top-wrapper"},[e("h4",[t._v("处理信息")]),e("a-descriptions",{attrs:{bordered:"",column:6}},[e("a-descriptions-item",{attrs:{label:"处理班组",span:2}},[t._v(" "+t._s(t.handleModel.solutionGroupName)+" ")]),e("a-descriptions-item",{attrs:{label:"处理人员",span:2}},[t._v(" "+t._s(t.handleModel.solutionUserName)+" ")]),e("a-descriptions-item",{attrs:{label:"处理时间",span:2}},[t._v(" "+t._s(t.handleModel.solutionTime)+" ")]),e("a-descriptions-item",{attrs:{label:"处理结果",span:6}},[t._v(" "+t._s(t.detail.handleStatus_dictText)+" ")]),e("a-descriptions-item",{attrs:{label:"关闭时间",span:2}},[t._v(" "+t._s(t.detail.closeTime)+" ")]),e("a-descriptions-item",{attrs:{label:"关闭人员",span:4}},[t._v(" "+t._s(t.detail.closeUserName)+" ")]),e("a-descriptions-item",{attrs:{label:"原因描述",span:4}},[t._v(" "+t._s(t.handleModel.reasonDesc)+" ")]),e("a-descriptions-item",{attrs:{label:"措施描述",span:4}},[t._v(" "+t._s(t.handleModel.solutionDesc)+" ")])],1)],1),e("div",{staticClass:"info-wrapper info-top-wrapper"},[e("h4",[t._v("附件")]),0===t.annexList.length?e("div",[t._v("暂无数据")]):e("div",t._l(t.annexList,(function(a,i){return e("ul",{key:i},[e("li",[e("a-icon",{attrs:{type:"file"}}),e("a",{on:{click:function(e){return t.handleSeeing(a)}}},[t._v(" "+t._s(a.name))])],1)])})),0)]),e("doc-preview-modal",{ref:"docPreview",attrs:{title:t.fileName}})],1)])},r=[],n=a("b47d"),l=a("ca00"),s=a("353a"),o={data:function(){return{fileName:"",annexList:[],detail:{},handleModel:{},getFaultdetailList:[],containerHeightStyle:{height:this.height,overflowY:"auto"}}},components:{DocPreviewModal:s["default"]},props:{businessKey:{type:String,default:null},isReadonly:{type:Boolean,default:!0},fromFlow:{type:Boolean,default:!1},height:{type:String,default:"100%"}},mounted:function(){this.businessKey&&this.show(this.businessKey)},methods:{getFaultdetail:function(t){var e=this;this.getFaultdetailLoading=!0,Object(n["db"])({code:t}).then((function(t){t.success&&t.result.length&&(e.getFaultdetailList=t.result.filter((function(t){return 0!=t.fltLevel&&3!=t.fltLevel}))),e.getFaultdetailLoading=!1,e.$emit("loaded")})).catch((function(t){e.getFaultdetailLoading=!1}))},show:function(t){var e=this;Object(l["e"])(t)||Object(n["P"])({id:t}).then((function(t){var a=t.result;e.detail=a,a.faultCodeId&&e.getFaultdetail(a.faultCodeId),e.annexList=a.annexList,Object(l["e"])(a.handleRecordList)||(e.handleModel=a.handleRecordList[0]),e.$emit("loaded")}))},handleSeeing:function(t){this.fileName=t.name,this.$refs.docPreview.handleFilePath(t.savepath)}}},c=o,d=(a("3206"),a("2877")),u=Object(d["a"])(c,i,r,!1,null,"21f53256",null);e["default"]=u.exports},3206:function(t,e,a){"use strict";a("932f")},3281:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:"详情",width:"100%",centered:"",visible:t.visible,dialogClass:"fullDialog no-footer",footer:null,destroyOnClose:!0,cancelText:"关闭"},on:{cancel:t.handleCancel}},[e("BreakdowmDetailItem",{ref:"BreakdowmDetailItem"})],1)},r=[],n=a("1a6f"),l={name:"BreakdownModal",components:{BreakdowmDetailItem:n["default"]},data:function(){return{visible:!1}},created:function(){},methods:{show:function(t){var e=this;this.visible=!0,this.$nextTick((function(){e.$refs.BreakdowmDetailItem.show(t)}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},s=l,o=a("2877"),c=Object(o["a"])(s,i,r,!1,null,"7dee63a6",null);e["default"]=c.exports},"51cf":function(t,e,a){},5633:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("span",[e("a-select",{key:t.key,attrs:{"allow-clear":"",value:t.getValueSting,disabled:t.disabled,placeholder:"线路"},on:{change:t.handleChange,select:t.onSelect}},[e("a-select-option",{attrs:{value:void 0}},[t._v("请选择")]),t._l(t.optionData,(function(a,i){return e("a-select-option",{key:i,attrs:{value:a.lineId}},[e("span",{staticStyle:{display:"inline-block",width:"100%"},attrs:{title:a.lineName}},[t._v(" "+t._s(a.lineName)+" ")])])}))],2)],1)},r=[],n=a("8fad"),l={name:"LineSelectList",props:{value:[String],triggerChange:Boolean,disabled:Boolean,defaultFirst:Boolean},data:function(){return{optionData:[],selectValue:"",key:0}},created:function(){this.findList()},computed:{getValueSting:function(){return null!=this.value?this.value.toString():void 0}},methods:{findList:function(){var t=this;Object(n["wb"])().then((function(e){e.success&&(t.optionData=e.result,t.defaultFirst&&t.optionData&&t.optionData.length>0&&setTimeout((function(){t.$emit("change",t.optionData[0].lineId),t.$emit("input",t.optionData[0].lineId)}),500))}))},handleChange:function(t,e){var a="";if(e&&e.componentOptions.children[0].data&&(a=e.componentOptions.children[0].data.attrs.title),this.$emit("change",t),this.$emit("input",t),this.$emit("changeName",a),this.triggerChange)if(t){var i=this.optionData[e.key];this.$emit("change",t,i)}else this.$emit("change",t,null)},onSelect:function(t,e){if(t){var a=this.optionData[e.data.key];this.$emit("select",t,a)}else this.$emit("select","",null)}}},s=l,o=a("2877"),c=Object(o["a"])(s,i,r,!1,null,"77265147",null);e["default"]=c.exports},"5eda":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bodyWrapper"},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline",form:t.form}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"来源"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"fault_from_type"},model:{value:t.queryParam.fromType,callback:function(e){t.$set(t.queryParam,"fromType",e)},expression:"queryParam.fromType"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"线路"}},[e("line-select-list",{model:{value:t.lineId,callback:function(e){t.lineId=e},expression:"lineId"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"车辆"}},[e("j-dict-select-seach-tag",{attrs:{dictCode:t.dictTrainStr,"trigger-change":!0},on:{focus:t.handleTrainFocus,change:t.handleTrainNo},model:{value:t.queryParam.trainNo,callback:function(e){t.$set(t.queryParam,"trainNo",e)},expression:"queryParam.trainNo"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"处理"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_fault_status"},model:{value:t.queryParam.status,callback:function(e){t.$set(t.queryParam,"status",e)},expression:"queryParam.status"}})],1)],1),e("a-col",{attrs:{md:4,sm:12}},[e("a-form-item",{attrs:{label:"时间"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_date_type"},model:{value:t.queryParam.dateType,callback:function(e){t.$set(t.queryParam,"dateType",e)},expression:"queryParam.dateType"}})],1)],1),"1"===t.queryParam.dateType||1===t.queryParam.dateType||"2"===t.queryParam.dateType?e("a-col",{attrs:{md:4,sm:12}},[e("a-form-item",[e("a-date-picker",{staticStyle:{width:"100%"},attrs:{mode:"year",placeholder:"请选择年份",format:"YYYY",open:t.yearPickShow},on:{panelChange:t.handlePanelChange,openChange:t.handleOpenChange},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}})],1)],1):t._e(),"2"===t.queryParam.dateType?e("a-col",{attrs:{md:4,sm:12}},[e("a-form-item",[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_quarter_type"},model:{value:t.queryParam.quarter,callback:function(e){t.$set(t.queryParam,"quarter",e)},expression:"queryParam.quarter"}})],1)],1):t._e(),"3"===t.queryParam.dateType?e("a-col",{attrs:{md:4,sm:12}},[e("a-form-item",[e("a-month-picker",{attrs:{placeholder:"选择月份"},model:{value:t.month,callback:function(e){t.month=e},expression:"month"}})],1)],1):t._e(),"4"===t.queryParam.dateType?e("a-col",{attrs:{md:6,sm:12}},[e("a-form-item",[e("a-range-picker",{attrs:{defaultPickerValue:t.defaultDateRange},model:{value:t.rangeDate,callback:function(e){t.rangeDate=e},expression:"rangeDate"}})],1)],1):t._e()],1),e("a-row",{style:{display:t.expand?"block":"none"},attrs:{gutter:24}},[e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"工班"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:t.dictGroupStr},model:{value:t.reportGroupId,callback:function(e){t.reportGroupId=e},expression:"reportGroupId"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-model-item",{attrs:{label:"部件"}},[e("a-select",{ref:"faultAssetSelect",attrs:{allowClear:"",placeholder:"请选择",open:!1,showArrow:!0},on:{change:t.allowClearCHange,dropdownVisibleChange:t.showAssetModal},model:{value:t.faultAssetName,callback:function(e){t.faultAssetName=e},expression:"faultAssetName"}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"工位"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:t.dictCodeStrWork},model:{value:t.queryParam.workstationId,callback:function(e){t.$set(t.queryParam,"workstationId",e)},expression:"queryParam.workstationId"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"等级"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_fault_level"},model:{value:t.queryParam.level,callback:function(e){t.$set(t.queryParam,"level",e)},expression:"queryParam.level"}})],1)],1)],1),e("a-row",{style:{display:t.expand?"block":"none"},attrs:{gutter:24}},[e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"阶段"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_fault_phase"},model:{value:t.queryParam.phase,callback:function(e){t.$set(t.queryParam,"phase",e)},expression:"queryParam.phase"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"正线"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_state"},model:{value:t.queryParam.online,callback:function(e){t.$set(t.queryParam,"online",e)},expression:"queryParam.online"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"有责"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_state"},model:{value:t.queryParam.hasDuty,callback:function(e){t.$set(t.queryParam,"hasDuty",e)},expression:"queryParam.hasDuty"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"取消"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_state"},model:{value:t.queryParam.canceled,callback:function(e){t.$set(t.queryParam,"canceled",e)},expression:"queryParam.canceled"}})],1)],1)],1),e("a-row",{style:{display:t.expand?"block":"none"},attrs:{gutter:24}},[e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"系统"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_train_asset_type,name,id,struct_type=1 and parent_id is null"},model:{value:t.queryParam.sysId,callback:function(e){t.$set(t.queryParam,"sysId",e)},expression:"queryParam.sysId"}})],1)],1),e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"列计划"}},[e("a-select",{ref:"planSelect",attrs:{placeholder:"请选择列计划",open:!1,showArrow:!0},on:{focus:t.openTrainPlanModal},model:{value:t.planName,callback:function(e){t.planName=e},expression:"planName"}},[e("div",{attrs:{slot:"suffixIcon"},slot:"suffixIcon"},[t.queryParam.planId?e("a-icon",{staticStyle:{"padding-right":"3px"},attrs:{type:"close-circle"},on:{click:function(e){return e.stopPropagation(),t.clearValue.apply(null,arguments)}}}):e("a-icon",{attrs:{type:"ellipsis"}})],1)])],1)],1)],1),e("a-row",[e("a-col",[e("span",{staticClass:"table-page-search-submitButtons"},[e("a-space",[e("a-button",{on:{click:t.findList}},[t._v("查询")]),e("a-button",{on:{click:t.resetSearch}},[t._v("重置")]),e("a-button",{attrs:{disabled:!(1==t.records.length&&2!==t.records[0].status)},on:{click:function(e){return e.stopPropagation(),t.handleEdit(t.records[0])}}},[t._v("编辑")]),e("a-button",{attrs:{disabled:t.records.length<1},on:{click:t.deleteRecord}},[t._v("取消")]),e("a-button",[e("a",{style:{fontSize:"12px"},on:{click:t.toggle}},[t._v(" 更多条件 "),e("a-icon",{attrs:{type:t.expand?"up":"down"}})],1)])],1)],1)])],1)],1)],1),e("div",{style:t.tableHeight.top},[e("vxe-table",{ref:"listTable",style:t.tableHeight.bottom,attrs:{border:"","max-height":t.tableHeight.size,align:t.allAlign,data:t.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"},"checkbox-config":{trigger:"row",highlight:!0,range:!0}},on:{"checkbox-change":t.checkboxChange,"checkbox-all":t.checkboxChange}},[e("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),e("vxe-table-column",{attrs:{field:"faultSn",title:"故障编号",width:"140"},scopedSlots:t._u([{key:"default",fn:function(a){var i=a.row;return[e("a",{on:{click:function(e){return e.stopPropagation(),t.faultDetail(i)}}},[t._v(t._s(i.faultSn))])]}}])}),e("vxe-table-column",{attrs:{field:"fromType_dictText",title:"来源",width:"120"}}),e("vxe-table-column",{attrs:{field:"lineName",title:"线路",width:"80"}}),e("vxe-table-column",{attrs:{field:"trainNo",title:"车号",width:"80"}}),e("vxe-table-column",{attrs:{field:"sysName",title:"故障系统","min-width":"100"}}),e("vxe-table-column",{attrs:{field:"faultAssetName",align:"left","header-align":"center",title:"故障部件","min-width":"100"}}),e("vxe-table-column",{attrs:{field:"faultDesc",title:"故障描述","min-width":"160",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{field:"happenTime",title:"发现时间",width:"100"}}),e("vxe-table-column",{attrs:{field:"reportUserName",align:"left","header-align":"center",title:"提报人员",width:"100"}}),e("vxe-table-column",{attrs:{field:"reportTime",title:"提报日期",width:"100"}}),e("vxe-table-column",{attrs:{field:"status_dictText",align:"left","header-align":"center",title:"故障状态",width:"80"}}),e("vxe-table-column",{attrs:{field:"submitStatus_dictText",title:"提交状态",width:"80"}})],1),e("vxe-pager",{attrs:{perfect:"","current-page":t.queryParam.pageNo,"page-size":t.queryParam.pageSize,total:t.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:current-page":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:pageSize":function(e){return t.$set(t.queryParam,"pageSize",e)},"update:page-size":function(e){return t.$set(t.queryParam,"pageSize",e)},"page-change":t.handlePageChange}})],1),e("BreakdownModal",{ref:"breakdownModal",on:{ok:function(e){return t.loadData()}}}),e("breakdown-detail-modal",{ref:"breakdownDetail"}),e("TrainPlanList",{ref:"trainPlanModal",on:{ok:t.onSelectPlan}}),e("CarDeviceSelectNew",{ref:"assetSelect",attrs:{canSelectType:[3,4],trainNo:t.queryParam.trainNo,lineId:t.queryParam.lineId,multiple:!1},on:{ok:t.addFaultAsset}})],1)},r=[],n=a("c1df"),l=a.n(n),s=a("b47d"),o=a("ab7d"),c=a("3281"),d=a("ca00"),u=a("5633"),h=a("d214"),m=a("785a"),f=a("310d"),p=a("60e2"),g={name:"BreakDownPage",components:{BreakdownModal:o["default"],BreakdownDetailModal:c["default"],TrainAssetList:m["default"],LineSelectList:u["default"],CarDeviceSelectNew:f["default"],TrainPlanList:p["default"]},data:function(){return{month:void 0,planName:"",records:[],date:null,dictGroupStr:"bu_mtr_workshop_group,group_name,id,workshop_id='"+this.$store.getters.userInfo.workshopId+"'|workshop_id",dictCodeStrWork:"bu_mtr_workstation,name,id,workshop_id='"+this.$store.getters.userInfo.workshopId+"'|workshop_id",year:null,queryParam:{fromType:1,planId:"",trainNo:"",lineId:"",faultAssetId:"",reportGroupId:"",placeId:"",online:null,hasDuty:null,canceled:null,phase:"",status:"",level:"",sysId:"",quarter:"",year:"",month:"",endDate:"",startDate:"",dateType:"",workstationId:"",pageNo:1,pageSize:10},totalResult:0,allAlign:"center",tableData:[],count:"",expand:!1,yearPick:null,yearPickShow:!1,form:this.$form.createForm(this),lineId:"",reportGroupId:"",rangeDate:[],trainStructId:"",dictTrainStr:"",faultAssetName:"",tableHeight:{top:"height: calc(100vh - 267px)",bottom:"height: calc(100vh - 267px)",size:"100%"}}},watch:{lineId:function(t,e){this.dictTrainStr=t?"bu_train_info,train_no,train_no,line_id="+t+"|train_struct_id":""},reportGroupId:function(t,e){this.dictCodeStrWork=t?"bu_mtr_workstation,name,id,id in (select workstation_id from bu_group_workstation where group_id='".concat(t,"')"):"bu_mtr_workstation,name,id"}},created:function(){this.findList()},methods:{openTrainPlanModal:function(){this.$refs.trainPlanModal.showModal(),this.$refs.planSelect.blur()},clearValue:function(){this.queryParam.planId="",this.planName=""},onSelectPlan:function(t){var e=this;t.forEach((function(t){e.queryParam.trainNo=t.trainNo,e.queryParam.lineId=t.lineId,e.lineId=t.lineId,e.queryParam.planId=t.id,e.planName=t.planName}))},checkboxChange:function(t){this.records=t.records},handleTrainFocus:function(){this.lineId||this.$message.warn("请先选择线路!")},handleAssetFocus:function(){this.queryParam.trainNo||this.$message.warn("请先选择车辆!")},handleTrainNo:function(t,e){t&&e.extFields&&(this.trainStructId=e.extFields[0].train_struct_id)},allowClearCHange:function(t){t||(this.queryParam.faultAssetId=void 0,this.faultAssetName=void 0)},showAssetModal:function(t){this.queryParam.trainNo?(this.$refs.assetSelect.showModal(),this.$refs.faultAssetSelect.blur()):this.$message.warn("请先选择车辆!")},addFaultAsset:function(t){Object(d["e"])(t)||(this.queryParam.faultAssetId=t[0].id,this.faultAssetName=t[0].assetName)},faultDetail:function(t){this.$refs.breakdownDetail.show(t.id)},findList:function(){var t=this;this.loading=!0,this.rangeDate.length>0&&"4"===this.queryParam.dateType&&(this.queryParam.startDate=l()(this.rangeDate[0]).format("YYYY-MM-DD"),this.queryParam.endDate=l()(this.rangeDate[1]).format("YYYY-MM-DD")),this.month&&"3"===this.queryParam.dateType&&(this.queryParam.year=l()(this.month).year(),this.queryParam.month=l()(this.month).month()+1),this.queryParam.lineId=this.lineId,this.queryParam.reportGroupId=this.reportGroupId,Object(h["L"])(this.queryParam).then((function(e){e.result&&(t.totalResult=e.result.total,t.records=[],t.tableData=e.result.records),t.loading=!1}))},handlePageChange:function(t){var e=t.currentPage,a=t.pageSize;this.queryParam.pageNo=e,this.queryParam.pageSize=a,this.findList()},loadData:function(){this.findList()},handleEdit:function(t){var e=this;Object(s["P"])({id:t.id}).then((function(t){var a=t.result;a["formType"]=1,e.$refs.breakdownModal.edit(a)}))},deleteRecord:function(){var t=this,e=this.$refs.listTable.getCheckboxRecords();if(e.length>0){var a=e.filter((function(t){return 0!==t.status}));if(a.length>0)return void this.$message.warn("已关闭或者已处理的故障不可以取消");var i=e.filter((function(t){return 2===t.submitStatus}));if(i.length>0)return void this.$message.warn("所选数据存在故障已经取消,无需再取消!");this.$confirm({content:"是否取消选中".concat(e.length,"数据？"),onOk:function(){var a=e.map((function(t,e){return t.id})).join(",");Object(s["o"])("ids="+a).then((function(e){t.findList(),t.$message.success(e.message)}))}})}else this.$message.error("尚未选中任何数据!")},handleOpenChange:function(t){this.yearPickShow=t},handlePanelChange:function(t){this.year=t,this.queryParam.year=l()(t).format("YYYY"),this.yearPickShow=!1},toggle:function(){this.expand=!this.expand,this.expand?this.tableHeight={top:"height: calc(100vh - 387px)",bottom:"height: calc(100vh - 387px)",size:"90%"}:this.tableHeight={top:"height: calc(100vh - 267px)",bottom:"height: calc(100vh - 267px)",size:"100%"}},resetSearch:function(){this.queryParam={pageNo:1,pageSize:10},this.faultAssetName="",this.lineId="",this.year=null,this.rangeDate=[],this.clearValue()}}},b=g,v=a("2877"),y=Object(v["a"])(b,i,r,!1,null,"a16a2476",null);e["default"]=y.exports},7068:function(t,e,a){"use strict";a("51cf")},"785a":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{width:"80%",title:"设备选择",visible:t.visible,confirmLoading:t.loading,centered:"",cancelText:"关闭",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("a-spin",{attrs:{spinning:t.loading}},[e("na-splitter",{staticStyle:{height:"calc(80vh - 15px)"},attrs:{defaultSize:250}},[e("div",{staticStyle:{"overflow-y":"auto","overflow-x":"hidden","padding-right":"2px"},attrs:{slot:"left-panel"},slot:"left-panel"},[e("a-tree",{attrs:{"tree-data":t.treeData,replaceFields:{title:"name",key:"id"},"load-data":t.onLoadTreeData},on:{select:t.onSelectTreeNode}})],1),e("div",{staticStyle:{"padding-left":"5px","padding-right":"3px",height:"calc(100% - 0px)"},attrs:{slot:"right-panel"},slot:"right-panel"},[e("vxe-table",{ref:"listTable",attrs:{border:"","row-id":"id",align:"center",data:t.tableData,"show-overflow":"tooltip",height:"auto","max-height":"100%","edit-config":{trigger:"manual",mode:"row"},"radio-config":t.multiple?{}:{trigger:"row",checkMethod:t.selectAbleCheck},"checkbox-config":t.multiple?{trigger:"row",highlight:!0,checkStrictly:!0,checkMethod:t.selectAbleCheck}:{}}},[t.multiple?e("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):e("vxe-table-column",{attrs:{type:"radio",width:"40"}}),e("vxe-table-column",{attrs:{field:"assetName",title:"名称","tree-node":"",align:"left","header-align":"center","min-width":"180"}}),e("vxe-table-column",{attrs:{field:"assetNo",title:"编码",width:"150"}}),e("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"100"}}),e("vxe-table-column",{attrs:{field:"structType_dictText",title:"类型",width:"100"}}),e("vxe-table-column",{attrs:{field:"assetTypeName",title:"设备类型",width:"100",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{field:"placeDesc",title:"位置描述",width:"250",align:"left","header-align":"center"}})],1)],1)])],1)],1)},r=[],n=a("8fad");function l(t){return d(t)||c(t)||o(t)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,e){if(t){if("string"==typeof t)return u(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?u(t,e):void 0}}function c(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function d(t){if(Array.isArray(t))return u(t)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=Array(e);a<e;a++)i[a]=t[a];return i}var h={name:"TrainAssetList",props:{multiple:{type:Boolean,default:!1},canSelectType:{type:Array,default:function(){return[1,2,3,4]}}},data:function(){return{visible:!1,loading:!1,treeData:[],tableData:[],defaultSelectedKeys:[],queryParam:{trainNo:"",structDetailId:""}}},methods:{showModal:function(t,e){this.queryParam.trainNo=t,this.trainStructId=e,this.queryParam.structDetailId=e,this.visible=!0,this.queryTreeData(),this.loadTableData()},queryTreeData:function(){var t=this,e={trainStructId:this.trainStructId};Object(n["bc"])(e).then((function(e){e.success?t.treeData=e.result:t.$message.warning("获取车辆结构树失败")}))},onLoadTreeData:function(t){var e=this,a={trainStructId:this.trainStructId,id:t.dataRef.id};return new Promise((function(i){t.dataRef.children&&t.dataRef.children.length>0?i():Object(n["bc"])(a).then((function(a){a.success?(t.dataRef.children=a.result,t.dataRef.children.map((function(t){t.isLeaf=!t.hasChildren})),e.treeData=l(e.treeData)):e.$message.warning("获取车辆结构树失败"),i()}))}))},onSelectTreeNode:function(t){!t||t.length<1?this.queryParam.structDetailId="":this.queryParam.structDetailId=t[0],this.loadTableData()},loadTableData:function(){var t=this;this.loading=!0,Object(n["Vb"])(this.queryParam).then((function(e){e.success?t.tableData=e.result:t.$message.error("加载车辆设备数据失败"),t.loading=!1}))},handleOk:function(){var t=[];this.multiple?t=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&t.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",t),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,Object.assign(this.$data,this.$options.data())},selectAbleCheck:function(t){t.row;return!0}}},m=h,f=a("2877"),p=Object(f["a"])(m,i,r,!1,null,"60221f2c",null);e["default"]=p.exports},"932f":function(t,e,a){},ab7d:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:"故障编辑",width:"100%",centered:"",visible:t.visible,dialogClass:"fullDialog",confirmLoading:t.confirmLoading,cancelText:"关闭"},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("div",{staticStyle:{height:"calc(100vh - 5px)","overflow-y":"auto"}},[t.visible?e("BreakdownFormItem",{ref:"breakdownForm",attrs:{fromWriteReport:t.fromWriteReport,workStationsList:t.workStationsList},on:{ok:t.onSaveOk,fail:t.onSaveFail,cancel:t.onSaveCancel}}):t._e()],1)])},r=[],n=a("d0ca"),l={name:"BreakdownModal",components:{BreakdownFormItem:n["default"]},props:{showWorkStation:{type:Boolean,default:!1},fromWriteReport:{type:Boolean,default:!1}},data:function(){return{visible:!1,confirmLoading:!1,workStationsList:[]}},created:function(){},methods:{setWorkStations:function(t){var e=this;this.workStationsList.length=0,t.forEach((function(t){e.workStationsList.find((function(e){return e.workstationId===t.workstationId}))||e.workStationsList.push(t)}))},add:function(t,e,a){this.edit({workOrderId:t,orderTaskId:e,formType:a,createType:a})},edit:function(t){var e=this;this.visible=!0,this.$nextTick((function(){e.$refs.breakdownForm.edit(t)}))},handleOk:function(){this.confirmLoading=!0,this.$refs.breakdownForm.save()},onSaveOk:function(){this.confirmLoading=!1,this.visible=!1,this.$message.success("保存成功"),this.$emit("ok")},onSaveFail:function(){this.$message.error("保存失败"),this.confirmLoading=!1},onSaveCancel:function(){this.confirmLoading=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.confirmLoading=!1,this.visible=!1}}},s=l,o=(a("7068"),a("2877")),c=Object(o["a"])(s,i,r,!1,null,"12e1d6e2",null);e["default"]=c.exports}}]);