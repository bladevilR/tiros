(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5df533bd"],{"00c9":function(t,e,i){"use strict";i("8826")},3481:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t._self._c;return e("a-spin",{staticStyle:{height:"calc(100%)"},attrs:{spinning:t.spinning,id:"mySpin"}},[e("div",{staticStyle:{"text-align":"right"}},[e("a-space",[e("a-button",{on:{click:t.zoomIn}},[t._v("放大")]),e("a-button",{on:{click:t.zoomOut}},[t._v("缩小")])],1)],1),e("div",{staticStyle:{height:"calc(100% - 35px)"}},[e("div",{staticStyle:{width:"100%",height:"calc(100% - 5px)","padding-top":"5px"},attrs:{id:"viewProject"}})])])},o=[],a=i("b47d"),s={name:"TaskManageModal",props:["planId"],data:function(){return{visible:!1,spinning:!1,project:null,projectData:{Tasks:[]}}},mounted:function(){this.loadProject()},methods:{zoomIn:function(){this.project.zoomIn()},zoomOut:function(){this.project.zoomOut()},loadProject:function(){var t=this;mini.parse(),this.project=new PlusProject,this.project.setStyle("width:100%;height:100%"),this.project.setBorderStyle("border:1px dotted #cdcdcd");var e=[new PlusProject.IDColumn,{name:"Name",header:"任务名称<br/>String",field:"Name",width:150},new PlusProject.StartColumn,new PlusProject.FinishColumn,new PlusProject.DurationColumn,{name:"programName",header:"修程<br/>String",field:"programName",width:100}];this.project.setColumns(e),this.project.render(document.getElementById("viewProject")),this.project.enableManualSchedule=!0,this.project.setShowDirty(!1),this.project.allowOrderProject=!1,this.project.setEditOnDblClick(!1),this.project.setTableViewWidth(550),this.project.on("cellbeginedit",(function(t){t.cancel=!0})),this.project.setTopTimeScale("month"),this.project.setBottomTimeScale("day"),this.project.setRowHeight(28),this.project.setAllowDragDrop(!0),this.project.setShowLinkLines(!1),this.project.on("itemdragcomplete",(function(e){var i=e.action,n=e.item;if("move"===i){var o=t.$moment(n.startDate),a=t.$moment(n.finishDate);n.Finish=new Date(t.$moment(n.Start).add(a.diff(o,"days"),"days").format("YYYY-MM-DD"))}})),this.getTemplateInfo()},save:function(){var t=this,e=[];this.projectData.Tasks.forEach((function(i){var n=Object.assign({},i);n.startDate=t.$moment(i.startDate).format("YYYY-MM-DD hh:mm:ss"),n.finishDate=t.$moment(i.Finish).format("YYYY-MM-DD hh:mm:ss"),n.Start=t.$moment(i.Start).format("YYYY-MM-DD hh:mm:ss"),n.Finish=t.$moment(i.Finish).format("YYYY-MM-DD hh:mm:ss"),e.push(n)})),Object(a["Kb"])(e).then((function(e){e.success?(t.$message.success("保存成功"),t.$emit("ok")):t.$message.error("保存失败")}))},getTemplateInfo:function(){var t=this;this.spinning=!0,Object(a["Bb"])({planYearId:this.planId}).then((function(e){e.success?(t.projectData=e.result,t.projectData.StartDate=new Date(t.projectData.StartDate),t.projectData.FinishDate=new Date(t.projectData.FinishDate),t.projectData.Tasks=mini.arrayToTree(t.projectData.Tasks,"children","UID","ParentId"),t.project.loadData(t.projectData)):t.$message.error("加载年计划明细数据失败"),t.spinning=!1})).catch((function(e){t.$message.error("加载年计划明细数据异常")}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},r=s,c=(i("00c9"),i("2877")),h=Object(c["a"])(r,n,o,!1,null,null,null);e["default"]=h.exports},8826:function(t,e,i){}}]);