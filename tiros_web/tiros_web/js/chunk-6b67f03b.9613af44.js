(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b67f03b","chunk-2d0e2cd1"],{"4dc4":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{"body-style":e.cardStyle}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"物资"}},[t("a-input",{attrs:{placeholder:"请输入物资编码或者名称",allowClear:""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"物资类别"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_material_type"},model:{value:e.queryParam.materialType,callback:function(t){e.$set(e.queryParam,"materialType",t)},expression:"queryParam.materialType"}})],1)],1),t("a-col",{attrs:{md:6,sm:8}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")]),t("a-upload",{staticStyle:{"margin-left":"8px"},attrs:{name:"file",multiple:!1,customRequest:e.customRequest,showUploadList:!1}},[t("a-button",{directives:[{name:"has",rawName:"v-has",value:"storage:import4level",expression:"'storage:import4level'"}],attrs:{loading:e.loading}},[e._v("导入4级库位")])],1),t("a-button",{on:{click:e.handleStockAttr}},[e._v("批次属性设置")])],1)],1)])],1)],1)],1),t("div",{staticStyle:{height:"calc(100vh - 250px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(100vh - 250px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{trigger:"manual",mode:"row"},"header-align":"center"}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40",align:"center"}}),t("vxe-table-column",{attrs:{field:"materialTypeCode",title:"物资编码",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("a",{on:{click:function(t){return t.stopPropagation(),e.stockDetail(r)}}},[e._v(e._s(r.materialTypeCode))])]}}])}),t("vxe-table-column",{attrs:{field:"materialTypeName",title:"物资名称","min-width":"140","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"warehouseName",title:"库位",width:"100","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"warehouseLevel",title:"库位级别",width:"80",formatter:e.formatLevel}}),t("vxe-table-column",{attrs:{field:"tradeNo",title:"所属批次",width:"160"}}),t("vxe-table-column",{attrs:{field:"amount",title:"当前库存",width:"80","header-align":"center",align:"right"}}),t("vxe-table-column",{attrs:{field:"usableAmount",title:"可用库存",width:"80","header-align":"center",align:"right"}}),t("vxe-table-column",{attrs:{field:"usedDetailInfo",title:"占用详情",width:"160","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"price",title:"库存单价",width:"80","header-align":"center",align:"right"}}),t("vxe-table-column",{attrs:{field:"materialTypePrice",title:"物资单价",width:"80","header-align":"center",align:"right"}}),t("vxe-table-column",{attrs:{field:"unit",title:"单位",width:"60"}}),t("vxe-table-column",{attrs:{field:"materialType_dictText",title:"物资类别",width:"80"}}),t("vxe-table-column",{attrs:{field:"materialAttr_dictText",title:"物资属性",width:"100"}}),t("vxe-table-column",{attrs:{field:"spec",title:"物料描述","min-width":"180","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"canReplace",title:"可替换物资",width:"100"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}}),t("stock-item-modal2",{ref:"modalForm",on:{ok:function(t){return e.loadData()}}}),t("stock-detail-modal",{ref:"stockDetailForm"})],1)])},i=[],l=a("c54ca"),o=a("ed91"),s=a("7ff2"),n={name:"RightStock",components:{StockItemModal2:o["default"],StockDetailModal:s["default"]},props:["value"],data:function(){return{loading:!1,selectRow:null,queryParam:{searchText:"",materialType:null,materialAttr:null,warehouseId:"",pageNo:1,pageSize:10},totalResult:0,allAlign:"center",tableData:[],cardStyle:{padding:"10px",height:"calc(100vh - 120px)"}}},created:function(){this.findList()},watch:{value:{immediate:!0,handler:function(e){this.queryParam.warehouseId=e,this.tableData=[],this.findList()}}},methods:{findList:function(){var e=this;this.loading=!0,Object(l["Tb"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},formatLevel:function(e){var t=e.cellValue;return t?parseInt(t)-1:""},customRequest:function(e){this.loading=!0;var t=new FormData;t.append("excelFile",e.file),this.saveFile(t)},saveFile:function(e){var t=this;Object(l["Kb"])(e).then((function(e){t.loading=!1,e.success?(t.$message.success(e.message),t.findList(),t.$emit("load")):t.$message.error(e.message)}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},handleStockAttr:function(){var e=this.$refs.listTable.getCheckboxRecords();if(e.length>0&&1===e.length){var t=e[0].materialTypeId,a=e[0].tradeNo;this.$refs.modalForm.edit(t,a),this.$refs.modalForm.title="设置属性"}else e.length>1?this.$message.error("只能选择一条数据!"):this.$message.error("尚未选中任何数据!")},loadData:function(){this.findList()},stockDetail:function(e){this.$refs.stockDetailForm.detail(e)},clearRadioRow:function(){this.selectRow=null,this.$refs.listTable.clearRadioRow()},radioChange:function(e){var t=e.row;this.selectRow=t}}},c=n,d=a("2877"),m=Object(d["a"])(c,r,i,!1,null,null,null);t["default"]=m.exports},"7ff2":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"详情",width:"70%",visible:e.visible,confirmLoading:e.confirmLoading,footer:null,destroyOnClose:!0},on:{cancel:e.handleCancel}},[t("div",{staticStyle:{height:"70vh"}},[t("a-descriptions",{attrs:{bordered:"",column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}}},[t("a-descriptions-item",{attrs:{label:"物资编码"}},[e._v(" "+e._s(e.StockDetail.materialTypeCode)+" ")]),t("a-descriptions-item",{attrs:{label:"物资名称"}},[e._v(" "+e._s(e.StockDetail.materialTypeName)+" ")]),t("a-descriptions-item",{attrs:{label:"库位"}},[e._v(" "+e._s(e.StockDetail.warehouseName)+" ")]),t("a-descriptions-item",{attrs:{label:"物资类别"}},[e._v(" "+e._s(e.StockDetail.materialType_dictText)+" ")]),t("a-descriptions-item",{attrs:{label:"物资属性"}},[e._v(" "+e._s(e.StockDetail.materialAttr_dictText)+" ")]),t("a-descriptions-item",{attrs:{label:"物资单位"}},[e._v(" "+e._s(e.StockDetail.unit)+" ")]),t("a-descriptions-item",{attrs:{label:"库存数量"}},[e._v(" "+e._s(e.StockDetail.amount)+" ")]),t("a-descriptions-item",{attrs:{label:"物资单价"}},[e._v(" "+e._s(e.StockDetail.materialTypePrice)+" ")]),t("a-descriptions-item",{attrs:{label:"生产日期"}},[e._v(" "+e._s(e.StockDetail.productionDate)+" ")]),t("a-descriptions-item",{attrs:{label:"失效日期"}},[e._v(" "+e._s(e.StockDetail.expirDate)+" ")]),t("a-descriptions-item",{attrs:{label:"物料描述"}},[e._v(" "+e._s(e.StockDetail.spec)+" ")])],1)],1)])},i=[],l={name:"StockDetail",data:function(){return{visible:!1,confirmLoading:!1,StockDetail:""}},methods:{detail:function(e){this.visible=!0,this.StockDetail=e},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},o=l,s=a("2877"),n=Object(s["a"])(o,r,i,!1,null,null,null);t["default"]=n.exports},ed91:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:1e3,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"物资名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["materialTypeName"],expression:"['materialTypeName']",modifiers:{trim:!0}}],attrs:{disabled:"",placeholder:"请输入物资名称"}})],1)],1),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"入库批次"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["tradeNo"],expression:"['tradeNo']",modifiers:{trim:!0}}],attrs:{disabled:"",placeholder:"请输入入库批次"}})],1)],1),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"入库日期"}},[t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["entryDate",e.validatorRules.entryDate],expression:"['entryDate', validatorRules.entryDate]",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{placeholder:"请选择入库日期"}})],1)],1),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"出厂日期"}},[t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["leaveFactory"],expression:"['leaveFactory']",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{placeholder:"请选择出厂日期"}})],1)],1),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"生产日期"}},[t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["productionDate"],expression:"['productionDate']",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{placeholder:"请选择生产日期"},on:{change:function(t){return e.dateChangeEvent(t,1)}}})],1)],1),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"有效期/天"}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["expirDay"],expression:"['expirDay']",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{min:0,precision:0,placeholder:"请输入有效期"},on:{change:function(t){return e.dateChangeEvent(t,2)}}})],1)],1),t("a-col",{attrs:{md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"有效日期"}},[t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["expirDate"],expression:"['expirDate']",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{placeholder:"请选择有效日期"},on:{change:function(t){return e.dateChangeEvent(t,3)}}})],1)],1),t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol2,wrapperCol:e.wrapperCol2,label:"物资描述"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["materialTypeSpec"],expression:"['materialTypeSpec']",modifiers:{trim:!0}}],attrs:{disabled:"",placeholder:"请输入物资描述","auto-size":{minRows:3,maxRows:5}}})],1)],1)],1)],1)],1)],1)},i=[],l=a("c1df"),o=a.n(l),s=(a("5c3a"),a("c54ca"));function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){m(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function m(e,t,a){return(t=u(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function u(e){var t=p(e,"string");return"symbol"==n(t)?t:t+""}function p(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var f={name:"StockItemModal2",data:function(){return{title:"操作",visible:!1,materialTypeId:"",model:{},labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}},labelCol2:{xs:{span:24},sm:{span:3}},wrapperCol2:{xs:{span:24},sm:{span:20}},validatorRules:{entryDate:{rules:[{required:!1,message:"请选择入库日期!"}]}},confirmLoading:!1,form:this.$form.createForm(this)}},created:function(){},methods:{moment:o.a,dateChangeEvent:function(e,t){var a=this.form.getFieldValue("expirDate"),r=this.form.getFieldValue("expirDay"),i=this.form.getFieldValue("productionDate");1==t&&e?a?this.form.setFieldsValue({expirDay:o()(a).diff(e,"day")}):r&&this.form.setFieldsValue({expirDate:o()(e).add(r,"days")}):2==t&&e&&i?this.form.setFieldsValue({expirDate:o()(i).add(e,"days")}):3==t&&e&&i&&this.form.setFieldsValue({expirDay:o()(e).diff(o()(i),"day")})},edit:function(e,t){var a=this;this.form.resetFields(),this.visible=!0,this.materialTypeId=e;var r={materialTypeId:e,tradeNo:t};Object(s["Ab"])(r).then((function(e){if(e.success&&e.result){a.model=d({},e.result);var t=e.result;t.productionDate&&(!t.expirDay&&t.expirDate?t.expirDay=o()(t.expirDate).diff(o()(t.productionDate),"day"):!t.expirDate&&t.expirDay&&(t.expirDate=o()(t.productionDate).add(t.expirDay,"days").format("YYYY-MM-DD"))),a.form.setFieldsValue({entryDate:t.entryDate,expirDate:t.expirDate,expirDay:t.expirDay,leaveFactory:t.leaveFactory,materialTypeName:t.materialTypeName,materialTypeSpec:t.materialTypeSpec,productionDate:t.productionDate,tradeNo:t.tradeNo})}}))},handleOk:function(){var e=this,t=this;t.form.validateFields((function(a,r){if(!a){var i=Object.assign(t.model,r,{materialTypeId:e.materialTypeId,entryDate:o()(r.entryDate).format("YYYY-MM-DD"),expirDate:o()(r.expirDate).format("YYYY-MM-DD"),productionDate:o()(r.productionDate).format("YYYY-MM-DD"),leaveFactory:o()(r.leaveFactory).format("YYYY-MM-DD")});Object(s["M"])(i).then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok"),t.close()):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1})),e.visible=!1}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},h=f,v=a("2877"),b=Object(v["a"])(h,r,i,!1,null,null,null);t["default"]=b.exports}}]);