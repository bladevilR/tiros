(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13745ea5","chunk-2d21eacb"],{"00d9":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bodyWrapper"},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"托盘"}},[e("a-input",{attrs:{placeholder:"请输入编码或者名称",allowClear:""},model:{value:t.queryParam.searchText,callback:function(e){t.$set(t.queryParam,"searchText",e)},expression:"queryParam.searchText"}})],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"物资类型"}},[e("a-select",{ref:"materialSelect",staticStyle:{width:"100%"},attrs:{allowClear:"",placeholder:"请选择物料",open:!1},on:{change:t.clearMaterialChange,dropdownVisibleChange:function(e){return t.openMaterialSelectModal()}},model:{value:t.materialTypeName,callback:function(e){t.materialTypeName=e},expression:"materialTypeName"}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},on:{click:function(e){e.stopPropagation(),t.queryParam.typeId=""}},slot:"suffixIcon"})],1)],1)],1),e("a-col",[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[e("a-space",[e("a-button",{on:{click:t.findList}},[t._v("查询")]),e("a-button",{attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("新增")]),e("a-button",{attrs:{disabled:!t.btnStatus.del},on:{click:t.bindMaterialType}},[t._v("绑定物资类型")]),e("a-button",{attrs:{disabled:!t.btnStatus.edit},on:{click:function(e){return t.handleEdit(t.btnStatus.editRow)}}},[t._v("编辑")]),e("a-button",{attrs:{disabled:!t.btnStatus.del},on:{click:t.deleteRecord}},[t._v("删除")])],1)],1)])],1)],1)],1),e("div",{staticStyle:{height:"calc(100vh - 225px)"}},[e("vxe-table",{ref:"listTable",staticStyle:{height:"calc(100vh - 225px)"},attrs:{border:"","max-height":"100%",align:t.allAlign,data:t.tableData,"show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{trigger:"manual",mode:"row"}},on:{"checkbox-change":function(e){return t.btnStatus.update()},"checkbox-all":function(e){return t.btnStatus.update()}}},[e("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),e("vxe-table-column",{attrs:{field:"code",title:"托盘编码",width:"100"}}),e("vxe-table-column",{attrs:{field:"name",title:"托盘名称","min-width":"100",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{field:"materialTypeNames",title:"物资类型","min-width":"100",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{field:"palletSize",title:"尺寸","min-width":"100",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{field:"texture",title:"材质","min-width":"100",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{field:"useStatus_dictText",title:"使用状态",width:"120"}}),e("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"80"}}),e("vxe-table-column",{attrs:{field:"remark",title:"备注","min-width":"120",align:"left","header-align":"center"}})],1),e("vxe-pager",{attrs:{perfect:"","current-page":t.queryParam.pageNo,"page-size":t.queryParam.pageSize,total:t.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:current-page":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:pageSize":function(e){return t.$set(t.queryParam,"pageSize",e)},"update:page-size":function(e){return t.$set(t.queryParam,"pageSize",e)},"page-change":t.handlePageChange}}),e("pallet-item-modal",{ref:"modalForm",on:{ok:function(e){return t.loadData()}}}),e("material-list",{ref:"materModalForm",attrs:{multiple:!0},on:{ok:t.selectmater}}),e("material-list",{ref:"materialForm",attrs:{multiple:!1},on:{ok:t.onSelectMaterial}})],1)])},l=[],i=a("c54ca"),s=a("d724"),o=a("7164"),n=a("54f6"),c={components:{PalletItemModal:s["default"],MaterialList:o["default"]},data:function(){return{tableData:[],allAlign:"center",materialTypeName:"",totalResult:0,queryParam:{searchText:"",pageNo:1,pageSize:10},btnStatus:new n["a"](this,"listTable")}},created:function(){this.findList()},methods:{loadData:function(){this.findList()},openMaterialSelectModal:function(){this.$refs.materialForm.showModal(),this.$refs.materialSelect.blur()},clearMaterialChange:function(t){t||(this.queryParam.typeId=null,this.materialTypeName=null)},onSelectMaterial:function(t){t.length&&(this.queryParam.typeId=t[0].id,this.materialTypeName=t[0].name)},findList:function(){var t=this;this.loading=!0,Object(i["mb"])(this.queryParam).then((function(e){t.totalResult=e.result.total,t.loading=!1,t.tableData=e.result.records,t.btnStatus.update()}))},handlePageChange:function(t){var e=t.currentPage,a=t.pageSize;this.queryParam.pageNo=e,this.queryParam.pageSize=a,this.findList()},handleEdit:function(t){this.$refs.modalForm.edit(t),this.$refs.modalForm.title="编辑",this.$refs.modalForm.showBatch=!0,this.$refs.modalForm.isBatchAdd=!1},handleAdd:function(){this.$refs.modalForm.add(),this.$refs.modalForm.title="新增",this.$refs.modalForm.showBatch=!1},bindMaterialType:function(){var t=this.$refs.listTable.getCheckboxRecords();t.length>0?this.$refs.materModalForm.showModal():this.$message.warn("尚未选中任何数据!")},deleteRecord:function(){var t=this,e=this.$refs.listTable.getCheckboxRecords();e.length>0?this.$confirm({content:"是否删除选中".concat(e.length,"数据？"),onOk:function(){var a=e.map((function(t,e){return t.id})).join(",");Object(i["t"])("ids="+a).then((function(e){t.findList(),t.$message.success(e.message)}))}}):this.$message.error("尚未选中任何数据!")},selectmater:function(t){var e=this,a=[],r=this.$refs.listTable.getCheckboxRecords();t.forEach((function(t){a.push(t.id)})),a=a.join(","),a.length<=0?this.$message.warn("请选择物资类型!"):this.$confirm({content:"是否绑定物资至选中".concat(r.length,"条数据？"),onOk:function(){var t=r.map((function(t,e){return t.id})).join(",");Object(i["l"])({materialTypes:a,palletIds:t}).then((function(t){e.findList(),e.$message.success(t.message)}))}})}}},m=c,u=a("2877"),d=Object(u["a"])(m,r,l,!1,null,null,null);e["default"]=d.exports},"54f6":function(t,e,a){"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,o(r.key),r)}}function s(t,e,a){return e&&i(t.prototype,e),a&&i(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t){var e=n(t,"string");return"symbol"==r(e)?e:e+""}function n(t,e){if("object"!=r(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var l=a.call(t,e||"default");if("object"!=r(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}a.d(e,"a",(function(){return c}));var c=function(){function t(e,a){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};l(this,t),this.options={attrs:[]},Object.assign(this.options,i),this.options.attrs.find((function(t){return"edit"===t.key}))||this.options.attrs.push({key:"edit"}),this.options.attrs.forEach((function(t){Object.hasOwnProperty.call(t,"key")&&(r[t.key]=!1),Object.hasOwnProperty.call(t,"judge")||(t["judge"]=function(t){return!0})})),this.del=!1,this.nextTick=e.$nextTick,this.refs=e.$refs,this.refName=a,e.$nextTick((function(){r.vxeTable=e.$refs[a]}))}return s(t,[{key:"editRow",get:function(){if(this.edit){var t=this.vxeTable.getCheckboxRecords();return t.length?t[0]:{}}return{}}},{key:"update",value:function(){var t=this;this.nextTick((function(){t.vxeTable||(t.vxeTable=t.refs[t.refName]);var e=t.vxeTable.getCheckboxRecords();t.del=e.length>0,t.options.attrs.forEach((function(a){for(var r in a)Object.hasOwnProperty.call(a,r)&&(a["isDel"]?e.length?t[a.key]=e.length>0&&a.judge(e[0]):t[a.key]=!1:e.length?t[a.key]=1===e.length&&a.judge(e[0]):t[a.key]=!1)}))}))}}])}()},d724:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:t.title,width:600,visible:t.visible,confirmLoading:t.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("a-spin",{attrs:{spinning:t.confirmLoading}},[e("a-form",{attrs:{form:t.form}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"托盘编码"}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["code",t.validatorRules.code],expression:"['code', validatorRules.code]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入托盘编码"}})],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"托盘名称"}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["name",t.validatorRules.name],expression:"['name', validatorRules.name]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入托盘名称"}})],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"物资类型"}},[e("a-select",{ref:"mymaterSelect",attrs:{placeholder:"请选择物资类型",open:!1,showArrow:!0,mode:"multiple","option-label-prop":"label"},on:{focus:t.openmaterModal,deselect:t.onDeselect},model:{value:t.materNameList,callback:function(e){t.materNameList=e},expression:"materNameList"}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"尺寸大小"}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["palletSize",t.validatorRules.palletSize],expression:"['palletSize', validatorRules.palletSize]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入尺寸大小"}})],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"材质描述"}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["texture",t.validatorRules.texture],expression:"['texture', validatorRules.texture]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入材质描述"}})],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:10,sm:24,offset:4}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"使用状态"}},[e("a-switch",{on:{change:t.changeUserStatus},model:{value:t.useStatus,callback:function(e){t.useStatus=e},expression:"useStatus"}})],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:10,sm:24,offset:4}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"是否可用"}},[e("a-switch",{on:{change:t.changeStatus},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}})],1)],1),e("a-col",{attrs:{md:10,sm:24,hidden:t.showBatch}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-checkbox",{model:{value:t.isBatchAdd,callback:function(e){t.isBatchAdd=e},expression:"isBatchAdd"}},[t._v("批量新增")])],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24,hidden:!t.isBatchAdd}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"编码序号"}},[e("a-input-number",{attrs:{min:1,max:t.batchAddEndNum},model:{value:t.batchAddStartNum,callback:function(e){t.batchAddStartNum=e},expression:"batchAddStartNum"}}),t._v(" ~ "),e("a-input-number",{attrs:{min:t.batchAddStartNum+1},model:{value:t.batchAddEndNum,callback:function(e){t.batchAddEndNum=e},expression:"batchAddEndNum"}})],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24,hidden:!t.isBatchAdd}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"提示"}},[e("span",{staticStyle:{color:"#f00"}},[t._v("*批量新增时，编码和名称只要输入前缀")])])],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"备注"}},[e("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark",t.validatorRules.remark],expression:"['remark', validatorRules.remark]"}]})],1)],1)],1)],1)],1),e("material-list",{ref:"materModalForm",attrs:{multiple:!0},on:{ok:t.selectmater}})],1)},l=[],i=a("c54ca"),s=a("4ec3"),o=a("ca00"),n=a("7164"),c={name:"PalletItemModal",components:{MaterialList:n["default"]},data:function(){return{showBatch:!1,isBatchAdd:!1,state:!0,useStatus:!1,batchStateOptions:[{label:"批量新增",value:!0}],batchAddStartNum:1,batchAddEndNum:10,title:"操作",visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:15}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{name:{rules:[{required:!0,message:"请输入托盘名称!"},{max:32,message:"输入长度不能超过32字符!"}]},code:{rules:[{required:!0,message:"请输入托盘编码!"},{validator:this.validateCode},{max:32,message:"输入长度不能超过32字符!"}]},texture:{rules:[{max:16,message:"输入长度不能超过16字符!"}]},palletSize:{rules:[{max:16,message:"输入长度不能超过16字符!"}]},remark:{rules:[{max:255,message:"输入长度不能超过255字符!"}]}},materNameList:[],materTypeList:[]}},created:function(){},methods:{validateCode:function(t,e,a){var r={tableName:"bu_material_pallet",fieldName:"code",fieldVal:e,dataId:this.model.id};Object(o["e"])(e)?a():Object(s["m"])(r).then((function(t){t.success?a():a(t.message)}))},add:function(){this.edit({})},edit:function(t){var e=this;this.form.resetFields(),this.isBatchAdd=!1,t.id?(this.state=!(!t["status"]||1!==t["status"]),this.useStatus=!(!t["useStatus"]||1!==t["useStatus"]),this.materTypeList=t.materialTypes?t.materialTypes.split(","):[],this.materNameList=t.materialTypeNames?t.materialTypeNames.split(","):[]):(this.state=!0,this.useStatus=!1,this.materTypeList=[],this.materNameList=[]),this.model=Object.assign({},t),this.visible=!0,this.$nextTick((function(){e.form.setFieldsValue({code:e.model.code,name:e.model.name,palletSize:e.model.palletSize,texture:e.model.texture,remark:e.model.remark})}))},changeStatus:function(t){this.state=t},changeUserStatus:function(t){this.useStatus=t},handleOk:function(){var t=this,e=this;e.form.validateFields((function(a,r){if(!a){var l,s=Object.assign(e.model,r);s["materialTypes"]=t.materTypeList.join(","),s["materialTypeNames"]=t.materNameList.join(","),s["status"]=e.state?1:0,s["useStatus"]=e.useStatus?1:0,s["isBatchAdd"]=e.isBatchAdd,e.isBatchAdd&&(s["batchAddStartNum"]=e.batchAddStartNum,s["batchAddEndNum"]=e.batchAddEndNum),l=e.model.id?Object(i["J"])(s):Object(i["f"])(s),l.then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok"),e.close()):e.$message.warning(t.message)})).finally((function(){e.confirmLoading=!1}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},openmaterModal:function(){this.$refs.materModalForm.showModal(),this.$refs.mymaterSelect.blur()},selectmater:function(t){var e=this;t.forEach((function(t){e.materNameList.push(t.name),e.materTypeList.push(t.id)}))},onDeselect:function(t){this.materTypeList.splice(this.materNameList.indexOf(t),1)}}},m=c,u=a("2877"),d=Object(u["a"])(m,r,l,!1,null,null,null);e["default"]=d.exports}}]);