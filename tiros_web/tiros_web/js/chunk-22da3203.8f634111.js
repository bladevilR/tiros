(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22da3203","chunk-2d0be16a"],{"2f88":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:"导入EXCEL",width:600,visible:t.visible,confirmLoading:t.uploading},on:{cancel:t.handleClose}},[e("a-form-model",{attrs:{form:t.form}},[e("a-row",[e("a-col",[e("a-form-model-item",{attrs:{prop:"fileList",labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"请选择文件"}},[e("a-upload",{attrs:{name:"file",multiple:!1,accept:".xls,.xlsx",fileList:t.form.fileList,remove:t.handleRemove,beforeUpload:t.beforeUpload}},[e("a-button",{attrs:{disabled:t.form.fileList.length>=t.sum}},[e("a-icon",{attrs:{type:"upload"}}),t._v(" 选择导入文件 ")],1)],1)],1)],1),e("a-col",[e("a-form-model-item",{attrs:{prop:"",labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"清除已有数据"}},[e("a-switch",{model:{value:t.form.clear,callback:function(e){t.$set(t.form,"clear",e)},expression:"form.clear"}})],1)],1)],1)],1),e("template",{slot:"footer"},[e("a-button",{on:{click:t.handleClose}},[t._v("关闭")]),e("a-button",{attrs:{type:"primary",disabled:0===t.form.fileList.length,loading:t.uploading},on:{click:t.handleImport}},[t._v(" "+t._s(t.uploading?"导入中...":"开始导入")+" ")])],1)],2)},i=[],o=a("0fea");function s(t){return c(t)||u(t)||l(t)||n()}function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t,e){if(t){if("string"==typeof t)return d(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?d(t,e):void 0}}function u(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function c(t){if(Array.isArray(t))return d(t)}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=Array(e);a<e;a++)r[a]=t[a];return r}var m={name:"GroupStockImport",props:{url:{type:String,default:"",required:!1},biz:{type:String,default:"",required:!1},sum:{type:Number,default:1}},data:function(){return{visible:!1,uploading:!1,form:{fileList:[],clear:!0},uploadAction:"",foreignKeys:"",labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}}},watch:{url:function(t){t&&(this.uploadAction=t)}},created:function(){this.uploadAction=this.url},mounted:function(){},methods:{handleClose:function(){this.visible=!1},show:function(t){Object.assign(this.form,this.$options.data().form),this.uploading=!1,this.visible=!0,this.foreignKeys=t},handleRemove:function(t){var e=this.form.fileList.indexOf(t),a=this.form.fileList;a.splice(e,1),this.fileList=JSON.parse(JSON.stringify(a))},beforeUpload:function(t){return this.form.fileList=[].concat(s(this.form.fileList),[t]),!1},handleImport:function(){var t=this,e=this.form.fileList,a=new FormData;this.biz&&a.append("isSingleTableImport",this.biz),this.foreignKeys&&this.foreignKeys.length>0&&a.append("foreignKeys",this.foreignKeys),e.forEach((function(t){a.append("file",t)})),a.append("cleanup",this.form.clear),this.uploading=!0,Object(o["j"])(this.uploadAction,a).then((function(e){t.uploading=!1,e.success?(t.$message.success(e.message),t.visible=!1,t.$emit("ok"),Object.assign(t.form,t.$options.data().form)):t.$message.warning(e.message)}))}}},p=m,f=a("2877"),h=Object(f["a"])(p,r,i,!1,null,"0e723c8c",null);e["default"]=h.exports},6651:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bodyWrapper"},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"物资"}},[e("a-input",{attrs:{placeholder:"物资编号或名称",disabled:t.searchTextDis,allowClear:""},model:{value:t.queryParam.searchText,callback:function(e){t.$set(t.queryParam,"searchText",e)},expression:"queryParam.searchText"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"物资类别"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_material_type"},model:{value:t.queryParam.materialType,callback:function(e){t.$set(t.queryParam,"materialType",e)},expression:"queryParam.materialType"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"车辆"}},[e("j-dict-select-seach-tag",{attrs:{placeholder:"请选择",dictCode:"bu_train_info,train_no,train_no"},model:{value:t.queryParam.trainNo,callback:function(e){t.$set(t.queryParam,"trainNo",e)},expression:"queryParam.trainNo"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{attrs:{label:"班组"}},[e("j-dict-select-tag",{ref:"groupSelect",attrs:{disabled:t.disGroup,placeholder:"请选择班组",dictCode:"bu_mtr_workshop_group,group_name,id"},on:{loaderData:t.dictLoaderData},model:{value:t.queryParam.groupId,callback:function(e){t.$set(t.queryParam,"groupId",e)},expression:"queryParam.groupId"}})],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:4,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[e("a-space",[e("a-button",{on:{click:t.findList}},[t._v("查询")]),t.isComponent?t._e():e("a-button",{on:{click:t.setMaterialAttribute}},[t._v("物资属性设置")]),t.isComponent?t._e():e("a-button",{on:{click:t.recoverMaterialAttribute}},[t._v("恢复车间属性")]),t.isComponent?t._e():e("a-button",{on:{click:t.transToTurnover}},[t._v("转入周转件")]),t.isComponent?t._e():e("a-button",{directives:[{name:"has",rawName:"v-has",value:"group:stock:import",expression:"'group:stock:import'"}],on:{click:function(e){return t.$refs.importModal.show()}}},[t._v("导入")]),t.isComponent?t._e():e("a-button",{on:{click:t.exportGroupStock}},[t._v("导出")])],1)],1)])],1)],1)],1),e("div",{style:t.tableHeight.top},[e("vxe-table",{ref:"listTable",attrs:{border:"",align:t.allAlign,data:t.tableData,height:"auto","show-overflow":"tooltip","radio-config":t.multiple?{}:{trigger:"row"},"checkbox-config":t.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"manual",mode:"row"}}},[t.multiple?e("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):e("vxe-table-column",{attrs:{type:"radio",width:"40"}}),e("vxe-table-column",{attrs:{field:"materialTypeCode",title:"物资编码",width:"140","header-align":"center",align:"center"}}),e("vxe-table-column",{attrs:{field:"materialTypeName",title:"物资名称",width:"150","header-align":"center",align:"left"}}),e("vxe-table-column",{attrs:{field:"spec","min-width":"180","header-align":"center",align:"left",title:"物资描述"}}),e("vxe-table-column",{attrs:{field:"trainNo",title:"车号",width:"80"}}),e("vxe-table-column",{attrs:{field:"groupName",title:"所属班组",width:"100"}}),e("vxe-table-column",{attrs:{field:"tradeNo","header-align":"center",align:"left",width:"160",title:"所属批次"}}),e("vxe-table-column",{attrs:{field:"amount",title:"库存数量",width:"100"}}),e("vxe-table-column",{attrs:{field:"usableAmount",title:"当前可用量",width:"100"}}),e("vxe-table-column",{attrs:{field:"usedDetailInfo",title:"占用详情",width:"180","header-align":"center",align:"left"}}),e("vxe-table-column",{attrs:{field:"useCategory_dictText",title:"类别",width:"80"}}),e("vxe-table-column",{attrs:{field:"materialAttr_dictText",title:"属性",width:"80"}}),e("vxe-table-column",{attrs:{field:"price",title:"价格",width:"80","header-align":"center",align:"right"}}),e("vxe-table-column",{attrs:{field:"systemName",title:"所属系统",width:"160"}}),e("vxe-table-column",{attrs:{field:"workstationName",title:"所属工位",width:"160"}})],1)],1),e("vxe-pager",{attrs:{perfect:"","current-page":t.queryParam.pageNo,"page-size":t.queryParam.pageSize,total:t.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:current-page":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:pageSize":function(e){return t.$set(t.queryParam,"pageSize",e)},"update:page-size":function(e){return t.$set(t.queryParam,"pageSize",e)},"page-change":t.handlePageChange}}),e("group-stock-import",{ref:"importModal",attrs:{url:"/import/groupStock"},on:{ok:function(e){return t.findList()}}}),e("material-attr-modal",{ref:"materialAttr",attrs:{ids:t.ids},on:{ok:function(e){return t.findList()}}}),e("TransTurnoverModal",{ref:"transTurnoverModal",attrs:{"group-stock-id":t.ids},on:{ok:function(e){return t.findList()}}})],1)},i=[],o=a("c54ca"),s=a("2f88"),n=a("1468"),l=a("839a"),u={name:"List",props:{isComponent:{type:Boolean,default:!1},multiple:{type:Boolean,default:!0},groupId:{type:String,default:""},materialTypeCode:{type:String,default:""}},components:{GroupStockImport:s["default"],MaterialAttrModal:n["default"],TransTurnoverModal:l["default"]},data:function(){return{searchTextDis:!1,disGroup:!1,queryParam:{searchText:"",materialType:void 0,groupId:this.$store.getters.userInfo.departId,trainNo:null,pageNo:1,pageSize:10},totalResult:0,allAlign:"center",tableData:[],tableHeight:{top:this.isComponent?"height: calc(80vh - 183px)":"height: calc(100vh - 225px)",bottom:this.isComponent?"height: calc(80vh - 183px)":"height: calc(100vh - 225px)",size:"100%"},ids:""}},mounted:function(){},methods:{dictLoaderData:function(){if(this.$store.getters.userInfo.departId){var t=this.$refs.groupSelect.getSelectItem(this.$store.getters.userInfo.departId);t?(this.queryParam.groupId=this.$store.getters.userInfo.departId,this.disGroup=!0):(this.queryParam.groupId=null,this.disGroup=!1),this.groupId&&(this.queryParam.groupId=this.groupId,this.disGroup=!0),this.materialTypeCode&&(this.queryParam.searchText=this.materialTypeCode,this.searchTextDis=!0)}this.findList()},getCheckboxRecords:function(){var t=this.multiple?this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord();return t},findList:function(){var t=this;Object(o["eb"])(this.queryParam).then((function(e){t.totalResult=e.result.total,t.loading=!1,t.tableData=e.result.records}))},handlePageChange:function(t){var e=t.currentPage,a=t.pageSize;this.queryParam.pageNo=e,this.queryParam.pageSize=a,this.findList()},exportGroupStock:function(){Object(o["Jb"])("班组库存导出.xls",{searchText:this.queryParam.searchText,materialType:this.queryParam.materialType,groupId:this.queryParam.groupId})},setMaterialAttribute:function(){var t=this.getCheckboxRecords();t.length>0?(this.ids=t.map((function(t){return t.id})).join(","),this.$refs.materialAttr.show()):this.$message.error("尚未选中任何数据!")},recoverMaterialAttribute:function(){var t=this,e=this.getCheckboxRecords();if(e.length>0){var a=e.map((function(t){return t.id})).join(","),r=e.map((function(t){return t.groupId})).join(",");Object(o["Yb"])("ids="+a+"&groupIds="+r).then((function(e){e.success?(t.$message.success(e.message),t.findList()):t.$message.error(e.message)}))}else this.$message.error("尚未选中任何数据!")},transToTurnover:function(){var t=this.getCheckboxRecords();t.length>0?t.length>1?this.$message.warning("只能选中一条数据!"):(this.ids=t.map((function(t){return t.id})).join(","),this.$refs.transTurnoverModal.show()):this.$message.error("尚未选中任何数据!")}}},c=u,d=a("2877"),m=Object(d["a"])(c,r,i,!1,null,null,null);e["default"]=m.exports},"839a":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:"转入周转件",visible:t.visible,confirmLoading:t.confirmLoading,destroyOnClose:!0,cancelText:"关闭"},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("a-form",{attrs:{form:t.form}},[e("a-row",{attrs:{gutter:24}},[e("a-col",[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"转入数量"}},[e("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["transAmount",t.validatorRules.transAmount],expression:"['transAmount', validatorRules.transAmount]",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{min:0,step:.1,max:99999999,placeholder:"请输入转入数量"}})],1)],1)],1)],1)],1)},i=[],o=a("c54ca"),s={name:"TransTurnoverModal",components:{},props:["groupStockId"],data:function(){return{visible:!1,confirmLoading:!1,form:this.$form.createForm(this),model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}},validatorRules:{transAmount:{rules:[{required:!0,message:"请输入转入数量!"}]}},transAmount:0}},methods:{show:function(){this.visible=!0,this.form.resetFields(),this.model=Object.assign({},{})},handleOk:function(){var t=this;t.form.validateFields((function(e,a){if(!e){var r=Object.assign(t.model,a);t.confirmLoading=!0,Object(o["pc"])("groupStockId="+t.groupStockId+"&transAmount="+r.transAmount).then((function(e){e.success?(t.$message.success(e.result),t.$emit("ok"),t.close()):t.$message.error(e.message)})).finally((function(){t.confirmLoading=!1}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},n=s,l=a("2877"),u=Object(l["a"])(n,r,i,!1,null,"7146cee2",null);e["default"]=u.exports}}]);