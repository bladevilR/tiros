(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3210fa7e"],{"3bcd":function(t,e,n){"use strict";n.d(e,"P",(function(){return r})),n.d(e,"N",(function(){return a})),n.d(e,"F",(function(){return o})),n.d(e,"J",(function(){return s})),n.d(e,"t",(function(){return u})),n.d(e,"i",(function(){return m})),n.d(e,"j",(function(){return k})),n.d(e,"h",(function(){return v})),n.d(e,"g",(function(){return I})),n.d(e,"l",(function(){return y})),n.d(e,"c",(function(){return w})),n.d(e,"e",(function(){return O})),n.d(e,"f",(function(){return T})),n.d(e,"d",(function(){return j})),n.d(e,"b",(function(){return C})),n.d(e,"x",(function(){return x})),n.d(e,"z",(function(){return L})),n.d(e,"w",(function(){return N})),n.d(e,"H",(function(){return P})),n.d(e,"I",(function(){return _})),n.d(e,"y",(function(){return $})),n.d(e,"A",(function(){return S})),n.d(e,"B",(function(){return K})),n.d(e,"M",(function(){return R})),n.d(e,"r",(function(){return D})),n.d(e,"E",(function(){return F})),n.d(e,"k",(function(){return p})),n.d(e,"D",(function(){return d})),n.d(e,"u",(function(){return c})),n.d(e,"L",(function(){return l})),n.d(e,"a",(function(){return f})),n.d(e,"K",(function(){return G})),n.d(e,"m",(function(){return B})),n.d(e,"p",(function(){return z})),n.d(e,"o",(function(){return J})),n.d(e,"G",(function(){return h})),n.d(e,"v",(function(){return b})),n.d(e,"C",(function(){return g})),n.d(e,"n",(function(){return A})),n.d(e,"q",(function(){return E})),n.d(e,"s",(function(){return q})),n.d(e,"O",(function(){return H}));var i=n("0fea"),r=function(t){return Object(i["d"])("/produce/train/history/tree/line-train",t)},a=function(t){return Object(i["d"])("/produce/train/history/maximo-asset/list-child",t)},o=function(t){return Object(i["d"])("/produce/train/history/train/get",t)},s=function(t){return Object(i["d"])("/produce/train/history/train/period",t)},u=function(t){return Object(i["d"])("/produce/train/history/maximo-asset/get",t)},l=function(t){return Object(i["d"])("/produce/train/history/work/page",t)},c=function(t){return Object(i["d"])("/produce/train/history/measure/page",t)},p=function(t){return Object(i["d"])("/produce/train/history/fault/page",t)},d=function(t){return Object(i["d"])("/produce/train/history/forms/page",t)},f=function(t){return Object(i["d"])("/produce/train/history/change/page",t)},h=function(t){return Object(i["d"])("/produce/train/history/train/period",t)},b=function(t){return Object(i["d"])("/produce/train/history/workLeaveRecord/page",t)},g=function(t){return Object(i["d"])("/produce/train/history/workRectify/page",t)},m=function(t){return Object(i["d"])("/produce/fault/detail/count",t)},k=function(t){return Object(i["d"])("/produce/fault/detail/page",t)},y=function(t){return Object(i["d"])("/produce/fault/statistics",t)},v=function(t){return Object(i["j"])("/produce/fault/compare",t)},I=function(t){return Object(i["d"])("/produce/fault/time-effect/data",t)},w=function(t){return Object(i["d"])("/produce/cost/detail/count",t)},O=function(t){return Object(i["d"])("/produce/cost/detail/page",t)},T=function(t){return Object(i["j"])("/produce/cost/statistics",t)},j=function(t){return Object(i["d"])("/produce/cost/compare/count-6year",t)},C=function(t){return Object(i["j"])("/produce/cost/compare",t)},x=function(t){return Object(i["d"])("/produce/plan/list",t)},L=function(t){return Object(i["d"])("/produce/plan/task/listByPlanId/".concat(t))},N=function(t){return Object(i["d"])("/produce/plan/get/".concat(t))},P=function(t){return Object(i["d"])("/serialPlan/plan/get/".concat(t))},_=function(t){return Object(i["d"])("/produce/plan/task/get/".concat(t))},$=function(t){return Object(i["d"])("/produce/plan/regu/list/".concat(t))},S=function(t){return Object(i["d"])("/produce/plan/train-struct/list/".concat(t))},K=function(t){return Object(i["d"])("/produce/plan/train-struct/orders/".concat(t))},R=function(t){return Object(i["d"])("/workshop/list",t)},D=function(t){return Object(i["d"])("/produce/workshop/fault/latest",t)},F=function(t){return Object(i["d"])("/produce/workshop/workstation/list",t)},G=function(t){return Object(i["d"])("/produce/workshop/train-track",t)},B=function(t){return Object(i["d"])("/produce/kpi/group",t)},z=function(t){return Object(i["d"])("/produce/kpi/user",t)},J=function(t){return Object(i["d"])("/produce/kpi/plan/list",t)},A=function(t){return Object(i["d"])("/produce/kpi/plan/get",t)},E=function(t){return Object(i["d"])("/serialPlan/plan/material/lack",t)},q=function(t){return Object(i["d"])("/board/plan-group-statistic/get-last-working-plan",t)},H=function(t){return Object(i["d"])("/board/plan-group-statistic/list",t)}},5786:function(t,e,n){t.exports=n.p+"img/magic.deee3b0e.svg"},6917:function(t,e,n){"use strict";n("e923")},a5c3:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"kpi-main"},[e("div",{style:{position:"absolute",top:1,left:15,zIndex:999,cursor:"pointer"}},[e("a-dropdown",{attrs:{trigger:["click"]}},[e("img",{attrs:{src:n("5786")},on:{click:function(t){return t.preventDefault()}}}),e("a-menu",{staticStyle:{"min-width":"110px"},attrs:{slot:"overlay"},slot:"overlay"},t._l(t.plansList,(function(n,i){return e("a-sub-menu",{key:i,attrs:{title:n.depotName}},t._l(n.plans,(function(n,i){return e("a-menu-item",{key:i,on:{click:function(e){return t.selectPlanInfo(n)}}},[t._v(t._s(n.planName)+" ")])})),1)})),1)],1)],1),e("div",[e("div",{staticClass:"kpi-table-header",attrs:{flex:""}},[e("div",{staticClass:"kpi-column",staticStyle:{width:"180px"},attrs:{"column-padding":""}},[e("div",{staticClass:"kpi-cell"},[t._v(t._s("当前状态：".concat(t.planStatu)))])]),e("div",{staticStyle:{width:"100%"},attrs:{border:""}},[e("div",{staticClass:"kpi-column"},[e("div",{staticClass:"kpi-cell"},[t._v(t._s(t.planTitle))])]),e("div",{attrs:{flex:""}},[e("div",{staticClass:"kpi-column",staticStyle:{width:"200px",position:"relative"},attrs:{"column-padding":""}},[e("div",{staticClass:"kpi-cell"},[e("span",{staticClass:"label",staticStyle:{position:"relative","z-index":"1"}},[t._v(" 当前架修进度："+t._s(t.planInfo.progress||0)+"% ")]),e("div",{staticClass:"kpi-progress"},[e("div",{staticClass:"progress-bg",style:"width: ".concat(t.planInfo.progress||0,"%")})])])]),e("div",{staticClass:"kpi-column",attrs:{"column-padding":""}},[e("div",{staticClass:"kpi-cell"},[t._v("当前工期第： "+t._s(t.planInfo.currentDay||0)+" 天")])]),e("div",{staticClass:"kpi-column",attrs:{"column-padding":""}},[e("div",{staticClass:"kpi-cell"},[t._v("计划完工： "+t._s(t.planInfo.finishDate||"暂无数据"))])]),e("div",{staticClass:"kpi-column",staticStyle:{width:"100%"},attrs:{"column-padding":"",align:"left"}},[e("div",{staticClass:"kpi-cell",staticStyle:{width:"100%"}},[e("a-row",{attrs:{type:"flex"}},[e("a-col",{attrs:{flex:"210px"}},[e("a-row",{staticStyle:{height:"32px"},attrs:{type:"flex"}},[e("a-col",{attrs:{span:24}},[e("a-radio-group",{staticStyle:{height:"100%",display:"flex","align-items":"center"},attrs:{name:"radioGroup"},on:{change:t.changeKpiType},model:{value:t.kpiType,callback:function(e){t.kpiType=e},expression:"kpiType"}},[e("a-radio",{attrs:{value:1}},[t._v(" 员工贡献")]),e("a-radio",{attrs:{value:2}},[t._v(" 班组贡献")])],1)],1)],1)],1),2==t.kpiType?e("a-col",[e("span",[t._v("检修班组： ")]),e("j-dict-select-tag",{staticStyle:{width:"150px"},attrs:{dictCode:"bu_mtr_workshop_group,group_name,id"},on:{select:t.selectWrokGroup},model:{value:t.workGroup,callback:function(e){t.workGroup=e},expression:"workGroup"}})],1):t._e()],1)],1)])])])])]),e("div",{staticClass:"kpi-body"},[e("div",{staticClass:"panel-left",class:{"panel-width-full":2===t.showPanelType,"panel-width-empty":0==t.showPanelType}},[e("vxe-table",{ref:"kpiTableLeft",attrs:{border:"",data:t.kpiTimeList,"auto-resize":"",height:"auto",align:"center"}},[e("vxe-table-colgroup",{attrs:{title:"工时贡献度"}},[e("vxe-table-column",{attrs:{title:"姓名",field:"userName"}}),e("vxe-table-column",{attrs:{title:"工号",field:"workNo"}}),e("vxe-table-column",{attrs:{title:"班组",field:"groupName"}}),e("vxe-table-column",{attrs:{title:"检修工时",field:"repairTime"}}),e("vxe-table-column",{attrs:{title:"处理故障工时",field:"faultTime"}}),e("vxe-table-column",{attrs:{title:"总工时",field:"totalTime"}}),e("vxe-table-column",{attrs:{title:"排名",field:"sortNo"}})],1)],1)],1),e("div",{staticClass:"panel-middle"},[0!==t.showPanelType?e("div",{staticClass:"panel-btn-left",on:{click:function(e){return t.panelToLeft()}}}):t._e(),2!==t.showPanelType?e("div",{staticClass:"panel-btn-right",staticStyle:{"margin-top":"10px"},on:{click:function(e){return t.panelToRight()}}}):t._e()]),e("div",{staticClass:"panel-right",class:{"panel-width-full":0===t.showPanelType,"panel-width-empty":2==t.showPanelType}},[e("vxe-table",{ref:"kpiTableRight",attrs:{border:"",data:t.kpiFaultList,"auto-resize":"",height:"auto",align:"center"}},[e("vxe-table-colgroup",{attrs:{title:"故障贡献度"}},[e("vxe-table-column",{attrs:{title:"姓名",field:"userName"}}),e("vxe-table-column",{attrs:{title:"工号",field:"workNo"}}),e("vxe-table-column",{attrs:{title:"班组",field:"groupName"}}),e("vxe-table-column",{attrs:{title:"发现故障次数",field:"faultAmount"}}),e("vxe-table-column",{attrs:{title:"处理故障次数",field:"handleAmount"}}),e("vxe-table-column",{attrs:{title:"故障次数总计",field:"totalHappen"}})],1)],1)],1)])])},r=[],a=n("3bcd"),o={name:"GroupKpiPage",components:{},data:function(){return{dictTrainStr:"",planInfo:{},resData:[],tableData:[],tableKpiInfo:{},plansList:[],workGroup:"",kpiType:1,showPanelType:1,activePlanIndex:0,queryParam:{lineId:null,trainNo:void 0,depotId:void 0,periodType:2}}},computed:{planTitle:function(){return this.plansList.length>0&&""!==this.planInfo.depotName&&""!==this.planInfo.trainNo?"".concat(this.planInfo.depotName,": ").concat(this.planInfo.trainNo,"车辆"):""},planStatu:function(){if(this.planInfo.hasOwnProperty("progressStatus")){if(0==this.planInfo.progressStatus)return"未开始";if(1==this.planInfo.progressStatus)return"正常(作业中)";if(2==this.planInfo.progressStatus)return"逾期(作业中)";if(3==this.planInfo.progressStatus)return"正常(完工)";if(4==this.planInfo.progressStatus)return"逾期(完工)";if(5==this.planInfo.progressStatus)return"提前(完工)"}return""},kpiTimeList:function(){return this.tableKpiInfo.timeList&&this.tableKpiInfo.timeList.length>0?this.tableKpiInfo.timeList:[]},kpiFaultList:function(){return this.tableKpiInfo.faultList&&this.tableKpiInfo.faultList.length>0?this.tableKpiInfo.faultList:[]}},watch:{workGroup:function(t){t||this.getKpiList()}},mounted:function(){this.getPlanList(),this.getKpiList()},methods:{getPlanList:function(){var t=this;Object(a["o"])().then((function(e){e.success&&e.result.length>0&&(t.plansList.length=0,e.result.forEach((function(e){e.plans.forEach((function(t){t.depotName||(t.depotName=e.depotName),t.depotId||(t.depotId=e.depotId)})),t.plansList.push(JSON.parse(JSON.stringify(e)))})),t.planInfo=t.plansList[0].plans[0],Object(a["n"])({planId:t.planInfo.id}).then((function(e){e.success?(t.planInfo.progress=e.result.progress,t.planInfo.currentDay=e.result.currentDay,t.planInfo.finishDate=e.result.finishDate):t.$message.error(e.message)})),t.getKpiList(),t.loadProject())})).catch((function(t){}))},selectPlanInfo:function(t){var e=this;this.planInfo=t,Object(a["n"])({planId:this.planInfo.id}).then((function(t){t.success?(e.planInfo.progress=t.result.progress,e.planInfo.currentDay=t.result.currentDay,e.planInfo.finishDate=t.result.finishDate):e.$message.error(t.message)})),this.getKpiList()},getKpiList:function(){var t=this;this.planInfo.hasOwnProperty("depotId")&&this.planInfo.hasOwnProperty("trainNo")&&this.planInfo.hasOwnProperty("id")&&(1==this.kpiType?Object(a["p"])({depotId:this.planInfo.depotId,lineId:this.planInfo.lineId,planId:this.planInfo.id}).then((function(e){e.success&&e.result?t.tableKpiInfo=e.result:t.$message.warn(e.message)})):Object(a["m"])({depotId:this.planInfo.depotId,groupId:this.workGroup||void 0,lineId:this.planInfo.lineId,planId:this.planInfo.id}).then((function(e){e.success&&e.result?t.tableKpiInfo=e.result:t.$message.warn(e.message)})))},changeKpiType:function(){2==this.kpiType?(this.$refs.kpiTableLeft.hideColumn(this.$refs.kpiTableLeft.getColumnByField("userName")),this.$refs.kpiTableLeft.hideColumn(this.$refs.kpiTableLeft.getColumnByField("workNo")),this.$refs.kpiTableRight.hideColumn(this.$refs.kpiTableRight.getColumnByField("userName")),this.$refs.kpiTableRight.hideColumn(this.$refs.kpiTableRight.getColumnByField("workNo"))):(this.$refs.kpiTableLeft.showColumn(this.$refs.kpiTableLeft.getColumnByField("userName")),this.$refs.kpiTableLeft.showColumn(this.$refs.kpiTableLeft.getColumnByField("workNo")),this.$refs.kpiTableRight.showColumn(this.$refs.kpiTableRight.getColumnByField("userName")),this.$refs.kpiTableRight.showColumn(this.$refs.kpiTableRight.getColumnByField("workNo"))),this.getKpiList()},selectWrokGroup:function(){this.getKpiList()},panelToLeft:function(){this.showPanelType>0&&this.showPanelType--,this.$refs.kpiTableLeft.refreshColumn(),this.$refs.kpiTableRight.refreshColumn()},panelToRight:function(){this.showPanelType<2&&this.showPanelType++,this.$refs.kpiTableLeft.refreshColumn(),this.$refs.kpiTableRight.refreshColumn()}}},s=o,u=(n("6917"),n("2877")),l=Object(u["a"])(s,i,r,!1,null,"6166c9b1",null);e["default"]=l.exports},e923:function(t,e,n){}}]);