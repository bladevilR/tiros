(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4adb1458"],{2830:function(t,e,i){},3979:function(t,e,i){"use strict";i("2830")},"94d7":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:"布局设置",centered:"",width:"100%",dialogClass:"fullDialog",visible:t.visible,destroyOnClose:!0},on:{ok:t.handleOk,cancel:function(e){t.visible=!1}}},[e("na-splitter",{staticStyle:{height:"calc(100%)"},attrs:{defaultSize:200}},[e("div",{staticStyle:{"overflow-y":"auto","overflow-x":"hidden"},attrs:{slot:"left-panel"},slot:"left-panel"},[e("div",{staticStyle:{padding:"10px","padding-left":"0px"}},[e("a-input-search",{staticStyle:{width:"100%"},attrs:{placeholder:"部件搜索"},on:{search:t.onSearch},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}})],1),e("div",{staticStyle:{padding:"10px","padding-left":"0px"}},t._l(t.widgets,(function(i){return i.hidden?t._e():e("div",{key:i.id,staticClass:"droppable-element",attrs:{id:i.id,draggable:"true",unselectable:"on"},on:{drag:t.drag,dragend:t.dragend}},[e("div",{staticStyle:{"line-height":"20px","font-weight":"bold"},attrs:{title:i.widgetName}},[e("a-icon",{style:{fontSize:"16px",color:"#08c"},attrs:{type:"ant-design"}}),t._v(" "+t._s(t.subStringBylen(i.widgetName,8))+" ")],1),e("div",{staticStyle:{color:"#cccccc"},attrs:{title:i.widgetDesc}},[t._v(t._s(t.subStringBylen(i.widgetDesc,10)))])])})),0)]),e("div",{staticStyle:{"padding-left":"5px","padding-right":"3px",height:"calc(100%)"},attrs:{slot:"right-panel"},slot:"right-panel"},[e("div",{attrs:{id:"content"}},[e("grid-layout",{ref:"gridlayout",attrs:{layout:t.layouts,"col-num":t.colNum,"row-height":20,autoSize:!0,"is-draggable":!0,"is-resizable":!0,responsive:!1,"prevent-collision":!0,"vertical-compact":!1,"use-css-transforms":!0},on:{"update:layout":function(e){t.layouts=e}}},t._l(t.layouts,(function(i){return e("grid-item",{key:i.i,attrs:{x:i.x,y:i.y,w:i.w,h:i.h,i:i.i}},[e("na-card",{staticStyle:{width:"100%",height:"100%"}},[e("div",{attrs:{slot:"title"},slot:"title"},[t.editTitle||t.editLayoutIndex===i.i?t._e():e("span",{on:{click:function(e){return e.stopPropagation(),t.editLayoutTitle(i)}}},[t._v(t._s(i.extInfo.title))]),t.editTitle&&t.editLayoutIndex===i.i?e("a-input",{staticStyle:{width:"60%"},attrs:{placeholder:"请输入"},on:{pressEnter:function(e){return e.stopPropagation(),t.doneEditItem.apply(null,arguments)}},model:{value:i.extInfo.title,callback:function(e){t.$set(i.extInfo,"title",e)},expression:"item.extInfo.title"}}):t._e()],1),e("div",{attrs:{slot:"extra"},slot:"extra"},[e("a",{attrs:{href:"javascript:void(0)",title:"移除该部件"},on:{click:function(e){return e.stopPropagation(),t.removeLayoutWidget(i)}}},[t._v("X")])]),e(i.viewComponent,{tag:"component"})],1)],1)})),1)],1)])])],1)},o=[],a=i("bebf"),s=i("ca00"),r=i("7be8"),l={x:null,y:null},u={x:null,y:null,w:1,h:1,i:null},d={name:"edit",components:{GridLayout:r["GridLayout"],GridItem:r["GridItem"]},data:function(){return{visible:!1,colNum:100,editTitle:!1,editLayoutIndex:null,searchText:"",layoutInfo:null,layouts:[],widgets:[]}},beforeMount:function(){this.getWidgets()},mounted:function(){document.addEventListener("dragover",(function(t){l.x=t.clientX,l.y=t.clientY}),!1)},methods:{editLayoutTitle:function(t){this.editTitle=!0,this.editLayoutIndex=t.i},doneEditItem:function(){this.editTitle=!1,this.editLayoutIndex=""},removeLayoutWidget:function(t){var e=this;this.layouts.forEach((function(i,n){i.i===t.i&&e.layouts.splice(n,1)}))},onSearch:function(){var t=this;this.widgets.forEach((function(e){t.searchText?e.widgetName.indexOf(t.searchText)>-1?e.hidden=!1:e.hidden=!0:e.hidden=!1}))},getWidgets:function(){var t=this;Object(a["e"])({pageNo:1,pageSize:1e5,status:1}).then((function(e){e.success?t.widgets=e.result.records:t.$message.error("查询部件失败")}))},getLayoutInfo:function(t){var e=this;Object(a["b"])({id:t}).then((function(t){t.success?(e.layoutInfo=t.result,e.initLayoutWidgets()):e.$message.error("加载部件信息失败")}))},trimStart:function(t){var e=new RegExp("^/*");return t.replace(e,"")},initLayoutWidgets:function(){var t=this;this.layoutInfo.layoutWidgetsList&&(this.layouts=[],this.layoutInfo.layoutWidgetsList.forEach((function(e){t.layouts.push({x:e.xPos,y:e.yPos,w:e.defWidth,h:e.defHeight,i:e.id,viewComponent:function(n){return Promise.all([i.e("chunk-862fcb7e"),i.e("chunk-7e9fd542"),i.e("chunk-7c666f7d"),i.e("chunk-d97b72b4"),i.e("chunk-931f7cbc")]).then(function(){var o=[i("692e")("./"+t.trimStart(e.componentPath)+".vue")];n.apply(null,o)}.bind(this)).catch(i.oe)},extInfo:e})})))},showModal:function(t){t?this.getLayoutInfo(t):this.layoutInfo={byUserId:"",byUserName:"",id:"",isMain:0,layoutCode:"",layoutDesc:"",layoutName:"",layoutScope:0,layoutWidgetsList:[{componentPath:"",defHeight:0,defWidth:0,id:"",isStatic:0,layoutId:"",moreUrl:"",status:0,title:"",widgetCategory:"",widgetCategoryName:"",widgetDesc:"",widgetId:"",widgetName:"",xPos:0,xpos:0,yPos:0,ypos:0}],status:0},this.visible=!0},handleOk:function(){var t=this;this.visible=!1;var e=[];this.layouts.forEach((function(t){var i=Object.assign({},t.extInfo);i.xPos=t.x,i.yPos=t.y,i.defWidth=t.w,i.defHeight=t.h,e.push(i)})),this.layoutInfo.layoutWidgetsList=e,Object(a["f"])(this.layoutInfo).then((function(e){e.success?(t.$message.success("保存成功"),t.$emit("ok"),t.visible=!1):t.$message.error("保存失败")}))},drag:function(t){var e=this,n=document.getElementById("content").getBoundingClientRect(),o=!1;if(l.x>n.left&&l.x<n.right&&l.y>n.top&&l.y<n.bottom&&(o=!0),!0===o&&-1===this.layouts.findIndex((function(t){return"drop"===t.i}))){var a=this.widgets.filter((function(e){return e.id===t.target.id}))[0];if(!a)return void(o=!1);this.layouts.push({x:2*this.layouts.length%(this.colNum||12),y:this.layouts.length+(this.colNum||12),w:1,h:1,i:"drop",viewComponent:function(t){return Promise.all([i.e("chunk-862fcb7e"),i.e("chunk-7e9fd542"),i.e("chunk-7c666f7d"),i.e("chunk-d97b72b4"),i.e("chunk-931f7cbc")]).then(function(){var n=[i("692e")("./"+e.trimStart(a.componentPath)+".vue")];t.apply(null,n)}.bind(this)).catch(i.oe)},extInfo:{componentPath:a.componentPath,defHeight:a.defHeight,defWidth:a.defWidth,id:Object(s["a"])(),isStatic:0,layoutId:"",moreUrl:a.moreUrl,status:0,title:a.widgetName,widgetId:a.id}})}var r=this.layouts.findIndex((function(t){return"drop"===t.i}));if(-1!==r){try{this.$refs.gridlayout.$children[this.layouts.length].$refs.item.style.display="none"}catch(f){}var d=this.$refs.gridlayout.$children[r];d.dragging={top:l.y-n.top,left:l.x-n.left};var c=d.calcXY(l.y-n.top,l.x-n.left);!0===o&&(this.$refs.gridlayout.dragEvent("dragstart","drop",c.x,c.y,1,1),u.i=String(r),u.x=this.layouts[r].x,u.y=this.layouts[r].y),!1===o&&(this.$refs.gridlayout.dragEvent("dragend","drop",c.x,c.y,1,1),this.layouts=this.layouts.filter((function(t){return"drop"!==t.i})))}},dragend:function(t){var e=document.getElementById("content").getBoundingClientRect(),i=!1;if(l.x>e.left&&l.x<e.right&&l.y>e.top&&l.y<e.bottom&&(i=!0),!0===i){var n=this.layouts.filter((function(t){return"drop"===t.i}))[0];this.$refs.gridlayout.dragEvent("dragend","drop",u.x,u.y,1,1),this.layouts=this.layouts.filter((function(t){return"drop"!==t.i})),this.layouts.push({x:u.x,y:u.y,w:n.extInfo.defWidth,h:n.extInfo.defHeight,i:n.extInfo.id,viewComponent:n.viewComponent,extInfo:n.extInfo});try{this.$refs.gridLayout.$children[this.layouts.length].$refs.item.style.display="block"}catch(o){}}},subStringBylen:function(t,e){var i=Object(s["q"])(t);return i>e?Object(s["r"])(t,e,!0)+"...":t}}},c=d,f=(i("3979"),i("2877")),h=Object(f["a"])(c,n,o,!1,null,"1c1fd9e8",null);e["default"]=h.exports},bebf:function(t,e,i){"use strict";i.d(e,"e",(function(){return s})),i.d(e,"f",(function(){return r})),i.d(e,"c",(function(){return l})),i.d(e,"a",(function(){return u})),i.d(e,"b",(function(){return d})),i.d(e,"d",(function(){return c}));var n=i("0fea"),o=i("4328"),a=i.n(o),s=function(t){return Object(n["d"])("/layout/widgets/page",t)},r=function(t){return Object(n["j"])("/layout/layouts/save",t)},l=function(t){return Object(n["d"])("/layout/layouts/page",t)},u=function(t){return Object(n["j"])("/layout/layouts/delete",a.a.stringify(t))},d=function(t){return Object(n["d"])("/layout/layouts/get",t)},c=function(){return Object(n["d"])("/layout/layouts/get/current-user-main")}}}]);