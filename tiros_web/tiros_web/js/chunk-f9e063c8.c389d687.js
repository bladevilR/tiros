(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f9e063c8"],{3170:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bodyWrapper",staticStyle:{padding:"8px"}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.loadData.apply(null,arguments)}}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:12,xl:8}},[e("a-form-item",{attrs:{label:"日期"}},[e("a-range-picker",{attrs:{defaultPickerValue:t.defaultDateRange},on:{change:t.onDateChange},model:{value:t.dateTime,callback:function(e){t.dateTime=e},expression:"dateTime"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("a-space",[e("a-button",{on:{click:t.init_sheet}},[t._v("查询")]),e("a-button",{on:{click:t.downloadExcel}},[t._v("导出")])],1)],1)],1)],1)],1),t._m(0)])},n=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"table-page-body"},[e("div",{staticStyle:{height:"calc(100% - 0px)",width:"100%"},attrs:{id:"luckysheet"}})])}],o=a("696e"),i=a("43f7"),u=a("7268"),s=a("e24e"),l=a("313e");function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function d(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",n=a.toStringTag||"@@toStringTag";function o(a,r,n,o){var s=r&&r.prototype instanceof u?r:u,l=Object.create(s.prototype);return f(l,"_invoke",function(a,r,n){var o,u,s,l=0,c=n||[],d=!1,f={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,a){return o=e,u=0,s=t,f.n=a,i}};function h(a,r){for(u=a,s=r,e=0;!d&&l&&!n&&e<c.length;e++){var n,o=c[e],h=f.p,m=o[2];a>3?(n=m===r)&&(s=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=t):o[0]<=h&&((n=a<2&&h<o[1])?(u=0,f.v=r,f.n=o[1]):h<m&&(n=a<3||o[0]>r||r>m)&&(o[4]=a,o[5]=r,f.n=m,u=0))}if(n||a>1)return i;throw d=!0,r}return function(n,c,m){if(l>1)throw TypeError("Generator is already running");for(d&&1===c&&h(c,m),u=c,s=m;(e=u<2?t:s)||!d;){o||(u?u<3?(u>1&&(f.n=-1),h(u,s)):f.n=s:f.v=s);try{if(l=2,o){if(u||(n="next"),e=o[n]){if(!(e=e.call(o,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,u<2&&(u=0)}else 1===u&&(e=o.return)&&e.call(o),u<2&&(s=TypeError("The iterator does not provide a '"+n+"' method"),u=1);o=t}else if((e=(d=f.n<0)?s:a.call(r,f))!==i)break}catch(e){o=t,u=1,s=e}finally{l=1}}return{value:e,done:d}}}(a,n,o),!0),l}var i={};function u(){}function s(){}function l(){}e=Object.getPrototypeOf;var c=[][r]?e(e([][r]())):(f(e={},r,(function(){return this})),e),h=l.prototype=u.prototype=Object.create(c);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,f(t,n,"GeneratorFunction")),t.prototype=Object.create(h),t}return s.prototype=l,f(h,"constructor",l),f(l,"constructor",s),s.displayName="GeneratorFunction",f(l,n,"GeneratorFunction"),f(h),f(h,n,"Generator"),f(h,r,(function(){return this})),f(h,"toString",(function(){return"[object Generator]"})),(d=function(){return{w:o,m:m}})()}function f(t,e,a,r){var n=Object.defineProperty;try{n({},"",{})}catch(t){n=0}f=function(t,e,a,r){function o(e,a){f(t,e,(function(t){return this._invoke(e,a,t)}))}e?n?n(t,e,{value:a,enumerable:!r,configurable:!r,writable:!r}):t[e]=a:(o("next",0),o("throw",1),o("return",2))},f(t,e,a,r)}function h(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function m(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?h(Object(a),!0).forEach((function(e){y(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function y(t,e,a){return(e=p(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function p(t){var e=g(t,"string");return"symbol"==c(e)?e:e+""}function g(t,e){if("object"!=c(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,e||"default");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function b(t,e,a,r,n,o,i){try{var u=t[o](i),s=u.value}catch(t){return void a(t)}u.done?e(s):Promise.resolve(s).then(r,n)}function v(t){return function(){var e=this,a=arguments;return new Promise((function(r,n){var o=t.apply(e,a);function i(t){b(o,r,n,i,u,"next",t)}function u(t){b(o,r,n,i,u,"throw",t)}i(void 0)}))}}var w={name:"fault_sum",components:{NaSelectDate:o["default"]},data:function(){return{maxRow:5,trainFaults:[],systeFaults:[],dateTime:[this.$moment(new Date).startOf("month").format("YYYY-MM-DD"),this.$moment(new Date).endOf("month").format("YYYY-MM-DD")],yearOpen:!1,yearValue:this.$moment(new Date),queryParam:{startDate:this.$moment(new Date).startOf("month").format("YYYY-MM-DD"),endDate:this.$moment(new Date).endOf("month").format("YYYY-MM-DD")},sheetOption:{},imageCount:1}},mounted:function(){this.init_sheet()},beforeDestroy:function(){luckysheet.destroy()},methods:{onDateChange:function(){this.dateTime[0]?this.queryParam.startDate=this.dateTime[0].format("YYYY-MM-DD"):this.queryParam.startDate="",this.dateTime[1]?this.queryParam.endDate=this.dateTime[1].format("YYYY-MM-DD"):this.queryParam.endDate=""},check:function(){return!0},init_sheet:function(){var t=this;Object(i["e"])("fault_sum").then((function(e){if(e.success)if(e.result&&e.result.tempContent){var a=JSON.parse(e.result.tempContent),r=Object.assign({},u["a"].getDefaultOptions());r.hook["workbookCreateAfter"]=function(){t.init_train_fault_sum(t.trainFaults),t.init_system_fault_sum(t.systeFaults)},t.imageCount=1,a.images={},a.data=[],r.allowEdit=!0,r.row=150,r.data=[a],t.loadData().then((function(){t.sheetOption=r,t.init_charts(),luckysheet.destroy(),luckysheet.create(t.sheetOption)}))}else t.$message.error("报表模板内容为空，请定义模板");else t.$message.error("报表模板查询失败：",e.message),t.dailyInfo=null}))},loadData:function(){var t=v(d().m((function t(){var e=this;return d().w((function(t){while(1)switch(t.n){case 0:return this.maxRow=0,t.a(2,Object(i["q"])(m({},this.queryParam)).then((function(t){t.success?(e.trainFaults=t.result,e.maxRow<e.trainFaults.length&&(e.maxRow=e.trainFaults.length)):(e.$message.error("查询车辆故障统计错误：",t.message),e.dailyInfo=null)})).then((function(){return Object(i["m"])(m({},e.queryParam)).then((function(t){t.success?(e.systeFaults=t.result,e.maxRow<e.systeFaults.length&&(e.maxRow=e.systeFaults.length)):(e.$message.error("查询车辆故障统计错误：",t.message),e.dailyInfo=null)}))})))}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),init_train_fault_sum:function(t){var e=0;if(t&&t.length>0){var a=t[0];u["a"].setCellValue(e,u["a"].char2Index("B"),parseInt(a["repair"])),u["a"].setCellValue(e,u["a"].char2Index("C"),parseInt(a["warranty"])),u["a"].setCellValue(e,u["a"].char2Index("D"),parseInt(a["warrantyOnline"])),u["a"].setCellValue(e,u["a"].char2Index("E"),parseInt(a["warrantyAboveB"])),u["a"].setCellValue(e,u["a"].char2Index("F"),parseInt(a["warrantyHasDuty"])),u["a"].setCellValue(e,u["a"].char2Index("G"),parseInt(a["expireWarranty"]))}if(e=2,t&&t.length>1){for(var r=1;r<t.length;r++){var n=t[r];u["a"].setCellValue(e,u["a"].char2Index("A"),{v:n["trainNo"],ht:0,vt:0,ff:"宋体",fs:11}),u["a"].setCellValue(e,u["a"].char2Index("B"),n["repair"]),u["a"].setCellValue(e,u["a"].char2Index("C"),n["warranty"]),u["a"].setCellValue(e,u["a"].char2Index("D"),n["warrantyOnline"]),u["a"].setCellValue(e,u["a"].char2Index("E"),n["warrantyAboveB"]),u["a"].setCellValue(e,u["a"].char2Index("F"),n["warrantyHasDuty"]),u["a"].setCellValue(e,u["a"].char2Index("G"),n["expireWarranty"]),e++}u["a"].setBorder(0,"A",e-1,"G")}},init_system_fault_sum:function(t){var e=2;if(t&&t.length>0){for(var a=0;a<t.length;a++){var r=t[a];u["a"].setCellValue(e,u["a"].char2Index("I"),{v:r["sys"],ht:0,vt:0,ff:"宋体",fs:11}),u["a"].setCellValue(e,u["a"].char2Index("J"),r["repair"]),u["a"].setCellValue(e,u["a"].char2Index("K"),r["warranty"]),e++}u["a"].setBorder(1,"I",e-1,"K"),this.systeFaults=t,luckysheet.setRangeShow("A1",{show:!1})}},init_charts:function(){var t=this,e={title:"各系统故障分布",dataCategory:["架修期","质保期"],dataNames:[],dataSeries:[{name:"架修期",type:"bar",data:[]},{name:"质保期",type:"bar",data:[]}]};this.systeFaults.forEach((function(t){e.dataNames.push(t.sys),e.dataSeries[0].data.push(t.repair),e.dataSeries[1].data.push(t.warranty)})),this.addHBar(this.maxRow,u["a"].char2Index("A"),e);var a={title:"各车辆故障分布",dataCategory:[],dataNames:[],dataSeries:[]},r=[{field:"repair",name:"架修期"},{field:"warranty",name:"质保期"},{field:"warrantyOnline",name:"质保期正线"},{field:"warrantyAboveB",name:"质保期B类及以上"},{field:"warrantyHasDuty",name:"质保期有责故障"},{field:"expireWarranty",name:"出质保故障数"}];r.forEach((function(e){for(var r={name:e.name,type:"bar",data:[]},n=1;n<t.trainFaults.length;n++){var o=t.trainFaults[n];r.data.push(o[e.field])}a.dataSeries.push(r),a.dataCategory.push(e.name)}));for(var n=1;n<this.trainFaults.length;n++){var o=this.trainFaults[n];a.dataNames.push(o.trainNo)}this.addHBar(this.maxRow,u["a"].char2Index("J"),a),this.maxRow=this.maxRow+22;var i={title:"架修期各系统故障占比",data:[]};this.systeFaults.forEach((function(t){t.repair&&i.data.push({name:t.sys,value:t.repair})})),0===i.data.length&&i.data.push({name:"暂无数据",value:0}),this.addPie(this.maxRow,u["a"].char2Index("A"),i);for(var s={title:"架修期各车故障占比",data:[]},l=1;l<this.trainFaults.length;l++){var c=this.trainFaults[l];c.repair&&s.data.push({name:c.trainNo,value:c.repair})}0===s.data.length&&s.data.push({name:"暂无数据",value:0}),this.addPie(this.maxRow,u["a"].char2Index("J"),s),this.maxRow=this.maxRow+22;var d={title:"质保期各系统故障占比",data:[]};this.systeFaults.forEach((function(t){t.warranty&&d.data.push({name:t.sys,value:t.warranty})})),0===d.data.length&&d.data.push({name:"暂无数据",value:0}),this.addPie(this.maxRow,u["a"].char2Index("A"),d);for(var f={title:"质保期各车故障占比",data:[]},h=1;h<this.trainFaults.length;h++){var m=this.trainFaults[h];m.warranty&&f.data.push({name:m.trainNo,value:m.warranty})}0===f.data.length&&f.data.push({name:"暂无数据",value:0}),this.addPie(this.maxRow,u["a"].char2Index("J"),f)},addPie:function(t,e,a){var r={backgroundColor:"#f6f6f6",title:{text:a.title,top:10,left:"center"},tooltip:{trigger:"item"},legend:{show:!1,orient:"vertical",left:"right"},series:[{name:"故障数",type:"pie",radius:"50%",data:a.data,label:{show:!0,formatter:"{b} : {c} ({d}%)"}}]};this.insertChart(t,e,r)},addHBar:function(t,e,a){var r={backgroundColor:"#f6f6f6",title:{text:a.title,top:10,left:"center"},legend:{data:a.dataCategory,orient:"vertical",left:"right",top:"middle"},grid:{top:"35",left:"15",right:"45",bottom:"15",containLabel:!0},xAxis:{type:"value",boundaryGap:[0,.01]},yAxis:{type:"category",data:a.dataNames},series:a.dataSeries};this.insertChart(t,e,r)},insertChart:function(t,e,a){a["textStyle"]={fontSize:13};var r=document.createElement("canvas");r.id="CursorLayer";var n=l["b"](r);n.clear(),n.setOption(a),n.resize({width:675,height:450,silent:!0});var o=n.getDataURL();this.sheetOption.data[0].images["image_".concat(t,"_").concat(e)]={type:"3",src:o,originWidth:675,originHeight:450,default:{width:583,height:387,top:18.5*this.maxRow+100,left:this.imageCount%2?0:664},crop:{width:583,height:387,offsetLeft:0,offsetTop:0},isFixedPos:!1,fixedLeft:77,fixedTop:286,border:{width:0,radius:0,style:"solid",color:"#000"}},this.imageCount++},downloadExcel:function(){Object(s["a"])(luckysheet.getAllSheets(),this.queryParam.year+"年故障汇总统计")}}},x=w,D=a("2877"),O=Object(D["a"])(x,r,n,!1,null,"340debb3",null);e["default"]=O.exports},"43f7":function(t,e,a){"use strict";a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return i})),a.d(e,"v",(function(){return u})),a.d(e,"e",(function(){return n})),a.d(e,"q",(function(){return s})),a.d(e,"m",(function(){return l})),a.d(e,"d",(function(){return p})),a.d(e,"t",(function(){return g})),a.d(e,"r",(function(){return d})),a.d(e,"p",(function(){return c})),a.d(e,"u",(function(){return h})),a.d(e,"o",(function(){return m})),a.d(e,"b",(function(){return y})),a.d(e,"n",(function(){return b})),a.d(e,"s",(function(){return f})),a.d(e,"f",(function(){return v})),a.d(e,"h",(function(){return w})),a.d(e,"g",(function(){return x})),a.d(e,"l",(function(){return D})),a.d(e,"j",(function(){return O})),a.d(e,"i",(function(){return P})),a.d(e,"k",(function(){return C}));var r=a("0fea"),n=function(t){return Object(r["d"])("/report/excel/get",{tempCode:t})},o=function(t){return Object(r["d"])("/report/daily/get",t)},i=function(t){return Object(r["d"])("/report/daily/generate",t)},u=function(t){return Object(r["j"])("/report/daily/save",t)},s=function(t){return Object(r["d"])("/report/fault/count/trains",t)},l=function(t){return Object(r["d"])("/report/fault/count/systems",t)},c=function(t){return Object(r["d"])("/report/fault/detail/list",t)},d=function(t){return Object(r["d"])("/report/cost/detail/statistic-consume",t)},f=function(t){return Object(r["d"])("/report/cost/detail/statistic-must-random",t)},h=function(t){return Object(r["d"])("/report/turnover/detail/page",t)},m=function(t){return Object(r["d"])("/report/cost/kpi/page",t)},y=function(t,e){return Object(r["c"])("/report/cost/kpi/export",t,e)},p=function(t){return Object(r["d"])("/report/fault/train-count/sys",t)},g=function(t){return Object(r["d"])("/report/cost/train/statistic",t)},b=function(t){return Object(r["d"])("/report/cost/train/get-cars-number",t)},v=function(t){return Object(r["d"])("/produce/plan/summary/cost",t)},w=function(t){return Object(r["d"])("/produce/plan/summary/fault",t)},x=function(t){return Object(r["d"])("/produce/plan/summary/total",t)},D=function(t){return Object(r["d"])("/produce/plan/summary/work-time",t)},O=function(t){return Object(r["d"])("/produce/plan/summary/period",t)},P=function(t){return Object(r["d"])("/produce/plan/summary/outsource",t)},C=function(t){return Object(r["d"])("/produce/plan/summary/progress",t)}},"696e":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"s-na-select-date",style:t.naStyle},[e("a-form-item",{style:{height:"32px"},attrs:{label:"日期:"}},[e("a-row",{attrs:{gutter:6}},[e("a-col",{attrs:{md:6}},[e("j-dict-select-tag",{staticClass:"na-select-clear",attrs:{allowClear:!0,hiddenArray:t.hiddenArray,placeholder:"请选择",dictCode:t.dictDateCode},on:{select:t.dateTypeChange},model:{value:t.queryParam.dateType,callback:function(e){t.$set(t.queryParam,"dateType",e)},expression:"queryParam.dateType"}})],1),1===Number(t.queryParam.dateType)||2===Number(t.queryParam.dateType)?e("a-col",{attrs:{md:2===Number(t.queryParam.dateType)?6:18}},[e("a-form-item",{style:{height:"32px"}},[e("a-date-picker",{staticStyle:{width:"100%"},attrs:{mode:"year",placeholder:"请选择年份",format:"YYYY",showToday:!0,allowClear:!0,open:t.yearOpen,defaultPickerValue:this.$moment(new Date)},on:{panelChange:t.changeYear,focus:function(e){t.yearOpen=!0}},model:{value:t.queryParam.year,callback:function(e){t.$set(t.queryParam,"year",e)},expression:"queryParam.year"}})],1)],1):t._e(),2===Number(t.queryParam.dateType)?e("a-col",{attrs:{md:12}},[e("a-form-item",{style:{height:"32px"}},[e("j-dict-select-tag",{staticClass:"na-select-clear",attrs:{placeholder:"请选择",dictCode:"bu_quarter_type",allowClear:!0},on:{select:t.dateChange},model:{value:t.queryParam.quarter,callback:function(e){t.$set(t.queryParam,"quarter",e)},expression:"queryParam.quarter"}})],1)],1):t._e(),3===Number(t.queryParam.dateType)?e("a-col",{attrs:{md:18}},[e("a-form-item",{style:{height:"32px"}},[e("a-month-picker",{staticStyle:{width:"100%"},attrs:{placeholder:"选择月份",format:"YYYY-MM",showToday:!0,allowClear:!0,defaultPickerValue:this.$moment(new Date)},on:{change:t.dateChange},model:{value:t.queryParam.month,callback:function(e){t.$set(t.queryParam,"month",e)},expression:"queryParam.month"}})],1)],1):t._e(),4===Number(t.queryParam.dateType)?e("a-col",{attrs:{md:18}},[e("a-form-item",{style:{height:"32px"}},[e("a-range-picker",{staticStyle:{width:"100%"},attrs:{showToday:!0,allowClear:!0,format:"YYYY-MM-DD"},on:{change:t.dateChange},model:{value:t.queryParam.dateRef,callback:function(e){t.$set(t.queryParam,"dateRef",e)},expression:"queryParam.dateRef"}})],1)],1):t._e()],1)],1)],1)},n=[];function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}var i={name:"na-select-date",data:function(){return{yearOpen:!1,queryParam:{dateType:this.defaultType,quarter:1,year:this.$moment(new Date),month:this.$moment(new Date),dateRef:[this.$moment(new Date),this.$moment(new Date)]},result:{dateType:1,quarter:1,year:null,month:null,dateRef:[null,null]}}},model:{prop:"modelVal",event:"change"},props:{hiddenArray:Array,dictDateCode:{type:String,default:"bu_date_type"},defaultType:{type:Number,default:1},modelVal:{dateType:1,quarter:1,year:null,month:null,dateRef:[]},naStyle:{type:String,default:""}},methods:{dateTypeChange:function(){this.dateChange()},changeYear:function(t,e){this.yearValue=t,this.queryParam.year=t.format("YYYY"),this.yearOpen=!1,this.dateChange()},reset:function(){this.queryParam.dateType=null,this.queryParam.quarter=1,this.queryParam.year=this.$moment(new Date),this.queryParam.month=this.$moment(new Date),this.queryParam.dateRef=[this.$moment(new Date),this.$moment(new Date)]},dateChange:function(){this.yearOpen=!1,this.queryParam.dateType?this.$set(this.result,"dateType",Number(this.queryParam.dateType)):this.$set(this.result,"dateType",null),3===this.result.dateType?this.$set(this.result,"year",Number(this.queryParam.month.format("YYYY"))):this.$set(this.result,"year","object"===o(this.queryParam.year)?Number(this.queryParam.year.format("YYYY")):Number(this.queryParam.year)),this.$set(this.result,"month","object"===o(this.queryParam.month)?Number(this.queryParam.month.format("MM")):Number(this.queryParam.month)),this.result.quarter=Number(this.queryParam.quarter),this.result.dateRef=[this.queryParam.dateRef[0].format("YYYY-MM-DD"),this.queryParam.dateRef[1].format("YYYY-MM-DD")],this.$set(this.result.dateRef,0,"object"===o(this.queryParam.dateRef[0])?this.queryParam.dateRef[0].format("YYYY-MM-DD"):this.queryParam.dateRef[0]),this.$set(this.result.dateRef,1,"object"===o(this.queryParam.dateRef[1])?this.queryParam.dateRef[1].format("YYYY-MM-DD"):this.queryParam.dateRef[1]),this.$emit("change",this.result)}}},u=i,s=a("2877"),l=Object(s["a"])(u,r,n,!1,null,null,null);e["default"]=l.exports},e24e:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));var r=a("e8ae"),n=a.n(r),o=a("21a6"),i=a.n(o),u=(a("7268"),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"),s=function(t,e){var a=new n.a.Workbook;"[object Object]"===Object.prototype.toString.call(t)&&(t=[t]),t.forEach((function(t){if(0===t.data.length)return!0;var e=a.addWorksheet(t.name),r=t.config&&t.config.merge||{},n=t.config&&t.config.borderInfo||{},o=t.config&&t.config.columnlen||{},i=t.images||{};return d(i,a,e),c(o,e),l(t.config,e),m(t.data,e),f(r,e),h(n,e),!0}));var r=a.xlsx.writeBuffer().then((function(t){var a=new Blob([t],{type:u});i.a.saveAs(a,"".concat(e,".xlsx"))}));return r},l=function(t,e){if(t&&t.rowlen)for(var a in t.rowlen){var r=parseInt(a),n=parseInt(t.rowlen[a]),o=e.getRow(r+1);o.height=n}},c=function(t,e){for(var a in t){var r=parseInt(a),n=parseInt(t[a]);e.getColumn(r+1).width=parseInt(n/7)}},d=function(t,e,a){for(var r in t){var n=t[r],o=n.src.split(";base64,"),i=o[0].replaceAll("data:image/",""),u=e.addImage({base64:n.src,extension:i}),s=luckysheet.location(n.default.left,n.default.top);a.addImage(u,{tl:{col:s.col,row:s.row},ext:{width:n.default.width,height:n.default.height}})}},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,a=Object.values(t);a.forEach((function(t){e.mergeCells(t.r+1,t.c+1,t.r+t.rs,t.c+t.cs)}))},h=function(t,e){Array.isArray(t)&&t.forEach((function(t){if("range"===t.rangeType)for(var a=b(t.borderType,t.style,t.color),r=t.range[0],n=r.row,o=r.column,i=n[0]+1;i<n[1]+2;i++)for(var u=o[0]+1;u<o[1]+2;u++)e.getCell(i,u).border=a;if("cell"===t.rangeType){var s=t.value,l=s.col_index,c=s.row_index,d=Object.assign({},t.value);delete d.col_index,delete d.row_index;var f=v(d,c,l);e.getCell(c+1,l+1).border=f}}))},m=function(t,e){Array.isArray(t)&&t.forEach((function(t,a){t.every((function(t,r){if(!t)return!0;var n=y(t.bg),o=p(t.ff,t.fc,t.bl,t.it,t.fs,t.cl,t.ul),i=g(t.vt,t.ht,t.tb,t.tr),u="";t.f?u={formula:t.f,result:t.v}:!t.v&&t.ct&&t.ct.s?t.ct.s.forEach((function(t){u+=t.v})):u=t.v;var s=w(r),l=e.getCell(s+(a+1));for(var c in n){l.fill=n;break}return l.font=o,l.alignment=i,l.value=u,!0}))}))},y=function(t){if(!t)return{};var e={type:"pattern",pattern:"solid",fgColor:{argb:t.replace("#","")}};return e},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000000",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u={0:"微软雅黑",1:"宋体（Song）",2:"黑体（ST Heiti）",3:"楷体（ST Kaiti）",4:"仿宋（ST FangSong）",5:"新宋体（ST Song）",6:"华文新魏",7:"华文行楷",8:"华文隶书",9:"Arial",10:"Times New Roman ",11:"Tahoma ",12:"Verdana",num2bl:function(t){return 0!==t}},s={name:"number"===typeof t?u[t]:t,family:1,size:n,color:{argb:e.replace("#","")},bold:u.num2bl(a),italic:u.num2bl(r),underline:u.num2bl(i),strike:u.num2bl(o)};return s},g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"default",n={vertical:{0:"middle",1:"top",2:"bottom",default:"top"},horizontal:{0:"center",1:"left",2:"right",default:"left"},wrapText:{0:!1,1:!1,2:!0,default:!1},textRotation:{0:0,1:45,2:-45,3:"vertical",4:90,5:-90,default:0}},o={vertical:n.vertical[t],horizontal:n.horizontal[e],wrapText:n.wrapText[a],textRotation:n.textRotation[r]};return o},b=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000";if(!t)return{};var r={type:{"border-all":"all","border-top":"top","border-right":"right","border-bottom":"bottom","border-left":"left"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}},n={style:r.style[e],color:{argb:a.replace("#","")}},o={};return"all"===r.type[t]?(o["top"]=n,o["right"]=n,o["bottom"]=n,o["left"]=n):o[r.type[t]]=n,o};function v(t,e,a){var r={},n={type:{l:"left",r:"right",b:"bottom",t:"top"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}};for(var o in t)-1===t[o].color.indexOf("rgb")?r[n.type[o]]={style:n.style[t[o].style],color:{argb:t[o].color.replace("#","")}}:r[n.type[o]]={style:n.style[t[o].style],color:{argb:t[o].color}};return r}function w(t){var e="A".charCodeAt(0),a="Z".charCodeAt(0),r=a-e+1,n="";while(t>=0)n=String.fromCharCode(t%r+e)+n,t=Math.floor(t/r)-1;return n}}}]);