(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-696ef4f5","chunk-2c88bf26","chunk-1ffd86bb","chunk-537c4b7a","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7"],{"39ff7":function(e,t,a){},4501:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"作业指导书",width:"100%",dialogClass:"fullDialog no-footer",visible:e.visible,footer:null},on:{cancel:e.handleCancel}},[t("div",{staticClass:"sop-body"},[t("div",{staticStyle:{display:"flex","align-content":"center","flex-wrap":"wrap"}},[e.loading?t("a-spin",{attrs:{tip:"下载中..."}}):e._e()],1),e.loading?e._e():t("div",{ref:"mainDom",staticClass:"sop-body-page"})])])},n=[],o=a("8fad"),l={name:"WorkSopView",components:{},data:function(){return{visible:!1,tableData:[],queryParam:{bookId:""},loading:!1}},created:function(){},methods:{findList:function(){},handleCancel:function(){this.visible=!1},showBook:function(e){var t=this;this.visible=!0,this.loading=!0,Object(o["ac"])({bookId:e}).then((function(e){if(e.success){var a=[];e.result.forEach((function(e){a.push(Object(o["bc"])({detailId:e.id}).then((function(e){if(e.success){var a=JSON.parse(JSON.stringify(e.result));return a}return t.$message.error(e.message),null})))})),Promise.all(a).then((function(e){e.sort((function(e,t){return e.stepNum-t.stepNum}));var a="";e.forEach((function(e){e&&(a+="<h2>".concat(e.stepNum,'<span style="margin-left:15px;margin-top: 24px;">').concat(e.stepTitle,"</span></h2>"),a+=e.stepContent||"")})),t.loading=!1,t.$nextTick.call(t,(function(){t.$refs.mainDom.innerHTML=a}))}))}}))},showSopDetail:function(e){var t=this;this.visible=!0;var a=[];e.forEach((function(e){a.push(Object(o["bc"])({detailId:e}).then((function(e){return e.success?e.result:""})))})),Promise.all(a).then((function(e){var a="";e.forEach((function(e){a+="<h2>".concat(e.stepNum,'<span style="margin-left:15px;">').concat(e.stepTitle,"</span></h2>"),a+=e.stepContent})),t.$refs.mainDom.innerHTML=a}))}}},r=l,s=(a("a9f9"),a("bca7"),a("2877")),c=Object(s["a"])(r,i,n,!1,null,"7e7655fc",null);t["default"]=c.exports},"4a04":function(e,t,a){"use strict";a("b286")},5633:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("span",[t("a-select",{key:e.key,attrs:{"allow-clear":"",value:e.getValueSting,disabled:e.disabled,placeholder:"线路"},on:{change:e.handleChange,select:e.onSelect}},[t("a-select-option",{attrs:{value:void 0}},[e._v("请选择")]),e._l(e.optionData,(function(a,i){return t("a-select-option",{key:i,attrs:{value:a.lineId}},[t("span",{staticStyle:{display:"inline-block",width:"100%"},attrs:{title:a.lineName}},[e._v(" "+e._s(a.lineName)+" ")])])}))],2)],1)},n=[],o=a("8fad"),l={name:"LineSelectList",props:{value:[String],triggerChange:Boolean,disabled:Boolean,defaultFirst:Boolean},data:function(){return{optionData:[],selectValue:"",key:0}},created:function(){this.findList()},computed:{getValueSting:function(){return null!=this.value?this.value.toString():void 0}},methods:{findList:function(){var e=this;Object(o["Jb"])().then((function(t){t.success&&(e.optionData=t.result,e.defaultFirst&&e.optionData&&e.optionData.length>0&&setTimeout((function(){e.$emit("change",e.optionData[0].lineId),e.$emit("input",e.optionData[0].lineId)}),500))}))},handleChange:function(e,t){var a="";if(t&&t.componentOptions.children[0].data&&(a=t.componentOptions.children[0].data.attrs.title),this.$emit("change",e),this.$emit("input",e),this.$emit("changeName",a),this.triggerChange)if(e){var i=this.optionData[t.key];this.$emit("change",e,i)}else this.$emit("change",e,null)},onSelect:function(e,t){if(e){var a=this.optionData[t.data.key];this.$emit("select",e,a)}else this.$emit("select","",null)}}},r=l,s=a("2877"),c=Object(s["a"])(r,i,n,!1,null,"77265147",null);t["default"]=c.exports},"5fab":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:450,visible:e.visible,confirmLoading:e.confirmLoading,destroyOnClose:!0,cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"作业指导书"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["teckBookName",e.validatorRules.teckBookName],expression:"['teckBookName', validatorRules.teckBookName]",modifiers:{trim:!0}}],ref:"mySelect",attrs:{placeholder:"请选择关联设备",open:!1,showArrow:!0},on:{focus:e.openModal}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1)],1)],1),t("TechBookList",{ref:"selectForm",attrs:{multiple:!1},on:{ok:e.selectBook}})],1)],1)},n=[],o=a("7dc0"),l={name:"FileItemModel",components:{TechBookList:o["default"]},data:function(){return{title:"操作",visible:!1,teckBookId:"",teckBookName:"",model:{},labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:14}},confirmLoading:!1,form:this.$form.createForm(this),deptId:"",validatorRules:{teckBookName:{rules:[{required:!0,message:"请选择作业指导书!"}]}}}},created:function(){},methods:{openModal:function(){this.$refs.selectForm.showModal(),this.$refs.mySelect.blur()},selectBook:function(e){e.length&&(this.teckBookId=e[0].id,this.teckBookName=e[0].fileName),this.form.setFieldsValue({teckBookName:this.teckBookName})},add:function(){this.edit({})},edit:function(e){var t=this;this.form.resetFields(),this.visible=!0,this.model=Object.assign({},e),e._XID&&this.$nextTick((function(){t.form.setFieldsValue({})}))},handleOk:function(){var e=this,t=this;t.form.validateFields((function(a,i){if(!a){t.confirmLoading=!0;var n=Object.assign(t.model,i,{teckBookId:e.teckBookId});t.$emit("ok",n),t.close(),t.confirmLoading=!1}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},r=l,s=a("2877"),c=Object(s["a"])(r,i,n,!1,null,null,null);t["default"]=c.exports},"7dc0":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"80%",title:"作业指导书选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",centered:"",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"名称"}},[t("a-input",{attrs:{placeholder:"请输入指导书名称"},model:{value:e.queryParam.formName,callback:function(t){e.$set(e.queryParam,"formName",t)},expression:"queryParam.formName"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"修程类型"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_repair_program,name,id"},model:{value:e.queryParam.repairProgramId,callback:function(t){e.$set(e.queryParam,"repairProgramId",t)},expression:"queryParam.repairProgramId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"所属线路"}},[t("line-select-list",{model:{value:e.queryParam.lineId,callback:function(t){e.$set(e.queryParam,"lineId",t)},expression:"queryParam.lineId"}})],1)],1),t("a-col",{attrs:{md:4,sm:8}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)])],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 130px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 130px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"highlight-current-row":"","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"click",mode:"cell",showIcon:"true"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"fileNo",title:"文件编号",width:"180"}}),t("vxe-table-column",{attrs:{field:"fileName",title:"文件名称","header-align":"center",align:"left"}}),t("vxe-table-column",{attrs:{field:"fileVer",title:"文件版本",width:"140"}}),t("vxe-table-column",{attrs:{field:"repairProgramName",title:"所属修程",width:"140"}}),t("vxe-table-column",{attrs:{field:"lineName",title:"所属线路",width:"140"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"有效状态",width:"80"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)])},n=[],o=a("5633"),l=a("8fad"),r={name:"TechBookList",components:{LineSelectList:o["default"]},props:{multiple:{type:Boolean,default:!0}},data:function(){return{queryParam:{formName:"",lineId:"",repairProgramId:"",pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,formItemLayout:{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}}}},methods:{showModal:function(){this.visible=!0,this.findList()},findList:function(){var e=this;this.loading=!0,Object(l["cc"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.close()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,this.queryParam.formName=""}}},s=r,c=(a("4a04"),a("2877")),u=Object(c["a"])(s,i,n,!1,null,"83e4a944",null);t["default"]=u.exports},"94ce":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"file-list-container"},[t("div",{staticClass:"btn_cont",staticStyle:{margin:"10px 0"}},[t("a-button",{staticStyle:{"margin-right":"6px"},attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增")]),t("a-button",{on:{click:e.handleDelete}},[e._v("删除")])],1),t("vxe-table",{ref:"listTable",attrs:{border:"",align:"center","max-height":"auto",data:e.data,"keep-source":!0,"checkbox-config":{trigger:"row",highlight:!0,range:!0}},on:{"update:data":function(t){e.data=t}}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{type:"seq",title:"序号",width:"120"}}),t("vxe-table-column",{attrs:{field:"teckBookName",title:"工艺文件",align:"left"}}),t("vxe-table-column",{attrs:{title:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(a){var i=a.row;return[t("a",{on:{click:function(t){return t.stopPropagation(),e.showSop(i)}}},[e._v("预览")])]}}])})],1),t("FileItemModel",{ref:"modalForm",on:{ok:e.addFileItemData}}),t("WorkSopView",{ref:"workSopViewModal"})],1)},n=[],o=a("5fab"),l=a("4501"),r={components:{FileItemModel:o["default"],WorkSopView:l["default"]},data:function(){return{}},props:{data:{type:Array,default:function(){return[]}}},methods:{handleAdd:function(){this.$refs.modalForm.add(),this.$refs.modalForm.title="新增"},handleDelete:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();t.length>0?this.$confirm({content:"是否删除选中".concat(t.length,"条数据？"),okText:"确定",cancelText:"取消",onOk:function(){e.$emit("del",t)}}):this.$message.error("请选择最少一条数据！")},addFileItemData:function(e){this.$emit("ok",e)},showSop:function(e){this.$refs.workSopViewModal.showBook(e.teckBookId)}}},s=r,c=a("2877"),u=Object(c["a"])(s,i,n,!1,null,"c4f6cf62",null);t["default"]=u.exports},a9f9:function(e,t,a){"use strict";a("d392")},b286:function(e,t,a){},bca7:function(e,t,a){"use strict";a("39ff7")},d392:function(e,t,a){}}]);