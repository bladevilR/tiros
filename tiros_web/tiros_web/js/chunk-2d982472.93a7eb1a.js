(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d982472","chunk-6012e0be","chunk-c7b1b1f0","chunk-68d3350a","chunk-ccd9324a","chunk-c7f0d712","chunk-2d22d5d2"],{"389d":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:"物资备料",width:"80%",bodyStyle:{height:"70vh"},visible:t.visible,confirmLoading:t.confirmLoading,closable:!0,forceRender:!0,destroyOnClose:!0},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("a-spin",{attrs:{spinning:t.confirmLoading}},[e("ApplyReadyComponent",{ref:"applyReady",on:{ok:t.saveOk,fail:t.saveFail,close:t.close}})],1)],1)},i=[],n=a("ff09"),o={name:"ApplyReadyModal",components:{ApplyReadyComponent:n["default"]},data:function(){return{visible:!1,confirmLoading:!1}},methods:{showModal:function(t){this.visible=!0,this.$refs.applyReady.edit(t)},handleOk:function(){this.confirmLoading=!0,this.$refs.applyReady.save()},saveOk:function(){this.$emit("ok"),this.$message.success("保存成功"),this.close()},saveFail:function(){this.confirmLoading=!1},handleCancel:function(){this.close()},close:function(){this.confirmLoading=!1,this.$emit("close"),this.visible=!1}}},l=o,s=a("2877"),c=Object(s["a"])(l,r,i,!1,null,null,null);e["default"]=c.exports},"49c2":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:t.title,width:"80%",bodyStyle:{height:"70vh"},centered:"",visible:t.visible,destroyOnClose:!0,confirmLoading:t.confirmLoading,cancelText:"关闭"},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("a-tabs",{attrs:{"default-active-key":"1"}},[e("a-tab-pane",{key:"1",attrs:{tab:"基本信息"}},[e("a-spin",{attrs:{spinning:t.confirmLoading}},[e("a-form",{attrs:{form:t.form}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"领料单名称"}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["title",t.validatorRules.title],expression:"['title',validatorRules.title]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入领料单名称"}})],1)],1),e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"申请时间"}},[e("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["applyDate",t.validatorRules.applyDate],expression:"[ 'applyDate',validatorRules.applyDate]",modifiers:{trim:!0}}]})],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"申请人"}},[e("div",{on:{click:function(e){return e.stopPropagation(),t.showUserModal()}}},[e("a-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["userName",t.validatorRules.userId],expression:"[ 'userName', validatorRules.userId]",modifiers:{trim:!0}}],attrs:{placeholder:"请选择人员",open:!1}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},on:{click:function(e){return e.stopPropagation(),t.showUserModal()}},slot:"suffixIcon"})],1)],1)])],1),e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"申请班组"}},[e("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["deptId",t.validatorRules.deptId],expression:"[ 'deptId', validatorRules.deptId]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,placeholder:"请选择",dictCode:t.dictGroupStr},on:{change:t.onGroupChange}})],1)],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"关联工单"}},[e("div",{on:{click:function(e){return e.stopPropagation(),t.showOrderModal()}}},[e("a-select",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["workOrderName"],expression:"[ 'workOrderName']",modifiers:{trim:!0}}],attrs:{placeholder:"请选择工单",open:!1}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},on:{click:function(e){return e.stopPropagation(),t.showOrderModal()}},slot:"suffixIcon"})],1)],1)])],1)],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"线路"}},[e("line-select-list",{directives:[{name:"decorator",rawName:"v-decorator",value:["lineId",t.validatorRules.lineId],expression:"['lineId', validatorRules.lineId]"}],on:{change:t.changeLine}})],1)],1),e("a-col",{attrs:{md:12,sm:24}},[e("a-form-item",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol,label:"车辆"}},[e("j-dict-select-seach-tag",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["trainNo",t.validatorRules.trainNo],expression:"[ 'trainNo', validatorRules.trainNo]",modifiers:{trim:!0}}],attrs:{triggerChange:!0,placeholder:"请选择",dictCode:t.dictTrainStr}})],1)],1)],1)],1)],1)],1),e("a-tab-pane",{key:"2",attrs:{tab:"物资信息","force-render":""}},[e("a-spin",{attrs:{spinning:t.confirmLoading}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:12,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden","margin-bottom":"8px"}},[e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("新增")]),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.deleteRecord}},[t._v("删除")])],1)])],1),e("vxe-table",{ref:"listTable",attrs:{border:"",align:t.allAlign,data:t.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"},"edit-rules":t.validRules}},[e("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeCode",title:"物资编码",width:"100",fixed:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeName",title:"物资名称","min-width":"150",align:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeSpec",title:"规格型号","min-width":"200"}}),e("vxe-table-column",{attrs:{field:"materialTypeUnit",title:"单位",width:"100"}}),e("vxe-table-column",{attrs:{field:"amount",title:"领用数量",width:"100","edit-render":{name:"$input",props:{type:"number",min:0}}}}),e("vxe-table-column",{attrs:{field:"warehouseName",title:"库位",width:"100"}}),e("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"100"}}),e("vxe-table-column",{attrs:{title:"操作",width:"150",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){var r=a.row;return[t.$refs.listTable.isActiveByRow(r)?[e("a-space",[e("a-button",{attrs:{size:"small"},on:{click:function(e){return e.stopPropagation(),t.saveMaterial(r)}}},[t._v("保存")]),e("a-button",{attrs:{size:"small"},on:{click:function(e){return e.stopPropagation(),t.cancelMaterial(r)}}},[t._v("取消")])],1)]:[e("a-button",{attrs:{size:"small"},on:{click:function(e){return e.stopPropagation(),t.editMaterial(r)}}},[t._v("编辑")])]]}}])})],1),e("material-list",{ref:"materialForm",attrs:{multiple:!0},on:{ok:t.addTarget}}),e("work-order-select",{ref:"orderSelectModal",attrs:{multiple:!1},on:{ok:t.onOrderSelect}}),e("user-list",{ref:"userSelectModal",attrs:{multiple:!1},on:{ok:t.onUserSelect}})],1)],1)],1)],1)},i=[],n=a("c54ca"),o=a("7164"),l=a("4ec3"),s=a("c1df"),c=a.n(s),u=a("673e"),d=a("b245"),f=a("5633"),m={name:"ApplyItemModal",components:{MaterialList:o["default"],WorkOrderSelect:u["default"],UserList:d["default"],LineSelectList:f["default"]},data:function(){return{dictTrainStr:"",dictGroupStr:"bu_mtr_workshop_group,group_name,id,workshop_id='"+this.$store.getters.userInfo.workshopId+"'|workshop_id",tableData:[],palletList:[],state:!0,title:"操作",visible:!1,model:{},allAlign:"center",labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:15}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{title:{rules:[{required:!0,message:"请输入领用单标题!"}]},lineId:{rules:[{required:!0,message:"请选择线路!"}]},trainNo:{rules:[{required:!0,message:"请选择车辆!"}]},applyDate:{rules:[{required:!0,message:"请选择申请日期!"}]},deptId:{rules:[{required:!0,message:"请选择申请部门!"}]},userId:{rules:[{required:!0,message:"请选择申请人!"}]},userName:{rules:[{required:!0,message:"请选择申请人!"}]}},validRules:{reason:[{required:!0,message:"请输入申请数量"}]},dictCode:"bu_material_pallet,name,id"}},created:function(){this.initDictData()},methods:{saveMaterial:function(t){this.$refs.listTable.clearActived()},cancelMaterial:function(t){this.$refs.listTable.clearActived()},editMaterial:function(t){this.$refs.listTable.setActiveRow(t)},unique:function(t){var e=new Map;return t.filter((function(t){return!e.has(t.materialTypeId)&&e.set(t.materialTypeId,1)}))},add:function(){this.edit({workOrderId:void 0})},edit:function(t){var e=this;this.form.resetFields(),this.tableData=[],this.model=Object.assign({},t),this.visible=!0,this.model.detailList&&this.model.detailList.length>0&&this.model.detailList.forEach((function(t){t.palletName=t.palletId,e.tableData.push(t)})),this.$nextTick((function(){e.form.setFieldsValue({title:e.model.title,lineId:e.model.lineId,trainNo:e.model.trainNo,userId:e.model.userId,userName:e.model.userName,deptId:e.model.deptId,applyDate:c()(e.model.applyDate||void 0)})}))},handleOk:function(){var t=this,e=this;e.form.validateFields((function(a,r){if(!a){var i,o=Object.assign(e.model,r,{receiveTime:c()(r.receiveTime).format("YYYY-MM-DD"),applyDate:c()(r.applyDate).format("YYYY-MM-DD")}),l=[];t.tableData.forEach((function(t){t.palletId=t.palletName,t.palletName="",l.push(t)})),o["detailList"]=l,i=e.model.id?Object(n["E"])(o):Object(n["a"])(o),i.then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok")):e.$message.warning(t.message)})).finally((function(){e.confirmLoading=!1,e.close()})),t.visible=!1}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},handleAdd:function(){this.$refs.materialForm.showModal()},deleteRecord:function(){var t=this,e=this.$refs.listTable.getCheckboxRecords();e.length>0?this.$confirm({content:"是否删除选中".concat(e.length,"数据？"),onOk:function(){if(t.model.detailList){var a=e.map((function(t,e){return t.id})).join(",");Object(n["q"])("ids="+a).then((function(e){t.findList(),t.$message.success(e.message)}))}t.tableData=t.tableData.filter((function(t){e.includes(t)}))}}):this.$message.error("尚未选中任何数据!")},addTarget:function(t){var e=this;t&&(t.map((function(t){e.tableData=e.tableData.concat(e.getMaterial(t))})),this.tableData=this.unique(this.tableData))},getMaterial:function(t){return{materialTypeCode:t.code,materialTypeName:t.name,materialTypeSpec:t.spec,materialTypeUnit:t.unit,materialTypeId:t.id,amount:t.num,receive:null,remark:"",palletId:"",palletName:""}},initDictData:function(){var t=this;Object(l["f"])(this.dictCode,null).then((function(e){e.success&&e.result&&e.result.map((function(e){t.palletList=t.palletList.concat({label:e.text,value:e.value})}))}))},changeLine:function(t){this.dictTrainStr=t?"bu_train_info,train_no,train_no,line_id="+t:""},showUserModal:function(){this.$refs.userSelectModal.showModal()},onUserSelect:function(t){var e=this;t&&t.length>0&&(this.$nextTick((function(){e.form.setFieldsValue({userName:t[0].realname})})),this.model.userId=t[0].id)},showOrderModal:function(){this.$refs.orderSelectModal.showModal()},onOrderSelect:function(t){var e=this;t&&t.length>0&&(this.model.workOrderId=t[0].id,this.$nextTick((function(){t[0].lineId&&(e.dictTrainStr="bu_train_info,train_no,train_no,line_id="+t[0].lineId),e.form.setFieldsValue({workOrderName:t[0].orderName,lineId:t[0].lineId,trainNo:t[0].trainNo})})))},onGroupChange:function(t,e){e.extFields&&e.extFields.workshop_id&&(this.model.workshopId=e.extFields.workshop_id,this.model.depotId=window._CONFIG["depotId"])}}},p=m,h=a("2877"),b=Object(h["a"])(p,r,i,!1,null,null,null);e["default"]=b.exports},"51c5":function(t,e,a){"use strict";a("e9d9")},"537c":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:"领用确认",width:"80%",bodyStyle:{height:"70vh"},visible:t.visible,confirmLoading:t.confirmLoading,closable:!0,forceRender:!0,destroyOnClose:!0},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("a-spin",{attrs:{spinning:t.confirmLoading}},[e("ApplyConfirmComponent",{ref:"applyReady",on:{ok:t.saveOk,fail:t.saveFail,close:t.close}})],1)],1)},i=[],n=a("f6d0"),o={name:"ApplyConfirmModal",components:{ApplyConfirmComponent:n["default"]},data:function(){return{visible:!1,confirmLoading:!1}},methods:{showModal:function(t){this.visible=!0,this.$refs.applyReady.edit(t)},handleOk:function(){this.confirmLoading=!0,this.$refs.applyReady.save()},saveOk:function(){this.$emit("ok"),this.$message.success("保存成功"),this.close()},saveFail:function(){this.confirmLoading=!1},handleCancel:function(){this.close()},close:function(){this.confirmLoading=!1,this.$emit("close"),this.visible=!1}}},l=o,s=a("2877"),c=Object(s["a"])(l,r,i,!1,null,null,null);e["default"]=c.exports},"607e":function(t,e,a){"use strict";a("c95b")},"673e":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{width:"80%",title:"工单选择",visible:t.visible,confirmLoading:t.confirmLoading,cancelText:"关闭",centered:"",bodyStyle:{height:"70vh"}},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.findList.apply(null,arguments)}}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:7,sm:24}},[e("a-form-item",{attrs:{label:"工单搜索"}},[e("a-input",{attrs:{placeholder:"请输入工单名称或编码"},model:{value:t.queryParam.searchText,callback:function(e){t.$set(t.queryParam,"searchText",e)},expression:"queryParam.searchText"}})],1)],1),e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"工单类型"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择工单类型",dictCode:"bu_order_type"},model:{value:t.queryParam.orderType,callback:function(e){t.$set(t.queryParam,"orderType",e)},expression:"queryParam.orderType"}})],1)],1),e("a-col",{attrs:{md:9,sm:24}},[e("a-form-item",{attrs:{label:"工单状态"}},[e("div",{staticClass:"autoWidth"},[e("j-multi-select-tag",{attrs:{placeholder:"请选择工单状态",dictCode:"bu_order_status"},model:{value:t.queryParam.status,callback:function(e){t.$set(t.queryParam,"status",e)},expression:"queryParam.status"}})],1)])],1),e("a-col",{attrs:{md:3,sm:24}},[e("a-form-item",[e("a-button",{attrs:{type:"primary"},on:{click:t.findList}},[t._v("查询")])],1)],1)],1)],1)],1),e("div",{staticStyle:{height:"calc(70vh - 172px)"}},[e("vxe-table",{ref:"listTable",staticStyle:{height:"calc(70vh - 172px)"},attrs:{border:"",align:t.allAlign,data:t.tableData,"max-height":"100%","show-overflow":"tooltip","radio-config":t.multiple?{}:{trigger:"row",checkMethod:t.checkRadioMethod},"checkbox-config":t.multiple?{trigger:"row",highlight:!0,range:!0,checkMethod:t.checkRadioMethod}:{},"edit-config":{trigger:"manual",mode:"row"}}},[t.multiple?e("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):e("vxe-table-column",{attrs:{type:"radio",width:"40"}}),e("vxe-table-column",{attrs:{field:"trainNo",title:"作业车号",width:"100"}}),e("vxe-table-column",{attrs:{field:"groupName",title:"所属班组",width:"100"}}),e("vxe-table-column",{attrs:{field:"orderCode",title:"工单编号",width:"150"}}),e("vxe-table-column",{attrs:{field:"orderName",title:"工单名称",align:"left","min-width":"150"}}),e("vxe-table-column",{attrs:{field:"startTime",title:"计划开始",width:"150"}}),e("vxe-table-column",{attrs:{field:"finishTime",title:"计划结束",width:"150"}}),e("vxe-table-column",{attrs:{field:"orderStatus_dictText",title:"工单状态",width:"150"}}),e("vxe-table-column",{attrs:{field:"orderType_dictText",title:"工单类型",width:"150"}})],1),e("vxe-pager",{attrs:{perfect:"","current-page":t.queryParam.pageNo,"page-size":t.queryParam.pageSize,total:t.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:current-page":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:pageSize":function(e){return t.$set(t.queryParam,"pageSize",e)},"update:page-size":function(e){return t.$set(t.queryParam,"pageSize",e)},"page-change":t.handlePageChange}})],1)])},i=[],n=a("f680"),o=a("b9c3"),l=a("c1df"),s=a.n(l),c={name:"WorkOrderSelect",components:{JMultiSelectTag:n["default"]},props:{multiple:{type:Boolean,default:!1},workGroupId:{type:String,default:""},planId:{type:String,default:""},orderType:{type:Number,default:null},orderStatus:{type:Array,default:function(){return[3,4,8]}},selectStatus:{type:Array,default:function(){return[]}}},data:function(){return{dateRange:[s()(new Date,"YYYY-MM-DD"),s()(new Date,"YYYY-MM-DD")],queryParam:{searchText:"",startDate:"",endDate:"",orderType:"",status:this.orderStatus.join(","),pageNo:1,pageSize:10,workGroupId:this.workGroupId,planId:this.planId},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,stationData:[]}},methods:{checkRadioMethod:function(t){var e=t.row;return!(this.selectStatus&&this.selectStatus.length>0)||this.selectStatus.indexOf(e.orderStatus)>-1},onDateChange:function(){this.dateRange[0]?this.queryParam.startDate=this.dateRange[0].format("YYYY-MM-DD"):this.queryParam.startDate=null,this.dateRange[1]?this.queryParam.endDate=this.dateRange[1].format("YYYY-MM-DD"):this.queryParam.endDate=null},showModal:function(){this.visible=!0,this.queryParam.planId=this.planId,this.queryParam.workGroupId=this.workGroupId,this.queryParam.orderType=this.orderType,this.findList()},findList:function(){var t=this;this.loading=!0,Object(o["T"])(this.queryParam).then((function(e){t.totalResult=e.result.total,t.loading=!1,t.tableData=e.result.records}))},handlePageChange:function(t){var e=t.currentPage,a=t.pageSize;this.queryParam.pageNo=e,this.queryParam.pageSize=a,this.findList()},handleOk:function(){var t=[];this.multiple?t=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&t.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",t),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},u=c,d=(a("607e"),a("2877")),f=Object(d["a"])(u,r,i,!1,null,null,null);e["default"]=f.exports},"8aa8":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:4,sm:12}},[e("a-form-item",{attrs:{label:"物资"}},[e("a-input",{attrs:{placeholder:"物资编码或者名称",allowClear:""},model:{value:t.queryParam.materialType,callback:function(e){t.$set(t.queryParam,"materialType",e)},expression:"queryParam.materialType"}})],1)],1),e("a-col",{attrs:{md:4,sm:12}},[e("a-form-item",{attrs:{label:"领料单"}},[e("a-input",{attrs:{placeholder:"领料单编码或者名称",allowClear:""},model:{value:t.queryParam.applyOrder,callback:function(e){t.$set(t.queryParam,"applyOrder",e)},expression:"queryParam.applyOrder"}})],1)],1),e("a-col",{attrs:{md:4,sm:12}},[e("a-form-item",{attrs:{label:"领用人"}},[e("a-input",{attrs:{placeholder:"人员或者工班",allowClear:""},model:{value:t.queryParam.receiver,callback:function(e){t.$set(t.queryParam,"receiver",e)},expression:"queryParam.receiver"}})],1)],1),t.toggleSearchStatus?[e("a-col",{attrs:{md:4,sm:12}},[e("a-form-item",{attrs:{label:"领用日期"}},[e("a-date-picker",{attrs:{format:"YYYY-MM-DD"},model:{value:t.queryParam.receiveTime,callback:function(e){t.$set(t.queryParam,"receiveTime",e)},expression:"queryParam.receiveTime"}})],1)],1),e("a-col",{attrs:{md:4,sm:12}},[e("a-form-item",{attrs:{label:"领料状态"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_material_apply_status"},model:{value:t.queryParam.status,callback:function(e){t.$set(t.queryParam,"status",e)},expression:"queryParam.status"}})],1)],1),e("a-col",{attrs:{md:4,sm:12}},[e("a-form-item",{attrs:{label:"备料状态"}},[e("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_material_apply_ready_status"},model:{value:t.queryParam.readyStatus,callback:function(e){t.$set(t.queryParam,"readyStatus",e)},expression:"queryParam.readyStatus"}})],1)],1)]:t._e(),e("a-col",{attrs:{md:8,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[e("a-button",{on:{click:t.findList}},[t._v("查询")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("新增")]),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.deleteRecord}},[t._v("删除")]),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.handlerReadyMaterial}},[t._v("备料确认")]),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.handleConfirmMaterial}},[t._v("领料确认")]),e("a",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return e.stopPropagation(),t.handleToggleSearch.apply(null,arguments)}}},[t._v(" "+t._s(t.toggleSearchStatus?"收起":"展开")+" "),e("a-icon",{attrs:{type:t.toggleSearchStatus?"up":"down"}})],1)],1)])],2)],1)],1),e("div",{staticStyle:{height:"calc(100vh - 225px)"}},[e("vxe-table",{ref:"listTable",staticStyle:{height:"calc(100vh - 225px)"},attrs:{border:"","max-height":"100%",align:t.allAlign,data:t.tableData,"show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{trigger:"manual",mode:"row"}}},[e("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),e("vxe-table-column",{attrs:{field:"code",title:"领料单编码",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){var r=a.row;return[e("a",{on:{click:function(e){return e.stopPropagation(),t.applyDetail(r)}}},[t._v(t._s(r.code))])]}}])}),e("vxe-table-column",{attrs:{field:"title",title:"领料单名称","min-width":"200","header-align":"center",align:"left"}}),e("vxe-table-column",{attrs:{field:"confirmTime",title:"备料日期",width:"100"}}),e("vxe-table-column",{attrs:{field:"readyStatus_dictText",title:"备料状态",width:"100"}}),e("vxe-table-column",{attrs:{field:"status_dictText",title:"领料状态",width:"100"}}),e("vxe-table-column",{attrs:{field:"deptName",title:"申请工班",width:"180","header-align":"center",align:"left"}}),e("vxe-table-column",{attrs:{field:"userName",title:"申请人",width:"100","header-align":"center",align:"left"}}),e("vxe-table-column",{attrs:{field:"receiveTime",title:"领用日期",width:"100"}}),e("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"150","header-align":"center",align:"left"}}),e("vxe-table-column",{attrs:{title:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){var r=a.row;return[e("a",{on:{click:function(e){return e.stopPropagation(),t.handleEdit(r)}}},[t._v("编辑")])]}}])})],1),e("vxe-pager",{attrs:{perfect:"","current-page":t.queryParam.pageNo,"page-size":t.queryParam.pageSize,total:t.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:current-page":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:pageSize":function(e){return t.$set(t.queryParam,"pageSize",e)},"update:page-size":function(e){return t.$set(t.queryParam,"pageSize",e)},"page-change":t.handlePageChange}})],1),e("apply-item-modal",{ref:"modalForm",on:{ok:function(e){return t.loadData()}}}),e("apply-detail",{ref:"materialDetail"}),e("apply-ready-modal",{ref:"readyMaterial",on:{ok:t.loadData}}),e("apply-confirm-modal",{ref:"confirmMaterial",on:{ok:t.loadData}})],1)},i=[],n=a("c54ca"),o=a("49c2"),l=a("8b15"),s=a("389d"),c=a("537c"),u={name:"Apply",components:{ApplyItemModal:o["default"],ApplyDetail:l["default"],ApplyReadyModal:s["default"],ApplyConfirmModal:c["default"]},data:function(){return{toggleSearchStatus:!1,queryParam:{materialType:"",applyOrder:null,receiver:"",receiveTime:null,status:null,readyStatus:null,pageNo:1,pageSize:10},totalResult:0,allAlign:"center",tableData:[],showEdit:!1}},created:function(){this.findList()},watch:{value:{immediate:!0,handler:function(t){this.queryParam.parentId=t,this.tableData=[],this.findList()}}},methods:{findList:function(){var t=this;Object(n["Y"])(this.queryParam).then((function(e){e.success?(t.totalResult=e.result.total,t.loading=!1,t.tableData=e.result.records):t.$message.error("查询数据失败")}))},handlePageChange:function(t){var e=t.currentPage,a=t.pageSize;this.queryParam.pageNo=e,this.queryParam.pageSize=a,this.findList()},loadData:function(){this.findList(),this.$emit("load")},handleAdd:function(){this.$refs.modalForm.add(),this.$refs.modalForm.title="新增"},handleEdit:function(t){this.$refs.modalForm.edit(t),this.$refs.modalForm.title="编辑"},deleteRecord:function(){var t=this,e=this.$refs.listTable.getCheckboxRecords();e.length>0?this.$confirm({content:"是否删除选中".concat(e.length,"数据？"),onOk:function(){var a=e.map((function(t,e){return t.id})).join(",");Object(n["q"])("ids="+a).then((function(e){t.findList(),t.$message.success(e.message)}))}}):this.$message.error("尚未选中任何数据!")},applyDetail:function(t){this.$refs.materialDetail.detail(t.id)},handlerReadyMaterial:function(){var t=this.$refs.listTable.getCheckboxRecords();t.length>0?t.length>1?this.$message.error("只能选中一条数据!"):this.$refs.readyMaterial.showModal(t[0].id):this.$message.error("尚未选中任何数据!")},handleConfirmMaterial:function(){var t=this.$refs.listTable.getCheckboxRecords();t.length>0?t.length>1?this.$message.error("只能选中一条数据!"):this.$refs.confirmMaterial.showModal(t[0].id):this.$message.error("尚未选中任何数据!")},handleToggleSearch:function(){this.toggleSearchStatus=!this.toggleSearchStatus}}},d=u,f=a("2877"),m=Object(f["a"])(d,r,i,!1,null,null,null);e["default"]=m.exports},"8b15":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:"领用物资明细",width:"80%",bodyStyle:{height:"70vh"},visible:t.visible,spinning:t.confirmLoading,closable:!0,destroyOnClose:!0,footer:null},on:{cancel:t.handleCancel}},[e("a-spin",{attrs:{spinning:t.confirmLoading}},[e("vxe-table",{ref:"listTable",attrs:{border:"",align:t.allAlign,data:t.tableData,"show-overflow":"ellipsis"}},[e("vxe-table-column",{attrs:{field:"materialTypeCode",title:"物资编码",width:"150"}}),e("vxe-table-column",{attrs:{field:"materialTypeName",title:"物资名称",width:"180",align:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeSpec",title:"规格型号","min-width":"180",align:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeUnit",title:"单位",width:"100"}}),e("vxe-table-column",{attrs:{field:"amount",title:"领用数量",width:"100",align:"right"}}),e("vxe-table-column",{attrs:{field:"receive",title:"发料数量",width:"100",align:"right"}}),e("vxe-table-column",{attrs:{field:"warehouseName",title:"库位",width:"120"}}),e("vxe-table-column",{attrs:{field:"palletName",title:"存放托盘",width:"150"}}),e("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"150"}})],1)],1)],1)},i=[],n=a("c54ca"),o={name:"ApplyDetail",data:function(){return{confirmLoading:!1,tableData:[],allAlign:"center",visible:!1,queryParam:{applyId:""}}},created:function(){},methods:{detail:function(t){this.visible=!0,this.queryParam.applyId=t,this.findList()},findList:function(){var t=this;this.confirmLoading=!0,Object(n["X"])(this.queryParam).then((function(e){t.confirmLoading=!1,t.tableData=e.result}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},l=o,s=a("2877"),c=Object(s["a"])(l,r,i,!1,null,null,null);e["default"]=c.exports},9527:function(t,e,a){},b245:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{width:"85%",title:"人员选择",visible:t.visible,confirmLoading:t.confirmLoading,cancelText:"关闭",bodyStyle:{height:"70vh"},destroyOnClose:!0},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("a-row",[e("a-col",{attrs:{md:4,sm:24}},[e("div",{staticStyle:{height:"calc(70vh - 20px)","border-right":"1px solid #e3e1e1","margin-right":"15px"}},[t.treeData&&t.treeData.length>0?e("a-tree",{staticClass:"limitHeight",attrs:{defaultSelectedKeys:[t.queryParam.depId],defaultExpandAll:!0,"tree-data":t.treeData},on:{select:t.onSelect}}):t._e()],1)]),e("a-col",{attrs:{md:20,sm:24}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.findList.apply(null,arguments)}}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"账号"}},[e("a-input",{attrs:{placeholder:"请输入用户账号"},model:{value:t.queryParam.username,callback:function(e){t.$set(t.queryParam,"username",e)},expression:"queryParam.username"}})],1)],1),e("a-col",{attrs:{md:5,sm:24}},[e("a-form-item",{attrs:{label:"真实名字"}},[e("a-input",{attrs:{placeholder:"请输入真实名字"},model:{value:t.queryParam.realname,callback:function(e){t.$set(t.queryParam,"realname",e)},expression:"queryParam.realname"}})],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"手机号码"}},[e("a-input",{attrs:{placeholder:"请输入手机号码"},model:{value:t.queryParam.phone,callback:function(e){t.$set(t.queryParam,"phone",e)},expression:"queryParam.phone"}})],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"角色"}},[e("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"sys_role,role_name,id",placeholder:"选择角色"},model:{value:t.queryParam.roleId,callback:function(e){t.$set(t.queryParam,"roleId",e)},expression:"queryParam.roleId"}})],1)],1),e("a-col",{attrs:{md:2,sm:8}},[e("a-button",{on:{click:t.findList}},[t._v("查询")])],1)],1)],1)],1),e("div",{staticStyle:{height:"calc(70vh - 130px)"}},[e("vxe-table",{ref:"listTable",staticStyle:{height:"calc(70vh - 130px)"},attrs:{border:"",align:t.allAlign,data:t.tableData,"max-height":"100%","show-overflow":"tooltip","radio-config":t.multiple?{}:{trigger:"row"},"checkbox-config":t.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"manual",mode:"row"}}},[t.multiple?e("vxe-table-column",{attrs:{type:"checkbox",width:"5%"}}):e("vxe-table-column",{attrs:{type:"radio",width:"5%"}}),e("vxe-table-column",{attrs:{field:"workNo",title:"工号",width:"100",align:"center"}}),e("vxe-table-column",{attrs:{field:"username",title:"用户账号",width:"150",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{field:"realname",title:"用户名字",width:"100",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{field:"roleNames",title:"角色","min-width":"180",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{field:"sex_dictText",title:"性别",width:"80"}}),e("vxe-table-column",{attrs:{field:"phone",title:"手机号码",width:"120"}}),e("vxe-table-column",{attrs:{field:"orgCode",title:"部门",width:"120",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"80"}})],1),e("vxe-pager",{attrs:{perfect:"","current-page":t.queryParam.pageNo,"page-size":t.queryParam.pageSize,total:t.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:current-page":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:pageSize":function(e){return t.$set(t.queryParam,"pageSize",e)},"update:page-size":function(e){return t.$set(t.queryParam,"pageSize",e)},"page-change":t.handlePageChange}})],1)])],1)],1)},i=[],n=a("8fad"),o={name:"UserList",props:{multiple:{type:Boolean,default:!0},depId:{type:String,default:""}},data:function(){return{queryParam:{username:"",realname:"",phone:"",orgCode:"",roleId:void 0,pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,treeData:[]}},watch:{depId:function(t){this.$set(this.queryParam,"depId",t||"")}},mounted:function(){this.$set(this.queryParam,"depId",this.depId||"")},methods:{showModal:function(){this.visible=!0,this.findList(),this.getTreeList()},getTreeList:function(){var t=this;Object(n["mb"])().then((function(e){e.success&&(t.treeData=e.result)}))},onSelect:function(t,e){if(t.length){var a=e.node.dataRef;this.queryParam.depId=a.id,this.findList()}else this.queryParam.orgCode="",this.findList()},findList:function(){var t=this;this.loading=!0,Object(n["gc"])(this.queryParam).then((function(e){t.loading=!1,e.success?(t.totalResult=e.result.total,t.tableData=e.result.records):t.$message.error("加载用户数据失败")})).catch((function(e){t.$message.error("加载用户数据异常")})).finally((function(){}))},handlePageChange:function(t){var e=t.currentPage,a=t.pageSize;this.queryParam.pageNo=e,this.queryParam.pageSize=a,this.findList()},handleOk:function(){var t=[];this.multiple?t=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&t.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",t),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,Object.assign(this.$data,this.$options.data())}}},l=o,s=(a("f76d"),a("2877")),c=Object(s["a"])(l,r,i,!1,null,"4aa7956f",null);e["default"]=c.exports},b9c3:function(t,e,a){"use strict";a.d(e,"lb",(function(){return o})),a.d(e,"f",(function(){return l})),a.d(e,"i",(function(){return s})),a.d(e,"v",(function(){return c})),a.d(e,"b",(function(){return f})),a.d(e,"l",(function(){return m})),a.d(e,"p",(function(){return p})),a.d(e,"G",(function(){return h})),a.d(e,"c",(function(){return d})),a.d(e,"B",(function(){return g})),a.d(e,"k",(function(){return y})),a.d(e,"A",(function(){return v})),a.d(e,"x",(function(){return w})),a.d(e,"g",(function(){return k})),a.d(e,"E",(function(){return x})),a.d(e,"C",(function(){return O})),a.d(e,"M",(function(){return S})),a.d(e,"kb",(function(){return N})),a.d(e,"O",(function(){return T})),a.d(e,"N",(function(){return P})),a.d(e,"jb",(function(){return j})),a.d(e,"t",(function(){return L})),a.d(e,"d",(function(){return _})),a.d(e,"W",(function(){return R})),a.d(e,"X",(function(){return I})),a.d(e,"e",(function(){return q})),a.d(e,"o",(function(){return A})),a.d(e,"V",(function(){return G})),a.d(e,"R",(function(){return F})),a.d(e,"Q",(function(){return z})),a.d(e,"K",(function(){return B})),a.d(e,"L",(function(){return V})),a.d(e,"fb",(function(){return gt})),a.d(e,"bb",(function(){return W})),a.d(e,"Y",(function(){return H})),a.d(e,"J",(function(){return Q})),a.d(e,"hb",(function(){return nt})),a.d(e,"U",(function(){return ot})),a.d(e,"eb",(function(){return X})),a.d(e,"cb",(function(){return Z})),a.d(e,"a",(function(){return tt})),a.d(e,"j",(function(){return ut})),a.d(e,"nb",(function(){return dt})),a.d(e,"gb",(function(){return ft})),a.d(e,"m",(function(){return mt})),a.d(e,"H",(function(){return vt})),a.d(e,"T",(function(){return J})),a.d(e,"S",(function(){return M})),a.d(e,"mb",(function(){return E})),a.d(e,"z",(function(){return pt})),a.d(e,"db",(function(){return ht})),a.d(e,"y",(function(){return bt})),a.d(e,"u",(function(){return u})),a.d(e,"F",(function(){return b})),a.d(e,"ob",(function(){return $})),a.d(e,"q",(function(){return C})),a.d(e,"D",(function(){return D})),a.d(e,"ib",(function(){return et})),a.d(e,"n",(function(){return at})),a.d(e,"I",(function(){return K})),a.d(e,"P",(function(){return Y})),a.d(e,"s",(function(){return lt})),a.d(e,"Z",(function(){return st})),a.d(e,"ab",(function(){return ct})),a.d(e,"h",(function(){return rt})),a.d(e,"w",(function(){return it})),a.d(e,"r",(function(){return U}));var r=a("0fea"),i=a("4328"),n=a.n(i),o=function(t){return Object(r["j"])("/group/fault/info/submit",t)},l=function(t){return Object(r["j"])("/group/fault/info/cancel",t)},s=function(t){return Object(r["j"])("/group/fault/info/delete",t)},c=function(t){return Object(r["d"])("/group/fault/info/page",t)},u=function(t){return Object(r["d"])("/group/fault/info/get",t)},d=function(t){return Object(r["j"])("/group/safeassume/read/add",t)},f=function(t){return Object(r["j"])("/group/safeassume/add",t)},m=function(t){return Object(r["j"])("/group/safeassume/delete",t)},p=function(t){return Object(r["j"])("/group/safeassume/edit",t)},h=function(t){return Object(r["d"])("/group/safeassume/page",t)},b=function(t){return Object(r["d"])("/group/safeassume/get",t)},g=function(t){return Object(r["d"])("/group/turnoverchange/page",t)},v=function(t){return Object(r["d"])("/material/spare-part/get",t)},y=function(t){return Object(r["j"])("/group/turnoverchange/delete",t)},w=function(t){return Object(r["d"])("/group/measurealert/page",t)},k=function(t){return Object(r["j"])("/group/measurealert/close",t)},x=function(t){return Object(r["d"])("/group/spare-part/page",t)},O=function(t){return Object(r["d"])("/group/spare-part/get",t)},D=function(t){return Object(r["d"])("/produce/train/history/asset/use/page",t)},S=function(t){return Object(r["d"])("/group/toolequipment/page",t)},N=function(t){return Object(r["j"])("/group/toolequipment/setStatus",t)},C=function(t){return Object(r["d"])("/group/toolequipment/usage",t)},T=function(t){return Object(r["d"])("/group/tool/page",t)},P=function(t){return Object(r["d"])("/group/tool/get",t)},j=function(t){return Object(r["j"])("/group/tool/setDutyUser",t)},$=function(t){return Object(r["d"])("/group/tool/usage",t)},L=function(t){return Object(r["d"])("/group/information/basic",t)},_=function(t){return Object(r["j"])("/group/information/tools/add",t)},R=function(t){return Object(r["d"])("/group/information/workstation/page-related",t)},I=function(t){return Object(r["d"])("/group/information/workstation/page-unrelated",t)},q=function(t){return Object(r["j"])("/group/information/workstation/add",t)},A=function(t){return Object(r["j"])("/group/information/workstation/delete",t)},M=function(t){return Object(r["d"])("/workGroup/workOrder/relevanceInfo/".concat(t))},E=function(t){return Object(r["j"])("/workGroup/workOrder/submit-to-dispatcher",n.a.stringify(t))},G=function(t){return Object(r["d"])("/workGroup/workRecord/list",t)},z=function(t){return Object(r["d"])("/serialPlan/plan/forms/online-form/get",t)},F=function(t){return Object(r["d"])("/serialPlan/plan/forms/work-record/get",t)},Y=function(t){return Object(r["d"])("/serialPlan/plan/forms/check-record/get",t)},J=function(t){return Object(r["d"])("/workGroup/workOrder/page",t)},U=function(t){return Object(r["d"])("/workGroup/workOrder/apply/page",t)},B=function(t){return Object(r["d"])("/workGroup/workRecord/recordForm",t)},V=function(t){return Object(r["d"])("/workGroup/workRecord/relevanceInfo/".concat(t))},K=function(t){return Object(r["d"])("/workGroup/workRecord/relevanceInfo/bookSteps/".concat(t))},W=function(t){return Object(r["j"])("/workGroup/workRecord/save/form-result",t)},H=function(t){return Object(r["j"])("/workGroup/workRecord/check",t)},Q=function(t){return Object(r["j"])("/workGroup/workRecord/getTaskQRCode",t)},X=function(t){return Object(r["j"])("/workGroup/workRecord/work-record/save-manufNo",n.a.stringify(t))},Z=function(t){return Object(r["j"])("/workGroup/workRecord/save/material",t)},tt=function(t){return Object(r["j"])("/workGroup/workRecord/save/actMaterial",t)},et=function(t){return Object(r["j"])("/workGroup/workRecord/save/work-time",t)},at=function(t){return Object(r["j"])("/workGroup/workRecord/arrange/delete",t)},rt=function(t){return Object(r["j"])("/workGroup/workOrder/material/commit-temp-apply",t)},it=function(t){return Object(r["d"])("/workGroup/workOrder/material/apply/list",t)},nt=function(t){return Object(r["j"])("/workGroup/workRecord/check/saveExcelData",t)},ot=function(t){return Object(r["d"])("/workGroup/workRecord/get/excelData/".concat(t))},lt=function(t){return Object(r["d"])("/serialPlan/plan/forms/check-record/item/list",t)},st=function(t){return Object(r["j"])("/workGroup/workRecord/check-record/set-check",t)},ct=function(t){return Object(r["j"])("/workGroup/workRecord/check-record/set-time",t)},ut=function(t){return Object(r["j"])("/workGroup/workRecord/delete/material",n.a.stringify(t))},dt=function(t){return Object(r["j"])("/workGroup/workRecord/submit-task",t)},ft=function(t){return Object(r["j"])("/workGroup/workRecord/save/tool",t)},mt=function(t){return Object(r["j"])("/workGroup/workRecord/delete/tool",n.a.stringify(t))},pt=function(t){return Object(r["d"])("/workGroup/workRecord/outsourceOutin",t)},ht=function(t){return Object(r["j"])("/workGroup/workRecord/save/outsourceOutin",t)},bt=function(t){return Object(r["d"])("/workGroup/workRecord/outin/not-returns",t)},gt=function(t){return Object(r["j"])("/group/safeassume/read/add",n.a.stringify(t))},vt=function(t){return Object(r["d"])("/serialPlan/plan/page",t)}},c95b:function(t,e,a){},e9d9:function(t,e,a){},f680:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return"checkbox"==t.tagType?e("a-checkbox-group",{attrs:{value:t.arrayValue,disabled:t.disabled},on:{change:t.onChange}},t._l(t.dictOptions,(function(a,r){return e("a-checkbox",{key:r,attrs:{value:a.value}},[t._v(t._s(a.text||a.label))])})),1):"select"==t.tagType?e("a-select",{attrs:{value:t.arrayValue,disabled:t.disabled,mode:"multiple",placeholder:t.placeholder,getPopupContainer:function(t){return t.parentNode},allowClear:""},on:{change:t.onChange}},t._l(t.dictOptions,(function(a,r){return e("a-select-option",{key:r,attrs:{value:a.value}},[e("span",{staticStyle:{display:"inline-block",width:"100%"},attrs:{title:a.text||a.label}},[t._v(" "+t._s(a.text||a.label)+" ")])])})),1):t._e()},i=[],n=a("4ec3");function o(t){return u(t)||c(t)||s(t)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t,e){if(t){if("string"==typeof t)return d(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?d(t,e):void 0}}function c(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function u(t){if(Array.isArray(t))return d(t)}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=Array(e);a<e;a++)r[a]=t[a];return r}var f={name:"JMultiSelectTag",props:{dictCode:String,placeholder:String,disabled:Boolean,value:String,type:String,options:Array},data:function(){return{dictOptions:[],tagType:"",arrayValue:this.value?this.value.split(","):[]}},created:function(){this.type&&"list_multi"!==this.type?this.tagType=this.type:this.tagType="select"},watch:{options:function(t){this.setCurrentDictOptions(t)},dictCode:{immediate:!0,handler:function(){this.initDictData()}},value:function(t){this.arrayValue=t?this.value.split(","):[]}},methods:{initDictData:function(){var t=this;if(this.options&&this.options.length>0)this.dictOptions=o(this.options);else{if(Object(n["u"])(this.dictCode))return void(this.dictOptions=Object(n["u"])(this.dictCode));Object(n["f"])(this.dictCode,null).then((function(e){e.success&&(t.dictOptions=e.result)}))}},onChange:function(t){this.$emit("change",t.join(","))},setCurrentDictOptions:function(t){this.dictOptions=t},getCurrentDictOptions:function(){return this.dictOptions}},model:{prop:"value",event:"change"}},m=f,p=a("2877"),h=Object(p["a"])(m,r,i,!1,null,null,null);e["default"]=h.exports},f6d0:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",[t.fromFlow?t._e():e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:12,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden","margin-bottom":"8px"}},[e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.save}},[t._v("确认领用")]),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.close}},[t._v("关闭")])],1)])],1),e("div",{staticStyle:{height:"calc(70vh - 45px)"}},[e("vxe-table",{ref:"listTable",attrs:{border:"","max-height":"100%",align:t.allAlign,data:t.tableData,"show-overflow":"tooltip","edit-config":{trigger:"click",mode:"row"},"checkbox-config":{highlight:!0,range:!0}}},[e("vxe-table-column",{attrs:{type:"seq",width:"40",fixed:"left"}}),e("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeCode",title:"物资编码",width:"150"}}),e("vxe-table-column",{attrs:{field:"materialTypeName",title:"物资名称","min-width":"180","header-align":"center",align:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeSpec",title:"规格型号","min-width":"180","header-align":"center",align:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeUnit",title:"单位",width:"100"}}),e("vxe-table-column",{attrs:{field:"useCategory_dictText",title:"类别",width:"100"}}),e("vxe-table-column",{attrs:{field:"amount",title:"申请数量",width:"100"}}),e("vxe-table-column",{attrs:{field:"receive",title:"发料数量",width:"100"}}),e("vxe-table-column",{attrs:{field:"sourceLocationAndPalletName",title:"发放信息",width:"380","sort-type":"string",sortable:""}}),e("vxe-table-column",{attrs:{field:"status_dictText",title:"确认状态",width:"100"}}),e("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"150","header-align":"center",align:"left"}})],1)],1),e("ApplyDistributionModal",{ref:"distributionModal",attrs:{dataList:t.distributionTableList},on:{ok:t.onSuccess}})],1)},i=[],n=a("c54ca"),o=a("2eb4"),l=a("8973");function s(t){return f(t)||d(t)||u(t)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(t,e){if(t){if("string"==typeof t)return m(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?m(t,e):void 0}}function d(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function f(t){if(Array.isArray(t))return m(t)}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=Array(e);a<e;a++)r[a]=t[a];return r}var p={name:"ApplyConfirmComponent",components:{ApplyDistributionModal:o["default"]},props:{businessKey:{type:String,default:null},isReadonly:{type:Boolean,default:!0},fromFlow:{type:Boolean,default:!1},orderType:{type:Number,default:null}},data:function(){return{tableData:[],palletList:[],distributionTableList:[],model:{},allAlign:"center",dictCode:"bu_material_pallet,name,id,status=1",queryParam:{orderId:"",status:[1]}}},mounted:function(){this.businessKey&&this.edit(this.businessKey)},methods:{edit:function(t){this.queryParam.orderId=t,this.findList()},findList:function(){var t=this;this.tableData=[],Object(n["bb"])(this.queryParam).then((function(e){e.success?(t.tableData=[].concat(s(t.tableData),s(e.result)),l["a"].joinDistributionInfo(t.tableData)):t.$message.error("加载数据失败"),t.$emit("loaded")}))},save:function(t){var e=this;if(this.tableData&&this.tableData.length>0){var a=this.tableData.map((function(t,e){return t.id}));if(0===a.length)return this.$message.warn("没有要确认领料的物资，无法继续！"),void this.$emit("fail",{message:"没有要确认领料的物资，无法继续！"});var r={fromType:2,ids:a.join(",")};Object(n["j"])(r).then((function(t){t.success?e.$emit("ok"):e.$emit("fail",t)})).catch((function(t){e.$message.error("保存异常"),e.$emit("fail",{message:"保存异常！"})}))}else this.$emit("ok")},close:function(){this.$emit("close")},openDistribution:function(t){this.$refs.distributionModal.showModal(t)},onSuccess:function(){var t=this;this.tableData.forEach((function(e){e.receive=0,t.distributionTableList.forEach((function(t){t.applyDetailId===e.id&&(e.receive+=Number(t.amount))}))}))}}},h=p,b=a("2877"),g=Object(b["a"])(h,r,i,!1,null,"1c988508",null);e["default"]=g.exports},f76d:function(t,e,a){"use strict";a("9527")},ff09:function(t,e,a){"use strict";a.r(e);var r,i=function(){var t=this,e=t._self._c;return e("div",[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"right",overflow:"hidden","margin-bottom":"8px"}},[e("a-space",[t.isDistribution?t._e():e("a-button",{staticClass:"iconBtn",attrs:{loading:t.confirmLoading,disabled:t.records.length<1},on:{click:t.autoArrange}},[t._v("自动安排库位")]),t.isDistribution?t._e():e("a-button",{staticClass:"iconBtn",attrs:{loading:t.confirmLoading,disabled:t.records.length<1},on:{click:t.arrangePan}},[t._v("批量设置托盘")])],1)],1)])],1),t.isDistribution?t._e():e("div",{staticStyle:{height:"calc(70vh - 45px)"}},[e("vxe-table",{ref:"listTable",attrs:{border:"","max-height":"100%",align:t.allAlign,data:t.tableData,"show-overflow":"tooltip","edit-config":{trigger:"click",mode:"row"},"checkbox-config":{highlight:!0,trigger:"row",range:!0}},on:{"checkbox-change":t.checkboxChange,"checkbox-all":t.checkboxChange}},[e("vxe-table-column",{attrs:{type:"seq",fixed:"left",width:"40"}}),e("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeCode",title:"物资编码",width:"150"}}),e("vxe-table-column",{attrs:{field:"materialTypeName",title:"物资名称","min-width":"180",align:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeSpec",title:"规格型号","min-width":"180",align:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeUnit",title:"单位",width:"100"}}),e("vxe-table-column",{attrs:{field:"useCategory_dictText",title:"类别",width:"100"}}),e("vxe-table-column",{attrs:{field:"amount",title:"申请数量",width:"100"}}),e("vxe-table-column",{attrs:{field:"receive",title:"发料数量",width:"100"}}),e("vxe-table-column",{attrs:{field:"sourceLocationAndPalletName",title:"发放信息",width:"380","sort-type":"string",sortable:""}}),e("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"150","header-align":"center",align:"left"}}),e("vxe-table-column",{attrs:{title:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){var r=a.row;return[e("a",{on:{click:function(e){return e.stopPropagation(),t.openDistribution(r)}}},[t._v("发放管理")])]}}],null,!1,768125003)})],1)],1),t.isDistribution?e("div",{staticClass:"panel-main",staticStyle:{height:"calc(70vh - 45px)"}},[e("div",{staticClass:"panel-left"},[e("vxe-table",{ref:"materialTable",attrs:{border:"",height:"auto","keep-source":"",data:t.tableData,"radio-config":{highlight:!0,trigger:"row",range:!0,checkMethod:function(){return 0===t.curEditMode}}},on:{"radio-change":t.onRadioChange,"cell-click":t.onMaterialCellClick}},[e("vxe-table-column",{attrs:{type:"radio",width:"40",fixed:"left"}}),e("vxe-table-column",{attrs:{field:"materialTypeCode",width:"160",title:"物资编码"}}),e("vxe-table-column",{attrs:{field:"materialTypeName",title:"名称"}}),e("vxe-table-column",{attrs:{field:"materialTypeSpec",title:"规格"}}),e("vxe-table-column",{attrs:{field:"amount",title:"所需数量",width:"80"}}),e("vxe-table-column",{attrs:{field:"receive",title:"发料数量",width:"80"}})],1)],1),e("div",{staticClass:"panel-right"},[e("div",{staticClass:"ant-alert ant-alert-info",staticStyle:{"margin-bottom":"16px"}},[e("a-space",[e("a-button",{attrs:{type:"primary"},on:{click:t.addDetail}},[t._v("添加发放库位")]),e("a-button",{on:{click:t.closeDistribution}},[t._v("关闭")]),e("span",{staticStyle:{color:"red","margin-left":"15px"}},[t._v(t._s("总量: ".concat(t.selectInfo?t.selectInfo.amount:0,";")))]),e("span",{staticStyle:{color:"red","margin-left":"5px"}},[t._v(t._s("差额：".concat(t.calcAmount)))])],1)],1),e("div",{staticStyle:{height:"calc(100% - 62px)"}},[e("vxe-table",{ref:"distributionTable",attrs:{border:"",height:"auto","keep-source":"",data:t.tableDistributionData,"edit-rules":t.validRules,"edit-config":{trigger:"manual",mode:"row",autoClear:!1,showStatus:!0}}},[e("vxe-table-column",{attrs:{field:"sourceLocationName",title:"来源库位","edit-render":{name:"input"}},scopedSlots:t._u([{key:"edit",fn:function(a){var r=a.row;return[e("a-select",{ref:"locationSelect",staticStyle:{width:"100%"},attrs:{placeholder:"选择库位",open:!1},on:{dropdownVisibleChange:function(e){return t.openlocationModal(r)}},model:{value:r.sourceLocationName,callback:function(e){t.$set(r,"sourceLocationName",e)},expression:"row.sourceLocationName"}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)]}}],null,!1,325071706)}),e("vxe-table-column",{attrs:{field:"palletName",title:"存放托盘","edit-render":{name:"input"}},scopedSlots:t._u([{key:"edit",fn:function(a){var r=a.row;return[e("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择托盘",open:!1},on:{dropdownVisibleChange:function(e){return t.openPalletModal()}},model:{value:r.palletName,callback:function(e){t.$set(r,"palletName",e)},expression:"row.palletName"}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)]}}],null,!1,3015230497)}),e("vxe-table-column",{attrs:{field:"tradeNo",title:"所属批次",width:"270","edit-render":{name:"input"}},scopedSlots:t._u([{key:"edit",fn:function(a){var r=a.row;return[r.needChooseTradeNo?e("div",[e("a-select",{staticStyle:{width:"100%"},on:{change:function(e){return t.tradeNoCHange(r)}},model:{value:r.tradeNo,callback:function(e){t.$set(r,"tradeNo",e)},expression:"row.tradeNo"}},t._l(r.tradeNoChoiceList,(function(a,r){return e("a-select-option",{key:r,attrs:{value:a.tradeNo}},[t._v(" "+t._s(a.tradeNo)+"    "+t._s(a.price)+" ")])})),1)],1):e("div",[t._v(" "+t._s(r.tradeNo)+" ")])]}}],null,!1,2270284966)}),e("vxe-table-column",{attrs:{field:"amount",title:"发放数量",width:"120",align:"center","edit-render":{name:"$input",props:{type:"number",min:0}}}}),e("vxe-table-column",{attrs:{title:"操作",width:"120px",align:"center","show-overflow":!1},scopedSlots:t._u([{key:"default",fn:function(a){var r=a.row;return[r&&!t.$refs.distributionTable.isActiveByRow(r)?e("a-space",[e("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(e){return e.stopPropagation(),t.editRowEvent(r)}}},[t._v("编辑 ")]),e("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(e){return e.stopPropagation(),t.handleDel(r)}}},[t._v("删除")])],1):e("a-space",[e("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(e){return e.stopPropagation(),t.saveRowEvent(r)}}},[t._v("保存")]),e("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(e){return e.stopPropagation(),t.cancelRowEvent(r)}}},[t._v("取消")])],1)]}}],null,!1,743031837)})],1)],1)])]):t._e(),e("ApplyDistributionModal",{ref:"distributionModal",on:{ok:t.onSuccess}}),e("PalletList",{ref:"palletModal",attrs:{modeType:2},on:{ok:t.onSelectPallet}}),e("PalletList",{ref:"palletModal2",attrs:{modeType:2},on:{ok:t.onChoosePallet}}),e("LocationList",{ref:"locationModal",attrs:{modeType:2},on:{ok:t.onSelectLocation}})],1)},n=[],o=a("c54ca"),l=a("2eb4"),s=a("4ec3"),c=a("9f49"),u=a("13f1"),d=a("8973");function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function m(t,e,a){return(e=p(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function p(t){var e=h(t,"string");return"symbol"==f(e)?e:e+""}function h(t,e){if("object"!=f(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,e||"default");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function b(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function n(a,r,i,n){var s=r&&r.prototype instanceof l?r:l,c=Object.create(s.prototype);return g(c,"_invoke",function(a,r,i){var n,l,s,c=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(e,a){return n=e,l=0,s=t,f.n=a,o}};function m(a,r){for(l=a,s=r,e=0;!d&&c&&!i&&e<u.length;e++){var i,n=u[e],m=f.p,p=n[2];a>3?(i=p===r)&&(s=n[(l=n[4])?5:(l=3,3)],n[4]=n[5]=t):n[0]<=m&&((i=a<2&&m<n[1])?(l=0,f.v=r,f.n=n[1]):m<p&&(i=a<3||n[0]>r||r>p)&&(n[4]=a,n[5]=r,f.n=p,l=0))}if(i||a>1)return o;throw d=!0,r}return function(i,u,p){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),l=u,s=p;(e=l<2?t:s)||!d;){n||(l?l<3?(l>1&&(f.n=-1),m(l,s)):f.n=s:f.v=s);try{if(c=2,n){if(l||(i="next"),e=n[i]){if(!(e=e.call(n,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,l<2&&(l=0)}else 1===l&&(e=n.return)&&e.call(n),l<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),l=1);n=t}else if((e=(d=f.n<0)?s:a.call(r,f))!==o)break}catch(e){n=t,l=1,s=e}finally{c=1}}return{value:e,done:d}}}(a,i,n),!0),c}var o={};function l(){}function s(){}function c(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(g(e={},r,(function(){return this})),e),d=c.prototype=l.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,g(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=c,g(d,"constructor",c),g(c,"constructor",s),s.displayName="GeneratorFunction",g(c,i,"GeneratorFunction"),g(d),g(d,i,"Generator"),g(d,r,(function(){return this})),g(d,"toString",(function(){return"[object Generator]"})),(b=function(){return{w:n,m:f}})()}function g(t,e,a,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}g=function(t,e,a,r){function n(e,a){g(t,e,(function(t){return this._invoke(e,a,t)}))}e?i?i(t,e,{value:a,enumerable:!r,configurable:!r,writable:!r}):t[e]=a:(n("next",0),n("throw",1),n("return",2))},g(t,e,a,r)}function v(t,e,a,r,i,n,o){try{var l=t[n](o),s=l.value}catch(t){return void a(t)}l.done?e(s):Promise.resolve(s).then(r,i)}function y(t){return function(){var e=this,a=arguments;return new Promise((function(r,i){var n=t.apply(e,a);function o(t){v(n,r,i,o,l,"next",t)}function l(t){v(n,r,i,o,l,"throw",t)}o(void 0)}))}}function w(t){return D(t)||O(t)||x(t)||k()}function k(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(t,e){if(t){if("string"==typeof t)return S(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?S(t,e):void 0}}function O(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function D(t){if(Array.isArray(t))return S(t)}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=Array(e);a<e;a++)r[a]=t[a];return r}var N={name:"ApplyReadyComponent",components:{ApplyDistributionModal:l["default"],PalletList:c["default"],LocationList:u["default"]},props:{businessKey:{type:String,default:null},isReadonly:{type:Boolean,default:!1},fromFlow:{type:Boolean,default:!1},orderType:{type:Number,default:""}},data:function(){return{records:[],confirmLoading:!1,tableData:[],tableDistributionData:[],palletList:[],distributionTableList:[],model:{},allAlign:"center",dictCode:"bu_material_pallet,name,id,status=1",queryParam:{status:[0],orderId:""},curRow:null,isDistribution:!1,selectInfo:{},addParam:{amount:"",applyDetailId:"",id:"",locationName:"",locationWbs:"",sourceLocationName:"",materialTypeId:"",palletId:"",palletName:"",stockPrice:"",tradeNo:""},curEditMode:0,validRules:{sourceLocationName:[{required:!0,message:"请选择库位",trigger:"manual"}],tradeNo:[{required:!0,message:"批次号不能为空",trigger:"manual"}],amount:[{required:!0,message:"请输入数量",trigger:"manual"}]}}},computed:{hasActiveRow:function(){return!!this.$refs.distributionTable.getActiveRecord()},calcAmount:function(){return this.getAmount()}},mounted:function(){this.businessKey&&this.edit(this.businessKey)},methods:(r={tradeNoCHange:function(t){var e=t.tradeNoChoiceList.filter((function(e){return e.tradeNo==t.tradeNo}));t.price=e[0].price},checkboxChange:function(t){this.records=t.records},edit:function(t){this.initDictData(),this.queryParam.orderId=t,this.findList()},findList:function(){var t=this;this.tableData=[],this.records=[],Object(o["bb"])(this.queryParam).then((function(e){e.success?(t.tableData=[].concat(w(t.tableData),w(e.result)),d["a"].joinDistributionInfo(t.tableData),t.distributionTableList=[]):t.$message.error("加载数据失败"),t.$emit("loaded")}))},autoArrange:function(){var t=this,e=this.$refs.listTable.getCheckboxRecords();e.length<=0?this.$message.warn("请先选择要进行自动安排的记录！"):this.$confirm({content:"将根据现有库存情况自动安排库位，并覆盖原有数据？",okText:"确定",cancelText:"取消",onOk:function(){var a={applyDetailIdList:[],type:0};e.forEach((function(t){a.applyDetailIdList.push(t.id)})),t.confirmLoading=!0,Object(o["k"])(a).then((function(a){if(a.success){var r=a.result.applyDetailList;t.$message.success(a.result.assignResultMessage),e.forEach((function(t){var e=r.find((function(e){return e.id===t.id}));e&&(e.sourceLocationAndPalletName="",e.assignDetailList.forEach((function(t){var a=t.sourceLocationName+" | "+t.amount;t.palletName&&(a+=" | ".concat(t.palletName)),t.tradeNo&&(a+=" | 第".concat(t.tradeNo,"批次")),e.sourceLocationAndPalletName+=a+" \n"})),Object.assign(t,e))}))}else t.$message.error(a.message);t.confirmLoading=!1}))},onCancel:function(){}})},arrangePan:function(){var t=this.$refs.listTable.getCheckboxRecords();if(t.length<=0)this.$message.warn("请先选择要进行自动安排的记录！");else{var e=t.filter((function(t){return t.assignDetailList.length<=0}));e.length>0?this.$message.warning("请先安排库位信息"):this.$refs.palletModal.showModal()}},onSelectPallet:function(t){var e=this.$refs.listTable.getCheckboxRecords();try{Array.from(e,(function(e){Array.from(e.assignDetailList,(function(e){e.palletId=t[0].id,e.palletName=t[0].name}))})),this.updateAssignInfo(),this.$message.success("设置成功")}catch(a){this.$message.error("设置失败")}},save:function(){var t=y(b().m((function t(e){var a,r,i,n,l=this;return b().w((function(t){while(1)switch(t.n){case 0:if(this.fromFlow){t.n=1;break}a=this.$refs.listTable.getCheckboxRecords(),a.length>0?this.$confirm({content:"是否确认发放选中".concat(a.length,"数据？"),onOk:function(){var t=a.map((function(t,e){return{id:t.id,palletId:t.palletName,receive:t.receive}})),e={id:l.queryParam.orderId,detailList:t};Object(o["i"])(e).then((function(t){t.success?l.$emit("ok"):l.$emit("fail",t)})).catch((function(t){l.$message.error("保存异常"),l.$emit("fail")}))}}):this.$message.error("尚未选中任何数据!"),t.n=6;break;case 1:if(!(this.tableData&&this.tableData.length>0)){t.n=5;break}if(r={id:this.queryParam.orderId,onlySave:e,detailList:this.tableData.filter((function(t){return!t.noSave}))},i=!0,n=this.tableData.filter((function(t){return 0===t.receive})),e||!n.length){t.n=3;break}return t.n=2,new Promise((function(t,e){var a=n.map((function(t){return"["+t.materialTypeName+"-"+t.materialTypeCode+"]缺少"+(t.amount-t.receive)})).join("；");l.$confirm({content:"数量不匹配提醒：  ".concat(a,"  ;  是否继续提交？"),onOk:function(){t(!0)},onCancel:function(){t(!1)}})}));case 2:i=t.v;case 3:if(i){t.n=4;break}return this.$emit("cancel"),t.a(2);case 4:o["i"].call(this,r).then((function(t){t.success?l.$emit("ok"):l.$emit("fail",t)})).catch((function(t){l.$message.error("备料保存异常"),l.$emit("fail",t)})),t.n=6;break;case 5:this.$emit("ok");case 6:return t.a(2)}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),close:function(){this.$emit("close")},initDictData:function(){var t=this;Object(s["f"])(this.dictCode,null).then((function(e){e.success&&e.result&&e.result.map((function(e){t.palletList=t.palletList.concat({label:e.text,value:e.value})}))}))},openDistribution:function(t){this.curRow=t,this.openDistribution(t)},onSuccess:function(t){var e=this;t.forEach((function(a){var r=e.tableData.find((function(t){return t.id===a.applyDetailId}));r.assignDetailList=JSON.parse(JSON.stringify(t)),r.receive=0,r.assignDetailList.forEach((function(t){r.receive+=Number(t.amount);var e=t.sourceLocationName+" | "+t.amount;t.palletName&&(e+=" | ".concat(t.palletName)),t.tradeNo&&(e+=" | 第".concat(t.tradeNo,"批次")),r.sourceLocationAndPalletName+=e+" \n"}))}))},updateAssignInfo:function(){this.tableData.forEach((function(t){t.sourceLocationAndPalletName="",t.assignDetailList.forEach((function(e){var a=e.sourceLocationName+" | "+e.amount;e.palletName&&(a+=" | ".concat(e.palletName)),e.tradeNo&&(a+=" | 第".concat(e.tradeNo,"批次")),t.sourceLocationAndPalletName+=a+" \n"}))}))}},m(m(m(m(m(m(m(m(m(m(r,"openDistribution",(function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isDistribution=!0,this.curEditMode=0,this.$nextTick((function(){t.$refs.materialTable.setRadioRow(e||t.tableData[0]||{}),t.setActiveRow(e||t.tableData[0])}))})),"closeDistribution",(function(){this.hasActiveRow?this.$message.warn("存在未保存数据，请先保存"):(this.isDistribution=!1,this.curEditMode=0)})),"setActiveRow",(function(t){var e=this;this.tableDistributionData=[],this.selectInfo={},this.selectInfo=this.tableData.find((function(e){return e.id===t.id})),this.selectInfo.assignDetailList.forEach((function(t){e.tableDistributionData.push(JSON.parse(JSON.stringify(t)))}))})),"onRadioChange",(function(t){var e=t.row;e&&!this.hasActiveRow&&this.setActiveRow(e)})),"onMaterialCellClick",(function(t){var e=t.$event;e.stopPropagation()})),"addDetail",(function(){var t=this;if(!this.$refs.distributionTable.getActiveRecord()){this.curEditMode=1;var e={applyDetailId:this.selectInfo.id,materialTypeId:this.selectInfo.materialTypeId,amount:this.getAmount()};this.$refs.distributionTable.insertAt(e,-1).then((function(e){var a=e.row;t.$refs.distributionTable.setActiveRow(a)}))}})),"editRowEvent",(function(t){this.$refs.distributionTable.getActiveRecord()||(this.curEditMode=2,this.$refs.distributionTable.setActiveRow(t))})),"getAmount",(function(){if(!this.selectInfo)return 0;var t=0;return this.tableDistributionData.forEach((function(e){t+=Number(e.amount)})),this.selectInfo.amount-t})),"openlocationModal",(function(t){this.$refs.locationModal.showModal(this.selectInfo.materialTypeId,t.applyDetailId,t.id)})),"onSelectLocation",(function(t){if(t.length>0){var e=this.$refs.distributionTable.getActiveRecord(),a=e.row;a&&(a.locationName=t[0].warehouseName,a.locationWbs=t[0].warehouseWbs,a.sourceLocationName=t[0].sourceLocationName,a.tradeNo=t[0].tradeNo,a.price=t[0].price,a.needChooseTradeNo=t[0].needChooseTradeNo,a.tradeNoChoiceList=t[0].tradeNoChoiceList,a.locationNum=t[0].usableAmount,this.calcAmount>a.locationNum?a.amount=a.locationNum:this.calcAmount>0&&this.calcAmount<=a.locationNum?a.amount=this.calcAmount:a.amount=0)}})),m(m(m(m(m(r,"saveRowEvent",(function(t){var e=this;this.$refs.distributionTable.validate(t,(function(a){if(!a){if(e.tableDistributionData.find((function(e){return e.sourceLocationName===t.sourceLocationName&&e.tradeNo===t.tradeNo}))&&1===e.curEditMode)return void e.$message.warn("该仓库该批次的物资记录已存在");if("number"===typeof t.locationNum&&t.amount>t.locationNum)return void e.$message.warn("该仓库该批次的物资库存量不足");var r=0;if(e.tableDistributionData.forEach((function(e){e.sourceLocationName,t.sourceLocationName,e.tradeNo!==t.tradeNo&&(r+=Number(e.amount))})),r+Number(t.amount)>Number(e.selectInfo.amount))return void e.$message.warn("选择的实际数量超过了发放数量");1===e.curEditMode&&(t.isNew=!0,e.tableDistributionData.push(JSON.parse(JSON.stringify(t)))),e.$refs.distributionTable.clearActived(),e.onSuccess(e.tableDistributionData),e.curEditMode=0}}))})),"cancelRowEvent",(function(t){this.$refs.distributionTable.clearActived(),1===this.curEditMode?this.$refs.distributionTable.remove(t):2===this.curEditMode&&this.$refs.distributionTable.revertData(t),this.curEditMode=0})),"handleDel",(function(t){var e=this;this.$refs.distributionTable.getActiveRecord()||(this.$confirm({content:"是否删除选中的数据？",okText:"确定",cancelText:"取消",onOk:function(){e.tableDistributionData.splice(e.tableDistributionData.findIndex((function(e){return e.sourceLocationName===t.sourceLocationName})),1);var a=e.tableData.find((function(e){return e.id===t.applyDetailId}));a.assignDetailList.find((function(e){return e.sourceLocationName===t.sourceLocationName}))&&(a.receive-=a.assignDetailList.find((function(e){return e.sourceLocationName===t.sourceLocationName})).amount,a.assignDetailList.splice(a.assignDetailList.findIndex((function(e){return e.sourceLocationName===t.sourceLocationName})),1)),e.$nextTick((function(){e.locationMaxAmount=e.calcAmount}))}}),this.curEditMode=0)})),"openPalletModal",(function(){this.$refs.palletModal2.showModal(this.selectInfo.materialTypeId,this.selectInfo.materialTypeName)})),"onChoosePallet",(function(t){if(t.length>0){var e=this.$refs.distributionTable.getActiveRecord(),a=e.row;a&&(a.palletId=t[0].id,a.palletName=t[0].name)}})))},C=N,T=(a("51c5"),a("2877")),P=Object(T["a"])(C,i,n,!1,null,"efd43ef8",null);e["default"]=P.exports}}]);