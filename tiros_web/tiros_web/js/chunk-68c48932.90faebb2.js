(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68c48932"],{9866:function(t,e,n){},d1e3:function(t,e,n){"use strict";n("9866")},e89a:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"luckySheetPringContent"}},[e("div",{staticClass:"table-page-body",staticStyle:{position:"relative"}},[e("div",{ref:"printDom",staticClass:"ls-print",style:{height:t.lHeight},attrs:{id:t.luckySheetId}})])])},c=[],a=n("8fad"),o=(n("2410"),n("7268")),r={name:"LuckySheetPrint",props:{luckySheetId:{type:String,default:"luckySheetPring"}},data:function(){return{recordSheet:{},lHeight:"calc(100% - 0)"}},mounted:function(){},methods:{printById:function(t){var e=this;a["Db"].call(this,t).then((function(t){t.success&&e.printBySheet(JSON.parse(t.result))})).catch((function(t){e.$message.error("加载表单内容异常")}))},printByData:function(t){var e=this;this.recordSheet=t,this.$nextTick((function(){e.print()}))},printBySheet:function(t){var e=this,n=Object.assign({},o["a"].getDefaultOptions());n.container=this.luckySheetId;var i=0,c=0,a=0;t.celldata.forEach((function(t){t.c>i&&(i=t.c),t.r>c&&(c=t.r)})),i++,c++,a=t.visibledatarow[t.visibledatarow.length-1],n.column=i,n.row=c,delete t.luckysheet_select_save,n.data=[t],this.lHeight="".concat(a+40,"px"),luckysheet.destroy(),luckysheet.create(n),setTimeout((function(){var t=document.getElementById("luckysheet-sheettable_0"),n=document.getElementById("luckysheetTableContent"),i=n.getContext("2d").getImageData(42,17,t.offsetWidth,t.offsetHeight+10),c=document.createElement("canvas");c.width=t.offsetWidth,c.height=t.offsetHeight;var a=c.getContext("2d");a.putImageData(i,0,0);var o=c.toDataURL("image/png");e.print('<img id="printImage" src="'.concat(o,'">'))}),500)},print:function(t){var e=this,n=document.getElementById("printDom")||document.createElement("iframe");n.id="printDom",document.body.appendChild(n),this.$nextTick((function(){var i=document.getElementById("printDom");i.contentDocument.write(t),i.contentDocument.getElementById("printImage").onload=function(){i.contentWindow.print(),luckysheet.destroy(),e.$emit("sheetPrintOk"),document.body.removeChild(n)}}))}}},s=r,d=(n("d1e3"),n("2877")),u=Object(d["a"])(s,i,c,!1,null,"4cc670b2",null);e["default"]=u.exports}}]);