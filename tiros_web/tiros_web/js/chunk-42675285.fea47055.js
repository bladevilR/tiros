(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42675285"],{"0cf5":function(e,t,l){"use strict";l.r(t);var c=function(){var e=this,t=e._self._c;return t("div",[t("a-space",[t("a-button",{staticClass:"tab-button",on:{click:e.openFile}},[e._v(" 导入 "),t("input",{ref:"file",staticStyle:{display:"none"},attrs:{id:"Luckyexcel-File",type:"file"},on:{change:e.loadFile}})]),t("a-button",{directives:[{name:"has",rawName:"v-has",value:"demo:excel:export",expression:"'demo:excel:export'"}],staticClass:"tab-button"},[e._v(" 导出 ")]),t("a-button",{on:{click:e.insertRow}},[e._v("插入一行")]),t("a-button",{on:{click:e.getRowData}},[e._v("获取行数据")]),t("a-button",{on:{click:e.setSelectValue}},[e._v("设置数据")]),t("a-button",{on:{click:e.getSheetData}},[e._v("获取表格数据")]),t("a-button",{on:{click:function(t){return e.setCheck("自检")}}},[e._v("自检")]),t("a-button",{on:{click:function(t){return e.setCheck("互检")}}},[e._v("互检")]),t("a-button",{on:{click:function(t){return e.setCheck("专检")}}},[e._v("专检")]),t("a-button",{on:{click:function(t){return e.setQualityCheck("质量检查")}}},[e._v("质量检查")]),t("a-button",{on:{click:e.setTools}},[e._v("工器具设置")])],1),t("div",{staticStyle:{height:"calc(100vh - 150px)",width:"100%"},attrs:{id:"luckysheet"}})],1)},o=[],n={name:"excel",data:function(){var e=this;return{defaultOptions:{container:"luckysheet",title:"sheet",column:26,row:50,lang:"zh",allowEdit:!0,showtoolbar:!0,showtoolbarConfig:{undoRedo:!0,paintFormat:!0,currencyFormat:!1,percentageFormat:!1,numberDecrease:!1,numberIncrease:!1,moreFormats:!1,font:!1,fontSize:!1,bold:!1,italic:!1,strikethrough:!1,underline:!1,textColor:!1,fillColor:!1,border:!0,mergeCell:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!1,image:!0,link:!1,chart:!1,postil:!1,pivotTable:!1,function:!1,frozenMode:!1,sortAndFilter:!1,conditionalFormat:!1,dataVerification:!0,splitColumn:!1,screenshot:!1,findAndReplace:!0,protection:!0,print:!1},showinfobar:!1,showsheetbar:!1,showstatisticBar:!1,enableAddRow:!1,enableAddCol:!1,functionButton:'<button id="" class="btn btn-primary" style="padding:3px 6px;font-size: 12px;margin-right: 10px;">下载</button>',cellRightClickConfig:{copy:!0,copyAs:!1,paste:!1,insertRow:!0,insertColumn:!1,deleteRow:!1,deleteColumn:!1,deleteCell:!1,hideRow:!1,hideColumn:!1,rowHeight:!1,columnWidth:!1,clear:!1,matrix:!1,sort:!1,filter:!1,chart:!1,image:!1,link:!1,data:!1,cellFormat:!1},hook:{sheetMouseup:function(t,l,c,o){e.getSelectRange()},cellEditBefore:function(e,t,l){},cellUpdateBefore:function(e,t,l){},cellUpdated:function(e,t,l,c,o){},cellMousedown:function(e,t){}}},selectRange:null,sheetMetaData:null}},mounted:function(){var e=window.demoData;this.defaultOptions.data=[e],luckysheet.create(this.defaultOptions),this.loadDemoData(e)},beforeDestroy:function(){luckysheet.destroy()},methods:{loadDemoData:function(e){for(var t=luckysheet.transToData(e.celldata),l={checkDetail:{id:"checkDetail",name:"作业记录检查明细",type:"zone",rowIndex:-1,colIndex:0,rowIndexTo:-1,colIndexTo:-1,rows:[]}},c=[],o=0;o<t.length;o++){var n=t[o],r=[];c.push(r);for(var i=0;i<n.length;i++){var a=n[i];if(a){var s=this.getCellText(a);if(!s&&this.checkProperty(a,"mc")){var d=a.mc;if(this.checkProperty(d,"r")&&this.checkProperty(d,"c")&&this.checkProperty(d,"rs")&&this.checkProperty(d,"cs"));else if(this.checkProperty(d,"r")&&this.checkProperty(d,"c")){var h=c[d.r][d.c];s=h||""}}s?r.push(s):r.push("")}else r.push("")}if(r.includes("序号")&&r.includes("项目")&&r.includes("自检")){var x={id:"detailTitle",name:"明细标题行",type:"row",rowIndex:o,rowIndexTo:o,cells:{}};l.checkDetail.rows.push(x),l.checkDetail.rowIndex=o;for(var u=0;u<n.length;u++){var I=n[u];if(I){l.checkDetail.colIndexTo=u;var y=this.getCellText(I);if(y){var f=this.getCellLocation(o,u,I);switch(y){case"序号":x.cells.xh={id:"xh",name:"序号",type:"cell",cellType:"title",rowIndex:f.rowIndex,rowIndexTo:f.rowIndexTo,colIndex:f.colIndex,colIndexTo:f.colIndexTo};case"项目":x.cells.xm={id:"xm",name:"项目",type:"cell",cellType:"title",rowIndex:f.rowIndex,rowIndexTo:f.rowIndexTo,colIndex:f.colIndex,colIndexTo:f.colIndexTo};case"作业内容":x.cells.zynr={id:"zynr",name:"作业内容",type:"cell",cellType:"title",rowIndex:f.rowIndex,rowIndexTo:f.rowIndexTo,colIndex:f.colIndex,colIndexTo:f.colIndexTo};case"控制点":x.cells.kzd={id:"kzd",name:"控制点",type:"cell",cellType:"title",rowIndex:f.rowIndex,rowIndexTo:f.rowIndexTo,colIndex:f.colIndex,colIndexTo:f.colIndexTo};case"技术要求":x.cells.jsyq={id:"jsyq",name:"技术要求",type:"cell",cellType:"title",rowIndex:f.rowIndex,rowIndexTo:f.rowIndexTo,colIndex:f.colIndex,colIndexTo:f.colIndexTo};case"作业情况":x.cells.zyqk={id:"zyqk",name:"作业情况",type:"cell",cellType:"title",rowIndex:f.rowIndex,rowIndexTo:f.rowIndexTo,colIndex:f.colIndex,colIndexTo:f.colIndexTo};case"结果":x.cells.jg={id:"jg",name:"结果",type:"cell",cellType:"title",rowIndex:f.rowIndex,rowIndexTo:f.rowIndexTo,colIndex:f.colIndex,colIndexTo:f.colIndexTo};case"自检":x.cells.zijian={id:"zijian",name:"自检",type:"cell",cellType:"title",rowIndex:f.rowIndex,rowIndexTo:f.rowIndexTo,colIndex:f.colIndex,colIndexTo:f.colIndexTo};case"互检":x.cells.hujian={id:"hujian",name:"互检",type:"cell",cellType:"title",rowIndex:f.rowIndex,rowIndexTo:f.rowIndexTo,colIndex:f.colIndex,colIndexTo:f.colIndexTo};case"专检":x.cells.zhuanjian={id:"zhuanjian",name:"专检",type:"cell",cellType:"title",rowIndex:f.rowIndex,rowIndexTo:f.rowIndexTo,colIndex:f.colIndex,colIndexTo:f.colIndexTo}}}}}}if(l.checkDetail.rowIndex>-1&&l.checkDetail.rows.length>0){var w=l.checkDetail.rows[0].cells,p=r[w.xh.colIndex];p&&parseInt(p)>0&&(l.checkDetail.rowIndexTo=o,l.checkDetail.rows.push({xh:{id:"xh",name:r[w.xh.colIndex],type:"cell",cellType:"title",rowIndex:o,rowIndexTo:o,colIndex:w.xh.colIndex,colIndexTo:w.xh.colIndexTo},xm:{id:"xm",name:r[w.xm.colIndex],type:"cell",cellType:"title",rowIndex:o,rowIndexTo:o,colIndex:w.xm.colIndex,colIndexTo:w.xm.colIndexTo},zynr:{id:"zynr",name:r[w.zynr.colIndex],type:"cell",cellType:"title",rowIndex:o,rowIndexTo:o,colIndex:w.zynr.colIndex,colIndexTo:w.zynr.colIndexTo},kzd:{id:"kzd",name:r[w.kzd.colIndex],type:"cell",cellType:"title",rowIndex:o,rowIndexTo:o,colIndex:w.kzd.colIndex,colIndexTo:w.kzd.colIndexTo},jsyq:{id:"jsyq",name:r[w.jsyq.colIndex],type:"cell",cellType:"title",rowIndex:o,rowIndexTo:o,colIndex:w.jsyq.colIndex,colIndexTo:w.jsyq.colIndexTo}}))}}this.sheetMetaData=l},checkProperty:function(e,t){return t in e},getCellText:function(e){var t=this,l="";if(this.checkProperty(e,"m"))l=e.m;else if(this.checkProperty(e,"v"))l=e.m;else if(this.checkProperty(e,"ct")&&this.checkProperty(e.ct,"s")){var c=e.ct.s;c.forEach((function(e,c){t.checkProperty(e,"m")?l+=e.m:t.checkProperty(e,"v")&&(l+=e.v)}))}return l},getSelectRange:function(){var e=luckysheet.getRange()[0],t={r_start:e.row[0],r_end:e.row[1],c_start:e.column[0],c_end:e.column[1]};this.selectRange=t},searchCellByText:function(e,t){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t||(t=luckysheet.getAllSheets()[0].data),-1===l)for(var c=0;c<t.length;c++)for(var o=0;o<t[c].length;o++){var n=t[c][o];if(n){var r=this.getCellText(n);if(r&&r.indexOf(e)>-1)return{r:c,c:o,mc:n.mc}}}else for(var i=0;i<t[l].length;i++){var a=t[l][i];if(a){var s=this.getCellText(a);if(s&&s.indexOf(e)>-1)return{r:l,c:i,mc:a.mc}}}},getCheckKeyByName:function(e){switch(e){case"自检":return"zijian";case"互检":return"hujian";case"专检":return"zhuanjian";default:return""}},setCheck:function(e){if(this.sheetMetaData&&this.selectRange){var t=this.getCheckKeyByName(e),l=this.sheetMetaData.checkDetail.rows[0].cells,c=l[t].colIndex,o=l.jg.colIndex,n=l.zyqk.colIndex;if(this.sheetMetaData.checkDetail.rowIndex<this.selectRange.r_start&&this.selectRange.r_end<=this.sheetMetaData.checkDetail.rowIndexTo)for(var r=this.selectRange.r_start;r<=this.selectRange.r_end;r++)c&&this.setCellValue(r,c,"我检查"),o&&this.setCellValue(r,o,"√"),n&&this.setCellValue(r,n,"正常");else this.$message.error("选择区域不能填写检查信息")}},findWriteCellIndex:function(e){if(!this.checkProperty(e,"mc"))return e.c+1;var t=e.mc;return this.checkProperty(t,"r")&&this.checkProperty(t,"c")&&this.checkProperty(t,"rs")&&this.checkProperty(t,"cs")?e.mc.c+e.mc.cs:this.checkProperty(t,"r")&&this.checkProperty(t,"c")?-1:void 0},getCellLocation:function(e,t,l){var c={rowIndex:e,rowIndexTo:e,colIndex:t,colIndexTo:t};if(this.checkProperty(l,"mc")){var o=l.mc;this.checkProperty(o,"r")&&this.checkProperty(o,"c")&&this.checkProperty(o,"rs")&&this.checkProperty(o,"cs")&&(c.rowIndex=l.mc.r,c.colIndex=l.mc.c,c.rowIndexTo=l.mc.r+l.mc.rs-1,c.colIndexTo=l.mc.c+l.mc.cs-1)}return c},setQualityCheck:function(){var e=this.searchCellByText("检查结果");if(e&&e.r!==this.sheetMetaData.checkDetail.rowIndex){var t=this.findWriteCellIndex(e);this.setCellValue(e.r,t,"结果不错")}if(e=this.searchCellByText("检查日期"),e&&e.r!==this.sheetMetaData.checkDetail.rowIndex){var l=this.findWriteCellIndex(e);this.setCellValue(e.r,l,"2021-09-14")}if(e=this.searchCellByText("质量负责人"),e&&e.r!==this.sheetMetaData.checkDetail.rowIndex){var c=this.findWriteCellIndex(e);this.setCellValue(e.r,c,"质检员啊")}e=this.searchCellByText("作业日期"),e&&e.r!==this.sheetMetaData.checkDetail.rowIndex&&this.setCellValue(e.r,e.c,"作业日期：2021-09-14  完工日期: 2021-09-14"),e=this.searchCellByText("作业班组"),e&&e.r!==this.sheetMetaData.checkDetail.rowIndex&&this.setCellValue(e.r,e.c,"作业班组：调试工班"),e=this.searchCellByText("车号"),e&&e.r!==this.sheetMetaData.checkDetail.rowIndex&&this.setCellValue(e.r,e.c,"车号：0105")},setTools:function(){var e=this.searchCellByText("计量器具");if(e)for(var t=e.mc.r,l=e.mc.r+e.mc.rs,c=t;c<=l;c++){var o=this.searchCellByText("名称",c);o&&this.setCellValue(o.r,o.c,"名称：可爱哇"),o=this.searchCellByText("规格型号",c),o&&this.setCellValue(o.r,o.c,"规格型号：可爱哇"),o=this.searchCellByText("出厂编号",c),o&&this.setCellValue(o.r,o.c,"出厂编号：可爱哇"),o=this.searchCellByText("使用时间",c),o&&this.setCellValue(o.r,o.c,"使用时间：可爱哇"),o=this.searchCellByText("下次检验时间",c),o&&this.setCellValue(o.r,o.c,"下次检验时间：可爱哇")}},setCellValue:function(e,t,l){luckysheet.setCellValue(e,t,l,{success:function(){}})},openFile:function(){this.$refs.file.dispatchEvent(new MouseEvent("click"))},loadFile:function(){var e=this,t=this.$refs.file.files[0],l="";try{var c=t.name.split(".");l=c[c.length-1]}catch(o){l=""}""===l||"xls"!==l&&"xlsx"!==l?alert("不是有效的EXCEL文件！"):LuckyExcel.transformExcelToLucky(t,(function(t){luckysheet.destroy();var l=Object.assign({},e.defaultOptions);t.sheets[0].config.authority={sheet:1,hintText:"不能编辑"},l=Object.assign(l,{data:t.sheets,title:t.info.name,userInfo:t.info.name.creator}),luckysheet.create(l)}))},insertRow:function(){var e=luckysheet.getRange();if(e&&e.length>0){var t=e[0].row[0];luckysheet.insertRow(t+1,{success:function(){}})}},getRowData:function(){var e=luckysheet.getLuckysheetfile()[0].data,t=luckysheet.getRange();if(t&&t.length>0){var l=t[0].row[0],c=JSON.parse(JSON.stringify(e[l]));c.map((function(e){e.mc})),e.splice(l,0,c)}},setSelectValue:function(){var e=luckysheet.getRange();if(e&&e.length>0){var t=e[0].row[0],l=e[0].column[0];luckysheet.setCellValue(t,l,"插入",{success:function(){}})}},getSheetData:function(){JSON.stringify(luckysheet.getLuckysheetfile()[0])}}},r=n,i=(l("2b1b"),l("2877")),a=Object(i["a"])(r,c,o,!1,null,null,null);t["default"]=a.exports},"2b1b":function(e,t,l){"use strict";l("dd76")},dd76:function(e,t,l){}}]);