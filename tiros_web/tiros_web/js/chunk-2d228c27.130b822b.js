(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d228c27"],{db0c:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:"故障记录选择",centered:"",visible:e.visible,bodyStyle:{height:"80vh"},cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline",form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:3,sm:24}},[t("a-form-item",{attrs:{label:"来源"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"fault_from_type"},model:{value:e.queryParam.fromType,callback:function(t){e.$set(e.queryParam,"fromType",t)},expression:"queryParam.fromType"}})],1)],1),t("a-col",{attrs:{md:3,sm:24}},[t("a-form-item",{attrs:{label:"线路"}},[t("line-select-list",{model:{value:e.lineId,callback:function(t){e.lineId=t},expression:"lineId"}})],1)],1),t("a-col",{attrs:{md:3,sm:24}},[t("a-form-item",{attrs:{label:"车辆"}},[t("j-dict-select-seach-tag",{attrs:{dictCode:e.dictCodeStr},model:{value:e.queryParam.trainNo,callback:function(t){e.$set(e.queryParam,"trainNo",t)},expression:"queryParam.trainNo"}})],1)],1),t("a-col",{attrs:{md:3,sm:12}},[t("a-form-item",{attrs:{label:"时间"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_date_type"},model:{value:e.queryParam.dateType,callback:function(t){e.$set(e.queryParam,"dateType",t)},expression:"queryParam.dateType"}})],1)],1),"1"===e.queryParam.dateType||1===e.queryParam.dateType||"2"===e.queryParam.dateType?t("a-col",{attrs:{md:3,sm:12}},[t("a-form-item",[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{mode:"year",placeholder:"请选择年份",format:"YYYY",open:e.yearPickShow},on:{panelChange:e.handlePanelChange,openChange:e.handleOpenChange},model:{value:e.year,callback:function(t){e.year=t},expression:"year"}})],1)],1):e._e(),"2"===e.queryParam.dateType?t("a-col",{attrs:{md:3,sm:12}},[t("a-form-item",[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_quarter_type"},model:{value:e.queryParam.quarter,callback:function(t){e.$set(e.queryParam,"quarter",t)},expression:"queryParam.quarter"}})],1)],1):e._e(),"3"===e.queryParam.dateType?t("a-col",{attrs:{md:3,sm:12}},[t("a-form-item",[t("a-month-picker",{attrs:{placeholder:"选择月份"},model:{value:e.queryParam.month,callback:function(t){e.$set(e.queryParam,"month",t)},expression:"queryParam.month"}})],1)],1):e._e(),"4"===e.queryParam.dateType?t("a-col",{attrs:{md:4,sm:12}},[t("a-form-item",[t("a-range-picker",{attrs:{defaultPickerValue:e.defaultDateRange},model:{value:e.rangeDate,callback:function(t){e.rangeDate=t},expression:"rangeDate"}})],1)],1):e._e(),t("a-col",{attrs:{md:7,sm:8}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")]),t("a-button",[t("a",{style:{fontSize:"12px"},on:{click:e.toggle}},[e._v(" 更多条件 "),t("a-icon",{attrs:{type:e.expand?"up":"down"}})],1)])],1)],1)])],1),t("a-row",{style:{display:e.expand?"block":"none"},attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"工班"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:e.dictGroupStr},model:{value:e.reportGroupId,callback:function(t){e.reportGroupId=t},expression:"reportGroupId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"系统"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_train_asset_type,name,id,struct_type=1 and parent_id is null"},model:{value:e.queryParam.sysId,callback:function(t){e.$set(e.queryParam,"sysId",t)},expression:"queryParam.sysId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"部件"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_tools_status"},model:{value:e.queryParam.faultAssetId,callback:function(t){e.$set(e.queryParam,"faultAssetId",t)},expression:"queryParam.faultAssetId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"工位"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:e.dictCodeStrWork},model:{value:e.queryParam.workstationId,callback:function(t){e.$set(e.queryParam,"workstationId",t)},expression:"queryParam.workstationId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"位置"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_train_place,place_name,id"},model:{value:e.queryParam.placeId,callback:function(t){e.$set(e.queryParam,"placeId",t)},expression:"queryParam.placeId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"等级"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_fault_level"},model:{value:e.queryParam.level,callback:function(t){e.$set(e.queryParam,"level",t)},expression:"queryParam.level"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"完成"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_fault_status"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"阶段"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_fault_phase"},model:{value:e.queryParam.phase,callback:function(t){e.$set(e.queryParam,"phase",t)},expression:"queryParam.phase"}})],1)],1),t("a-col",{attrs:{md:9,sm:24}},[t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{label:"是否正线"}},[t("a-switch",{attrs:{dictCode:"bu_state"},on:{change:e.handleState1},model:{value:e.online,callback:function(t){e.online=t},expression:"online"}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{label:"是否有责"}},[t("a-switch",{attrs:{dictCode:"bu_state"},on:{change:e.handleState2},model:{value:e.hasDuty,callback:function(t){e.hasDuty=t},expression:"hasDuty"}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-form-item",{attrs:{label:"是否委外"}},[t("a-switch",{attrs:{dictCode:"bu_state"},on:{change:e.handleState3},model:{value:e.outsource,callback:function(t){e.outsource=t},expression:"outsource"}})],1)],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 130px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 130px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"click",mode:"cell",showIcon:"true"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"faultSn",title:"故障编号",width:"140"}}),t("vxe-table-column",{attrs:{field:"fromType_dictText",title:"来源",width:"120"}}),t("vxe-table-column",{attrs:{field:"lineName",title:"线路",width:"100"}}),t("vxe-table-column",{attrs:{field:"trainNo",title:"车号",width:"80"}}),t("vxe-table-column",{attrs:{field:"sysName",title:"故障系统",width:"180"}}),t("vxe-table-column",{attrs:{field:"faultAssetName",title:"故障部件",width:"180"}}),t("vxe-table-column",{attrs:{field:"faultDesc",title:"故障描述",align:"left"}}),t("vxe-table-column",{attrs:{field:"happenTime",title:"发现时间",width:"120"}}),t("vxe-table-column",{attrs:{field:"reportUserName",title:"提报人员",width:"100"}}),t("vxe-table-column",{attrs:{field:"reportTime",title:"提报时间",width:"120"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"100"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)])},l=[],o=a("c1df"),s=a.n(o),i=a("b47d"),n=a("5633"),c={name:"FaultSelectList",components:{LineSelectList:n["default"]},props:{multiple:{type:Boolean,default:!1}},data:function(){return{dictGroupStr:"bu_mtr_workshop_group,group_name,id,workshop_id='"+this.$store.getters.userInfo.workshopId+"'|workshop_id",visible:!1,dictCodeStr:"bu_train_info,train_no,train_no,status=1",dictCodeStrWork:"bu_mtr_workstation,name,id",year:null,queryParam:{fromType:1,trainNo:"",lineId:"",faultAssetId:"",reportGroupId:"",placeId:"",online:0,hasDuty:0,outsource:0,phase:"",status:"",level:"",sysId:"",quarter:"",year:"",month:"",endDate:"",startDate:"",dateType:"",workstationId:"",pageNo:1,pageSize:10},online:!1,hasDuty:!1,outsource:!1,totalResult:0,allAlign:"center",tableData:[],expand:!1,yearPick:null,yearPickShow:!1,form:this.$form.createForm(this),lineId:"",reportGroupId:"",rangeDate:[]}},watch:{lineId:function(e,t){this.dictCodeStr=e?"bu_train_info,train_no,train_no,line_id="+e:"bu_train_info,train_no,train_no"},reportGroupId:function(e,t){this.dictCodeStrWork=e?"bu_mtr_workstation,name,id,id in (select workstation_id from bu_group_workstation where group_id='".concat(e,"')"):"bu_mtr_workstation,name,id"}},methods:{showModal:function(e,t,a){e&&(this.queryParam.lineId=e),t&&(this.queryParam.trainNo=t),a&&(this.queryParam.reportGroupId=a),this.visible=!0,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.close()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},findList:function(){var e=this;this.loading=!0,this.rangeDate.length>0&&"4"===this.queryParam.dateType&&(this.queryParam.startDate=s()(this.rangeDate[0]).format("YYYY-MM-DD"),this.queryParam.endDate=s()(this.rangeDate[1]).format("YYYY-MM-DD")),this.queryParam.month&&"3"===this.queryParam.dateType&&(this.queryParam.year=s()(this.queryParam.month).year(),this.queryParam.month=s()(this.queryParam.month).month()+1),this.queryParam.lineId=this.lineId,this.queryParam.reportGroupId=this.reportGroupId,this.queryParam.status=0,Object(i["Q"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handleOpenChange:function(e){this.yearPickShow=e},handlePanelChange:function(e){this.year=e,this.queryParam.year=s()(e).format("YYYY"),this.yearPickShow=!1},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},handleState1:function(e){this.queryParam.online=e?1:0},handleState2:function(e){this.queryParam.hasDuty=e?1:0},handleState3:function(e){this.queryParam.outsource=e?1:0},toggle:function(){this.expand=!this.expand}}},u=c,d=a("2877"),m=Object(d["a"])(u,r,l,!1,null,"1f8ff92c",null);t["default"]=m.exports}}]);