(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-508f174f","chunk-29136323","chunk-cfac6c42"],{"05d5":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"表单查看-"+e.trainNo+"车 "+e.formName,centered:"",visible:e.visible,width:"100%",footer:null,dialogClass:"fullDialog no-title no-footer",destroyOnClose:!0},on:{cancel:function(t){e.visible=!1}}},[t("div",{staticClass:"table-page-body",staticStyle:{height:"calc(100% - 50px)"}},[t("div",{attrs:{id:"luckysheet"}})])])},i=[],o=a("8fad"),l=a("b9c3"),n=a("7268"),s={name:"FormTemplate",data:function(){return{formName:"",trainNo:"",groupName:"",visible:!1,fileUrl:"",tableData:[],defaultOptions:{container:"luckysheet",title:"sheet",column:26,row:50,lang:"zh",allowEdit:!1,showinfobar:!1,sheetFormulaBar:!1,showsheetbar:!1,showstatisticBar:!0,enableAddRow:!1,enableAddCol:!1,showtoolbar:!1}}},beforeDestroy:function(){luckysheet.destroy()},methods:{initSheet:function(e){var t=JSON.parse(JSON.stringify(this.defaultOptions));t.data=[e],luckysheet.destroy(),luckysheet.create(t)},showModal:function(e){this.formName=e.formObjName,this.groupName=e.groupName,this.loadOnlineFormDetail(e.id,e.formInstId),this.visible=!0},showModal2:function(e,t,a,r){this.formName=e,this.groupName=t,this.loadOnlineFormDetail("task2InstId",a),this.visible=!0},loadOnlineFormDetail:function(e,t){var a=this,r={task2InstId:e,formInstId:t,needValues:!1};Object(l["Q"])(r).then((function(e){if(e.success){var t=e.result;if(a.trainNo=t.trainNo,t&&t.result)try{var r=JSON.parse(t.result);Object(o["ub"])(t.formObjId).then((function(e){if(e.success){var i=JSON.parse(e.result);r&&(i.data=[],i.celldata=luckysheet.transToCellData(r)),a.initSheet(i),setTimeout((function(){n["a"].setRangeConditionalOncell(t.formObjId,t.id)}),200)}else a.$message.error("获取表单模板数据失败")}))}catch(i){return void a.$message.error("转换表单填写结果异常")}else a.$message.error("获取作业表单数据失败")}else a.$message.error("获取记录表内容错误")})).catch((function(e){a.$message.error("获取记录表内容异常")}))}}},c=s,d=(a("5577"),a("2877")),u=Object(d["a"])(c,r,i,!1,null,"7efb72d8",null);t["default"]=u.exports},1158:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:"工位选择",centered:"",bodyStyle:{height:"80vh"},visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{staticStyle:{"border-right":"1px dotted #D3E1F1",height:"calc(80vh - 20px)","margin-right":"8px",padding:"0px"},attrs:{md:4,sm:24}},[e.treeData.length?t("a-tree",{attrs:{defaultExpandAll:"","tree-data":e.treeData,"default-selected-keys":e.defaultKey,dropdownStyle:{maxHeight:"200px",overflow:"auto"},replaceFields:{title:"name",key:"id"}},on:{select:e.onSelect}}):e._e()],1),t("a-col",{attrs:{md:19,sm:24}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getWorkStation.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"工位"}},[t("a-input",{attrs:{placeholder:"请输入工位名称","allow-clear":""},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"班组"}},[t("j-dict-select-tag",{attrs:{dictCode:"sys_depart,depart_name,id,org_category=4",placeholder:"请选择"},model:{value:e.queryParam.groupId,callback:function(t){e.$set(e.queryParam,"groupId",t)},expression:"queryParam.groupId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-space",[t("a-button",{on:{click:e.getWorkStation}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticClass:"limitHeight"},[t("vxe-table",{ref:"listTable",staticStyle:{height:"100%"},attrs:{border:"","row-id":"id",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"},"radio-config":{trigger:"row"},"checkbox-config":{trigger:"row",highlight:!0,range:!0,checkStrictly:!0},"max-height":"100%"}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40",fixed:"left"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"stationNo",title:"工位号",width:"100"}}),t("vxe-table-column",{attrs:{field:"name",title:"工位名称",width:"20%",align:"left"}}),t("vxe-table-column",{attrs:{field:"groupName",title:"所属班组",width:"20%",align:"left"}}),t("vxe-table-column",{attrs:{field:"location",title:"位置",width:"100",align:"left"}}),t("vxe-table-column",{attrs:{field:"content",title:"作业内容",width:"25%",align:"left"}}),t("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"10%",align:"left"}})],1)],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.page.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)],1)],1)},i=[],o=a("8fad"),l={name:"WorkStationList",props:{multiple:{type:Boolean,default:!1},groupId:{type:String,default:null}},data:function(){return{visible:!1,confirmLoading:!1,treeData:[],tableData:[],allAlign:"center",defaultKey:[],queryParam:{id:"",name:"",groupId:"",pageNo:1,pageSize:10},page:{currentPage:1,pageSize:10,totalResult:3}}},mounted:function(){this.groupId&&(this.queryParam.groupId=this.groupId)},methods:{showModal:function(){this.visible=!0,this.getTreeList()},getTreeList:function(){var e=this;Object(o["Ub"])().then((function(t){t.success&&(e.treeData=t.result,e.defaultKey[0]=t.result[0].id,e.queryParam.id=t.result[0].id,e.getWorkStation())}))},getWorkStation:function(){var e=this;Object(o["Tb"])(this.queryParam).then((function(t){e.page.totalResult=t.result.total,e.tableData=t.result.records}))},onSelect:function(e,t){var a=t.node.dataRef;e.length>0&&(this.queryParam.id=a.id,this.queryParam.pageNo=1,this.getWorkStation())},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.getTreeList()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},n=l,s=(a("7483"),a("2877")),c=Object(s["a"])(n,r,i,!1,null,"ea42f1f8",null);t["default"]=c.exports},"27b5":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"预警"}},[t("a-input",{attrs:{placeholder:"预警描述",allowClear:""},model:{value:e.queryParam.alertDescribe,callback:function(t){e.$set(e.queryParam,"alertDescribe",t)},expression:"queryParam.alertDescribe"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"状态"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_work_measure_alert_status"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"测量日期"}},[t("a-date-picker",{staticClass:"datePaddingRight",model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)],1),t("a-col",{attrs:{md:8,sm:24}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")]),t("a-button",{attrs:{disabled:!e.selectedRow||0!=e.selectedRow.status},on:{click:function(t){return e.handleClose(e.selectedRow)}}},[e._v("修复关闭")]),t("a-button",{attrs:{disabled:!e.selectedRow||0!=e.selectedRow.status},on:{click:function(t){return e.createFault(e.selectedRow)}}},[e._v("转为故障")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(100vh - 225px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(100vh - 225px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","checkbox-config":{trigger:"row",highlight:!0,range:!0}},on:{"checkbox-change":e.rowSelectChange}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{title:"表单查看","min-width":"150",align:"left","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("a",{on:{click:function(t){return t.stopPropagation(),e.jumpInfo(r)}}},[e._v(e._s(r.formObjName))])]}}])}),t("vxe-table-column",{attrs:{field:"alertTime",title:"测量时间",width:"160"}}),t("vxe-table-column",{attrs:{field:"groupName",title:"作业工班",width:"120"}}),t("vxe-table-column",{attrs:{field:"taskName",title:"作业工序","min-width":"140",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"80"}}),t("vxe-table-column",{attrs:{field:"alertValue",title:"测量原始值",width:"100"}}),t("vxe-table-column",{attrs:{field:"thresholdValueDesc",title:"阈值",width:"120"}}),t("vxe-table-column",{attrs:{field:"fixedValue",title:"修复值",width:"100"}}),t("vxe-table-column",{attrs:{field:"fixDesc",align:"left","header-align":"center",title:"备注","min-width":"100"}}),t("vxe-table-column",{attrs:{field:"alertMessage",title:"预警描述","min-width":"240",align:"left","header-align":"center"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1),t("warning-off-modal",{ref:"modalForm",on:{ok:function(t){return e.loadData()}}}),t("form-template",{ref:"formTemplate"}),t("BreakdownModal",{ref:"breakdownModal",on:{ok:function(t){return e.loadData()}}})],1)},i=[],o=a("c1df"),l=a.n(o),n=a("b9c3"),s=a("f33f"),c=a("ab7d"),d=a("05d5"),u={name:"WarningOffPage",components:{WarningOffModal:s["default"],FormTemplate:d["default"],BreakdownModal:c["default"]},data:function(){return{date:null,queryParam:{alertDescribe:"",workstationId:"",status:"",alertTime:null,pageNo:1,pageSize:10},totalResult:0,allAlign:"center",tableData:[],count:"",selectedRow:null}},created:function(){this.findList()},methods:{findList:function(){var e=this;this.loading=!0,this.date?this.queryParam.alertTime=l()(this.date).format("YYYY-MM-DD"):this.queryParam.alertTime="",Object(n["x"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},loadData:function(){this.findList()},handleClose:function(e){this.$refs.modalForm.edit(e),this.$refs.modalForm.title="修复关闭"},createFault:function(e){this.$refs.breakdownModal.edit({workOrderId:e.orderId,orderTaskId:e.orderTaskId,formValueId:e.id,formType:2,createType:2,happenTime:e.alertTime,faultDesc:e.alertMessage,phase:1})},jumpInfo:function(e){this.$refs.formTemplate.showModal2(e.formObjName,e.groupName,e.formDataRecordId,e.formObjId)},rowSelectChange:function(){var e=this.$refs.listTable.getCheckboxRecords();e&&1==e.length?this.selectedRow=e[0]:this.selectedRow=null}}},m=u,f=a("2877"),h=Object(f["a"])(m,r,i,!1,null,"0a6744ae",null);t["default"]=h.exports},"2e75":function(e,t,a){},"51cf":function(e,t,a){},"52d1":function(e,t,a){},5577:function(e,t,a){"use strict";a("52d1")},7068:function(e,t,a){"use strict";a("51cf")},7483:function(e,t,a){"use strict";a("2e75")},ab7d:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"故障编辑",width:"100%",centered:"",visible:e.visible,dialogClass:"fullDialog",confirmLoading:e.confirmLoading,cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticStyle:{height:"calc(100vh - 5px)","overflow-y":"auto"}},[e.visible?t("BreakdownFormItem",{ref:"breakdownForm",attrs:{fromWriteReport:e.fromWriteReport,workStationsList:e.workStationsList},on:{ok:e.onSaveOk,fail:e.onSaveFail,cancel:e.onSaveCancel}}):e._e()],1)])},i=[],o=a("d0ca"),l={name:"BreakdownModal",components:{BreakdownFormItem:o["default"]},props:{showWorkStation:{type:Boolean,default:!1},fromWriteReport:{type:Boolean,default:!1}},data:function(){return{visible:!1,confirmLoading:!1,workStationsList:[]}},created:function(){},methods:{setWorkStations:function(e){var t=this;this.workStationsList.length=0,e.forEach((function(e){t.workStationsList.find((function(t){return t.workstationId===e.workstationId}))||t.workStationsList.push(e)}))},add:function(e,t,a){this.edit({workOrderId:e,orderTaskId:t,formType:a,createType:a})},edit:function(e){var t=this;this.visible=!0,this.$nextTick((function(){t.$refs.breakdownForm.edit(e)}))},handleOk:function(){this.confirmLoading=!0,this.$refs.breakdownForm.save()},onSaveOk:function(){this.confirmLoading=!1,this.visible=!1,this.$message.success("保存成功"),this.$emit("ok")},onSaveFail:function(){this.$message.error("保存失败"),this.confirmLoading=!1},onSaveCancel:function(){this.confirmLoading=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.confirmLoading=!1,this.visible=!1}}},n=l,s=(a("7068"),a("2877")),c=Object(s["a"])(n,r,i,!1,null,"12e1d6e2",null);t["default"]=c.exports},f33f:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{centered:"",title:e.title,width:600,bodyStyle:{height:"300px"},visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"新的测量"}},[t("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["newValue",e.validatorRules.newValue],expression:"['newValue', validatorRules.newValue]",modifiers:{trim:!0}}],staticStyle:{width:"100%"},attrs:{max:999999999,placeholder:"请输入"}})],1)],1)],1),t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"备注描述"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["remark",e.validatorRules.remark],expression:"['remark', validatorRules.remark]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入",maxLength:201,"auto-size":{minRows:3,maxRows:10}}})],1)],1)],1)],1)],1)],1)},i=[],o=(a("c1df"),a("b9c3")),l={name:"WarningOffModal",data:function(){return{title:"操作",visible:!1,model:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}},isClose:!1,confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{newValue:{rules:[{required:!0,message:"请输入新的测量内容!"}]},remark:{rules:[{max:200,message:"不能超过200个字符"}]}}}},created:function(){},methods:{changeClose:function(e){this.isClose=e},edit:function(e){var t=this;e.id?this.isClose=!(!e["close"]||1!=e["close"]):this.isClose=!1,this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue({newValue:t.model.newValue,remark:t.model.remark})}))},handleOk:function(){var e=this,t=this;t.form.validateFields((function(a,r){if(!a){t.confirmLoading=!0;var i,l=Object.assign(t.model,r);i=Object(o["g"])(l),i.then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok")):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1,t.close()})),e.visible=!1}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},n=l,s=a("2877"),c=Object(s["a"])(n,r,i,!1,null,"90c5b484",null);t["default"]=c.exports}}]);