(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-505931f2","chunk-5c4c88d1"],{"61f4":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:"90%",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",centered:"",bodyStyle:{height:"60vh"},destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-form-model",{ref:"form",attrs:{model:e.planInfo,rules:e.formRules,labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-row",{staticStyle:{width:"100%"}},[t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"车辆段",prop:"depotId"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_mtr_depot,name,id"},model:{value:e.planInfo.depotId,callback:function(t){e.$set(e.planInfo,"depotId",t)},expression:"planInfo.depotId"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"车间",prop:"workshopId"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_mtr_workshop,name,id"},model:{value:e.planInfo.workshopId,callback:function(t){e.$set(e.planInfo,"workshopId",t)},expression:"planInfo.workshopId"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"所属线路",prop:"lineId"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_mtr_line,line_name,line_id",triggerChange:""},on:{change:e.lineChange},model:{value:e.planInfo.lineId,callback:function(t){e.$set(e.planInfo,"lineId",t)},expression:"planInfo.lineId"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"维修车辆",prop:"exchangeId"}},[t("a-row",{attrs:{gutter:10}},[t("a-select",{staticStyle:{width:"calc(100% - 186px)","margin-right":"10px"},attrs:{allowClear:""},on:{change:e.handleExchange},model:{value:e.planInfo.exchangeId,callback:function(t){e.$set(e.planInfo,"exchangeId",t)},expression:"planInfo.exchangeId"}},e._l(e.exChanges,(function(n){return t("a-select-option",{key:n.id,attrs:{value:n.id}},[e._v(" 第"+e._s(n.trainIndex)+"列-"+e._s(n.trainNo)+" ")])})),1),t("span",[e._v("如果没有车辆，请先接车")])],1)],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"计划模版",prop:"planTemplateId"}},[t("a-select",{attrs:{allowClear:""},on:{change:e.handleTempChange},model:{value:e.planInfo.planTemplateId,callback:function(t){e.$set(e.planInfo,"planTemplateId",t)},expression:"planInfo.planTemplateId"}},e._l(e.templates,(function(n){return t("a-select-option",{key:n.id},[e._v(" "+e._s(n.tpName)+"-"+e._s(n.duration)+"天 ")])})),1)],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"修程类型",prop:"repairProgramId"}},[t("j-dict-select-tag",{ref:"repairProgram",attrs:{disabled:"",dictCode:"bu_repair_program,name,id"},model:{value:e.planInfo.repairProgramId,callback:function(t){e.$set(e.planInfo,"repairProgramId",t)},expression:"planInfo.repairProgramId"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"关联规程",prop:"planTemplateId"}},[t("j-dict-select-tag",{attrs:{disabled:"",triggerChange:"",dictCode:"bu_repair_regu_info,name,id,status=1"},model:{value:e.planInfo.reguId,callback:function(t){e.$set(e.planInfo,"reguId",t)},expression:"planInfo.reguId"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"计划开始",prop:"startDate"}},[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{valueFormat:"YYYY-MM-DD"},on:{change:e.changeStartDate},model:{value:e.planInfo.startDate,callback:function(t){e.$set(e.planInfo,"startDate",t)},expression:"planInfo.startDate"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"计划结束",prop:"finishDate",title:"仅做参考"}},[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:"",valueFormat:"YYYY-MM-DD"},model:{value:e.planInfo.finishDate,callback:function(t){e.$set(e.planInfo,"finishDate",t)},expression:"planInfo.finishDate"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"计划工期",prop:"duration"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{disabled:"",min:0},model:{value:e.planInfo.duration,callback:function(t){e.$set(e.planInfo,"duration",t)},expression:"planInfo.duration"}})],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"计划名称",labelCol:{span:2},wrapperCol:{span:22},prop:"planName"}},[t("a-input",{attrs:{maxLength:33},model:{value:e.planInfo.planName,callback:function(t){e.$set(e.planInfo,"planName",t)},expression:"planInfo.planName"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"财务项目",prop:"fdProject"}},[t("FinanceSelect",{attrs:{type:"project"},on:{change:function(t){e.planInfo.fdTask=void 0}},model:{value:e.planInfo.fdProject,callback:function(t){e.$set(e.planInfo,"fdProject",t)},expression:"planInfo.fdProject"}})],1)],1),t("a-col",{attrs:{span:8}},[t("a-form-model-item",{attrs:{label:"财务任务",prop:"fdTask"}},[t("FinanceSelect",{attrs:{id:e.planInfo.fdProject,type:"task"},model:{value:e.planInfo.fdTask,callback:function(t){e.$set(e.planInfo,"fdTask",t)},expression:"planInfo.fdTask"}})],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"备注",labelCol:{span:2},wrapperCol:{span:22},prop:"remark"}},[t("a-textarea",{attrs:{maxLength:201,placeholder:"请输入内容"},model:{value:e.planInfo.remark,callback:function(t){e.$set(e.planInfo,"remark",t)},expression:"planInfo.remark"}})],1)],1)],1)],1)],1)},a=[],o=n("b47d"),c=n("9ced"),i={name:"edit",props:["visible","plan","title"],components:{FinanceSelect:c["default"]},data:function(){return{oldValue:!1,confirmLoading:!1,formRules:{planName:[{required:!0,message:"请输入计划名称",trigger:"change"},{min:0,max:32,message:"输入长度不能超过32字符!"}],depotId:[{required:!0,message:"请选择车辆段",trigger:"change"}],workshopId:[{required:!0,message:"请选择车间",trigger:"change"}],lineId:[{required:!0,message:"请选择线路",trigger:"change"}],repairProgramId:[{required:!0,message:"请选修程类型",trigger:"change"}],exchangeId:[{required:!0,message:"请选维修车辆",trigger:"change"}],planTemplateId:[{required:!0,message:"请选计划模版",trigger:"change"}],startDate:[{required:!0,message:"请选择开始日期",trigger:"change"}],finishDate:[{required:!0,message:"请选择结束日期",trigger:"change"}],duration:[{required:!0,message:"请设置计划工期",trigger:"change"}],fdProject:[{required:!1,message:"请输入所属财务项目",trigger:"change"},{min:0,max:64,message:"输入长度不能超过64字符!"}],fdTask:[{required:!1,message:"请输入所属财务任务",trigger:"change"},{min:0,max:64,message:"输入长度不能超过64字符!"}],fdCostType:[{required:!1,message:"请输入所属开支编码",trigger:"change"},{min:0,max:64,message:"输入长度不能超过64字符!"}],remark:[{min:0,max:200,message:"输入长度不能超过200字符!"}]},exChanges:[],templates:[],labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}},planInfo:{depotId:void 0,workshopId:void 0,lineId:void 0,exchangeId:void 0,planTemplateId:void 0,remark:void 0,fdCostType:void 0,repairProgramId:void 0,reguId:void 0,startDate:void 0,finishDate:void 0,duration:void 0,planName:void 0,fdProject:void 0,fdTask:void 0},exchangeName:"",repairProgramName:""}},beforeMount:function(){this.loadExChange(),this.loadTemplates();var e=JSON.parse(JSON.stringify(this.plan));e&&e.id&&(this.oldValue={exchangeId:e.exchangeId,planTemplateId:e.planTemplateId,startDate:this.$moment(e.startDate).format("YYYY-MM-DD")},this.planInfo=Object.assign({},e))},methods:{loadExChange:function(){var e=this;this.planInfo.lineId&&this.planInfo.lineId,Object(o["wb"])({lineId:this.planInfo.lineId}).then((function(t){t.success&&(e.exChanges=t.result)}))},loadTemplates:function(){var e=this;Object(o["vb"])().then((function(t){t.success&&(e.templates=t.result)}))},handleOk:function(){var e=this;this.$refs.form.validate((function(t){if(t)if(e.confirmLoading=!0,e.planInfo.id){var n=e.oldValue,r=!0;for(var a in n)if(n[a]!==e.planInfo[a]){r=!1;break}if(r)e.editorAction();else{var c=e;e.$confirm({content:"修改列计划的车辆、模板、开始时间将重新生成列计划，将导致原有的数据将删除，是否继续？",onOk:function(){return c.editorAction()},onCancel:function(){c.confirmLoading=!1}})}}else Object(o["i"])(e.planInfo).then((function(t){e.confirmLoading=!1,t.success?(e.$emit("save_success"),e.$message.success("保存成功"),e.$emit("update:visible",!1)):e.$message.error(t.message)})).catch((function(t){e.$message.error("保存异常")}))}))},editorAction:function(){var e=this;return Object(o["Rb"])(this.planInfo).then((function(t){t.success?(e.$message.success("保存成功"),e.$emit("save_success"),e.$emit("update:visible",!1)):e.$message.error(t.message),e.confirmLoading=!1})).catch((function(t){e.$message.error("保存异常")}))},handleCancel:function(){this.$emit("update:visible",!1)},getTemplateDate:function(e){var t=this;e&&Object(o["W"])({id:e}).then((function(e){e.success?(t.planInfo.planTemplateId=e.result.planTempId,t.handleTempChange(e.result.planTempId),t.planInfo.startDate=e.result.acceptDate,t.changeStartDate(e.result.acceptDate)):t.$message.error(e.message)}))},handleExchange:function(e){var t=this;this.getTemplateDate(e),this.exChanges.map((function(n){n.id===e&&(t.plan.id||(t.exchangeName="第".concat(n.trainIndex,"列-").concat(n.trainNo,"车"),t.$set(t.planInfo,"planName",t.exchangeName+t.repairProgramName)),t.planInfo.mileage=n.acceptMileage,t.planInfo.trainIndex=n.trainIndex)}))},changeStartDate:function(e){e&&this.planInfo.duration&&(this.planInfo.finishDate=this.$moment(this.planInfo.startDate).clone(),this.planInfo.finishDate.add(this.planInfo.duration,"d"),this.planInfo.finishDate=this.planInfo.finishDate.format("YYYY-MM-DD"))},handleTempChange:function(e){var t=this;this.templates.map((function(n){n.id===e&&(t.planInfo.reguId=n.reguId,t.planInfo.duration=n.duration,t.planInfo.repairProgramId=n.repairProgramId,t.$set(t.planInfo,"fdProject",n.fdProject),t.$set(t.planInfo,"fdTask",n.fdTask),t.$set(t.planInfo,"fdCostType",n.fdCostType),t.planInfo.startDate&&(t.planInfo.finishDate=t.$moment(t.planInfo.startDate).clone(),t.planInfo.finishDate.add(t.planInfo.duration,"d")),t.$nextTick((function(){var e=t.$refs.repairProgram.getSelectItem(t.planInfo.repairProgramId);e&&(t.repairProgramName=e.text+"计划",t.$set(t.planInfo,"planName",t.exchangeName+t.repairProgramName),t.$forceUpdate())})))}))},lineChange:function(){this.loadExChange()}}},u=i,s=n("2877"),l=Object(s["a"])(u,r,a,!1,null,"5e43dcf2",null);t["default"]=l.exports},"9ced":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e._self._c;return t("div",["project"==e.type||"task"==e.type?t("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"","show-search":"",placeholder:"project"==e.type?"请选择财务项目":"task"==e.type&&"请选择财务任务","option-filter-prop":"children","filter-option":e.filterOption},on:{focus:e.handleFocus,change:e.handleChange},model:{value:e.modelValue,callback:function(t){e.modelValue=t},expression:"modelValue"}},e._l(e.selectList,(function(n,r){return t("a-select-option",{key:r,attrs:{value:n.id}},[e._v(" "+e._s(n.name)+" - "+e._s(n.code)+" ")])})),1):t("span",{staticStyle:{color:"red"}},[e._v(" 参数 “type” 不能为空 参数详阅组件 src/components/finance/index.vue ")])],1)},a=[],o=n("d214"),c={name:"finance",model:{prop:"value",event:"change"},props:["value","type","id"],data:function(){return{modelValue:void 0,selectList:[]}},watch:{value:{handler:function(e){this.modelValue=e},immediate:!0},id:{handler:function(e){this.getSelectList()},immediate:!0}},created:function(){this.getSelectList()},methods:{filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},handleFocus:function(){"task"!=this.type||this.id||this.$message.warning("请先选择财务项目！")},handleChange:function(e){this.$emit("change",e)},getSelectList:function(){var e=this;this.selectList=[];var t="project"==this.type?o["M"]:"task"==this.type&&o["N"];if(t){if("task"==this.type&&!this.id)return;t("task"==this.type&&{projectId:this.id}).then((function(t){t.success&&t.result.length&&(e.selectList=t.result)}))}}}},i=c,u=n("2877"),s=Object(u["a"])(i,r,a,!1,null,"10418fd5",null);t["default"]=s.exports},d214:function(e,t,n){"use strict";n.d(t,"h",(function(){return a})),n.d(t,"D",(function(){return o})),n.d(t,"eb",(function(){return c})),n.d(t,"r",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"w",(function(){return s})),n.d(t,"H",(function(){return l})),n.d(t,"I",(function(){return g})),n.d(t,"k",(function(){return d})),n.d(t,"c",(function(){return h})),n.d(t,"x",(function(){return I})),n.d(t,"l",(function(){return j})),n.d(t,"K",(function(){return b})),n.d(t,"a",(function(){return v})),n.d(t,"v",(function(){return O})),n.d(t,"j",(function(){return x})),n.d(t,"F",(function(){return k})),n.d(t,"J",(function(){return f})),n.d(t,"G",(function(){return p})),n.d(t,"t",(function(){return m})),n.d(t,"Q",(function(){return y})),n.d(t,"u",(function(){return C})),n.d(t,"db",(function(){return T})),n.d(t,"q",(function(){return _})),n.d(t,"bb",(function(){return P})),n.d(t,"cb",(function(){return S})),n.d(t,"C",(function(){return w})),n.d(t,"g",(function(){return D})),n.d(t,"P",(function(){return $})),n.d(t,"X",(function(){return Y})),n.d(t,"ab",(function(){return M})),n.d(t,"f",(function(){return F})),n.d(t,"p",(function(){return q})),n.d(t,"jb",(function(){return L})),n.d(t,"kb",(function(){return N})),n.d(t,"Z",(function(){return B})),n.d(t,"e",(function(){return E})),n.d(t,"A",(function(){return A})),n.d(t,"n",(function(){return J})),n.d(t,"m",(function(){return G})),n.d(t,"O",(function(){return z})),n.d(t,"Y",(function(){return H})),n.d(t,"V",(function(){return Q})),n.d(t,"gb",(function(){return X})),n.d(t,"hb",(function(){return Z})),n.d(t,"L",(function(){return ee})),n.d(t,"ib",(function(){return te})),n.d(t,"B",(function(){return V})),n.d(t,"y",(function(){return U})),n.d(t,"d",(function(){return W})),n.d(t,"z",(function(){return K})),n.d(t,"W",(function(){return ne})),n.d(t,"o",(function(){return R})),n.d(t,"fb",(function(){return re})),n.d(t,"i",(function(){return ae})),n.d(t,"E",(function(){return oe})),n.d(t,"s",(function(){return ce})),n.d(t,"M",(function(){return ie})),n.d(t,"N",(function(){return ue})),n.d(t,"S",(function(){return se})),n.d(t,"T",(function(){return le})),n.d(t,"U",(function(){return de})),n.d(t,"R",(function(){return fe}));var r=n("0fea"),a=function(e){return Object(r["j"])("/outsource/supplier/add",e)},o=function(e){return Object(r["j"])("/outsource/supplier/edit",e)},c=function(e){return Object(r["d"])("/outsource/supplier/page",e)},i=function(e){return Object(r["j"])("/outsource/supplier/delete",e)},u=function(e){return Object(r["j"])("/outsource/contractInfo/add",e)},s=function(e){return Object(r["j"])("/outsource/contractInfo/edit",e)},l=function(e){return Object(r["d"])("/outsource/contractInfo/page",e)},d=function(e){return Object(r["j"])("/outsource/contractInfo/delete",e)},f=function(e){return Object(r["d"])("/outsource/contractInfo/monitor",e)},p=function(e){return Object(r["d"])("/outsource/contract/annex/list",e)},m=function(e){return Object(r["j"])("/outsource/contract/annex/delete",e)},g=function(e){return Object(r["d"])("/outsource/contractInfo/price",e)},h=function(e){return Object(r["j"])("/outsource/contractPay/add",e)},I=function(e){return Object(r["j"])("/outsource/contractPay/edit",e)},b=function(e){return Object(r["d"])("/outsource/contractPay/page",e)},j=function(e){return Object(r["j"])("/outsource/contractPay/delete",e)},v=function(e){return Object(r["j"])("/outsource/contractBakMoney/add",e)},O=function(e){return Object(r["j"])("/outsource/contractBakMoney/edit",e)},k=function(e){return Object(r["d"])("/outsource/contractBakMoney/page",e)},x=function(e){return Object(r["j"])("/outsource/contractBakMoney/delete",e)},y=function(e){return Object(r["d"])("/outsource/outin/page",e)},C=function(e){return Object(r["j"])("/outsource/outin/delete",e)},$=function(e){return Object(r["d"])("/outsource/outin/page/detail",e)},D=function(e){return Object(r["j"])("/outsource/supervise/add",e)},w=function(e){return Object(r["j"])("/outsource/supervise/edit",e)},T=function(e){return Object(r["d"])("/outsource/supervise/page",e)},_=function(e){return Object(r["j"])("/outsource/supervise/delete",e)},P=function(e){return Object(r["d"])("/outsource/supervise/get",{id:e})},S=function(e){return Object(r["d"])("/outsource/supervise/get-by-order",e)},N=function(e){return Object(r["d"])("/outsource/perform/vendor/tree",e)},L=function(e){return Object(r["j"])("/outsource/perform/delayReason",e)},Y=function(e){return Object(r["d"])("/outsource/perform/page",e)},q=function(e){return Object(r["j"])("/outsource/perform/delete/resource",e)},M=function(e){return Object(r["d"])("/outsource/perform/resource",e)},F=function(e){return Object(r["j"])("/outsource/perform/resource/add",e)},V=function(e){return Object(r["j"])("/outsource/perform/resource/edit",e)},B=function(e){return Object(r["d"])("/outsource/rateing/page",e)},E=function(e){return Object(r["j"])("/outsource/rateing/add",e)},A=function(e){return Object(r["j"])("/outsource/rateing/edit",e)},J=function(e){return Object(r["j"])("/outsource/rateing/delete",e)},R=function(e){return Object(r["j"])("/outsource/rateing/delete/attachment",e)},G=function(e){return Object(r["j"])("/outsource/otherSource/delete",e)},U=function(e){return Object(r["j"])("/outsource/otherSource/edit",e)},W=function(e){return Object(r["j"])("/outsource/otherSource/add",e)},z=function(e){return Object(r["d"])("/outsource/otherSource/page",e)},H=function(e){return Object(r["d"])("/outsource/quality/page",e)},K=function(e){return Object(r["j"])("/outsource/quality/edit",e)},Q=function(e){return Object(r["d"])("/outsource/part/page",e)},X=function(e){return Object(r["d"])("/outsource/fault/countFault",e)},Z=function(e){return Object(r["d"])("/outsource/fault/countFaultGroupBySystem",e)},ee=function(e){return Object(r["d"])("/outsource/fault/page",e)},te=function(e){return Object(r["j"])("/outsource/fault/countFaultGroupByPhaseAndSystem",e)},ne=function(e){return Object(r["d"])("/outsource/contractPay/page",e)},re=function(e){return Object(r["d"])("/training/record/page",e)},ae=function(e){return Object(r["j"])("/training/record/add",e)},oe=function(e){return Object(r["j"])("/training/record/edit",e)},ce=function(e){return Object(r["j"])("/training/record/delete",e)},ie=function(e){return Object(r["d"])("/base/finance/project/list",e)},ue=function(e){return Object(r["d"])("/base/finance/task/list",e)},se=function(e){return Object(r["d"])("/outsource/cost/listCost",e)},le=function(e){return Object(r["d"])("/outsource/cost/detail",e)},de=function(e){return Object(r["d"])("/outsource/cost/part",e)},fe=function(e){return Object(r["d"])("/outsource/cost/asset",e)}}}]);