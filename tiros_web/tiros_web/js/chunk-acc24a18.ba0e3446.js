(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-acc24a18","chunk-535429be"],{"25e0":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,centered:"",width:500,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查日期"}},[t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["checkDate",e.validatorRules.checkDate],expression:"['checkDate', validatorRules.checkDate]"}],staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD",placeholder:"选择检查日期"},on:{change:e.changeCheckDate}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"检查结果"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["checkResult",e.validatorRules.checkResult],expression:"['checkResult', validatorRules.checkResult]"}],attrs:{triggerChange:!0,placeholder:"请选择检查结果",dictCode:"bu_work_order_record_result"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"质量负责人"}},[t("a-input",{ref:"userSelect",staticStyle:{width:"100%"},attrs:{placeholder:"请选择质量负责人",open:!1},on:{click:function(t){return e.openSelectUser()}},model:{value:e.checkUserName,callback:function(t){e.checkUserName=t},expression:"checkUserName"}},[t("a-icon",{attrs:{slot:"suffix",type:"ellipsis"},slot:"suffix"})],1)],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"备注"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["remark"],expression:"['remark']",modifiers:{trim:!0}}],attrs:{placeholder:"请输入备注"}})],1)],1)],1),t("user-list",{ref:"userSelectModal",attrs:{multiple:!1},on:{ok:e.onSelectUser}})],1)},o=[],l=a("b245"),i=a("b7b4"),n=a("c1df"),s=a.n(n),c={name:"ConfirmForm",components:{UserList:l["default"]},data:function(){return{title:"检查确认",visible:!1,recordId:"",checkUserName:"",checkUserId:"",model:{},confirmLoading:!1,labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},form:this.$form.createForm(this),validatorRules:{checkDate:{rules:[{required:!0,message:"请选择检查日期!"}]},checkResult:{rules:[{required:!0,message:"请选择检查结果!"}]}}}},mounted:function(){},methods:{confirm:function(e){var t=this;this.form.resetFields(),this.visible=!0,this.confirmLoading=!1,this.recordId=e,this.model=Object.assign({},{checkDate:s()(new Date).format("YYYY-MM-DD")}),this.$nextTick((function(){t.form.setFieldsValue({checkDate:t.model.checkDate})})),this.checkUserName=this.$store.getters.userInfo.realname,this.checkUserId=this.$store.getters.userInfo.id},changeCheckDate:function(e){e&&(this.model.checkDate=e)},handleOk:function(){var e=this;e.form.validateFields((function(t,a){if(!t){e.confirmLoading=!0;var r=Object.assign(e.model,a,{checkDate:s()(e.model.checkDate).format("YYYY-MM-DD"),id:e.recordId,checkUserName:e.checkUserName,checkUserId:e.checkUserId});Object(i["f"])(r).then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok",r),e.close()):e.$message.warning(t.message)})).finally((function(){e.confirmLoading=!1}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},openSelectUser:function(){this.$refs.userSelectModal.showModal(),this.$refs.userSelect.blur()},onSelectUser:function(e){e.length&&(this.checkUserName=e[0].realname,this.checkUserId=e[0].id,this.$forceUpdate())}}},d=c,h=a("2877"),u=Object(h["a"])(d,r,o,!1,null,null,null);t["default"]=u.exports},"3ff1":function(e,t,a){},"45ff":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{ref:"calcHeight"})},o=[],l=a("e8ae"),i=a("21a6"),n=a("8fad"),s="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",c={name:"TableExport",data:function(){return{}},mounted:function(){},methods:{printById:function(e){var t=this;Object(n["xb"])({id:e}).then((function(e){e.success?t.initWorkBook(e.result):t.$message.error("获取记录表详情失败")})).catch((function(e){t.$message.error("获取记录表详情异常")}))},printByData:function(e){this.initWorkBook(e)},initWorkBook:function(e){var t=new l["Workbook"];t.creator="GY",t.lastModifiedBy="2021-10-28",t.created=new Date,t.modified=new Date,t.lastPrinted=new Date;var a=t.addWorksheet("Sheet1",{properties:{defaultColWidth:22,alignment:{vertical:"middle",horizontal:"left",wrapText:!0}},pageSetup:{paperSize:9}}),r=[];a.mergeCells("A1:C1"),a.getCell("A1").value="车号："+(e.trainNo||""),r.push({cell:"A1",horizontal:"left",fill:!0,size:14,bold:!0}),0===e.updown?(a.mergeCells("A2:C2"),a.getCell("A2").value="部件号："+(e.manufNo||""),r.push({cell:"A2",horizontal:"left",fill:!0,size:14,bold:!0})):1===e.updown?(a.mergeCells("A2:C2"),a.getCell("A2").value="原部件序列号："+(e.manufNo||""),r.push({cell:"A2",horizontal:"left",fill:!0,size:14,bold:!0}),a.mergeCells("A3:C3"),a.getCell("A3").value="新部件序列号："+(e.manufNoUp||""),r.push({cell:"A3",horizontal:"left",fill:!0,size:14,bold:!0})):a.mergeCells("A1:C2"),1===e.updown?a.mergeCells("D1:F3"):a.mergeCells("D1:F2"),a.getCell("D1").value=e.title||e.workRecName||"",r.push({cell:"D1",fill:!0,size:14,bold:!0}),a.mergeCells("G1:H1"),a.getCell("G1").value="作业日期："+(e.workDate||""),r.push({cell:"G1",fill:!0,horizontal:"left",size:14,bold:!0}),a.mergeCells("I1:J1"),a.getCell("I1").value="完工日期："+(e.finishDate||""),r.push({cell:"I1",fill:!0,horizontal:"left",size:14,bold:!0}),1===e.updown?a.mergeCells("G2:J3"):a.mergeCells("G2:J2"),a.getCell("G2").value="作业班组："+(e.workGroupName||""),r.push({cell:"G2",fill:!0,horizontal:"left",size:14,bold:!0}),a.getColumn("A").width=15,a.getColumn("B").width=30,a.getColumn("C").width=60,a.getColumn("D").width=15,a.getColumn("E").width=60,a.getColumn("F").width=60,a.getRow(1).height=30,a.getRow(2).height=30,a.getRow(3).height=30,1===e.updown&&(a.getRow(4).height=30);var o={A:"序号",B:"项目",C:"作业内容",D:"控制点",E:"技术要求",F:"作业情况",G:"结果",H:"自检",I:"互检",J:"专检"};for(var n in o)a.getCell(n+(1===e.updown?4:3)).value=o[n],r.push({cell:n+(1===e.updown?4:3),fill:!0,size:14,bold:!0});var c=1===e.updown?5:4,d=0;e.categoryList.forEach((function(e,t){a.getCell("A".concat(c+t)).value=e.recIndex,r.push({cell:"A".concat(c+t)}),a.mergeCells("A".concat(c+t,":A").concat(c+t+e.detailList.length-1)),a.getCell("B".concat(c+t)).value=e.reguTitle,r.push({cell:"B".concat(c+t),horizontal:"left"}),a.mergeCells("B".concat(c+t,":B").concat(c+t+e.detailList.length-1)),e.detailList.forEach((function(e,o){a.getCell("C".concat(c+t+o)).value="\n".concat(e.workContent||"","\n"),r.push({cell:"C".concat(c+t+o),horizontal:"left"}),a.getCell("D".concat(c+t+o)).value=e.checkLevel_dictText||"",r.push({cell:"D".concat(c+t+o)}),a.getCell("E".concat(c+t+o)).value="\n".concat(e.techRequire||"","\n"),r.push({cell:"E".concat(c+t+o),horizontal:"left"}),a.getCell("F".concat(c+t+o)).value=0==e.isIgnore?e.workInfo:e.ignoreDesc,r.push({cell:"F".concat(c+t+o),horizontal:"left"}),a.getCell("G".concat(c+t+o)).value=e.result?"√":"□",r.push({cell:"G".concat(c+t+o)}),a.getCell("H".concat(c+t+o)).value=e.selfCheck||"",r.push({cell:"H".concat(c+t+o)}),a.getCell("I".concat(c+t+o)).value=e.guarderCheck||"",r.push({cell:"I".concat(c+t+o)}),a.getCell("J".concat(c+t+o)).value=e.monitorCheck||"",r.push({cell:"J".concat(c+t+o)})})),c+=e.detailList.length-1,d+=e.detailList.length})),d+=1===e.updown?5:4,a.mergeCells("A".concat(d,":J").concat(d)),a.getRow(d).height=30,r.push({cell:"A".concat(d),bold:!0}),d+=1;var h=e.measureToolList||[];h.length&&(a.mergeCells("A".concat(d,":B").concat(d+h.length-1)),a.getCell("A".concat(d)).value="计量器具使用",r.push({cell:"A".concat(d)}),h.forEach((function(e,t,o){a.mergeCells("C".concat(d+t,":D").concat(d+t)),a.getCell("C".concat(d+t)).value=" \n名称："+(e.name||"")+"\n",r.push({cell:"C".concat(d+t),horizontal:"left"}),a.getCell("E".concat(d+t)).value=" \n规格型号："+(e.model||"")+"\n",r.push({cell:"E".concat(d+t),horizontal:"left"}),a.getCell("F".concat(d+t)).value=" \n出厂编号："+(e.serialNo||"")+"\n",r.push({cell:"F".concat(d+t),horizontal:"left"}),a.mergeCells("G".concat(d+t,":H").concat(d+t)),a.getCell("G".concat(d+t)).value=" \n上次检验时间："+(e.lastCheckTime||"")+"\n",r.push({cell:"G".concat(d+t),horizontal:"left"}),a.mergeCells("I".concat(d+t,":J").concat(d+t)),a.getCell("I".concat(d+t)).value=" \n下次检验时间："+(e.nextCheckTime||"")+"\n",r.push({cell:"I".concat(d+t),horizontal:"left"})})),d+=h.length,a.mergeCells("A".concat(d,":J").concat(d)),a.getRow(d).height=30,r.push({cell:"A".concat(d),bold:!0}),d+=1);var u=["控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。","“自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。","“作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。","“结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。","作业内容中有数据要求的一并填入“作业情况”栏。"];a.mergeCells("A".concat(d,":J").concat(d));var f="";u.forEach((function(e,t,a){f+="".concat(t+1,"、").concat(e).concat(t<a.length-1?"\n":"")})),f="说明：\n"+f+"\n",f="\n检查结果：".concat(0===e.checkResult?"未通过":"通过","                                        检查日期：").concat(e.checkDate||"            ","                                        质量负责人：").concat(e.checkUserName||"            ","\n\n")+f,a.getCell("A".concat(d)).value=f,r.push({cell:"A".concat(d),horizontal:"left",border:top});var m=12*(u.length+4)+18;a.getRow(d).height=m,r.forEach((function(e,t,r){var o=a.getCell(e.cell);o.alignment={vertical:"middle",horizontal:e.horizontal||"center",wrapText:!0},e.fill&&(o.fill={type:"pattern",pattern:"darkGray",fgColor:{argb:"FFe9e9e9"}}),o.font={name:"黑体",family:4,size:e.size||12,underline:!1,bold:e.bold||!1},o.padding={top:10,left:10,bottom:10,right:10},o.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})),t.xlsx.writeBuffer().then((function(t){var a=new Blob([t],{type:s});i["saveAs"](a,"".concat(e.title||e.workRecName,".xlsx"))}))}}},d=c,h=a("2877"),u=Object(h["a"])(d,r,o,!1,null,"dac1198a",null);t["default"]=u.exports},"4b54":function(e,t,a){},8522:function(e,t,a){"use strict";a("f000")},"88da":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,centered:"",visible:e.visible,width:"100%",dialogClass:6===e.operator?"fullDialog":"fullDialog no-footer",destroyOnClose:!0},on:{cancel:function(t){e.visible=!1}}},[t("a-button",{attrs:{"na-btn-type":"print",type:"primary"},on:{click:e.exportPrint}},[e._v("导出打印")]),3===e.formType&&1===e.workRecordType?t("div",{staticClass:"table-page-body",staticStyle:{height:"100%","overflow-y":"auto"}},[t("RecordSheetTable",{directives:[{name:"show",rawName:"v-show",value:e.curRecordData,expression:"curRecordData"}],ref:"recordTable"})],1):e._e(),4===e.formType?t("div",{staticClass:"table-page-body",staticStyle:{height:"100%","overflow-y":"auto"}},[t("JobCheckSheetTable",{ref:"jobCheckTable",attrs:{data:e.sheetData}})],1):e._e(),1===e.formType||3===e.formType&&2===e.workRecordType?t("div",{staticClass:"table-page-body",staticStyle:{height:"100%"}},[t("div",{attrs:{id:"luckysheet"}})]):e._e(),6===e.operator?t("template",{slot:"footer"},[t("a-button",{attrs:{type:"primary"},on:{click:e.confirmForm}},[e._v(" 检查确认")]),t("a-button",{on:{click:function(t){e.visible=!1}}},[e._v(" 关闭")])],1):e._e(),t("ConfirmForm",{ref:"confirmForm",on:{ok:e.handleOk}}),t("WorkRecordPrint",{ref:"workRecordPrint",attrs:{luckySheetId:"luckysheet"},on:{sheetPrintOk:e.onSheetPrintOk}}),t("JobCheckTableExport",{ref:"tablePrintRef"}),t("TableExport",{ref:"tablePrintRef2"})],2)},o=[],l=a("b7b4"),i=a("b9c3"),n=a("958d"),s=a("e0ce"),c=a("3cf2"),d=a("45ff"),h=a("8fad"),u=a("7268"),f=a("25e0"),m=a("10f9"),p=a("e24e"),g={name:"ViewWorkForm",components:{RecordSheetTable:n["default"],ConfirmForm:f["default"],JobCheckSheetTable:s["default"],WorkRecordPrint:m["default"],JobCheckTableExport:c["default"],TableExport:d["default"]},props:{operator:{type:Number,default:0}},data:function(){return{sheetData:{},formType:1,workRecordType:0,formName:"",trainNo:"",groupName:"",visible:!1,fileUrl:"",tableData:[],curRecordData:[],curOnlineForm:null,formSheetId:"",formInfo:{},formInstId:"",onLineInstId:"",defaultOptions:{container:"luckysheet",title:"sheet",column:26,row:50,lang:"zh",allowEdit:!1,showinfobar:!1,sheetFormulaBar:!1,showsheetbar:!1,showstatisticBar:!0,enableAddRow:!1,enableAddCol:!1,showtoolbar:!1},printType:0,allItems:!0}},computed:{title:function(){return"表单查看-"+this.trainNo+"车 "+this.formName}},beforeDestroy:function(){luckysheet.destroy()},methods:{exportPrint:function(){try{var e="";switch(this.trainNo&&(e="-"+this.trainNo+"车"),this.formType){case 1:Object(p["a"])(luckysheet.getAllSheets(),this.formName+e);break;case 3:1===this.workRecordType?this.$refs.tablePrintRef2.printByData(this.curRecordData):2===this.workRecordType&&Object(p["a"])(luckysheet.getAllSheets(),this.formName+e);break;case 4:this.$refs.tablePrintRef.printByRow(this.sheetData)}}catch(t){}},initSheet:function(e){e.scrollLeft=0,e.scrollTop=0;var t=JSON.parse(JSON.stringify(this.defaultOptions));t.data=[e],luckysheet.destroy(),luckysheet.create(t)},showModal:function(e,t){try{this.formInfo=e,this.formType=e.instType,this.workRecordType=e.workRecordType,this.trainNo=t,this.formName=e.formName,this.formInstId=e.formInstId,this.allItems=!1,this.loadFormDetail(!1)}catch(a){}},showModalAllItem:function(e,t){try{this.formInfo=e,this.formType=e.instType,this.trainNo=t,this.formName=e.formName,this.formInstId=e.formInstId,this.allItems=!0,this.loadFormDetail(!0)}catch(a){}},loadFormDetail:function(e){this.printType=0;try{switch(this.formType){case 1:this.formInfo.formObjId=this.formInfo.id,this.loadOnlineFormDetail(this.formInfo.task2InstId,this.formInfo.formInstId);break;case 3:1===this.workRecordType?this.loadRecordTableDetail(this.formInfo.task2InstId,this.formInfo.formInstId,e):2===this.workRecordType&&this.loadWorkRecordDetail(this.formInfo.formObjId,this.formInfo.formInstId);break;case 4:this.loadWorkCheckFormDetail(this.formInfo.task2InstId,this.formInfo.formInstId,e)}}catch(t){}},loadWorkRecordDetail:function(e,t){var a=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.visible=!0,Object(h["rb"])(e).then((function(e){if(e.success){var o=JSON.parse(e.result);if(!r)return void a.initSheet(o);Object(i["U"])(t).then((function(e){if(e.success){if(e.result){var t=JSON.parse(e.result);o.data=[],o.celldata=luckysheet.transToCellData(t)}a.initSheet(o)}else a.initSheet(o)}))}else a.$message.error("获取作业记录表模板数据失败")}))},loadWorkCheckFormDetail:function(e,t){var a=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(i["P"])({task2InstId:e,formInstId:t,allItems:r}).then((function(e){if(e.success&&e.result){var t=e.result;a.sheetData=t,a.visible=!0}else a.$message.error("加载记录数据异常")}))},loadOnlineFormDetail:function(e,t){var a=this;this.visible=!0,Object(i["Q"])({task2InstId:e,formInstId:t,needValues:!1}).then((function(e){if(e.success){a.curOnlineForm=e.result;var t=null;if(a.curOnlineForm){if(a.curOnlineForm.result)try{t=JSON.parse(a.curOnlineForm.result)}catch(r){return void a.$message.error("转换表单填写结果异常")}Object(h["rb"])(a.curOnlineForm.formObjId).then((function(e){if(e.success){var r=JSON.parse(e.result);t&&(r.data=[],r.celldata=luckysheet.transToCellData(t)),a.initSheet(r)}else a.$message.error("获取表单模板数据失败")}))}else a.$message.error("获取作业表单数据失败")}else a.$message.error("获取记录表内容错误")}))},loadRecordTableDetail:function(e,t){var a=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(i["R"])({task2InstId:e,formInstId:t,needChecks:!0,needCategory:!0,allItems:r}).then((function(e){e.success&&e.result?(a.curRecordData=e.result,a.curRecordData.categoryList&&a.curRecordData.categoryList.sort((function(e,t){return e.recIndex-t.recIndex})),a.$nextTick((function(){a.$refs.recordTable.loadData(a.curRecordData)})),a.visible=!0):a.$message.error("加载记录数据异常")}))},confirmForm:function(){this.$refs.confirmForm.confirm(this.formInstId)},handleOk:function(e){if(3===this.formType&&2===this.workRecordType){var t=u["a"].searchCellByText("检查结果",luckysheet.getAllSheets()[0].data),a=t.c;if(t){var r=u["a"].getCellText(t.cell),o="1"===e.checkResult?"通过":"不通过";r=r.replace("检查结果：","检查结果："+o),u["a"].setCellValue(t.r,t.c,r)}t=u["a"].searchCellByText("检查日期",luckysheet.getAllSheets()[0].data);var l=t.c;if(t){var i=u["a"].getCellText(t.cell);i=i.replace("检查日期：","检查日期："+e.checkDate),u["a"].setCellValue(t.r,t.c,i)}t=u["a"].searchCellByText("质量负责人",luckysheet.getAllSheets()[0].data);var n=t.c;if(t){var s=u["a"].getCellText(t.cell);s=s.replace("质量负责人：","质量负责人："+e.checkUserName),u["a"].setCellValue(t.r,t.c,s)}if(a===l&&l===n){var c="1"===e.checkResult?"通过":"不通过",d="检查结果："+c;d+="          检查日期："+e.checkDate,d+="          质量负责人："+e.checkUserName,u["a"].setCellValue(t.r,t.c,d)}this.saveWorkRecord(!1)}this.$emit("checkSuccess",this.formInfo,e),this.visible=!1},saveWorkRecord:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=JSON.stringify(luckysheet.getAllSheets()[0].data),r={formInstId:this.formInfo.formInstId,xlsJson:a};Object(i["hb"])(r).then((function(a){a.success?t&&e.$message.success("保存作业记录表信息成功"):t&&e.$message.error("保存作业记录表信息失败")}))},print:function(){var e={id:this.formInfo.id,instType:this.formType,formInstId:this.formInfo.formInstId,formObjId:this.formInfo.formObjId,formName:this.formName,workRecordType:this.workRecordType};0===this.printType?this.$refs.workRecordPrint.print(e):1===this.printType&&this.$refs.workRecordPrint.printNoData(e)},onSheetPrintOk:function(){0===this.printType?this.loadFormDetail(this.allItems):1===this.printType&&this.loadFormDetailNoData()},showModalNoData:function(e,t){this.formInfo=e,this.formType=e.instType,this.trainNo=t,this.formName=e.formName,this.formInstId=e.formInstId,this.loadFormDetailNoData()},loadFormDetailNoData:function(){this.printType=1;try{switch(this.formType){case 1:this.formInfo.formObjId=this.formInfo.id,this.loadOnlineDetailNoData(this.formInfo.formInstId);break;case 3:1===this.workRecordType?this.loadRecordDetailNoData(this.formInfo.formInstId):2===this.workRecordType&&this.loadWorkRecordDetail(this.formInfo.formObjId||this.formInfo.id,this.formInfo.formInstId,!1);break;case 4:this.loadCheckDetailNoData(this.formInfo.formInstId)}}catch(e){}},loadRecordDetailNoData:function(e){var t=this;Object(h["xb"])({id:e}).then((function(e){e.success&&e.result?(t.curRecordData=e.result,t.curRecordData.categoryList&&t.curRecordData.categoryList.sort((function(e,t){return e.recIndex-t.recIndex})),t.$nextTick((function(){t.$refs.recordTable.loadData(t.curRecordData)})),t.visible=!0):t.$message.error("加载记录数据异常")}))},loadCheckDetailNoData:function(e){var t=this;Object(l["y"])({id:e}).then((function(e){try{if(e.success&&e.result){var a=e.result;t.sheetData=a,t.visible=!0}else t.$message.error("加载记录数据异常")}catch(r){t.$message.error("加载记录数据异常")}}))},loadOnlineDetailNoData:function(e){var t=this;this.visible=!0,Object(h["rb"])(e).then((function(e){if(e.success){var a=JSON.parse(e.result);t.$nextTick((function(){t.initSheet(a)}))}}))}}},v=g,b=(a("f0c5"),a("8522"),a("2877")),y=Object(b["a"])(v,r,o,!1,null,"a7b5b52c",null);t["default"]=y.exports},9527:function(e,t,a){},"958d":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("table",{staticClass:"table"},[t("thead",[t("tr",[t("td",{staticStyle:{padding:"0"},attrs:{colspan:"4",rowspan:"2"}},[e.recordSheet.assetTypeId?e._e():t("span",{staticStyle:{"padding-left":"5px"}},[e._v("车号："+e._s(e.recordSheet.trainNo))]),e.recordSheet.assetTypeId&&0===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",[e._v("部件号："+e._s(e.recordSheet.manufNo))])])]):e._e(),e.recordSheet.assetTypeId&&1===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",{staticClass:"bottom"},[e._v("原部件序列号："+e._s(e.recordSheet.manufNo))])]),t("tr",[t("td",[e._v("新部件序列号："+e._s(e.recordSheet.manufNoUp))])])]):e._e()]),t("td",{staticStyle:{"text-align":"center","font-weight":"bold"},attrs:{colspan:"3",rowspan:"2"}},[e._v(" "+e._s(e.recordSheet.title||e.recordSheet.workRecName)+" ")]),t("td",{attrs:{colspan:"3"}},[e._v("作业日期："+e._s(e.recordSheet.workDate)+" 完工日期: "+e._s(e.recordSheet.finishDate))])]),t("tr",[t("td",{attrs:{colspan:"3"}},[e._v("作业班组："+e._s(e.recordSheet.workGroupName))])]),e._m(0)]),e._l(e.recordSheet.categoryList,(function(a){return t("tbody",{key:a.id},e._l(a.detailList,(function(r,o){return t("tr",{key:r.id},[0===o?t("td",{attrs:{rowspan:a.detailList.length}},[e._v(" "+e._s(a.recIndex)+" ")]):e._e(),0===o?t("td",{attrs:{rowspan:a.detailList.length}},[e._v(" "+e._s(a.reguTitle)+" ")]):e._e(),t("td",[e._v(" "+e._s(r.workContent)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[e._v(" "+e._s(r.checkLevel_dictText)+" ")]),t("td",[e._v(" "+e._s(r.techRequire)+" ")]),t("td",[e._v(" "+e._s(0==r.isIgnore?r.workInfo:r.ignoreDesc)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[1===r.result?t("a-checkbox",{attrs:{checked:"",disabled:""}}):e._e(),0===r.result?t("a-checkbox",{attrs:{disabled:""}}):e._e()],1),t("td",[e._v(" "+e._s(r.selfCheck)+" ")]),t("td",[e._v(" "+e._s(r.guarderCheck)+" ")]),t("td",[e._v(" "+e._s(r.monitorCheck)+" ")])])})),0)})),e._l(e.recordSheet.measureToolList,(function(a,r){return t("tr",{key:r},[0===r?t("td",{attrs:{colspan:"2",rowspan:e.recordSheet.measureToolList.length}},[e._v("计量器具使用")]):e._e(),t("td",{attrs:{colspan:"2"}},[e._v("名称: "+e._s(a.name))]),t("td",[e._v("规格型号："+e._s(a.model))]),t("td",[e._v("出厂编号："+e._s(a.serialNo))]),t("td",{attrs:{colspan:"2"}},[e._v("上次检验时间："+e._s(a.lastCheckTime))]),t("td",{attrs:{colspan:"2"}},[e._v("下次检验时间："+e._s(a.nextCheckTime))])])})),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[e._v("情况说明："+e._s(e.recordSheet.remark))])]),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[t("span",{staticStyle:{"margin-left":"5%"}},[e._v("检查结果："+e._s(0===e.recordSheet.checkResult?"未通过":"通过")+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("检查日期："+e._s(e.recordSheet.checkDate)+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("质量负责人："+e._s(e.recordSheet.checkUserName)+" ")]),e._m(1)])])],2)])},o=[function(){var e=this,t=e._self._c;return t("tr",[t("th",{staticStyle:{width:"60px"}},[e._v("序号")]),t("th",{staticStyle:{width:"100px"}},[e._v("项目")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业内容")]),t("th",{staticStyle:{width:"60px"}},[e._v("控制点")]),t("th",{staticStyle:{width:"200px"}},[e._v("技术要求")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业情况")]),t("th",{staticStyle:{width:"80px"}},[e._v("结果")]),t("th",{staticStyle:{width:"60px"}},[e._v("自检")]),t("th",{staticStyle:{width:"60px"}},[e._v("互检")]),t("th",{staticStyle:{width:"60px"}},[e._v("专检")])])},function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"padding-top":"15px"}},[e._v(" 说明："),t("br"),e._v(" 1. 控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。"),t("br"),e._v(" 2. “自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。"),t("br"),e._v(" 3. “作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。"),t("br"),e._v(" 4. “结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。"),t("br"),e._v(" 5. 作业内容中有数据要求的一并填入“作业情况”栏 。 ")])}],l={name:"RecordSheetTable",data:function(){return{recordSheet:{}}},methods:{loadData:function(e){this.recordSheet=e}}},i=l,n=(a("d88b"),a("2877")),s=Object(n["a"])(i,r,o,!1,null,"197d5722",null);t["default"]=s.exports},b245:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"85%",title:"人员选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",bodyStyle:{height:"70vh"},destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{attrs:{md:4,sm:24}},[t("div",{staticStyle:{height:"calc(70vh - 20px)","border-right":"1px solid #e3e1e1","margin-right":"15px"}},[e.treeData&&e.treeData.length>0?t("a-tree",{staticClass:"limitHeight",attrs:{defaultSelectedKeys:[e.queryParam.depId],defaultExpandAll:!0,"tree-data":e.treeData},on:{select:e.onSelect}}):e._e()],1)]),t("a-col",{attrs:{md:20,sm:24}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"账号"}},[t("a-input",{attrs:{placeholder:"请输入用户账号"},model:{value:e.queryParam.username,callback:function(t){e.$set(e.queryParam,"username",t)},expression:"queryParam.username"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"真实名字"}},[t("a-input",{attrs:{placeholder:"请输入真实名字"},model:{value:e.queryParam.realname,callback:function(t){e.$set(e.queryParam,"realname",t)},expression:"queryParam.realname"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"手机号码"}},[t("a-input",{attrs:{placeholder:"请输入手机号码"},model:{value:e.queryParam.phone,callback:function(t){e.$set(e.queryParam,"phone",t)},expression:"queryParam.phone"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"角色"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"sys_role,role_name,id",placeholder:"选择角色"},model:{value:e.queryParam.roleId,callback:function(t){e.$set(e.queryParam,"roleId",t)},expression:"queryParam.roleId"}})],1)],1),t("a-col",{attrs:{md:2,sm:8}},[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(70vh - 130px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(70vh - 130px)"},attrs:{border:"",align:e.allAlign,data:e.tableData,"max-height":"100%","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"manual",mode:"row"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"5%"}}):t("vxe-table-column",{attrs:{type:"radio",width:"5%"}}),t("vxe-table-column",{attrs:{field:"workNo",title:"工号",width:"100",align:"center"}}),t("vxe-table-column",{attrs:{field:"username",title:"用户账号",width:"150",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"realname",title:"用户名字",width:"100",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"roleNames",title:"角色","min-width":"180",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"sex_dictText",title:"性别",width:"80"}}),t("vxe-table-column",{attrs:{field:"phone",title:"手机号码",width:"120"}}),t("vxe-table-column",{attrs:{field:"orgCode",title:"部门",width:"120",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"80"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)])],1)],1)},o=[],l=a("8fad"),i={name:"UserList",props:{multiple:{type:Boolean,default:!0},depId:{type:String,default:""}},data:function(){return{queryParam:{username:"",realname:"",phone:"",orgCode:"",roleId:void 0,pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,treeData:[]}},watch:{depId:function(e){this.$set(this.queryParam,"depId",e||"")}},mounted:function(){this.$set(this.queryParam,"depId",this.depId||"")},methods:{showModal:function(){this.visible=!0,this.findList(),this.getTreeList()},getTreeList:function(){var e=this;Object(l["mb"])().then((function(t){t.success&&(e.treeData=t.result)}))},onSelect:function(e,t){if(e.length){var a=t.node.dataRef;this.queryParam.depId=a.id,this.findList()}else this.queryParam.orgCode="",this.findList()},findList:function(){var e=this;this.loading=!0,Object(l["gc"])(this.queryParam).then((function(t){e.loading=!1,t.success?(e.totalResult=t.result.total,e.tableData=t.result.records):e.$message.error("加载用户数据失败")})).catch((function(t){e.$message.error("加载用户数据异常")})).finally((function(){}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,Object.assign(this.$data,this.$options.data())}}},n=i,s=(a("f76d"),a("2877")),c=Object(s["a"])(n,r,o,!1,null,"4aa7956f",null);t["default"]=c.exports},d88b:function(e,t,a){"use strict";a("3ff1")},e24e:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a("e8ae"),o=a.n(r),l=a("21a6"),i=a.n(l),n=(a("7268"),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"),s=function(e,t){var a=new o.a.Workbook;"[object Object]"===Object.prototype.toString.call(e)&&(e=[e]),e.forEach((function(e){if(0===e.data.length)return!0;var t=a.addWorksheet(e.name),r=e.config&&e.config.merge||{},o=e.config&&e.config.borderInfo||{},l=e.config&&e.config.columnlen||{},i=e.images||{};return h(i,a,t),d(l,t),c(e.config,t),m(e.data,t),u(r,t),f(o,t),!0}));var r=a.xlsx.writeBuffer().then((function(e){var a=new Blob([e],{type:n});i.a.saveAs(a,"".concat(t,".xlsx"))}));return r},c=function(e,t){if(e&&e.rowlen)for(var a in e.rowlen){var r=parseInt(a),o=parseInt(e.rowlen[a]),l=t.getRow(r+1);l.height=o}},d=function(e,t){for(var a in e){var r=parseInt(a),o=parseInt(e[a]);t.getColumn(r+1).width=parseInt(o/7)}},h=function(e,t,a){for(var r in e){var o=e[r],l=o.src.split(";base64,"),i=l[0].replaceAll("data:image/",""),n=t.addImage({base64:o.src,extension:i}),s=luckysheet.location(o.default.left,o.default.top);a.addImage(n,{tl:{col:s.col,row:s.row},ext:{width:o.default.width,height:o.default.height}})}},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=Object.values(e);a.forEach((function(e){t.mergeCells(e.r+1,e.c+1,e.r+e.rs,e.c+e.cs)}))},f=function(e,t){Array.isArray(e)&&e.forEach((function(e){if("range"===e.rangeType)for(var a=b(e.borderType,e.style,e.color),r=e.range[0],o=r.row,l=r.column,i=o[0]+1;i<o[1]+2;i++)for(var n=l[0]+1;n<l[1]+2;n++)t.getCell(i,n).border=a;if("cell"===e.rangeType){var s=e.value,c=s.col_index,d=s.row_index,h=Object.assign({},e.value);delete h.col_index,delete h.row_index;var u=y(h,d,c);t.getCell(d+1,c+1).border=u}}))},m=function(e,t){Array.isArray(e)&&e.forEach((function(e,a){e.every((function(e,r){if(!e)return!0;var o=p(e.bg),l=g(e.ff,e.fc,e.bl,e.it,e.fs,e.cl,e.ul),i=v(e.vt,e.ht,e.tb,e.tr),n="";e.f?n={formula:e.f,result:e.v}:!e.v&&e.ct&&e.ct.s?e.ct.s.forEach((function(e){n+=e.v})):n=e.v;var s=k(r),c=t.getCell(s+(a+1));for(var d in o){c.fill=o;break}return c.font=l,c.alignment=i,c.value=n,!0}))}))},p=function(e){if(!e)return{};var t={type:"pattern",pattern:"solid",fgColor:{argb:e.replace("#","")}};return t},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000000",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,n={0:"微软雅黑",1:"宋体（Song）",2:"黑体（ST Heiti）",3:"楷体（ST Kaiti）",4:"仿宋（ST FangSong）",5:"新宋体（ST Song）",6:"华文新魏",7:"华文行楷",8:"华文隶书",9:"Arial",10:"Times New Roman ",11:"Tahoma ",12:"Verdana",num2bl:function(e){return 0!==e}},s={name:"number"===typeof e?n[e]:e,family:1,size:o,color:{argb:t.replace("#","")},bold:n.num2bl(a),italic:n.num2bl(r),underline:n.num2bl(i),strike:n.num2bl(l)};return s},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"default",o={vertical:{0:"middle",1:"top",2:"bottom",default:"top"},horizontal:{0:"center",1:"left",2:"right",default:"left"},wrapText:{0:!1,1:!1,2:!0,default:!1},textRotation:{0:0,1:45,2:-45,3:"vertical",4:90,5:-90,default:0}},l={vertical:o.vertical[e],horizontal:o.horizontal[t],wrapText:o.wrapText[a],textRotation:o.textRotation[r]};return l},b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000";if(!e)return{};var r={type:{"border-all":"all","border-top":"top","border-right":"right","border-bottom":"bottom","border-left":"left"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}},o={style:r.style[t],color:{argb:a.replace("#","")}},l={};return"all"===r.type[e]?(l["top"]=o,l["right"]=o,l["bottom"]=o,l["left"]=o):l[r.type[e]]=o,l};function y(e,t,a){var r={},o={type:{l:"left",r:"right",b:"bottom",t:"top"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}};for(var l in e)-1===e[l].color.indexOf("rgb")?r[o.type[l]]={style:o.style[e[l].style],color:{argb:e[l].color.replace("#","")}}:r[o.type[l]]={style:o.style[e[l].style],color:{argb:e[l].color}};return r}function k(e){var t="A".charCodeAt(0),a="Z".charCodeAt(0),r=a-t+1,o="";while(e>=0)o=String.fromCharCode(e%r+t)+o,e=Math.floor(e/r)-1;return o}},f000:function(e,t,a){},f0c5:function(e,t,a){"use strict";a("4b54")},f76d:function(e,t,a){"use strict";a("9527")}}]);