(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b5a1969","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0df437","chunk-2d0df437"],{5633:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("span",[t("a-select",{key:e.key,attrs:{"allow-clear":"",value:e.getValueSting,disabled:e.disabled,placeholder:"线路"},on:{change:e.handleChange,select:e.onSelect}},[t("a-select-option",{attrs:{value:void 0}},[e._v("请选择")]),e._l(e.optionData,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.lineId}},[t("span",{staticStyle:{display:"inline-block",width:"100%"},attrs:{title:a.lineName}},[e._v(" "+e._s(a.lineName)+" ")])])}))],2)],1)},i=[],n=a("8fad"),o={name:"LineSelectList",props:{value:[String],triggerChange:Boolean,disabled:Boolean,defaultFirst:Boolean},data:function(){return{optionData:[],selectValue:"",key:0}},created:function(){this.findList()},computed:{getValueSting:function(){return null!=this.value?this.value.toString():void 0}},methods:{findList:function(){var e=this;Object(n["Jb"])().then((function(t){t.success&&(e.optionData=t.result,e.defaultFirst&&e.optionData&&e.optionData.length>0&&setTimeout((function(){e.$emit("change",e.optionData[0].lineId),e.$emit("input",e.optionData[0].lineId)}),500))}))},handleChange:function(e,t){var a="";if(t&&t.componentOptions.children[0].data&&(a=t.componentOptions.children[0].data.attrs.title),this.$emit("change",e),this.$emit("input",e),this.$emit("changeName",a),this.triggerChange)if(e){var r=this.optionData[t.key];this.$emit("change",e,r)}else this.$emit("change",e,null)},onSelect:function(e,t){if(e){var a=this.optionData[t.data.key];this.$emit("select",e,a)}else this.$emit("select","",null)}}},l=o,s=a("2877"),c=Object(s["a"])(l,r,i,!1,null,"77265147",null);t["default"]=c.exports},"88bc":function(e,t,a){(function(t){var a=1/0,r=9007199254740991,i="[object Arguments]",n="[object Function]",o="[object GeneratorFunction]",l="[object Symbol]",s="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,d=s||c||Function("return this")();function u(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function p(e,t){var a=-1,r=e?e.length:0,i=Array(r);while(++a<r)i[a]=t(e[a],a,e);return i}function m(e,t){var a=-1,r=t.length,i=e.length;while(++a<r)e[i+a]=t[a];return e}var f=Object.prototype,h=f.hasOwnProperty,v=f.toString,b=d.Symbol,g=f.propertyIsEnumerable,w=b?b.isConcatSpreadable:void 0,C=Math.max;function k(e,t,a,r,i){var n=-1,o=e.length;a||(a=j),i||(i=[]);while(++n<o){var l=e[n];t>0&&a(l)?t>1?k(l,t-1,a,r,i):m(i,l):r||(i[i.length]=l)}return i}function y(e,t){return e=Object(e),I(e,t,(function(t,a){return a in e}))}function I(e,t,a){var r=-1,i=t.length,n={};while(++r<i){var o=t[r],l=e[o];a(l,o)&&(n[o]=l)}return n}function x(e,t){return t=C(void 0===t?e.length-1:t,0),function(){var a=arguments,r=-1,i=C(a.length-t,0),n=Array(i);while(++r<i)n[r]=a[t+r];r=-1;var o=Array(t+1);while(++r<t)o[r]=a[r];return o[t]=n,u(e,this,o)}}function j(e){return $(e)||O(e)||!!(w&&e&&e[w])}function L(e){if("string"==typeof e||F(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function O(e){return _(e)&&h.call(e,"callee")&&(!g.call(e,"callee")||v.call(e)==i)}var $=Array.isArray;function R(e){return null!=e&&N(e.length)&&!S(e)}function _(e){return D(e)&&R(e)}function S(e){var t=P(e)?v.call(e):"";return t==n||t==o}function N(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}function P(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function D(e){return!!e&&"object"==typeof e}function F(e){return"symbol"==typeof e||D(e)&&v.call(e)==l}var T=x((function(e,t){return null==e?{}:y(e,p(k(t,1),L))}));e.exports=T}).call(this,a("c8ba"))},f9332:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:"80%",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{staticStyle:{width:"100%"}},[t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"规程编码"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["code",e.validatorRules.code],expression:"['code', validatorRules.code]",modifiers:{trim:!0}}]})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"规程名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["name",e.validatorRules.name],expression:"['name', validatorRules.name]",modifiers:{trim:!0}}]})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属修程"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["repairProId",e.validatorRules.repairProId],expression:"['repairProId', validatorRules.repairProId]"}],attrs:{triggerChange:"",dictCode:"bu_repair_program,name,id"},on:{change:e.handlerRepairPro}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属车间"}},[t("j-dict-select-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["workshopId",e.validatorRules.workshopId],expression:"['workshopId', validatorRules.workshopId]"}],attrs:{triggerChange:"",dictCode:"bu_mtr_workshop,name,id"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属线路"}},[t("line-select-list",{directives:[{name:"decorator",rawName:"v-decorator",value:["lineId",e.validatorRules.lineId],expression:"['lineId', validatorRules.lineId]"}],attrs:{"trigger-change":!0},on:{change:e.handlerLine}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"版本号"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["version",e.validatorRules.version],expression:"['version', validatorRules.version]"}]})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"备注描述"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark",e.validatorRules.remark],expression:"['remark', validatorRules.remark]"}]})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"导入规程"}},[t("a-upload",{attrs:{multiple:!1,"file-list":e.fileList,accept:".xlsx,.xls",remove:e.handleRemove,"before-upload":e.beforeUpload}},[t("a-button",{attrs:{type:"primary"}},[e._v("添加文件")])],1)],1)],1)],1)],1)],1)],1)},i=[],n=a("88bc"),o=a.n(n),l=a("8fad"),s=a("4ec3"),c=a("ca00"),d=a("5633"),u={name:"LeftItemModal",components:{LineSelectList:d["default"]},data:function(){return{value:1,title:"操作",visibleCheck:!0,visible:!1,model:{},fileList:[],trainTypeId:"",labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{code:{rules:[{required:!0,message:"请输入规程编码!"},{validator:this.validateCode},{max:32,message:"输入长度不能超过32字符!"}]},name:{rules:[{required:!0,message:"请输入规程名称!"},{max:32,message:"输入长度不能超过32字符!"}]},repairProId:{rules:[{required:!0,message:"请选择所属修程!"}]},lineId:{rules:[{required:!0,message:"请选择所属线路!"}]},workshopId:{rules:[{required:!0,message:"请选择所属车间!"}]},remark:{rules:[{max:200,message:"输入长度不能超过200字符!"}]},version:{rules:[{max:16,message:"输入长度不能超过16字符!"}]}}}},created:function(){},methods:{handlerRepairPro:function(e,t){t&&(this.model.repairProName=t.title)},handlerLine:function(e,t){t&&(this.trainTypeId=t.trainTypeId)},handleRemove:function(e){var t=this.fileList.indexOf(e),a=this.fileList.slice();a.splice(t,1),this.fileList=a},beforeUpload:function(e){this.model.id&&this.$message.warn("该操作会覆盖原有的规程项,请谨慎使用!");var t=e.size/1024/1024<10;if(t){var a="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type||"application/vnd.ms-excel"===e.type;if(a)return this.$set(this.fileList,0,e),!1;this.$message.error("只支持Excel文件导入!")}else this.$message.error("文件不得大于10MB!")},customRequest:function(e){var t=this,a=this.fileList;a.forEach((function(a){var r=new FormData;r.append("file",a),r.append("name",e.name),r.append("code",e.code),r.append("repairProId",e.repairProId),r.append("lineId",e.lineId),r.append("workshopId",e.workshopId),r.append("trainTypeId",t.trainTypeId),r.append("version",e.version),r.append("remark",e.remark),t.model.id?r.append("id",t.model.id):r.append("id",""),Object(l["zc"])(r).then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok"),t.close()):t.$message.error(e.message)})).finally((function(){t.confirmLoading=!1}))}))},validateCode:function(e,t,a){var r={tableName:"bu_repair_regu_info",fieldName:"code",fieldVal:t,dataId:this.model.id};Object(c["e"])(t)?a():Object(s["m"])(r).then((function(e){e.success?a():a(e.message)}))},add:function(){this.edit({})},edit:function(e){var t=this;e.id?this.visiblekey=!0:this.visiblekey=!1,this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue(o()(t.model,"code","name","lineId","workshopId","repairProId","version","remark"))}))},handleOk:function(){var e=this;e.form.validateFields((function(t,a){if(!t){e.confirmLoading=!0;var r=Object.assign(e.model,a);e.fileList.length>0?e.customRequest(r):Object(l["vd"])(r).then((function(t){t.success?(e.$message.success(t.message),e.$emit("ok",!0),e.confirmLoading=!1,e.close()):e.$message.warning(t.message)}))}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,this.fileList=[]}}},p=u,m=a("2877"),f=Object(m["a"])(p,r,i,!1,null,null,null);t["default"]=f.exports}}]);