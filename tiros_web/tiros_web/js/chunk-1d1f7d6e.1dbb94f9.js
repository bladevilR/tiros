(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1d1f7d6e","chunk-24cb054c"],{9527:function(e,t,a){},a525:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,width:490,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"负责人"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["userName",e.validatorRules.userName],expression:"[ 'userName', validatorRules.userName ]"}],ref:"myuserSelect",attrs:{placeholder:"请选择负责人",open:!1,showArrow:!0},on:{focus:e.openuserModal}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},slot:"suffixIcon"})],1)],1)],1)],1)],1)],1),t("user-list",{ref:"UserModalForm",attrs:{multiple:!0},on:{ok:e.addTarget}})],1)},i=[],l=a("b9c3"),s=a("b245"),n={name:"ToolsManageModal",components:{UserList:s["default"]},data:function(){return{title:"操作",visible:!1,UserId:"",UserName:"",model:{},labelCol:{xs:{span:24},sm:{span:9}},wrapperCol:{xs:{span:24},sm:{span:10}},isClose:!1,confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{userName:{rules:[{required:!0,message:"请选择!"}]}}}},created:function(){},methods:{changeClose:function(e){this.isClose=e},set:function(e){var t=this;e.id?this.isClose=!(!e["close"]||1!=e["close"]):this.isClose=!1,this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue({userName:t.model.userName})}))},openuserModal:function(){this.$refs.UserModalForm.showModal(),this.$refs.myuserSelect.blur()},addTarget:function(e){e.length&&(this.UserName=e[0].realname,this.UserId=e[0].id),this.form.setFieldsValue({userName:this.UserName})},handleOk:function(){var e=this,t=this;t.form.validateFields((function(a,r){if(!a){t.confirmLoading=!0;var i,s=Object.assign(t.model,r);s["userId"]=t.UserId,i=Object(l["jb"])(s),i.then((function(e){e.success?(t.$message.success(e.message),t.$emit("ok")):t.$message.warning(e.message)})).finally((function(){t.confirmLoading=!1,t.close()})),e.visible=!1}}))},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1}}},o=n,c=a("2877"),u=Object(c["a"])(o,r,i,!1,null,"152b8f22",null);t["default"]=u.exports},b245:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"85%",title:"人员选择",visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",bodyStyle:{height:"70vh"},destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("a-row",[t("a-col",{attrs:{md:4,sm:24}},[t("div",{staticStyle:{height:"calc(70vh - 20px)","border-right":"1px solid #e3e1e1","margin-right":"15px"}},[e.treeData&&e.treeData.length>0?t("a-tree",{staticClass:"limitHeight",attrs:{defaultSelectedKeys:[e.queryParam.depId],defaultExpandAll:!0,"tree-data":e.treeData},on:{select:e.onSelect}}):e._e()],1)]),t("a-col",{attrs:{md:20,sm:24}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"账号"}},[t("a-input",{attrs:{placeholder:"请输入用户账号"},model:{value:e.queryParam.username,callback:function(t){e.$set(e.queryParam,"username",t)},expression:"queryParam.username"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"真实名字"}},[t("a-input",{attrs:{placeholder:"请输入真实名字"},model:{value:e.queryParam.realname,callback:function(t){e.$set(e.queryParam,"realname",t)},expression:"queryParam.realname"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"手机号码"}},[t("a-input",{attrs:{placeholder:"请输入手机号码"},model:{value:e.queryParam.phone,callback:function(t){e.$set(e.queryParam,"phone",t)},expression:"queryParam.phone"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"角色"}},[t("j-dict-select-tag",{attrs:{triggerChange:!0,dictCode:"sys_role,role_name,id",placeholder:"选择角色"},model:{value:e.queryParam.roleId,callback:function(t){e.$set(e.queryParam,"roleId",t)},expression:"queryParam.roleId"}})],1)],1),t("a-col",{attrs:{md:2,sm:8}},[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(70vh - 130px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(70vh - 130px)"},attrs:{border:"",align:e.allAlign,data:e.tableData,"max-height":"100%","show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{},"edit-config":{trigger:"manual",mode:"row"}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"5%"}}):t("vxe-table-column",{attrs:{type:"radio",width:"5%"}}),t("vxe-table-column",{attrs:{field:"workNo",title:"工号",width:"100",align:"center"}}),t("vxe-table-column",{attrs:{field:"username",title:"用户账号",width:"150",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"realname",title:"用户名字",width:"100",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"roleNames",title:"角色","min-width":"180",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"sex_dictText",title:"性别",width:"80"}}),t("vxe-table-column",{attrs:{field:"phone",title:"手机号码",width:"120"}}),t("vxe-table-column",{attrs:{field:"orgCode",title:"部门",width:"120",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"80"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)])],1)],1)},i=[],l=a("8fad"),s={name:"UserList",props:{multiple:{type:Boolean,default:!0},depId:{type:String,default:""}},data:function(){return{queryParam:{username:"",realname:"",phone:"",orgCode:"",roleId:void 0,pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,treeData:[]}},watch:{depId:function(e){this.$set(this.queryParam,"depId",e||"")}},mounted:function(){this.$set(this.queryParam,"depId",this.depId||"")},methods:{showModal:function(){this.visible=!0,this.findList(),this.getTreeList()},getTreeList:function(){var e=this;Object(l["yb"])().then((function(t){t.success&&(e.treeData=t.result)}))},onSelect:function(e,t){if(e.length){var a=t.node.dataRef;this.queryParam.depId=a.id,this.findList()}else this.queryParam.orgCode="",this.findList()},findList:function(){var e=this;this.loading=!0,Object(l["uc"])(this.queryParam).then((function(t){e.loading=!1,t.success?(e.totalResult=t.result.total,e.tableData=t.result.records):e.$message.error("加载用户数据失败")})).catch((function(t){e.$message.error("加载用户数据异常")})).finally((function(){}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,Object.assign(this.$data,this.$options.data())}}},n=s,o=(a("f76d"),a("2877")),c=Object(o["a"])(n,r,i,!1,null,"4aa7956f",null);t["default"]=c.exports},d5f8:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bodyWrapper"},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"工具"}},[t("a-input",{attrs:{placeholder:"请输入名称或编码",allowClear:""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"状态"}},[t("j-dict-select-tag",{attrs:{placeholder:"请选择",dictCode:"bu_tools_status"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",{attrs:{md:6,sm:8}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{attrs:{disabled:1!=e.records.length},on:{click:function(t){return e.handleSet(e.records[0])}}},[e._v("分配责任人")]),t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)])],1)],1)],1),t("div",{staticStyle:{height:"calc(100vh - 225px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(100vh - 225px)"},attrs:{border:"","auto-resize":"","max-height":"100%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","cell-class-name":e.cellClassName,"checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{trigger:"manual",mode:"row"}},on:{"checkbox-change":e.checkboxChange,"checkbox-all":e.checkboxChange}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{title:"工具名称","min-width":"150",align:"left","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("a",{on:{click:function(t){return t.stopPropagation(),e.jumpInfo(r)}}},[e._v(e._s(r.name))])]}}])}),t("vxe-table-column",{attrs:{field:"code",title:"物资编码",width:"200"}}),t("vxe-table-column",{attrs:{field:"assetCode",title:"资产编号",width:"200"}}),t("vxe-table-column",{attrs:{field:"toolType_dictText",title:"架大修类别",width:"100"}}),t("vxe-table-column",{attrs:{field:"amount",title:"数量",width:"100",align:"right","header-align":"center"}}),t("vxe-table-column",{attrs:{field:"nextCheckTime",title:"下次送检",width:"150"}}),t("vxe-table-column",{attrs:{field:"isOverTime",title:"是否逾期",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.getIsOverTimeStatus(a))+" ")]}}])}),t("vxe-table-column",{attrs:{field:"isOverTimeDays",title:"逾期天数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.getIsOverTimeDays(a))+" ")]}}])}),t("vxe-table-column",{attrs:{field:"userName",title:"保管人姓名",width:"100"}}),t("vxe-table-column",{attrs:{field:"entryDate",title:"入库日期",width:"100"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"100"}}),t("vxe-table-column",{attrs:{field:"warehouseName",title:"库位",width:"200"}}),t("vxe-table-column",{attrs:{field:"serviceInterval",title:"送检间隔",width:"100"}}),t("vxe-table-column",{attrs:{field:"entraceDate",title:"入场使用日期",width:"110"}}),t("vxe-table-column",{attrs:{field:"lifetime",title:"使用寿命",width:"100"}}),t("vxe-table-column",{attrs:{field:"expirDate",title:"有效期",width:"100"}}),t("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"180"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1),t("tools-manage-modal",{ref:"modalForm",on:{ok:function(t){return e.loadData()}}}),t("user-list",{ref:"UserModalForm",attrs:{multiple:!1},on:{ok:e.addTarget}}),t("a-modal",{attrs:{title:"工具详情",width:"90%",centered:"",visible:e.visible,dialogClass:"fullDialog no-footer",forceRender:!0},on:{cancel:e.handleCancel}},[t("tools-manage-info",{ref:"toolsManageInfo"})],1)],1)},i=[],l=a("b9c3"),s=a("a525"),n=a("2b0e"),o=a("9fb0"),c=a("b245"),u=a("9ba5"),d={name:"ToolsManagePage",components:{ToolsManageModal:s["default"],UserList:c["default"],ToolsManageInfo:u["default"]},data:function(){return{visible:!1,queryParam:{searchText:"",status:"",groupId:"",pageNo:1,pageSize:10},totalResult:0,allAlign:"center",tableData:[],count:"",editData:{},records:[]}},created:function(){this.findList()},methods:{checkboxChange:function(e){this.records=e.records},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1,this.$refs.toolsManageInfo.close()},addTarget:function(e){var t=this;e.length&&(this.editData["userId"]=e[0].id,Object(l["jb"])(this.editData).then((function(e){e.success?(t.$message.success(e.message),t.findList()):t.$message.error(e.message)})))},findList:function(){var e=this;this.loading=!0;var t=n["default"].ls.get(o["s"]);this.queryParam.groupId=t.departId,Object(l["O"])(this.queryParam).then((function(t){e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},handleSet:function(e){this.editData=e,this.$refs.UserModalForm.showModal()},loadData:function(){this.findList()},jumpInfo:function(e){this.visible=!0,this.$refs.toolsManageInfo.show({id:e.id})},getIsOverTimeDays:function(e){if(e.nextCheckTime){var t=this.$moment(new Date).format("YYYY-MM-DD"),a=this.$moment(e.nextCheckTime).diff(t,"day");if(a<0)return Math.abs(a)}return""},getIsOverTimeStatus:function(e){if(e.nextCheckTime){var t=this.$moment(new Date).format("YYYY-MM-DD"),a=this.$moment(e.nextCheckTime).diff(t,"day");return a<0?"是":"否"}return"否"},cellClassName:function(e){var t=e.row,a=(e.rowIndex,e.column),r=(e.columnIndex,["nextCheckTime","isOverTime","isOverTimeDays"]);if(r.includes(a.property)&&t.nextCheckTime){var i=this.$moment(new Date).format("YYYY-MM-DD"),l=this.$moment(t.nextCheckTime).diff(i,"day");if("nextCheckTime"===a.property){if(l<=0)return"table-cell-bg-red";if(l>0&&l<=15)return"table-cell-bg-yellow"}if("isOverTime"===a.property&&l<0)return"table-cell-bg-red";if("isOverTimeDays"===a.property&&l<0)return"table-cell-bg-red"}}}},m=d,h=a("2877"),f=Object(h["a"])(m,r,i,!1,null,"f7ccdd60",null);t["default"]=f.exports},f76d:function(e,t,a){"use strict";a("9527")}}]);