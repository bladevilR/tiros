(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-798f5732","chunk-cfae2090","chunk-0f12fa96","chunk-535429be","chunk-29096d72","chunk-1945f686","chunk-58d495c5","chunk-2d0c17f7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0c89b7","chunk-2d0cc598"],{"2cb5":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",centered:"",title:e.title,visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchQuery.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"名称"}},[t("a-input",{attrs:{placeholder:"名称或编码","allow-clear":""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"状态"}},[t("j-dict-select-tag",{attrs:{dictCode:"bu_enable"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}})],1)],1),t("a-col",{attrs:{md:3,sm:12}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-button",{on:{click:e.searchQuery}},[e._v("查询")])],1)])],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 85px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 85px)"},attrs:{border:"","max-height":"100%","row-id":"id",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","radio-config":e.multiple?{}:{trigger:"row",checkMethod:e.checkRadioMethod},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,checkMethod:e.checkRadioMethod}:{},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"name",title:"名称","tree-node":"",align:"left"}}),t("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"code",title:"编码",width:"15%"}}),t("vxe-table-column",{attrs:{field:"structType_dictText",title:"类型",width:"10%"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"10%"}}),t("vxe-table-column",{attrs:{field:"placeCode",title:"位置编码",width:"15%"}}),t("vxe-table-column",{attrs:{field:"placeDesc",title:"位置描述",width:"15%"}})],1)],1)])},i=[],o=a("8fad"),l={name:"TrainAssetType",props:{trainTypeId:{type:String,default:""},parentId:{type:String,default:null},multiple:{type:Boolean,default:!0},title:{type:String,default:"设备类型选择"},canSelectType:{type:Array,default:function(){return[1,2,3,4]}}},data:function(){return{queryParam:{trainTypeId:"",id:"",searchText:"",status:null,structType:null},allAlign:"center",tableData:[],treeData:[],selectParent:"",visible:!1,confirmLoading:!1}},mounted:function(){},methods:{showModal:function(){this.visible=!0,this.queryParam.trainTypeId=this.trainTypeId,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.visible=!1},handleCancel:function(){this.$emit("cancel"),this.close()},close:function(){this.$emit("close"),this.visible=!1},findList:function(){var e=this;this.loading=!0,this.parentId&&(this.queryParam.id=this.parentId),this.selectParent&&(this.queryParam.id=this.selectParent),Object(o["Qd"])(this.queryParam).then((function(t){t.success&&(e.loading=!1,e.tableData=t.result)}))},findSelectList:function(){var e=this,t={id:this.parentId,trainTypeId:this.trainTypeId};this.parentId&&(t.id=this.parentId),Object(o["Qd"])(t).then((function(t){t.success&&(e.loading=!1,e.treeData=t.result.map((function(t){return e.genSelectTreeNode(t)})))}))},loadChildrenMethod:function(e){var t=this,a=e.row,r={trainTypeId:this.trainTypeId,id:a.id};return new Promise((function(e){Object(o["Qd"])(r).then((function(a){a.success?e(a.result):t.$message.error("".concat(a.msg))}))}))},loadSelectNodeMethod:function(e){var t=this,a={trainTypeId:this.trainTypeId,id:e.dataRef.id,searchText:this.queryParam.searchText,status:this.queryParam.status,structType:this.queryParam.structType};return new Promise((function(e){Object(o["Qd"])(a).then((function(e){e.success?e.result.map((function(e){t.treeData=t.treeData.concat(t.genSelectTreeNode(e))})):t.$message.warning(e.message)})),e()}))},genSelectTreeNode:function(e){return{id:e.id,pId:e.parentId,value:e.id,title:e.name,isLeaf:!e.hasChildren}},searchQuery:function(){this.findList()},checkRadioMethod:function(e){var t=e.row;return this.canSelectType.indexOf(t.structType)>-1}}},n=l,s=(a("9589"),a("2877")),c=Object(s["a"])(n,r,i,!1,null,"52968c59",null);t["default"]=c.exports},"2f2f":function(e,t,a){},3737:function(e,t,a){"use strict";a("2f2f")},37582:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:e.title,centered:"",bodyStyle:{height:"80vh"},visible:e.visible,confirmLoading:e.confirmLoading,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("na-splitter",{staticStyle:{height:"calc(80vh - 15px)"},attrs:{defaultSize:200}},[t("div",{staticStyle:{"overflow-y":"auto","overflow-x":"hidden","padding-right":"2px"},attrs:{slot:"left-panel"},slot:"left-panel"},[t("a-menu",{attrs:{mode:"inline","default-selected-keys":e.defaultSelect},on:{click:e.handleMenuClick}},[t("a-menu-item",{key:1},[t("a-icon",{attrs:{type:"pie-chart"}}),t("span",[e._v("数据记录表")])],1),t("a-menu-item",{key:3},[t("a-icon",{attrs:{type:"pie-chart"}}),t("span",[e._v("作业记录表【新】")])],1),t("a-menu-item",{key:4},[t("a-icon",{attrs:{type:"pie-chart"}}),t("span",[e._v("检查记录表")])],1)],1)],1),t("div",{staticStyle:{"padding-left":"5px","padding-right":"3px"},attrs:{slot:"right-panel"},slot:"right-panel"},[t("div",[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline","label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:7,sm:24}},[t("a-form-item",{attrs:{label:"表单名称"}},[t("a-input",{attrs:{placeholder:"请输入表单名称"},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol,label:"线路"}},[t("line-select-list",{model:{value:e.queryParam.lineId,callback:function(t){e.$set(e.queryParam,"lineId",t)},expression:"queryParam.lineId"}})],1)],1),t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{"label-col":e.formItemLayout.labelCol,"wrapper-col":e.formItemLayout.wrapperCol,label:"所属修程"}},[t("j-dict-select-tag",{attrs:{triggerChange:"",dictCode:"bu_repair_program,name,id"},model:{value:e.queryParam.repairProId,callback:function(t){e.$set(e.queryParam,"repairProId",t)},expression:"queryParam.repairProId"}})],1)],1),t("a-col",{attrs:{md:3,sm:8}},[t("a-form-item",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(80vh - 135px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 135px)"},attrs:{border:"","max-height":"100%",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","edit-config":{trigger:"manual",mode:"row"},"radio-config":e.multiple?{}:{trigger:"row"},"checkbox-config":e.multiple?{trigger:"row",highlight:!0,range:!0}:{}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{title:"-",width:"80"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("span",[t("a",{on:{click:function(t){return t.stopPropagation(),e.handleSeeing(r)}}},[e._v("预览")])])]}}])}),t("vxe-table-column",{attrs:{field:"title",title:3===e.formType?"作业记录表名称":1===e.formType?"数据记录表":4===e.formType?"检查记录表":"",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{width:"100",align:"left","header-align":"center",field:"code",title:"编码"}}),t("vxe-table-column",{attrs:{field:"lineName",title:"线路",width:"100"}}),4===e.formType?t("vxe-table-column",{attrs:{field:"repairProName",title:"修程",width:"100"}}):e._e(),1===e.formType||3===e.formType?t("vxe-table-column",{attrs:{field:"repairProgramName",title:"修程",width:"100"}}):e._e(),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("div",{style:{backgroundColor:e.statusColor[r.status+""],borderRadius:"4px"}},[e._v(" "+e._s(r.status_dictText)+" ")])]}}])}),t("vxe-table-column",{attrs:{field:"reguName",title:"所属规程",width:"120"}}),t("vxe-table-column",{attrs:{field:"reguVersion",title:"规程版本",width:"100"}}),t("vxe-table-column",{attrs:{field:"remark",title:"备注",align:"left","header-align":"center"}})],1),t("vxe-pager",{attrs:{perfect:"","current-page":e.queryParam.pageNo,"page-size":e.queryParam.pageSize,total:e.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:current-page":function(t){return e.$set(e.queryParam,"pageNo",t)},"update:pageSize":function(t){return e.$set(e.queryParam,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParam,"pageSize",t)},"page-change":e.handlePageChange}})],1)]),t("RecordTableView",{ref:"recordTableView"}),t("JobCheckTableView",{ref:"jobCheckTableView"}),t("FormViewModal",{ref:"formViewModal"})],1)])],1)},i=[],o=a("b7b4"),l=a("8fad"),n=a("4ec3"),s=a("e18e"),c=a("7e9e"),d=a("aaa8"),u=a("3dbe"),h=a("5633"),f={name:"FormsList",components:{NaSplitter:s["default"],RecordTableView:c["default"],FormViewModal:u["default"],LineSelectList:h["default"],JobCheckTableView:d["default"]},props:{title:{type:String,default:"表单选择"},multiple:{type:Boolean,default:!0}},data:function(){return{fileName:"",formItemLayout:{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},statusColor:{0:"#dedede",1:"#bad795"},queryParam:{name:"",workstationId:"",lineId:"",repairProId:"",status:1,pageNo:1,pageSize:10},formType:3,workRecordType:2,defaultSelect:[3],dictCode:"bu_mtr_workstation,name,id",allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1,stationData:[],isShowPlan:!1}},methods:{handleSeeing:function(e){var t=this;3===this.formType&&1===this.workRecordType&&this.$refs.recordTableView.show(e.id),(1===this.formType||3===this.formType&&2===this.workRecordType)&&this.$refs.formViewModal.showModal(e.id),4===this.formType&&Object(o["A"])({id:e.id}).then((function(e){if(e.success&&e.result){var a=e.result;t.$refs.jobCheckTableView.show(a)}else t.$message.error("加载记录数据异常")}))},showModal:function(e){e&&e.lineId&&(this.queryParam.lineId=e.lineId),e&&e.repairProgramId&&(this.queryParam.repairProId=e.repairProgramId),this.visible=!0,this.isShowPlan=!1,this.formType=3,this.workRecordType=2,this.defaultSelect=[3],this.findList()},showModalByPlan:function(e){this.visible=!0,this.isShowPlan=!0,this.formType=3,this.workRecordType=2,this.defaultSelect=[3],this.queryParam.planId=e,this.findList()},initDictData:function(){var e=this;Object(n["u"])(this.dictCode)?this.stationData=Object(n["u"])(this.dictCode):Object(n["f"])(this.dictCode).then((function(t){t.success&&(e.stationData=t.result)}))},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},initParamByFormType:function(){3===this.formType&&(this.queryParam.category="1328995639249358850",this.queryParam.type=1,this.workRecordType=2),1===this.formType&&(this.queryParam.category="1328995580210335746",this.queryParam.type=1,this.workRecordType=0)},findList:function(){var e=this;this.loading=!0,this.initParamByFormType(),(1===this.formType||3===this.formType&&2===this.workRecordType)&&Object(l["Sc"])(this.queryParam).then((function(t){t.success&&(e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records)})),4===this.formType&&Object(l["xc"])(this.queryParam).then((function(t){t.success&&(e.totalResult=t.result.total,e.loading=!1,e.tableData=t.result.records)}))},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.queryParam.pageNo=t,this.queryParam.pageSize=a,this.findList()},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord());var t="";1===this.formType&&(t="数据记录表"),3===this.formType&&(1===this.workRecordType&&(t="作业记录表(老)"),2===this.workRecordType&&(t="作业记录表(新)")),4===this.formType&&(t="检查记录表"),this.$emit("ok",{formType:this.formType,workRecordType:this.workRecordType,formTypeName:t,forms:e}),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},handleMenuClick:function(e){this.formType!==e.key&&(this.formType=e.key,this.queryParam.name="",this.initParamByFormType(),this.findList())}}},m=f,p=(a("3737"),a("2877")),g=Object(p["a"])(m,r,i,!1,null,"1ecb454d",null);t["default"]=g.exports},"3c2d":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%","overflow-x":"hidden"}},[t("a-button",{attrs:{"na-btn-type":"print",type:"primary"},on:{click:e.exportPrint}},[e._v("导出打印")]),t("div",{staticStyle:{margin:"0px",padding:"0px",width:"100%",height:"calc(100vh - 85px)"},attrs:{id:"luckysheet"}}),e.showLoading?t("div",{staticStyle:{width:"100%","text-align":"center",position:"absolute",top:"0px",height:"100%","font-size":"16px","z-index":"1000000000",background:"#fff"}},[e._m(0)]):e._e()],1)},i=[function(){var e=this,t=e._self._c;return t("div",{staticStyle:{position:"relative",top:"45%",width:"100%"}},[t("div",{staticClass:"luckysheetLoaderGif"}),t("span",[e._v("加载中...")])])}],o=a("8fad"),l=a("2410"),n=a.n(l),s=a("e24e"),c={name:"view",props:["customId","formName"],data:function(){return{showLoading:!1,defaultOptions:{container:"luckysheet",title:"sheet",column:26,row:50,lang:"zh",allowEdit:!0,showinfobar:!1,sheetFormulaBar:!1,showsheetbar:!1,showstatisticBar:!0,enableAddRow:!1,enableAddCol:!1,showtoolbar:!1}}},beforeDestroy:function(){luckysheet.destroy()},mounted:function(){var e=this,t=n()(this.defaultOptions);t.data=[{name:"Sheet1",color:"",status:"1",order:"0",index:0,ch_width:2044,rh_height:1080}],this.customId?Object(o["Db"])(this.customId).then((function(e){if(e.success){var a=JSON.parse(e.result);a.scrollLeft=0,a.scrollTop=0,t.showtoolbarConfig={},a.config.authority={sheet:1,hintText:"禁止编辑",allowRangeList:[]},t.data=[a],luckysheet.destroy(),luckysheet.create(t)}})).catch((function(a){e.$message.error("加载表单内容异常"),luckysheet.destroy(),luckysheet.create(t)})):(luckysheet.destroy(),luckysheet.create(t))},methods:{exportPrint:function(){try{var e=this.formName;e||(e="export"),Object(s["a"])(luckysheet.getAllSheets(),e)}catch(t){}}}},d=c,u=a("2877"),h=Object(u["a"])(d,r,i,!1,null,"22edf2fe",null);t["default"]=h.exports},"3dbe":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"表单查看",width:"100%",dialogClass:"fullDialog no-footer",visible:e.visible,footer:null,destroyOnClose:!0},on:{cancel:function(t){e.visible=!1}}},[t("FormView",{attrs:{"custom-id":e.customId,"form-name":e.formName}})],1)},i=[],o=a("3c2d"),l={name:"FormViewModal",components:{FormView:o["default"]},props:["formName"],data:function(){return{visible:!1,customId:null}},methods:{showModal:function(e){e&&(this.customId=e,this.visible=!0)}}},n=l,s=a("2877"),c=Object(s["a"])(n,r,i,!1,null,"65a9461c",null);t["default"]=c.exports},"3ff1":function(e,t,a){},4186:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{centered:"",width:"100%",title:"计划表单关联",dialogClass:"fullDialog no-footer",visible:e.visible,confirmLoading:e.loading,footer:null,destroyOnClose:!0},on:{ok:e.close,cancel:e.close}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"表单名称"}},[t("a-input",{attrs:{placeholder:"请输入内容",allowClear:""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:4,sm:24}},[t("a-form-item",{attrs:{label:"表单类型"}},[t("a-select",{attrs:{allowClear:""},model:{value:e.queryParam.formType,callback:function(t){e.$set(e.queryParam,"formType",t)},expression:"queryParam.formType"}},[t("a-select-option",{attrs:{value:3}},[e._v(" 作业记录表")]),t("a-select-option",{attrs:{value:1}},[e._v(" 数据记录表")]),t("a-select-option",{attrs:{value:4}},[e._v(" 检查记录表")])],1)],1)],1),t("a-col",{attrs:{md:6,sm:8}},[t("a-form-item",[t("a-space",[t("a-button",{staticClass:"primary-color",on:{click:e.loadForms}},[e._v("查询")]),t("a-button",{staticClass:"primary-color",attrs:{type:"dashed"},on:{click:e.handleAdd}},[e._v("添加")]),t("a-button",{staticClass:"primary-color",attrs:{type:"dashed"},on:{click:e.importForms}},[e._v("批量导入")]),t("a-button",{attrs:{type:"dashed"},on:{click:e.handleDel}},[e._v("删除")])],1)],1)],1)],1)],1)],1),t("div",{staticStyle:{height:"calc(100vh - 135px)"}},[t("vxe-table",{ref:"listTable",attrs:{border:"",height:"auto",align:"center",data:e.forms,"edit-rules":e.validRules,"edit-config":{key:"id",trigger:"manual",mode:"row",autoClear:!1,showStatus:!0}},on:{"update:data":function(t){e.forms=t}}},[t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),t("vxe-table-column",{attrs:{field:"formName",title:"表单名称","min-width":"180","edit-render":{name:"input"},align:"left","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("a",{on:{click:function(t){return e.handleSeeing(r)}}},[e._v(e._s(r.title))])]}},{key:"edit",fn:function(a){var r=a.row;return[t("a-input",{ref:"formSelect",staticStyle:{width:"100%"},attrs:{placeholder:"请选择表单",open:!1},model:{value:r.title,callback:function(t){e.$set(r,"title",t)},expression:"row.title"}},[t("a-icon",{attrs:{slot:"suffix",type:"ellipsis"},on:{click:function(t){return e.openFormSelectModal(r)}},slot:"suffix"})],1)]}}])}),t("vxe-table-column",{attrs:{field:"formType_dictText",title:"表单类型",width:"120","edit-render":{name:"input"}},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(3!==a.formType?a.formType_dictText:1===a.workRecordType?"作业记录表(老)":"作业记录表(新)")+" ")]}},{key:"edit",fn:function(a){var r=a.row;return[t("a-input",{attrs:{placeholder:"请选择表单",disabled:""},model:{value:r.formType_dictText,callback:function(t){e.$set(r,"formType_dictText",t)},expression:"row.formType_dictText"}})]}}])}),t("vxe-table-column",{attrs:{field:"reguName",title:"所属规程",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.reguName)+" ")]}},{key:"edit",fn:function(a){var r=a.row;return[t("a-input",{attrs:{placeholder:"请选择表单",disabled:""},model:{value:r.reguName,callback:function(t){e.$set(r,"reguName",t)},expression:"row.reguName"}})]}}])}),t("vxe-table-column",{attrs:{field:"reguVersion",title:"规程版本",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.reguVersion)+" ")]}},{key:"edit",fn:function(a){var r=a.row;return[t("a-input",{attrs:{placeholder:"请选择表单",disabled:""},model:{value:r.reguVersion,callback:function(t){e.$set(r,"reguVersion",t)},expression:"row.reguVersion"}})]}}])}),t("vxe-table-column",{attrs:{field:"trainStructName",title:"关联设备",width:"160","edit-render":{name:"input"},align:"left","header-align":"center"},scopedSlots:e._u([{key:"edit",fn:function(a){var r=a.row;return[t("a-select",{ref:"trainStruct",staticStyle:{width:"100%"},attrs:{placeholder:"请选择关联设备",open:!1},on:{focus:function(t){return e.openAssetTypeModal(r)}},model:{value:r.trainStructName,callback:function(t){e.$set(r,"trainStructName",t)},expression:"row.trainStructName"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"ellipsis"},on:{click:function(t){return e.openAssetTypeModal(r)}},slot:"suffixIcon"})],1)]}}])}),t("vxe-table-column",{attrs:{field:"remark",title:"备注",width:"160","edit-render":{name:"input"},align:"left","header-align":"center"},scopedSlots:e._u([{key:"edit",fn:function(a){var r=a.row;return[t("a-input",{attrs:{maxLength:201,placeholder:"请输入备注"},on:{change:function(t){return e.remarkChangeValue(r)}},model:{value:r.remark,callback:function(t){e.$set(r,"remark",t)},expression:"row.remark"}})]}}])}),t("vxe-table-column",{attrs:{title:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[e.$refs.listTable.isActiveByRow(r)?[t("a-space",[t("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(t){return e.saveRowEvent(r)}}},[e._v("保存")]),t("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(t){return e.cancelRowEvent(r)}}},[e._v("取消")])],1)]:[t("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(t){return e.editRowEvent(r)}}},[e._v("编辑")])]]}}])})],1)],1),t("FormsList",{ref:"modalForm",attrs:{multiple:!1},on:{ok:e.onSelectForm}}),t("FormsList",{ref:"modalForms",on:{ok:e.onSelectForms}}),t("RecordTableView",{ref:"recordTableView"}),t("FormViewModal",{ref:"formViewModal"}),t("JobCheckTableView",{ref:"jobCheckTableView"}),t("train-structure-list",{ref:"assetSelect",attrs:{multiple:!1,"line-id":e.lineId},on:{ok:e.addTrainStruct}})],1)},i=[],o=a("ca00"),l=a("5633"),n=a("37582"),s=a("2cb5"),c=a("8fad"),d=a("7e9e"),u=a("aaa8"),h=a("3dbe"),f=a("b7b4"),m=a("4e0a"),p={name:"PlanForms",components:{FormsList:n["default"],TrainAssetType:s["default"],RecordTableView:d["default"],JobCheckTableView:u["default"],FormViewModal:h["default"],TrainStructureList:m["default"],LineSelectList:l["default"]},data:function(){return{queryParam:{tpPlanId:"",searchText:"",formType:""},title:"表单关联管理",visible:!1,loading:!1,curEditMode:0,curRow:null,validRules:{title:[{required:!0,message:"表单必须选择"}],remark:[{max:200,type:"string",message:"备注不能超过200个字符"}]},lineId:"",repairProgramId:"",forms:[],planId:"",trainTypeId:""}},methods:{remarkChangeValue:function(e){var t=e.remark;t.length>200&&this.$message.error("备注不能超过200个字符")},show:function(e){this.planId=e.id,this.trainTypeId=e.trainTypeId,this.lineId=e.lineId,this.repairProgramId=e.repairProgramId,this.loadForms(),this.visible=!0},close:function(){this.$emit("close"),this.visible=!1,Object.assign(this.$data,this.$options.data())},loadForms:function(){var e=this;this.forms=[],this.queryParam.tpPlanId=this.planId,Object(c["Rc"])(this.queryParam).then((function(t){t.success?e.forms=t.result:e.$message.error("获取模板表单失败")})).catch((function(t){e.$message.error("获取模板表单异常")}))},handleAdd:function(){var e=this;if(!(this.curEditMode>0)){this.curEditMode=1;var t={id:Object(o["p"])(),tpPlanId:this.planId,formName:""};this.$refs.listTable.insertAt(t,-1).then((function(t){var a=t.row;e.$refs.listTable.setActiveCell(a,"remark")}))}},importForms:function(){this.$refs.listTable.getActiveRecord()||this.$refs.modalForms.showModal({lineId:this.lineId,repairProgramId:this.repairProgramId})},handleDel:function(){var e=this,t=this.$refs.listTable.getCheckboxRecords();t.length<=0?this.$message.warn("请选择要删除的记录"):this.$confirm({content:"是否删除选中".concat(t.length,"条数据？"),okText:"确定",cancelText:"取消",onOk:function(){var a=t.map((function(e){return e.id})).join(",");Object(c["N"])("ids="+a).then((function(a){a.success?(t.forEach((function(t){e.forms.forEach((function(a,r){t.id===a.id&&e.forms.splice(r,1)}))})),e.$message.success("删除成功")):e.$message.error("删除失败")})).catch((function(t){e.$message.error("删除异常")}))}})},editRowEvent:function(e){this.curEditMode=2,this.$refs.listTable.setActiveRow(e)},delRowEvent:function(e){var t=this;this.forms.map((function(a,r){e.id===a.id?Object(c["N"])("ids="+e.id).then((function(e){e.success?(t.forms.splice(r,1),t.$message.success("删除成功")):t.$message.error("删除失败")})).catch((function(e){t.$message.error("删除异常")})):t.$message.error("删除失败")}))},saveRowEvent:function(e){var t=this;this.$refs.listTable.validate(e,(function(a){a||(1===t.curEditMode&&Object(c["k"])(e).then((function(a){a.success?(t.forms.push(e),t.$refs.listTable.clearActived(),t.curEditMode=0,t.$message.success("保存成功")):t.$message.error("保存失败")})).catch((function(e){t.$message.error("保存异常")})),2===t.curEditMode&&Object(c["kb"])(e).then((function(e){e.success?(t.$refs.listTable.clearActived(),t.curEditMode=0):t.$message.error("保存失败")})).catch((function(e){t.$message.error("保存异常")})))}))},cancelRowEvent:function(e){this.$refs.listTable.clearActived(),1===this.curEditMode&&this.$refs.listTable.remove(e),this.curEditMode=0},openFormSelectModal:function(e){this.curRow=e,this.$refs.modalForm.showModal({lineId:this.lineId,repairProgramId:this.repairProgramId}),this.$refs.formSelect.blur()},onSelectForm:function(e){if(e&&e.forms.length>0){var t=e.forms[0];this.curRow.title=t.title,this.curRow.objId=t.id,this.curRow.formType=t.formType,this.curRow.formType_dictText=t.formType_dictText,this.curRow.workRecordType=t.workRecordType,this.curRow.reguId=t.reguId,this.curRow.reguName=t.reguName,this.curRow.reguVersion=t.reguVersion}else this.curRow.title="",this.curRow.objId="",this.curRow.formType="",this.curRow.formType_dictText="",this.curRow.workRecordType=0,this.curRow.reguId="",this.curRow.reguName="",this.curRow.reguVersion=""},onSelectForms:function(e){var t=this;e&&e.forms.length>0&&e.forms.forEach((function(e){if(t.forms.find((function(t){return t.objId===e.id})))t.$message.warn("".concat(e.title," 已经在列表中存在"));else{var a={id:Object(o["p"])(),tpPlanId:t.planId,title:e.title,assetTypeName:null,formType:e.formType,formType_dictText:e.formType_dictText,workRecordType:e.workRecordType,objId:e.id,remark:null,reguId:e.reguId,reguName:e.reguName,reguVersion:e.reguVersion};Object(c["k"])(a).then((function(e){e.success?(t.forms.push(a),t.$refs.listTable.clearActived(),t.curEditMode=0):t.$message.error("保存失败")})).catch((function(e){t.$message.error("保存异常")}))}}))},openAssetTypeModal:function(e){this.curRow=e,this.$refs.assetSelect.showModal(),this.$refs.trainStruct.blur()},onCancelAssetTypeSelect:function(){},handleSeeing:function(e){var t=this;1===e.formType&&this.$refs.formViewModal.showModal(e.objId),3===e.formType&&(1===e.workRecordType?this.$refs.recordTableView.show(e.objId):2===e.workRecordType&&this.$refs.formViewModal.showModal(e.objId)),4===e.formType&&Object(f["A"])({id:e.objId}).then((function(e){if(e.success&&e.result){var a=e.result;t.$refs.jobCheckTableView.show(a)}else t.$message.error("加载记录数据异常")}))},addTrainStruct:function(e){Object(o["e"])(e)||(this.$set(this.curRow,"trainStructName",e[0].name),this.$set(this.curRow,"trainStructId",e[0].id))}}},g=p,v=a("2877"),b=Object(v["a"])(g,r,i,!1,null,"1187ab86",null);t["default"]=b.exports},"45ff":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{ref:"calcHeight"})},i=[],o=a("e8ae"),l=a("21a6"),n=a("8fad"),s="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",c={name:"TableExport",data:function(){return{}},mounted:function(){},methods:{printById:function(e){var t=this;Object(n["Kb"])({id:e}).then((function(e){e.success?t.initWorkBook(e.result):t.$message.error("获取记录表详情失败")})).catch((function(e){t.$message.error("获取记录表详情异常")}))},printByData:function(e){this.initWorkBook(e)},initWorkBook:function(e){var t=new o["Workbook"];t.creator="GY",t.lastModifiedBy="2021-10-28",t.created=new Date,t.modified=new Date,t.lastPrinted=new Date;var a=t.addWorksheet("Sheet1",{properties:{defaultColWidth:22,alignment:{vertical:"middle",horizontal:"left",wrapText:!0}},pageSetup:{paperSize:9}}),r=[];a.mergeCells("A1:C1"),a.getCell("A1").value="车号："+(e.trainNo||""),r.push({cell:"A1",horizontal:"left",fill:!0,size:14,bold:!0}),0===e.updown?(a.mergeCells("A2:C2"),a.getCell("A2").value="部件号："+(e.manufNo||""),r.push({cell:"A2",horizontal:"left",fill:!0,size:14,bold:!0})):1===e.updown?(a.mergeCells("A2:C2"),a.getCell("A2").value="原部件序列号："+(e.manufNo||""),r.push({cell:"A2",horizontal:"left",fill:!0,size:14,bold:!0}),a.mergeCells("A3:C3"),a.getCell("A3").value="新部件序列号："+(e.manufNoUp||""),r.push({cell:"A3",horizontal:"left",fill:!0,size:14,bold:!0})):a.mergeCells("A1:C2"),1===e.updown?a.mergeCells("D1:F3"):a.mergeCells("D1:F2"),a.getCell("D1").value=e.title||e.workRecName||"",r.push({cell:"D1",fill:!0,size:14,bold:!0}),a.mergeCells("G1:H1"),a.getCell("G1").value="作业日期："+(e.workDate||""),r.push({cell:"G1",fill:!0,horizontal:"left",size:14,bold:!0}),a.mergeCells("I1:J1"),a.getCell("I1").value="完工日期："+(e.finishDate||""),r.push({cell:"I1",fill:!0,horizontal:"left",size:14,bold:!0}),1===e.updown?a.mergeCells("G2:J3"):a.mergeCells("G2:J2"),a.getCell("G2").value="作业班组："+(e.workGroupName||""),r.push({cell:"G2",fill:!0,horizontal:"left",size:14,bold:!0}),a.getColumn("A").width=15,a.getColumn("B").width=30,a.getColumn("C").width=60,a.getColumn("D").width=15,a.getColumn("E").width=60,a.getColumn("F").width=60,a.getRow(1).height=30,a.getRow(2).height=30,a.getRow(3).height=30,1===e.updown&&(a.getRow(4).height=30);var i={A:"序号",B:"项目",C:"作业内容",D:"控制点",E:"技术要求",F:"作业情况",G:"结果",H:"自检",I:"互检",J:"专检"};for(var n in i)a.getCell(n+(1===e.updown?4:3)).value=i[n],r.push({cell:n+(1===e.updown?4:3),fill:!0,size:14,bold:!0});var c=1===e.updown?5:4,d=0;e.categoryList.forEach((function(e,t){a.getCell("A".concat(c+t)).value=e.recIndex,r.push({cell:"A".concat(c+t)}),a.mergeCells("A".concat(c+t,":A").concat(c+t+e.detailList.length-1)),a.getCell("B".concat(c+t)).value=e.reguTitle,r.push({cell:"B".concat(c+t),horizontal:"left"}),a.mergeCells("B".concat(c+t,":B").concat(c+t+e.detailList.length-1)),e.detailList.forEach((function(e,i){a.getCell("C".concat(c+t+i)).value="\n".concat(e.workContent||"","\n"),r.push({cell:"C".concat(c+t+i),horizontal:"left"}),a.getCell("D".concat(c+t+i)).value=e.checkLevel_dictText||"",r.push({cell:"D".concat(c+t+i)}),a.getCell("E".concat(c+t+i)).value="\n".concat(e.techRequire||"","\n"),r.push({cell:"E".concat(c+t+i),horizontal:"left"}),a.getCell("F".concat(c+t+i)).value=0==e.isIgnore?e.workInfo:e.ignoreDesc,r.push({cell:"F".concat(c+t+i),horizontal:"left"}),a.getCell("G".concat(c+t+i)).value=e.result?"√":"□",r.push({cell:"G".concat(c+t+i)}),a.getCell("H".concat(c+t+i)).value=e.selfCheck||"",r.push({cell:"H".concat(c+t+i)}),a.getCell("I".concat(c+t+i)).value=e.guarderCheck||"",r.push({cell:"I".concat(c+t+i)}),a.getCell("J".concat(c+t+i)).value=e.monitorCheck||"",r.push({cell:"J".concat(c+t+i)})})),c+=e.detailList.length-1,d+=e.detailList.length})),d+=1===e.updown?5:4,a.mergeCells("A".concat(d,":J").concat(d)),a.getRow(d).height=30,r.push({cell:"A".concat(d),bold:!0}),d+=1;var u=e.measureToolList||[];u.length&&(a.mergeCells("A".concat(d,":B").concat(d+u.length-1)),a.getCell("A".concat(d)).value="计量器具使用",r.push({cell:"A".concat(d)}),u.forEach((function(e,t,i){a.mergeCells("C".concat(d+t,":D").concat(d+t)),a.getCell("C".concat(d+t)).value=" \n名称："+(e.name||"")+"\n",r.push({cell:"C".concat(d+t),horizontal:"left"}),a.getCell("E".concat(d+t)).value=" \n规格型号："+(e.model||"")+"\n",r.push({cell:"E".concat(d+t),horizontal:"left"}),a.getCell("F".concat(d+t)).value=" \n出厂编号："+(e.serialNo||"")+"\n",r.push({cell:"F".concat(d+t),horizontal:"left"}),a.mergeCells("G".concat(d+t,":H").concat(d+t)),a.getCell("G".concat(d+t)).value=" \n上次检验时间："+(e.lastCheckTime||"")+"\n",r.push({cell:"G".concat(d+t),horizontal:"left"}),a.mergeCells("I".concat(d+t,":J").concat(d+t)),a.getCell("I".concat(d+t)).value=" \n下次检验时间："+(e.nextCheckTime||"")+"\n",r.push({cell:"I".concat(d+t),horizontal:"left"})})),d+=u.length,a.mergeCells("A".concat(d,":J").concat(d)),a.getRow(d).height=30,r.push({cell:"A".concat(d),bold:!0}),d+=1);var h=["控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。","“自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。","“作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。","“结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。","作业内容中有数据要求的一并填入“作业情况”栏。"];a.mergeCells("A".concat(d,":J").concat(d));var f="";h.forEach((function(e,t,a){f+="".concat(t+1,"、").concat(e).concat(t<a.length-1?"\n":"")})),f="说明：\n"+f+"\n",f="\n检查结果：".concat(0===e.checkResult?"未通过":"通过","                                        检查日期：").concat(e.checkDate||"            ","                                        质量负责人：").concat(e.checkUserName||"            ","\n\n")+f,a.getCell("A".concat(d)).value=f,r.push({cell:"A".concat(d),horizontal:"left",border:top});var m=12*(h.length+4)+18;a.getRow(d).height=m,r.forEach((function(e,t,r){var i=a.getCell(e.cell);i.alignment={vertical:"middle",horizontal:e.horizontal||"center",wrapText:!0},e.fill&&(i.fill={type:"pattern",pattern:"darkGray",fgColor:{argb:"FFe9e9e9"}}),i.font={name:"黑体",family:4,size:e.size||12,underline:!1,bold:e.bold||!1},i.padding={top:10,left:10,bottom:10,right:10},i.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})),t.xlsx.writeBuffer().then((function(t){var a=new Blob([t],{type:s});l["saveAs"](a,"".concat(e.title||e.workRecName,".xlsx"))}))}}},d=c,u=a("2877"),h=Object(u["a"])(d,r,i,!1,null,"dac1198a",null);t["default"]=h.exports},"4e0a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:"90%",title:"车辆设备选择",centered:"",visible:e.visible,bodyStyle:{height:"80vh"},cancelText:"关闭",destroyOnClose:!0},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.findList.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:8}},[t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{attrs:{placeholder:"名称或编码","allow-clear":""},model:{value:e.queryParam.searchText,callback:function(t){e.$set(e.queryParam,"searchText",t)},expression:"queryParam.searchText"}})],1)],1),t("a-col",{attrs:{md:9,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-space",[t("a-button",{on:{click:e.findList}},[e._v("查询")])],1)],1)])],1)],1)],1),t("div",{staticClass:"tableHeight",staticStyle:{height:"calc(80vh - 85px)"}},[t("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 85px)"},attrs:{border:"","row-id":"id",align:e.allAlign,data:e.tableData,"show-overflow":"tooltip","max-height":"100%","radio-config":{trigger:e.multiple?"default":"row",highlight:!0,checkMethod:e.checkRadioMethod},"checkbox-config":{trigger:e.multiple?"row":"default",highlight:!0,checkStrictly:!0,checkMethod:e.checkRadioMethod},"tree-config":{lazy:!0,children:"children",hasChild:"hasChildren",loadMethod:e.loadChildrenMethod}}},[e.multiple?t("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):t("vxe-table-column",{attrs:{type:"radio",width:"40"}}),t("vxe-table-column",{attrs:{field:"name",title:"名称","tree-node":"",align:"left","header-align":"center"}}),t("vxe-table-column",{attrs:{align:"left","header-align":"center",field:"code",title:"编码",width:"150"}}),t("vxe-table-column",{attrs:{field:"structType_dictText",title:"类型",width:"120"}}),t("vxe-table-column",{attrs:{field:"status_dictText",title:"状态",width:"100"}}),t("vxe-table-column",{attrs:{field:"placeId",title:"位置编码",width:"150"}}),t("vxe-table-column",{attrs:{field:"placeDesc",title:"位置描述",width:"200",align:"left","header-align":"center"}})],1)],1)])},i=[],o=a("8fad"),l={name:"TrainStructureList",props:{multiple:{type:Boolean,default:!1},canSelectType:{type:Array,default:function(){return[1,2,3,4]}},lineId:{type:String,default:""}},data:function(){return{visible:!1,queryParam:{id:"",searchText:"",status:null,trainStructId:""},selectParent:{},labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}},allAlign:"center",tableData:[],trainStructId:""}},methods:{showModal:function(e){this.queryParam.trainStructId=e,this.queryParam.lineId=this.lineId,this.trainStructId=e,this.visible=!0,this.findList()},findList:function(){var e=this;Object(o["pc"])(this.queryParam).then((function(t){t.success&&(e.tableData=t.result)}))},loadChildrenMethod:function(e){var t=this,a=e.row,r={trainStructId:this.trainStructId,id:a.id};return new Promise((function(e){Object(o["pc"])(r).then((function(a){a.success?e(a.result):t.$message.error("".concat(a.msg))}))}))},handleOk:function(){var e=[];this.multiple?e=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&e.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",e),this.close()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},checkRadioMethod:function(e){var t=e.row;return this.canSelectType.indexOf(t.structType)>-1}}},n=l,s=a("2877"),c=Object(s["a"])(n,r,i,!1,null,"5f613a8e",null);t["default"]=c.exports},5633:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("span",[t("a-select",{key:e.key,attrs:{"allow-clear":"",value:e.getValueSting,disabled:e.disabled,placeholder:"线路"},on:{change:e.handleChange,select:e.onSelect}},[t("a-select-option",{attrs:{value:void 0}},[e._v("请选择")]),e._l(e.optionData,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.lineId}},[t("span",{staticStyle:{display:"inline-block",width:"100%"},attrs:{title:a.lineName}},[e._v(" "+e._s(a.lineName)+" ")])])}))],2)],1)},i=[],o=a("8fad"),l={name:"LineSelectList",props:{value:[String],triggerChange:Boolean,disabled:Boolean,defaultFirst:Boolean},data:function(){return{optionData:[],selectValue:"",key:0}},created:function(){this.findList()},computed:{getValueSting:function(){return null!=this.value?this.value.toString():void 0}},methods:{findList:function(){var e=this;Object(o["Jb"])().then((function(t){t.success&&(e.optionData=t.result,e.defaultFirst&&e.optionData&&e.optionData.length>0&&setTimeout((function(){e.$emit("change",e.optionData[0].lineId),e.$emit("input",e.optionData[0].lineId)}),500))}))},handleChange:function(e,t){var a="";if(t&&t.componentOptions.children[0].data&&(a=t.componentOptions.children[0].data.attrs.title),this.$emit("change",e),this.$emit("input",e),this.$emit("changeName",a),this.triggerChange)if(e){var r=this.optionData[t.key];this.$emit("change",e,r)}else this.$emit("change",e,null)},onSelect:function(e,t){if(e){var a=this.optionData[t.data.key];this.$emit("select",e,a)}else this.$emit("select","",null)}}},n=l,s=a("2877"),c=Object(s["a"])(n,r,i,!1,null,"77265147",null);t["default"]=c.exports},7237:function(e,t,a){},"7e9e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,centered:"",width:"100%",dialogClass:"fullDialog no-footer",visible:e.visible,confirmLoading:e.loading,footer:null,cancelText:"关闭",destroyOnClose:!0},on:{ok:e.close,cancel:e.close}},[t("a-button",{attrs:{"na-btn-type":"print",type:"primary"},on:{click:e.print}},[e._v("导出")]),t("RecordSheetTable",{directives:[{name:"show",rawName:"v-show",value:e.recordSheet,expression:"recordSheet"}],ref:"recordTable"}),t("div",{staticStyle:{height:"20px"}}),t("TableExport",{ref:"tablePrintRef"})],1)},i=[],o=a("8fad"),l=a("958d"),n=a("45ff"),s={name:"RecordTableView",components:{RecordSheetTable:l["default"],TableExport:n["default"]},props:{},data:function(){return{title:"记录表查看",visible:!1,loading:!1,recordId:"",recordSheet:{}}},mounted:function(){},methods:{show:function(e){this.recordId=e,this.loadData(),this.visible=!0},close:function(){this.$emit("close"),this.visible=!1},loadData:function(){var e=this;Object(o["Kb"])({id:this.recordId}).then((function(t){t.success?(e.recordSheet=t.result,e.$refs.recordTable.loadData(e.recordSheet)):e.$message.error("获取记录表详情失败")})).catch((function(t){e.$message.error("获取记录表详情异常")}))},print:function(){this.$refs.tablePrintRef.printById(this.recordId)}}},c=s,d=a("2877"),u=Object(d["a"])(c,r,i,!1,null,"a8b3abda",null);t["default"]=u.exports},9589:function(e,t,a){"use strict";a("7237")},"958d":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",[t("table",{staticClass:"table"},[t("thead",[t("tr",[t("td",{staticStyle:{padding:"0"},attrs:{colspan:"4",rowspan:"2"}},[e.recordSheet.assetTypeId?e._e():t("span",{staticStyle:{"padding-left":"5px"}},[e._v("车号："+e._s(e.recordSheet.trainNo))]),e.recordSheet.assetTypeId&&0===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",[e._v("部件号："+e._s(e.recordSheet.manufNo))])])]):e._e(),e.recordSheet.assetTypeId&&1===e.recordSheet.updown?t("table",{staticClass:"innerTable"},[t("tr",[t("td",{staticClass:"bottom"},[e._v("车号："+e._s(e.recordSheet.trainNo))])]),t("tr",[t("td",{staticClass:"bottom"},[e._v("原部件序列号："+e._s(e.recordSheet.manufNo))])]),t("tr",[t("td",[e._v("新部件序列号："+e._s(e.recordSheet.manufNoUp))])])]):e._e()]),t("td",{staticStyle:{"text-align":"center","font-weight":"bold"},attrs:{colspan:"3",rowspan:"2"}},[e._v(" "+e._s(e.recordSheet.title||e.recordSheet.workRecName)+" ")]),t("td",{attrs:{colspan:"3"}},[e._v("作业日期："+e._s(e.recordSheet.workDate)+" 完工日期: "+e._s(e.recordSheet.finishDate))])]),t("tr",[t("td",{attrs:{colspan:"3"}},[e._v("作业班组："+e._s(e.recordSheet.workGroupName))])]),e._m(0)]),e._l(e.recordSheet.categoryList,(function(a){return t("tbody",{key:a.id},e._l(a.detailList,(function(r,i){return t("tr",{key:r.id},[0===i?t("td",{attrs:{rowspan:a.detailList.length}},[e._v(" "+e._s(a.recIndex)+" ")]):e._e(),0===i?t("td",{attrs:{rowspan:a.detailList.length}},[e._v(" "+e._s(a.reguTitle)+" ")]):e._e(),t("td",[e._v(" "+e._s(r.workContent)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[e._v(" "+e._s(r.checkLevel_dictText)+" ")]),t("td",[e._v(" "+e._s(r.techRequire)+" ")]),t("td",[e._v(" "+e._s(0==r.isIgnore?r.workInfo:r.ignoreDesc)+" ")]),t("td",{staticStyle:{"text-align":"center"}},[1===r.result?t("a-checkbox",{attrs:{checked:"",disabled:""}}):e._e(),0===r.result?t("a-checkbox",{attrs:{disabled:""}}):e._e()],1),t("td",[e._v(" "+e._s(r.selfCheck)+" ")]),t("td",[e._v(" "+e._s(r.guarderCheck)+" ")]),t("td",[e._v(" "+e._s(r.monitorCheck)+" ")])])})),0)})),e._l(e.recordSheet.measureToolList,(function(a,r){return t("tr",{key:r},[0===r?t("td",{attrs:{colspan:"2",rowspan:e.recordSheet.measureToolList.length}},[e._v("计量器具使用")]):e._e(),t("td",{attrs:{colspan:"2"}},[e._v("名称: "+e._s(a.name))]),t("td",[e._v("规格型号："+e._s(a.model))]),t("td",[e._v("出厂编号："+e._s(a.serialNo))]),t("td",{attrs:{colspan:"2"}},[e._v("上次检验时间："+e._s(a.lastCheckTime))]),t("td",{attrs:{colspan:"2"}},[e._v("下次检验时间："+e._s(a.nextCheckTime))])])})),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[e._v("情况说明："+e._s(e.recordSheet.remark))])]),t("tr",[t("td",{staticStyle:{height:"80px"},attrs:{colspan:"10"}},[t("span",{staticStyle:{"margin-left":"5%"}},[e._v("检查结果："+e._s(0===e.recordSheet.checkResult?"未通过":"通过")+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("检查日期："+e._s(e.recordSheet.checkDate)+" ")]),t("span",{staticStyle:{"margin-left":"30%"}},[e._v("质量负责人："+e._s(e.recordSheet.checkUserName)+" ")]),e._m(1)])])],2)])},i=[function(){var e=this,t=e._self._c;return t("tr",[t("th",{staticStyle:{width:"60px"}},[e._v("序号")]),t("th",{staticStyle:{width:"100px"}},[e._v("项目")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业内容")]),t("th",{staticStyle:{width:"60px"}},[e._v("控制点")]),t("th",{staticStyle:{width:"200px"}},[e._v("技术要求")]),t("th",{staticStyle:{width:"200px"}},[e._v("作业情况")]),t("th",{staticStyle:{width:"80px"}},[e._v("结果")]),t("th",{staticStyle:{width:"60px"}},[e._v("自检")]),t("th",{staticStyle:{width:"60px"}},[e._v("互检")]),t("th",{staticStyle:{width:"60px"}},[e._v("专检")])])},function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"padding-top":"15px"}},[e._v(" 说明："),t("br"),e._v(" 1. 控制点分为H点和W点，“H”点为该项工序操作过程必须经过专业工程师现场检查确认的工序，“W”点为班组长可在工序完工后确认的工序。"),t("br"),e._v(" 2. “自检”栏为作业者本人进行签字；“互检”栏由作业监护人员进行检查签字；“专检”栏由班组长进行检查签字。“质量负责人”由相关专业工程师进行签字。"),t("br"),e._v(" 3. “作业情况”需根据实际情况填写。若该项工序无异常则由作业者在框中填入√；若该项工序存在异常，则将实际故障情况填入框内。"),t("br"),e._v(" 4. “结果”栏方框在完成该项作业及检查后，由工班长进行填写。若无异常则在方框内填入√，若有异常，工班长需对故障情况进行确认，在方框内填入×，并将故障在“备注”栏进行汇总。"),t("br"),e._v(" 5. 作业内容中有数据要求的一并填入“作业情况”栏 。 ")])}],o={name:"RecordSheetTable",data:function(){return{recordSheet:{}}},methods:{loadData:function(e){this.recordSheet=e}}},l=o,n=(a("d88b"),a("2877")),s=Object(n["a"])(l,r,i,!1,null,"197d5722",null);t["default"]=s.exports},d88b:function(e,t,a){"use strict";a("3ff1")},e24e:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a("e8ae"),i=a.n(r),o=a("21a6"),l=a.n(o),n=(a("7268"),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"),s=function(e,t){var a=new i.a.Workbook;"[object Object]"===Object.prototype.toString.call(e)&&(e=[e]),e.forEach((function(e){if(0===e.data.length)return!0;var t=a.addWorksheet(e.name),r=e.config&&e.config.merge||{},i=e.config&&e.config.borderInfo||{},o=e.config&&e.config.columnlen||{},l=e.images||{};return u(l,a,t),d(o,t),c(e.config,t),m(e.data,t),h(r,t),f(i,t),!0}));var r=a.xlsx.writeBuffer().then((function(e){var a=new Blob([e],{type:n});l.a.saveAs(a,"".concat(t,".xlsx"))}));return r},c=function(e,t){if(e&&e.rowlen)for(var a in e.rowlen){var r=parseInt(a),i=parseInt(e.rowlen[a]),o=t.getRow(r+1);o.height=i}},d=function(e,t){for(var a in e){var r=parseInt(a),i=parseInt(e[a]);t.getColumn(r+1).width=parseInt(i/7)}},u=function(e,t,a){for(var r in e){var i=e[r],o=i.src.split(";base64,"),l=o[0].replaceAll("data:image/",""),n=t.addImage({base64:i.src,extension:l}),s=luckysheet.location(i.default.left,i.default.top);a.addImage(n,{tl:{col:s.col,row:s.row},ext:{width:i.default.width,height:i.default.height}})}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=Object.values(e);a.forEach((function(e){t.mergeCells(e.r+1,e.c+1,e.r+e.rs,e.c+e.cs)}))},f=function(e,t){Array.isArray(e)&&e.forEach((function(e){if("range"===e.rangeType)for(var a=b(e.borderType,e.style,e.color),r=e.range[0],i=r.row,o=r.column,l=i[0]+1;l<i[1]+2;l++)for(var n=o[0]+1;n<o[1]+2;n++)t.getCell(l,n).border=a;if("cell"===e.rangeType){var s=e.value,c=s.col_index,d=s.row_index,u=Object.assign({},e.value);delete u.col_index,delete u.row_index;var h=y(u,d,c);t.getCell(d+1,c+1).border=h}}))},m=function(e,t){Array.isArray(e)&&e.forEach((function(e,a){e.every((function(e,r){if(!e)return!0;var i=p(e.bg),o=g(e.ff,e.fc,e.bl,e.it,e.fs,e.cl,e.ul),l=v(e.vt,e.ht,e.tb,e.tr),n="";e.f?n={formula:e.f,result:e.v}:!e.v&&e.ct&&e.ct.s?e.ct.s.forEach((function(e){n+=e.v})):n=e.v;var s=w(r),c=t.getCell(s+(a+1));for(var d in i){c.fill=i;break}return c.font=o,c.alignment=l,c.value=n,!0}))}))},p=function(e){if(!e)return{};var t={type:"pattern",pattern:"solid",fgColor:{argb:e.replace("#","")}};return t},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000000",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,n={0:"微软雅黑",1:"宋体（Song）",2:"黑体（ST Heiti）",3:"楷体（ST Kaiti）",4:"仿宋（ST FangSong）",5:"新宋体（ST Song）",6:"华文新魏",7:"华文行楷",8:"华文隶书",9:"Arial",10:"Times New Roman ",11:"Tahoma ",12:"Verdana",num2bl:function(e){return 0!==e}},s={name:"number"===typeof e?n[e]:e,family:1,size:i,color:{argb:t.replace("#","")},bold:n.num2bl(a),italic:n.num2bl(r),underline:n.num2bl(l),strike:n.num2bl(o)};return s},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"default",i={vertical:{0:"middle",1:"top",2:"bottom",default:"top"},horizontal:{0:"center",1:"left",2:"right",default:"left"},wrapText:{0:!1,1:!1,2:!0,default:!1},textRotation:{0:0,1:45,2:-45,3:"vertical",4:90,5:-90,default:0}},o={vertical:i.vertical[e],horizontal:i.horizontal[t],wrapText:i.wrapText[a],textRotation:i.textRotation[r]};return o},b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000";if(!e)return{};var r={type:{"border-all":"all","border-top":"top","border-right":"right","border-bottom":"bottom","border-left":"left"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}},i={style:r.style[t],color:{argb:a.replace("#","")}},o={};return"all"===r.type[e]?(o["top"]=i,o["right"]=i,o["bottom"]=i,o["left"]=i):o[r.type[e]]=i,o};function y(e,t,a){var r={},i={type:{l:"left",r:"right",b:"bottom",t:"top"},style:{0:"none",1:"thin",2:"hair",3:"dotted",4:"dashDot",5:"dashDot",6:"dashDotDot",7:"double",8:"medium",9:"mediumDashed",10:"mediumDashDot",11:"mediumDashDotDot",12:"slantDashDot",13:"thick"}};for(var o in e)-1===e[o].color.indexOf("rgb")?r[i.type[o]]={style:i.style[e[o].style],color:{argb:e[o].color.replace("#","")}}:r[i.type[o]]={style:i.style[e[o].style],color:{argb:e[o].color}};return r}function w(e){var t="A".charCodeAt(0),a="Z".charCodeAt(0),r=a-t+1,i="";while(e>=0)i=String.fromCharCode(e%r+t)+i,e=Math.floor(e/r)-1;return i}}}]);