(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-09589ce3","chunk-5db6ff55"],{"5bbd":function(t,e,a){},"7ba1":function(t,e,a){"use strict";a("5bbd")},"7c1d":function(t,e,a){},"7dfc":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:"".concat(t.queryParam.id?"编辑":"新增").concat(t.title),width:"100%",dialogClass:"fullDialog",visible:t.visible,confirmLoading:t.confirmLoading},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("div",{staticClass:"bodyWrapper",staticStyle:{height:"100% !important"}},[e("a-spin",{staticClass:"full-srceen",staticStyle:{padding:"0 12px",height:"100% !important"},attrs:{spinning:t.confirmLoading}},[e("NaCardContent",{attrs:{title:"基本信息"}},[e("a-form",{attrs:{form:t.form,layout:"inline"}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:4,sm:24}},[e("a-form-item",{staticStyle:{width:"100%"},attrs:{label:"步骤",labelCol:{span:6},wrapperCol:{span:18}}},[e("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["stepNum",t.validatorRules.stepNum],expression:"['stepNum', validatorRules.stepNum]"}],staticStyle:{width:"100%"},attrs:{max:999999999,placeholder:"请输入步骤"}})],1)],1),e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{staticStyle:{width:"100%"},attrs:{label:"步骤标题",labelCol:{span:6},wrapperCol:{span:18}}},[e("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["stepTitle",t.validatorRules.stepTitle],expression:"['stepTitle', validatorRules.stepTitle]"}],staticStyle:{width:"100%"},attrs:{maxLength:65,placeholder:"请输入内容"}})],1)],1)],1)],1)],1),e("NaCardContent",{attrs:{title:"步骤明细",height:"100%"}},[e("a-tabs",{attrs:{forceRender:!0},on:{tabClick:t.onTabClick,change:t.tabChangeEvent},scopedSlots:t._u([{key:"tabBarExtraContent",fn:function(){return[e("a-space",[1!==t.activeKey?e("a-button",{attrs:{type:"primary",disabled:t.isSaveData},on:{click:t.openFormModal}},[t._v("新增")]):t._e(),1!==t.activeKey?e("a-button",{attrs:{type:"dashed",disabled:!(t.isCheckRows&&!t.isSaveData)},on:{click:t.handleDel}},[t._v("删除")]):t._e(),t.isSaveData&&1!==t.activeKey?e("a-button",{attrs:{type:"primary"},on:{click:t.saveRowData}},[t._v("保存")]):t._e(),t.isSaveData&&1!==t.activeKey?e("a-button",{on:{click:t.cencelRowData}},[t._v("取消")]):t._e()],1)]},proxy:!0}]),model:{value:t.activeKey,callback:function(e){t.activeKey=e},expression:"activeKey"}},[e("a-tab-pane",{key:1,attrs:{tab:"步骤内容"}},[t.isShowEditor?e("j-editor",{attrs:{triggerChange:""},on:{change:t.onEditor},model:{value:t.queryParam.stepContent,callback:function(e){t.$set(t.queryParam,"stepContent",e)},expression:"queryParam.stepContent"}}):t._e()],1),e("a-tab-pane",{key:2,attrs:{tab:"额定物料"}},[e("div",{staticStyle:{height:"calc(100vh - 334px)"}},[e("vxe-table",{ref:"materialListTable",attrs:{border:"",align:"center",height:"auto",data:t.queryParam.materialList,"edit-rules":t.validRules,"keep-source":!0,"checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{trigger:"manual",mode:"row",autoClear:!1,showStatus:!0}},on:{"checkbox-change":t.rangeChange,"checkbox-all":t.rangeChange}},[e("vxe-table-column",{attrs:{type:"checkbox",width:"60px"}}),e("vxe-table-column",{attrs:{field:"name",title:"物料名称"}}),e("vxe-table-column",{attrs:{field:"category2_dictText",title:"物料分类"}}),e("vxe-table-column",{attrs:{field:"amount",title:"所需数量","edit-render":{name:"input"}},scopedSlots:t._u([{key:"edit",fn:function(a){var i=a.row;return[e("a-input-number",{staticStyle:{width:"100%"},attrs:{defaultValue:1,min:1,max:999999},model:{value:i.amount,callback:function(e){t.$set(i,"amount",e)},expression:"row.amount"}})]}}])}),e("vxe-table-column",{attrs:{field:"unit",title:"单位"}}),e("vxe-table-column",{attrs:{field:"code",title:"物料编码"}}),e("vxe-table-column",{attrs:{title:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){var i=a.row;return[t.$refs.materialListTable.isActiveByRow(i)?[e("a-space",[e("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(e){return e.stopPropagation(),t.saveRowData()}}},[t._v("保存")]),e("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(e){return e.stopPropagation(),t.cencelRowData()}}},[t._v("取消")])],1)]:[e("a-button",{attrs:{type:"dashed",disabled:!1,size:"small"},on:{click:function(e){return e.stopPropagation(),t.handleEdit(i)}}},[t._v("编辑")])]]}}])})],1)],1)]),e("a-tab-pane",{key:3,attrs:{tab:"所需工具"}},[e("div",{staticStyle:{height:"calc(100vh - 334px)"}},[e("vxe-table",{ref:"toolListTable",attrs:{border:"",align:"center",height:"auto",data:t.queryParam.toolList,"edit-rules":t.validRules,"keep-source":!0,"checkbox-config":{trigger:"row",highlight:!0,range:!0},"edit-config":{trigger:"manual",mode:"row",autoClear:!1,showStatus:!0}},on:{"checkbox-change":t.rangeChange,"checkbox-all":t.rangeChange}},[e("vxe-table-column",{attrs:{type:"checkbox",width:"60px"}}),e("vxe-table-column",{attrs:{field:"name",title:"工器具名称"}}),e("vxe-table-column",{attrs:{field:"kind_dictText",title:"工器具分类"}}),e("vxe-table-column",{attrs:{field:"amount",title:"所需数量","edit-render":{name:"input"}},scopedSlots:t._u([{key:"edit",fn:function(a){var i=a.row;return[e("a-input-number",{staticStyle:{width:"100%"},attrs:{defaultValue:1,min:1,max:999999},model:{value:i.amount,callback:function(e){t.$set(i,"amount",e)},expression:"row.amount"}})]}}])}),e("vxe-table-column",{attrs:{field:"unit",title:"单位"}}),e("vxe-table-column",{attrs:{field:"code",title:"物料编码"}}),e("vxe-table-column",{attrs:{title:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){var i=a.row;return[t.$refs.toolListTable.isActiveByRow(i)?[e("a-space",[e("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(e){return e.stopPropagation(),t.saveRowData()}}},[t._v("保存")]),e("a-button",{attrs:{type:"dashed",size:"small"},on:{click:function(e){return e.stopPropagation(),t.cencelRowData()}}},[t._v("取消")])],1)]:[e("a-button",{attrs:{type:"dashed",disabled:!1,size:"small"},on:{click:function(e){return e.stopPropagation(),t.handleEdit(i)}}},[t._v("编辑")])]]}}])})],1)],1)])],1)],1)],1)],1),e("material-list",{ref:"materialModal",attrs:{multiple:!0},on:{ok:t.onSelectMaterial}}),e("ToolsList",{ref:"toolsModal",attrs:{batch:"",multiple:!0,canSelectType:[4,5]},on:{ok:t.onSelectTool}})],1)},r=[],n=a("d4ee"),o=a("7164"),s=a("5633"),l=a("a4db"),c=a("8fad"),u=a("a061"),d=a("ca00"),h={name:"WorkSopDetailModal",components:{LineSelectList:s["default"],JEditor:u["default"],NaCardContent:n["default"],MaterialList:o["default"],ToolsList:l["default"]},data:function(){return{isCheckRow:!1,isCheckRows:!1,isSaveData:!1,isShowEditor:!0,value:1,title:"步骤",visible:!1,activeKey:1,contentStr:"",model:{},curRow:null,confirmLoading:!1,form:this.$form.createForm(this),validRules:{amount:[{required:!0,message:"数量必须填写"}]},validatorRules:{stepNum:{rules:[{required:!0,message:"请输入步骤"}]},stepTitle:{rules:[{required:!0,message:"请输入标题"},{max:64,message:"不能超过64个字符"}]}},queryParam:{bookId:null,stepNum:null,stepTitle:null,stepContent:null,materialList:[],toolList:[]},historyActiveKey:null,maxNumber:-1}},computed:{activeTableRef:function(){return 3===this.activeKey?this.$refs.toolListTable:this.$refs.materialListTable}},created:function(){},methods:{add:function(t,e){this.queryParam.bookId=t,this.maxNumber=e,this.edit({})},edit:function(t){var e=this;this.confirmLoading=!1,this.visible=!0,this.activeKey=1,this.isSaveData=!1,t.id?Object(c["Qb"])({detailId:t.id}).then((function(a){a.success?t=Object.assign(e.queryParam,JSON.parse(JSON.stringify(a.result))):(e.$message.error(a.message),e.visible=!1)})):(this.queryParam.id=null,this.queryParam.stepNum=null,this.queryParam.stepTitle=null,this.queryParam.stepContent=null,this.queryParam.materialList=[],this.queryParam.toolList=[],this.maxNumber>0&&(this.queryParam.stepNum=this.maxNumber),t=JSON.parse(JSON.stringify(this.queryParam))),this.form.resetFields(),this.model=JSON.parse(JSON.stringify(t)),this.visible=!0,this.$nextTick((function(){e.isShowEditor=!0,e.form.setFieldsValue({stepNum:t.stepNum,stepTitle:t.stepTitle})})),this.queryParam.stepNum=-1},handleOk:function(){this.save()},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.isShowEditor=!1,this.visible=!1},save:function(){var t=this;this.confirmLoading=!0,this.form.validateFields((function(e,a){e?t.confirmLoading=!1:(Object.assign(t.queryParam,a),Object(c["Xc"])(t.queryParam).then((function(e){e.success?(t.$message.success("保存成功"),t.isShowEditor=!1,t.$emit("ok",t.queryParam.bookId),t.visible=!1):t.$message.error(e.message)})).finally((function(){t.confirmLoading=!1})))}))},saveRowData:function(){var t=this,e=this.activeTableRef.getActiveRecord();e&&(this.activeTableRef.validate(e.row,(function(a){if(a)for(var i in a){var r=a[i];r.forEach((function(e){e.rule&&t.$message.error(e.rule.message)}))}else 2===t.activeKey?t.queryParam.materialList.find((function(t){return t===e.row}))||(e.row.id=Object(d["p"])(),t.queryParam.materialList.push(Object.assign({},e.row))):t.queryParam.toolList.find((function(t){return t===e.row}))||(e.row.id=Object(d["p"])(),t.queryParam.toolList.push(Object.assign({},e.row))),t.isSaveData=!1,t.activeTableRef.clearActived()})),this.rangeChange())},cencelRowData:function(){var t=this.activeTableRef.getActiveRecord();t&&(t.row.id?this.activeTableRef.revertData(t.row):this.activeTableRef.remove(t.row)),this.activeTableRef.clearActived(),this.isSaveData=!1},handleEdit:function(t){this.activeTableRef.setActiveRow(t),this.isSaveData=!0},handleDel:function(){var t=this,e=this.activeTableRef.getCheckboxRecords();this.$confirm({content:"是否删除选中".concat(e.length,"条数据？"),okText:"确定",cancelText:"取消",onOk:function(){e.forEach((function(e){2===t.activeKey?t.queryParam.materialList.splice(t.queryParam.materialList.findIndex((function(t){return t===e})),1):3===t.activeKey&&t.queryParam.toolList.splice(t.queryParam.toolList.findIndex((function(t){return t===e})),1),t.isCheckRow=!1,t.isCheckRows=!1}))}})},openFormModal:function(){switch(this.activeKey){case 2:this.$refs.materialModal.showModal();break;case 3:this.$refs.toolsModal.showModal();break}},onEditor:function(t){this.queryParam.stepContent=t},onSelectMaterial:function(t){var e=this;t.forEach((function(t){if(e.queryParam.materialList.find((function(e){return e.materialTypeId===t.id})))e.$message.warn("".concat(t.name,"物料已经存在列表中"));else{var a={amount:Number(t.num),bookDetailId:e.queryParam.id,category1:t.category1,category1_dictText:t.category1_dictText,category2:t.category2,category2_dictText:t.category2_dictText,code:t.code,id:"",kind:t.kind,materialTypeId:t.id,name:t.name,price:t.price,spec:t.spec,unit:t.unit};e.queryParam.materialList.push(a)}}))},onSelectTool:function(t){var e=this;t.forEach((function(t){if(e.queryParam.toolList.find((function(e){return e.toolTypeId===t.id})))e.$message.warn("".concat(t.name,"工器具已经存在列表中"));else{var a={amount:Number(t.num),bookDetailId:e.queryParam.id,kind_dictText:t.kind_dictText,code:t.code,id:"",toolTypeId:t.id,unit:t.unit,name:t.name,status_dictText:t.status_dictText};e.queryParam.toolList.push(a)}}))},rangeChange:function(){var t=this.activeTableRef.getCheckboxRecords();this.isCheckRow=1===t.length,this.isCheckRows=t.length>0},testEvent:function(t){return t.preventDefault(),!1},onTabClick:function(){if(this.activeTableRef&&this.activeTableRef.getActiveRecord())return this.historyActiveKey=this.activeKey,void this.$message.warn("有未保存数据");this.historyActiveKey=null},tabChangeEvent:function(){this.historyActiveKey&&(this.activeKey=this.historyActiveKey),this.isShowEditor=1===this.activeKey}}},m=h,f=a("2877"),p=Object(f["a"])(m,i,r,!1,null,null,null);e["default"]=p.exports},"9d91":function(t,e,a){"use strict";a("7c1d")},a4db:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{width:"90%",title:t.title,visible:t.visible,confirmLoading:t.confirmLoading,cancelText:"关闭",centered:"",destroyOnClose:!0,bodyStyle:{height:"80vh"}},on:{ok:t.handleOk,cancel:t.handleCancel}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.findList.apply(null,arguments)}}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:7,sm:24}},[e("a-form-item",{attrs:{label:"搜索"}},[e("a-input",{attrs:{placeholder:"请输入工器具名称或编码"},model:{value:t.queryParam.searchText,callback:function(e){t.$set(t.queryParam,"searchText",e)},expression:"queryParam.searchText"}})],1)],1),e("a-col",{attrs:{md:7,sm:24}},[e("a-form-item",{attrs:{label:"分类"}},[e("j-dict-select-tag",{attrs:{dictCode:"bu_tools_type",disabledArray:t.canSelectType},model:{value:t.queryParam.category1,callback:function(e){t.$set(t.queryParam,"category1",e)},expression:"queryParam.category1"}})],1)],1),e("a-col",{attrs:{md:3,sm:8}},[e("a-button",{on:{click:t.findList}},[t._v("查询")])],1)],1)],1)],1),e("div",{staticStyle:{height:"calc(80vh - 130px)"}},[e("vxe-table",{ref:"listTable",staticStyle:{height:"calc(80vh - 130px)"},attrs:{border:"","max-height":"100%",align:t.allAlign,data:t.tableData,"show-overflow":"tooltip","radio-config":t.multiple?{}:{trigger:"row",checkMethod:t.checkRadioMethod},"checkbox-config":t.multiple?{trigger:"row",highlight:!0,range:!0,checkMethod:t.checkRadioMethod}:{},"edit-config":{trigger:"click",mode:"cell",showIcon:"true"}},on:{"cell-click":t.onCellClick}},[t.multiple?e("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}):e("vxe-table-column",{attrs:{type:"radio",width:"40"}}),e("vxe-table-column",{attrs:{field:"code",title:"编码",width:"150"}}),e("vxe-table-column",{attrs:{field:"name",title:"名称",align:"left","header-align":"center"}}),e("vxe-table-column",{attrs:{field:"category1_dictText",title:"类别",width:"150"}}),e("vxe-table-column",{attrs:{field:"unit",title:"单位",width:"150"}}),t.batch?e("vxe-table-column",{attrs:{field:"num",title:"所需数量",width:"200","edit-render":{name:"$input",immediate:!0,props:{type:"number",Min:0}}}}):t._e()],1),e("vxe-pager",{attrs:{perfect:"","current-page":t.queryParam.pageNo,"page-size":t.queryParam.pageSize,total:t.totalResult,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},on:{"update:currentPage":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:current-page":function(e){return t.$set(t.queryParam,"pageNo",e)},"update:pageSize":function(e){return t.$set(t.queryParam,"pageSize",e)},"update:page-size":function(e){return t.$set(t.queryParam,"pageSize",e)},"page-change":t.handlePageChange}})],1)])},r=[],n=a("c54ca"),o={name:"ToolTypeSelect",props:{multiple:{type:Boolean,default:!0},canSelectType:{type:Array,default:function(){return[4,5,6]}},batch:{type:Boolean,default:!1}},data:function(){return{title:"工器具类型选择",queryParam:{type:"2",searchText:"",category1:null,pageNo:1,pageSize:10},allAlign:"center",totalResult:0,tableData:[],visible:!1,confirmLoading:!1}},methods:{showModal:function(){this.visible=!0,this.canSelectType&&this.canSelectType.length>0&&(this.queryParam.category1=this.canSelectType[0]),this.findList()},findList:function(){var t=this;this.loading=!0,Object(n["Cb"])(this.queryParam).then((function(e){t.totalResult=e.result.total,t.loading=!1,t.tableData=e.result.records,t.tableData.forEach((function(e){t.$set(e,"num",1)}))}))},handlePageChange:function(t){var e=t.currentPage,a=t.pageSize;this.queryParam.pageNo=e,this.queryParam.pageSize=a,this.findList()},handleOk:function(){var t=[];this.multiple?t=this.$refs.listTable.getCheckboxRecords():this.$refs.listTable.getRadioRecord()&&t.push(this.$refs.listTable.getRadioRecord()),this.$emit("ok",t),this.visible=!1},handleCancel:function(){this.close()},close:function(){this.$emit("close"),this.visible=!1},checkRadioMethod:function(t){var e=t.row;return!this.canSelectType||-1!==this.canSelectType.indexOf(e.category1)},onCellClick:function(t){var e=t.row,a=t.column;"num"===a.property&&this.$refs.listTable.setCheckboxRow([e],!0)}}},s=o,l=(a("7ba1"),a("2877")),c=Object(l["a"])(s,i,r,!1,null,"df2d4508",null);e["default"]=c.exports},c1fa:function(t,e,a){"use strict";function i(t){if(null==t)throw new TypeError("Cannot destructure "+t)}a.r(e);var r=function(){var t=this,e=t._self._c;return e("NaCardContent",{attrs:{title:"借用明细",height:"100%"}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{staticStyle:{"margin-bottom":"12px"},attrs:{span:24}},[e("a-space",[t.isSaveData?t._e():e("a-button",{attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("新增")]),t.isCheckRow&&!t.isSaveData?e("a-button",{attrs:{type:"dashed"},on:{click:t.handleEdit}},[t._v("编辑")]):t._e(),t.isCheckRows&&!t.isSaveData?e("a-button",{attrs:{type:"dashed"},on:{click:t.handleDel}},[t._v("删除")]):t._e(),t.isSaveData?e("a-button",{attrs:{type:"primary"},on:{click:t.saveRowData}},[t._v("保存")]):t._e(),t.isSaveData?e("a-button",{on:{click:t.cencelRowData}},[t._v("取消")]):t._e()],1)],1)],1),e("div",{staticClass:"table-page-body-wrapper",staticStyle:{height:"100%"}},[e("div",{staticClass:"table-body-context"},[e("vxe-table",{ref:"listTable",attrs:{border:"",align:"center",height:"auto","keep-source":!0,"edit-config":{trigger:"manual",mode:"row",autoClear:!1,showStatus:!0},data:t.tableData,"edit-rules":t.validatorRules,"checkbox-config":{trigger:"row",highlight:!0,range:!0}},on:{"checkbox-change":t.rangeChange,"checkbox-all":t.rangeChange}},[e("vxe-table-column",{attrs:{type:"checkbox",width:"60px"}}),e("vxe-table-column",{attrs:{field:"materialTypeCode",title:"物资编码"}}),e("vxe-table-column",{attrs:{field:"materialTypeName",title:"物资名称"}}),e("vxe-table-column",{attrs:{field:"materialTypeSpec",title:"物资描述"}}),e("vxe-table-column",{attrs:{field:"materialTypeUnit",title:"单位"}}),e("vxe-table-column",{attrs:{field:"amount",title:"借用数量","edit-render":{name:"input"}},scopedSlots:t._u([{key:"edit",fn:function(a){var i=a.row;return[e("a-input-number",{staticStyle:{width:"100%"},attrs:{defaultValue:1,min:1,max:1e7},model:{value:i.amount,callback:function(e){t.$set(i,"amount",e)},expression:"row.amount"}})]}}])}),e("vxe-table-column",{attrs:{field:"reason",title:"借用理由","edit-render":{name:"input"}}}),e("vxe-table-column",{attrs:{field:"warehouseName",title:"库位"}}),e("vxe-table-column",{attrs:{field:"returnStatus_dictText",title:"归还状态","edit-render":{name:"input"}},scopedSlots:t._u([{key:"edit",fn:function(a){var i=a.row;return[e("j-dict-select-tag",{staticStyle:{width:"100%"},attrs:{dictCode:t.dictReturnStatusStr},on:{select:t.onReturnStatusChange},model:{value:i.returnStatus,callback:function(e){t.$set(i,"returnStatus",e)},expression:"row.returnStatus"}})]}}])}),e("vxe-table-column",{attrs:{field:"returnDate",title:"归还日期","edit-render":{name:"input"}},scopedSlots:t._u([{key:"edit",fn:function(a){return i(a),[e("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD"},model:{value:t.pickDate,callback:function(e){t.pickDate=e},expression:"pickDate"}})]}}])})],1)],1)]),e("material-list",{ref:"materialModal",attrs:{multiple:!1},on:{ok:t.onSelectMaterial}})],1)},n=[],o=a("d4ee"),s=a("7dfc"),l=(a("c54ca"),a("7164")),c={name:"BorrowDetail",components:{NaCardContent:o["default"],WorkSopDetailModal:s["default"],MaterialList:l["default"]},props:{tableData:{type:Array,default:[]},borrowInfo:{type:Object,default:{}}},data:function(){return{curEditMode:0,isCheckRow:!1,isCheckRows:!1,isSaveData:!1,visible:!1,dictReturnStatusStr:"bu_material_return_status",confirmLoading:!1,pickDate:null,queryParam:{id:""},validatorRules:{reason:[{max:64,message:"输入长度不能超过64个字符!"}]}}},created:function(){},methods:{initStatus:function(){this.isSaveData=!1,this.isCheckRow=!1,this.isCheckRows=!1,this.updateDict(this.borrowInfo.returnType)},updateDict:function(t){1==t?this.dictReturnStatusStr="bu_material_return_status":2==t&&(this.dictReturnStatusStr="bu_material_transfers_status")},save:function(){this.isSaveData=!1},saveRowData:function(){var t=this,e=this.$refs.listTable.getActiveRecord();e&&(this.$refs.listTable.validate(e.row,(function(a){if(a)for(var i in a){var r=a[i];r.forEach((function(e){e.rule&&t.$message.error(e.rule.message)}))}else t.pickDate&&(e.row.returnDate=t.pickDate.format("YYYY-MM-DD")),t.tableData.find((function(t){return t===e.row}))||t.tableData.push(Object.assign({},e.row)),t.isSaveData=!1,t.curEditMode=0,t.$refs.listTable.clearActived()})),this.rangeChange())},cencelRowData:function(){var t=this.$refs.listTable.getActiveRecord();t&&(t.row.id||2===this.curEditMode?this.$refs.listTable.revertData(t.row):this.$refs.listTable.remove(t.row)),this.$refs.listTable.clearActived(),this.isSaveData=!1,this.curEditMode=0},rangeChange:function(){var t=this.$refs.listTable.getCheckboxRecords();this.isCheckRow=1===t.length,this.isCheckRows=t.length>0},handleAdd:function(){this.curEditMode=1,this.$refs.materialModal.showModal()},handleEdit:function(){if(this.curEditMode=2,this.$refs.listTable.getActiveRecord())this.$message.warn("有未保存数据");else{var t=this.$refs.listTable.getCheckboxRecords()[0];this.$refs.listTable.setActiveRow(t),t.returnDate?this.pickDate=this.$moment(t.returnDate):this.pickDate=null,this.isSaveData=!0}},handleDel:function(){var t=this,e=this.$refs.listTable.getCheckboxRecords();this.$confirm({content:"是否删除选中".concat(e.length,"条数据？"),okText:"确定",cancelText:"取消",onOk:function(){e.forEach((function(e){t.tableData.splice(t.tableData.findIndex((function(t){return t===e})),1),t.isCheckRow=!1,t.isCheckRows=!1}))}})},onReturnStatusChange:function(t,e){var a=this.$refs.listTable.getActiveRecord();a.row.returnStatus_dictText=e.title},onSelectMaterial:function(t){var e=this;t.forEach((function(t){if(e.tableData.find((function(e){return e.materialTypeId===t.id})))e.$message.warn("".concat(t.name,"物料已经存在列表中"));else{var a={amount:Number(t.num),borrowId:e.borrowInfo.borrowId,id:null,materialTypeCode:t.code,materialTypeId:t.id,materialTypeName:t.name,materialTypeSpec:t.spec,materialTypeUnit:t.unit,reason:"",remark:"",returnDate:null,returnStatus:0,returnStatus_dictText:"未归还",warehouseLocationId:e.borrowInfo.warehouseLocationId,warehouseName:e.borrowInfo.warehouseName};e.pickDate=null,e.isSaveData=!0,e.$refs.listTable.insertAt.call(e,a,-1).then((function(t){var a=t.row;e.isSaveData=!0,e.$refs.listTable.setActiveCell(a,"amount")}))}}))}}},u=c,d=a("2877"),h=Object(d["a"])(u,r,n,!1,null,null,null);e["default"]=h.exports},d4ee:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"na-content-body",style:{height:t.height}},[e("h4",{staticClass:"na-content-title"},[t._v(t._s(t.title))]),t._t("default")],2)},r=[],n={props:{title:{type:String,default:""},height:{type:String,default:"auto"}}},o=n,s=(a("9d91"),a("2877")),l=Object(s["a"])(o,i,r,!1,null,"274eed10",null);e["default"]=l.exports}}]);