<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.modules.basemanage.track.mapper.BuMtrTrackMapper">


    <select id="selectTrackPage" resultType="org.jeecg.modules.basemanage.track.entity.BuMtrTrack">
        SELECT
        (@rownum := @rownum + 1) AS rowNum,d.name as depot,
        t.*
        FROM
        bu_mtr_track t left join bu_mtr_depot d on t.depot_id =d.id,
        (SELECT
        @rownum := 0) AS rn

        <where>
            <if test="track.depotId!=null and track.depotId!=''">
                t.depot_id = #{track.depotId}
            </if>
            <if test="track.code!=null and track.code!=''">
                and t.code like concat('%',#{track.code} '%')
            </if>
        </where>
        ORDER BY code
    </select>
</mapper>
