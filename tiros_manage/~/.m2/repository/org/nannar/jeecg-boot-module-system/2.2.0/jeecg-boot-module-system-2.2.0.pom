<project xmlns="http://maven.apache.org/POM/4.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<artifactId>jeecg-boot-module-system</artifactId>

	<parent>
		<groupId>org.nannar</groupId>
		<artifactId>tiros-manage-parent</artifactId>
		<version>2.2.0</version>
	</parent>

	<dependencies>
		<dependency>
			<groupId>org.nannar</groupId>
			<artifactId>jeecg-boot-base-common</artifactId>
			<version>${project.parent.version}</version>
		</dependency>
		<dependency>
			<groupId>org.nannar</groupId>
			<artifactId>jeecg-boot-module-basemanage</artifactId>
			<version>${project.parent.version}</version>
		</dependency>
		<dependency>
			<groupId>org.nannar</groupId>
			<artifactId>jeecg-boot-module-materialmanage</artifactId>
			<version>${project.parent.version}</version>
		</dependency>
		<dependency>
			<groupId>org.nannar</groupId>
			<artifactId>jeecg-boot-module-dispatchmanage</artifactId>
			<version>${project.parent.version}</version>
		</dependency>
		<dependency>
			<groupId>org.nannar</groupId>
			<artifactId>jeecg-boot-module-groupmanage</artifactId>
			<version>${project.parent.version}</version>
		</dependency>
		<dependency>
			<groupId>org.nannar</groupId>
			<artifactId>jeecg-boot-module-qualitymanage</artifactId>
			<version>${project.parent.version}</version>
		</dependency>
		<dependency>
			<groupId>org.nannar</groupId>
			<artifactId>jeecg-boot-module-outsource</artifactId>
			<version>${project.parent.version}</version>
		</dependency>
		<dependency>
			<groupId>org.nannar</groupId>
			<artifactId>jeecg-boot-module-producemanage</artifactId>
			<version>${project.parent.version}</version>
		</dependency>
		<dependency>
			<groupId>org.nannar</groupId>
			<artifactId>jeecg-boot-module-boardmanage</artifactId>
			<version>${project.parent.version}</version>
		</dependency>
		<dependency>
			<groupId>org.nannar</groupId>
			<artifactId>jeecg-boot-module-reportmanage</artifactId>
			<version>${project.parent.version}</version>
		</dependency>
		<!-- 提供监控信息接口 (供spring boot admin 调用)-->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-actuator</artifactId>
		</dependency>

		<!-- 用于控制actuator 访问安全 -->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-security</artifactId>
		</dependency>

		<!-- spring boot admin client -->
		<dependency>
			<groupId>de.codecentric</groupId>
			<artifactId>spring-boot-admin-starter-client</artifactId>
			<version>2.3.0</version>
		</dependency>
		<!-- 启动 Nacos 配置管理服务 -->
		<!--<dependency>
			<groupId>com.alibaba.cloud</groupId>
			<artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>
		</dependency>-->

		<dependency>
			<groupId>javax.servlet</groupId>
			<artifactId>javax.servlet-api</artifactId>
			<version>4.0.1</version>
			<scope>compile</scope>
		</dependency>

		<dependency>
			<groupId>org.apache.httpcomponents</groupId>
			<artifactId>httpclient</artifactId>
			<version>4.5.7</version>
		</dependency>
		<dependency>
			<groupId>com.nannar</groupId>  <!--自定义-->
			<artifactId>sso</artifactId>    <!--自定义-->
			<version>1.0</version> <!--自定义-->
			<scope>system</scope> <!--system，类似provided，需要显式提供依赖的jar以后，Maven就不会在Repository中查找它-->
			<systemPath>${basedir}/lib/JavaPSO.jar</systemPath> <!--项目根目录下的lib文件夹下-->
		</dependency>
		<dependency>
			<groupId>com.nannar</groupId>
			<artifactId>sso2</artifactId>
			<version>2.3.6</version>
			<scope>system</scope>
			<systemPath>${basedir}/lib/bingo-sso-client-web-2.3.6.jar</systemPath>
		</dependency>

		<!-- 使用Spring Security Oauth2的自动配置 -->
		<!--<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-oauth2-client</artifactId>
			<version>2.1.3.RELEASE</version>
		</dependency>-->
	</dependencies>
	
	<build>
		<!-- jar包名 -->
		<finalName>tiros_manage</finalName>
		<plugins>
			<plugin>
				<groupId>org.springframework.boot</groupId>
				<artifactId>spring-boot-maven-plugin</artifactId>
				<configuration>
					<layout>ZIP</layout>
					<includes>
						<include>
							<groupId>non-exists</groupId>
							<artifactId>non-exists</artifactId>
						</include>
					</includes>
				</configuration>
				<executions>
					<execution>
						<goals>
							<goal>repackage</goal>
						</goals>
					</execution>
				</executions>
			</plugin>
			<!-- 分离lib -->
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-dependency-plugin</artifactId>
				<executions>
					<execution>
						<id>copy-dependencies</id>
						<phase>package</phase>
						<goals>
							<goal>copy-dependencies</goal>
						</goals>
						<configuration>
							<!-- 依赖包输出目录，将来不打进jar包里 -->
							<outputDirectory>${project.build.directory}/${project.build.finalName}/lib</outputDirectory>
							<excludeTransitive>false</excludeTransitive>
							<stripVersion>false</stripVersion>

							<includeScope>runtime</includeScope>
						</configuration>
					</execution>
				</executions>
			</plugin>
			<!-- copy资源文件 -->
			<plugin>
				<artifactId>maven-resources-plugin</artifactId>
				<executions>
					<execution>
						<id>copy-resources</id>
						<phase>package</phase>
						<goals>
							<goal>copy-resources</goal>
						</goals>
						<configuration>
							<resources>
								<resource>
									<directory>src/main/resources</directory>
								</resource>
							</resources>
							<outputDirectory>${project.build.directory}/${project.build.finalName}/resources</outputDirectory>
							<encoding>UTF-8</encoding>
						</configuration>
					</execution>
				</executions>
			</plugin>
			<!-- 打jar包时忽略配置文件 -->
			<!--<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-jar-plugin</artifactId>
				<configuration>
					<excludes>
						<exclude>**/*.yml</exclude>
						<exclude>**/*.xml</exclude>
					</excludes>
				</configuration>
			</plugin>-->
			<!-- 打jar包时忽略resources文件 -->
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-jar-plugin</artifactId>
				<configuration>
					<excludes>
						<!--注意这玩意从编译结果目录开始算目录结构-->
						<exclude>/*.yml</exclude>
						<exclude>/*.xml</exclude>
						<exclude>/*.txt</exclude>
						<exclude>/*.properties</exclude>
						<exclude>/static/**</exclude>
						<exclude>/templates/**</exclude>
						<exclude>/jeecg/**</exclude>
					</excludes>
				</configuration>
			</plugin>
			<!-- spring boot repackage -->
			<!-- copy 相关文件 -->
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-antrun-plugin</artifactId>
				<version>1.8</version>
				<executions>
					<execution>
						<id>copy-jar-file</id>
						<phase>package</phase>
						<goals>
							<goal>run</goal>
						</goals>
						<configuration>
							<tasks>
								<copy todir="${project.basedir}/target/${project.build.finalName}">
									<fileset dir="${project.basedir}/target">
										<include name="${project.build.finalName}.jar" />
									</fileset>
								</copy>
								<copy todir="${project.basedir}/target/${project.build.finalName}" failonerror="false">
									<fileset dir="${project.basedir}/run">										
										<include name="app.sh" />
										<include name="app.bat" />
									</fileset>
								</copy>
								<copy todir="${project.basedir}/target/${project.build.finalName}/lib" failonerror="false">
									<fileset dir="${project.basedir}/lib">
										<include name="*.jar" />
									</fileset>
								</copy>
							</tasks>
						</configuration>
					</execution>
				</executions>
			</plugin>
			<!-- -->
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-install-plugin</artifactId>
				<version>2.5.2</version>
				<executions>
					<execution>
						<id>install-external-JavaPSO</id>
						<phase>clean</phase>
						<configuration>
							<file>${basedir}/lib/JavaPSO.jar</file>
							<repositoryLayout>default</repositoryLayout>
							<groupId>com.nannar</groupId>
							<artifactId>sso</artifactId>
							<version>1.0</version>
							<packaging>jar</packaging>
							<generatePom>true</generatePom>
						</configuration>
						<goals>
							<goal>install-file</goal>
						</goals>
					</execution>
				</executions>
			</plugin>
		</plugins>
	</build>
</project>