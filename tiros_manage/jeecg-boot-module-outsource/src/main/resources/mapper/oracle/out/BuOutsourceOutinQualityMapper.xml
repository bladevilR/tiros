<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.modules.outsource.mapper.BuOutsourceOutinQualityMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="org.jeecg.modules.outsource.bean.BuOutsourceOutinQuality">
        <id column="id" property="id"/>
        <result column="detail_id" property="detailId"/>
        <result column="asset_no" property="assetNo"/>
        <result column="asset_name" property="assetName"/>
        <result column="system_id" property="systemId"/>
        <result column="amount" property="amount"/>
        <result column="train_no" property="trainNo"/>
        <result column="turnover_asset_id" property="turnoverAssetId"/>
        <result column="check_date" property="checkDate"/>
        <result column="start_date" property="startDate"/>
        <result column="end_date" property="endDate"/>
        <result column="day_count" property="dayCount"/>
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, detail_id, asset_no, asset_name, system_id, amount, train_no, turnover_asset_id,
        check_date, start_date, end_date, day_count
    </sql>


    <update id="updateListWarranty">
        <if test="list != null and list.size > 0">
            <foreach collection="list" item="item" open="begin" close=";end;" separator=";">
                update bu_outsource_outin_quality
                set
                start_date = #{item.startDate, jdbcType=TIMESTAMP},
                end_date = #{item.endDate, jdbcType=TIMESTAMP},
                day_count = #{item.dayCount, jdbcType=NUMERIC}
                where detail_id in (
                select id from bu_outsource_outin_detail where outin_id in (
                select id from bu_outsource_outin where contract_id = #{item.contractId, jdbcType=VARCHAR}
                )
                )
            </foreach>
        </if>
    </update>

</mapper>
